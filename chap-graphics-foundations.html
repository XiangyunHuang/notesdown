<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>第 10 章 图形基础 | R 语言学习笔记</title>
<meta name="author" content="黄湘云">
<meta name="generator" content="bookdown 0.26 with bs4_book()">
<meta property="og:title" content="第 10 章 图形基础 | R 语言学习笔记">
<meta property="og:type" content="book">
<meta property="og:image" content="/images/cover.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="第 10 章 图形基础 | R 语言学习笔记">
<meta name="twitter:image" content="/images/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap/bootstrap.bundle.min.js"></script><script src="libs/bs3compat/transition.js"></script><script src="libs/bs3compat/tabs.js"></script><script src="libs/bs3compat/bs3compat.js"></script><link href="libs/bs4_book/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book/bs4_book.js"></script><script src="libs/htmlwidgets/htmlwidgets.js"></script><script src="libs/plotly-binding/plotly.js"></script><script src="libs/typedarray/typedarray.min.js"></script><link href="libs/crosstalk/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main/plotly-latest.min.js"></script><script src="libs/plotly-locale-zh-CN/zh-cn.js"></script><script src="libs/mathjax/cdn.js"></script><script src="libs/echarts4r/echarts-en.min.js"></script><script src="libs/echarts4r/ecStat.min.js"></script><script src="libs/echarts4r/dataTool.min.js"></script><script src="libs/echarts4r-binding/echarts4r.js"></script><script src="libs/d3/d3.min.js"></script><script src="libs/forceNetwork-binding/forceNetwork.js"></script><link href="libs/vis/vis-network.min.css" rel="stylesheet">
<script src="libs/vis/vis-network.min.js"></script><script src="libs/visNetwork-binding/visNetwork.js"></script><script src="libs/FileSaver/FileSaver.min.js"></script><script src="libs/Blob/Blob.js"></script><script src="libs/canvas-toBlob/canvas-toBlob.js"></script><script src="libs/html2canvas/html2canvas.js"></script><script src="libs/jspdf/jspdf.debug.js"></script><link href="libs/jquery-sparkline/jquery.sparkline.css" rel="stylesheet">
<script src="libs/jquery-sparkline/jquery.sparkline.js"></script><script src="libs/sparkline-binding/sparkline.js"></script><script src="libs/r2d3-render/r2d3-render.js"></script><script src="libs/webcomponents/webcomponents.js"></script><script src="libs/r2d3-binding/r2d3.js"></script><script src="libs/d3v6/d3.min.js"></script><script src="libs/kePrint/kePrint.js"></script><link href="libs/lightable/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-54GQKWF7VP"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-54GQKWF7VP');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
<meta name="description" content="library(survival) library(lattice) library(nlme) library(MASS) library(RColorBrewer) library(latticeExtra) library(shape) library(splines) library(mgcv) library(maps) library(mapproj)...">
<meta property="og:description" content="library(survival) library(lattice) library(nlme) library(MASS) library(RColorBrewer) library(latticeExtra) library(shape) library(splines) library(mgcv) library(maps) library(mapproj)...">
<meta name="twitter:description" content="library(survival) library(lattice) library(nlme) library(MASS) library(RColorBrewer) library(latticeExtra) library(shape) library(splines) library(mgcv) library(maps) library(mapproj)...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R 语言学习笔记</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">欢迎</a></li>
<li><a class="" href="chap-preface.html"><span class="header-section-number">1</span> 前言</a></li>
<li class="book-part">数据整理</li>
<li><a class="" href="chap-data-wrangling.html">介绍</a></li>
<li><a class="" href="chap-data-structure.html"><span class="header-section-number">2</span> 数据结构</a></li>
<li><a class="" href="chap-data-transportation.html"><span class="header-section-number">3</span> 数据搬运</a></li>
<li><a class="" href="chap-string-operations.html"><span class="header-section-number">4</span> 字符串操作</a></li>
<li><a class="" href="chap-regular-expressions.html"><span class="header-section-number">5</span> 正则表达式</a></li>
<li><a class="" href="chap-data-manipulation.html"><span class="header-section-number">6</span> 数据操作</a></li>
<li><a class="" href="chap-advanced-manipulation.html"><span class="header-section-number">7</span> 高级数据操作</a></li>
<li><a class="" href="chap-parallel-manipulation.html"><span class="header-section-number">8</span> 并行化操作</a></li>
<li><a class="" href="chap-dplyr-manipulation.html"><span class="header-section-number">9</span> 净土化操作</a></li>
<li class="book-part">统计图形</li>
<li><a class="" href="chap-statistical-graphics.html">介绍</a></li>
<li><a class="active" href="chap-graphics-foundations.html"><span class="header-section-number">10</span> 图形基础</a></li>
<li><a class="" href="chap-data-visualization.html"><span class="header-section-number">11</span> 数据可视化</a></li>
<li><a class="" href="chap-interactive-web-graphics.html"><span class="header-section-number">12</span> 交互图形</a></li>
<li class="book-part">统计计算</li>
<li><a class="" href="chap-statistical-computation.html">介绍</a></li>
<li><a class="" href="chap-numerical-optimization.html"><span class="header-section-number">13</span> 数值优化</a></li>
<li><a class="" href="chap-differential-equations.html"><span class="header-section-number">14</span> 微分方程</a></li>
<li class="book-part">附录</li>
<li><a class="" href="chap-linux-command-bash.html"><span class="header-section-number">A</span> 命令行操作</a></li>
<li><a class="" href="references.html">参考文献</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/XiangyunHuang/notesdown">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="chap-graphics-foundations" class="section level1" number="10">
<h1>
<span class="header-section-number">第 10 章</span> 图形基础<a class="anchor" aria-label="anchor" href="#chap-graphics-foundations"><i class="fas fa-link"></i></a>
</h1>
<div class="sourceCode" id="cb1303"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival">survival</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://lattice.r-forge.r-project.org/">lattice</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/">nlme</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://latticeextra.r-forge.r-project.org/">latticeExtra</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">shape</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">splines</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">mgcv</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">maps</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">mapproj</span><span class="op">)</span></code></pre></div>
<!--
作为知识介绍，本章所有数据都来源于基础 R 包，即安装 R 软件后自带的数据集，图库在以 base R 中的数据集介绍完后，以相应真实数据扩展为案列，结合统计意义和探索性数据分析介绍各种常见统计图形
-->
<p>数据可视化是一种重要的数据分析手段， R 提供了两套图形系统，分别是 graphics 包提供的基础绘图系统和 grid 包提供的栅格绘图系统，后者主要以两个 R 包为大家所熟知，一个是 lattice 包，另一个是 ggplot2 包。</p>
<p>Base 图形系统的扩展包 <a href="https://github.com/KKPMW/basetheme">basetheme</a> 可以设置主题，<a href="https://github.com/jumpingrivers/prettyB">prettyB</a> 和 <a href="https://github.com/pmur002/gridgraphics">gridGraphics</a></p>
<p>为了方便记忆函数 <code>par</code> 的各个参数，Paul Murrell 整理了一份 <a href="https://www.stat.auckland.ac.nz/~paul/R/parMemnonics.html">助记符</a>，此外，LaTeX 宏包 <a href="https://github.com/latexstudio/LaTeXPackages-CN">geometry</a> 对版面设置有很多专业的说明</p>
<div id="graphics-elements" class="section level2" number="10.1">
<h2>
<span class="header-section-number">10.1</span> 绘图基本要素<a class="anchor" aria-label="anchor" href="#graphics-elements"><i class="fas fa-link"></i></a>
</h2>
<div id="base-points" class="section level3" number="10.1.1">
<h3>
<span class="header-section-number">10.1.1</span> 点线<a class="anchor" aria-label="anchor" href="#base-points"><i class="fas fa-link"></i></a>
</h3>
<p>点和线是最常见的画图元素，在 <code>plot</code> 函数中，分别用参数 <code>pch</code> 和 <code>lty</code> 来设定类型，点的大小、线的宽度分别用参数 <code>cex</code> 和 <code>lwd</code> 来指定，颜色由参数 <code>col</code> 设置。参数 <code>type</code> 不同的值设置如下，<code>p</code> 显示点，<code>l</code> 绘制线，<code>b</code> 同时绘制空心点，并用线连接，<code>c</code> 只有线，<code>o</code> 在线上绘制点，<code>s</code> 和 <code>S</code> 点线连接绘制阶梯图，<code>h</code> 绘制类似直方图一样的垂线，最后 <code>n</code> 表示什么也不画。</p>
<p>点 points 、线 grid 背景线 abline lines rug 刻度线（线段segments、箭头arrows）、</p>
<div class="sourceCode" id="cb1304"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## -------- Showing all the extra &amp; some char graphics symbols ---------</span>
<span class="va">pchShow</span> <span class="op">&lt;-</span>
  <span class="kw">function</span><span class="op">(</span><span class="va">extras</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"*"</span>, <span class="st">"."</span>, <span class="st">"o"</span>, <span class="st">"O"</span>, <span class="st">"0"</span>, <span class="st">"+"</span>, <span class="st">"-"</span>, <span class="st">"|"</span>, <span class="st">"%"</span>, <span class="st">"#"</span><span class="op">)</span>,
             <span class="va">cex</span> <span class="op">=</span> <span class="fl">2</span>, <span class="co">## good for both .Device=="postscript" and "x11"</span>
             <span class="va">col</span> <span class="op">=</span> <span class="st">"red3"</span>, <span class="va">bg</span> <span class="op">=</span> <span class="st">"gold"</span>, <span class="va">coltext</span> <span class="op">=</span> <span class="st">"brown"</span>, <span class="va">cextext</span> <span class="op">=</span> <span class="fl">1.2</span>,
             <span class="va">main</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span>
               <span class="st">"plot symbols :  points (...  pch = *, cex ="</span>,
               <span class="va">cex</span>, <span class="st">")"</span>
             <span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">nex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">extras</span><span class="op">)</span>
    <span class="va">np</span> <span class="op">&lt;-</span> <span class="fl">26</span> <span class="op">+</span> <span class="va">nex</span>
    <span class="va">ipch</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">np</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>
    <span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">np</span><span class="op">)</span><span class="op">)</span>
    <span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span>
    <span class="va">rx</span> <span class="op">&lt;-</span> <span class="va">dd</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">ix</span> <span class="op">&lt;-</span> <span class="va">ipch</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%/%</a></span> <span class="va">k</span><span class="op">)</span>
    <span class="va">ry</span> <span class="op">&lt;-</span> <span class="va">dd</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">iy</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="op">+</span> <span class="op">(</span><span class="va">k</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">-</span> <span class="va">ipch</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span> <span class="va">k</span><span class="op">)</span>
    <span class="va">pch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="va">ipch</span><span class="op">)</span> <span class="co"># list with integers &amp; strings</span>
    <span class="kw">if</span> <span class="op">(</span><span class="va">nex</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="va">pch</span><span class="op">[</span><span class="fl">26</span> <span class="op">+</span> <span class="fl">1</span><span class="op">:</span><span class="va">nex</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="va">extras</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">rx</span>, <span class="va">ry</span>, type <span class="op">=</span> <span class="st">"n"</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, main <span class="op">=</span> <span class="va">main</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">ix</span>, h <span class="op">=</span> <span class="va">iy</span>, col <span class="op">=</span> <span class="st">"lightgray"</span>, lty <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span>
    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">np</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">pc</span> <span class="op">&lt;-</span> <span class="va">pch</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>
      <span class="co">## 'col' symbols with a 'bg'-colored interior (where available) :</span>
      <span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">ix</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">iy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, pch <span class="op">=</span> <span class="va">pc</span>, col <span class="op">=</span> <span class="va">col</span>, bg <span class="op">=</span> <span class="va">bg</span>, cex <span class="op">=</span> <span class="va">cex</span><span class="op">)</span>
      <span class="kw">if</span> <span class="op">(</span><span class="va">cextext</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span>
        <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">ix</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.3</span>, <span class="va">iy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">pc</span>, col <span class="op">=</span> <span class="va">coltext</span>, cex <span class="op">=</span> <span class="va">cextext</span><span class="op">)</span>
      <span class="op">}</span>
    <span class="op">}</span>
  <span class="op">}</span>

<span class="fu">pchShow</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-2"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-2-1.png" alt="不同的 pch 参数值" width="75%"><p class="caption">
图 10.1: 不同的 pch 参数值
</p>
</div>
<div class="sourceCode" id="cb1305"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## ------------ test code for various pch specifications -------------</span>
<span class="co"># Try this in various font families (including Hershey)</span>
<span class="co"># and locales.  Use sign = -1 asserts we want Latin-1.</span>
<span class="co"># Standard cases in a MBCS locale will not plot the top half.</span>
<span class="va">TestChars</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sign</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">font</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">MB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/l10n_info.html">l10n_info</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">MBCS</span>
  <span class="va">r</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="va">font</span> <span class="op">==</span> <span class="fl">5</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">sign</span> <span class="op">&lt;-</span> <span class="fl">1</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">32</span><span class="op">:</span><span class="fl">126</span>, <span class="fl">160</span><span class="op">:</span><span class="fl">254</span><span class="op">)</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">MB</span><span class="op">)</span> <span class="fl">32</span><span class="op">:</span><span class="fl">126</span> <span class="kw">else</span> <span class="fl">32</span><span class="op">:</span><span class="fl">255</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">sign</span> <span class="op">==</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">32</span><span class="op">:</span><span class="fl">126</span>, <span class="fl">160</span><span class="op">:</span><span class="fl">255</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>pty <span class="op">=</span> <span class="st">"s"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">16</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">16</span><span class="op">)</span>,
    type <span class="op">=</span> <span class="st">"n"</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>,
    xaxs <span class="op">=</span> <span class="st">"i"</span>, yaxs <span class="op">=</span> <span class="st">"i"</span>,
    main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"sign = %d, font = %d"</span>, <span class="va">sign</span>, <span class="va">font</span><span class="op">)</span>
  <span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="fl">17</span>, <span class="fl">17</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MBCS:"</span>, <span class="va">MB</span><span class="op">)</span><span class="op">)</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">r</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html">try</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">i</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span> <span class="fl">16</span>, <span class="va">i</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%/%</a></span> <span class="fl">16</span>, pch <span class="op">=</span> <span class="va">sign</span> <span class="op">*</span> <span class="va">i</span>, font <span class="op">=</span> <span class="va">font</span>, <span class="va">...</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu">TestChars</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-3-1"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-3-1.png" alt="pch 支持的字符" width="45%"><p class="caption">
图 10.2: pch 支持的字符
</p>
</div>
<div class="sourceCode" id="cb1306"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/try.html">try</a></span><span class="op">(</span><span class="fu">TestChars</span><span class="op">(</span>sign <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-3-2"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-3-2.png" alt="pch 支持的字符" width="45%"><p class="caption">
图 10.3: pch 支持的字符
</p>
</div>
<div class="sourceCode" id="cb1307"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">TestChars</span><span class="op">(</span>font <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="co"># Euro might be at 160 (0+10*16).</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-3-3"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-3-3.png" alt="pch 支持的字符" width="45%"><p class="caption">
图 10.4: pch 支持的字符
</p>
</div>
<div class="sourceCode" id="cb1308"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># macOS has apple at 240 (0+15*16).</span>
<span class="kw"><a href="https://rdrr.io/r/base/try.html">try</a></span><span class="op">(</span><span class="fu">TestChars</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, font <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># bold</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-3-4"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-3-4.png" alt="pch 支持的字符" width="45%"><p class="caption">
图 10.5: pch 支持的字符
</p>
</div>
<div class="sourceCode" id="cb1309"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">12</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">pi</span> <span class="op">/</span> <span class="fl">5</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fl">.1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">tp</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="st">"l"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"o"</span>, <span class="st">"h"</span>, <span class="st">"s"</span>, <span class="st">"S"</span>, <span class="st">"n"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, type <span class="op">=</span> <span class="va">tp</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"plot(*, type = \""</span>, <span class="va">tp</span>, <span class="st">"\")"</span><span class="op">)</span><span class="op">)</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">tp</span> <span class="op">==</span> <span class="st">"S"</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, type <span class="op">=</span> <span class="st">"s"</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"lines(*, type = \"s\", ...)"</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-4-1.png" alt="不同的 type 参数值" width="672"><p class="caption">
图 10.6: 不同的 type 参数值
</p>
</div>
<p>颜色 col 连续型和离散型</p>
<p>线帽/端和字体的样式</p>
<div class="sourceCode" id="cb1310"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 合并为一个图 三条粗横线 横线上三种字形</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">20</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">20</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"n"</span>, ann <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">15</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">15</span>, lend <span class="op">=</span> <span class="st">"round"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">5</span>, <span class="st">"Hello, Helvetica"</span>, cex <span class="op">=</span> <span class="fl">1.5</span>, family <span class="op">=</span> <span class="st">"sans"</span>, pos <span class="op">=</span> <span class="fl">1</span>, offset <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="st">"sans"</span>, cex <span class="op">=</span> <span class="fl">1.5</span>, family <span class="op">=</span> <span class="st">"sans"</span>, pos <span class="op">=</span> <span class="fl">2</span>, offset <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">5</span>, <span class="st">"lend = round"</span>, pos <span class="op">=</span> <span class="fl">4</span>, offset <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">15</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">15</span>, lend <span class="op">=</span> <span class="st">"butt"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="st">"Hello, Helvetica"</span>, cex <span class="op">=</span> <span class="fl">1.5</span>, family <span class="op">=</span> <span class="st">"mono"</span>, pos <span class="op">=</span> <span class="fl">1</span>, offset <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="st">"mono"</span>, cex <span class="op">=</span> <span class="fl">1.5</span>, family <span class="op">=</span> <span class="st">"mono"</span>, pos <span class="op">=</span> <span class="fl">2</span>, offset <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">10</span>, <span class="st">"lend = butt"</span>, pos <span class="op">=</span> <span class="fl">4</span>, offset <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">15</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">15</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">15</span>, lend <span class="op">=</span> <span class="st">"square"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">15</span>, <span class="st">"Hello, Helvetica"</span>, cex <span class="op">=</span> <span class="fl">1.5</span>, family <span class="op">=</span> <span class="st">"serif"</span>, pos <span class="op">=</span> <span class="fl">1</span>, offset <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">15</span>, <span class="st">"serif"</span>, cex <span class="op">=</span> <span class="fl">1.5</span>, family <span class="op">=</span> <span class="st">"serif"</span>, pos <span class="op">=</span> <span class="fl">2</span>, offset <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">15</span>, <span class="st">"lend = square"</span>, pos <span class="op">=</span> <span class="fl">4</span>, offset <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-5"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-5-1.png" alt="不同的线端样式" width="55%"><p class="caption">
图 10.7: 不同的线端样式
</p>
</div>
<p>lend：线端的样式，可用一个整数或字符串指定：</p>
<ul>
<li>0 或 “round” 圆形（默认）</li>
<li>1 或 “butt” 对接形</li>
<li>2 或 “square” 方形</li>
</ul>
</div>
<div id="base-rect" class="section level3" number="10.1.2">
<h3>
<span class="header-section-number">10.1.2</span> 区域<a class="anchor" aria-label="anchor" href="#base-rect"><i class="fas fa-link"></i></a>
</h3>
<p>矩形，多边形，曲线交汇出来的区域
面（矩形rect，多边形polygon）、路径 polypath
面/多边形 rect 颜色填充</p>
<div class="sourceCode" id="cb1311"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># From the manual</span>
<span class="va">ch.col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="st">"rainbow(n, start=.7, end=.1)"</span>,
  <span class="st">"heat.colors(n)"</span>,
  <span class="st">"terrain.colors(n)"</span>,
  <span class="st">"topo.colors(n)"</span>,
  <span class="st">"cm.colors(n)"</span>
<span class="op">)</span> <span class="co"># 选择颜色</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">16</span>
<span class="va">nt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ch.col</span><span class="op">)</span>
<span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span>
<span class="va">j</span> <span class="op">&lt;-</span> <span class="va">n</span> <span class="op">/</span> <span class="va">nt</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="va">j</span> <span class="op">/</span> <span class="fl">6</span>
<span class="va">dy</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">d</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">i</span> <span class="op">+</span> <span class="va">d</span>,
  type <span class="op">=</span> <span class="st">"n"</span>,
  yaxt <span class="op">=</span> <span class="st">"n"</span>,
  ylab <span class="op">=</span> <span class="st">""</span>,
  xlab <span class="op">=</span> <span class="st">""</span>,
  main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"color palettes; n="</span>, <span class="va">n</span><span class="op">)</span>
<span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nt</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/rect.html">rect</a></span><span class="op">(</span><span class="va">i</span> <span class="op">-</span> <span class="fl">.5</span>, <span class="op">(</span><span class="va">k</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">j</span> <span class="op">+</span> <span class="va">dy</span>, <span class="va">i</span> <span class="op">+</span> <span class="fl">.4</span>, <span class="va">k</span> <span class="op">*</span> <span class="va">j</span>,
    col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/parse.html">parse</a></span><span class="op">(</span>text <span class="op">=</span> <span class="va">ch.col</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span> <span class="co"># 咬人的函数/字符串解析为/转函数</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">j</span>, <span class="va">k</span> <span class="op">*</span> <span class="va">j</span> <span class="op">+</span> <span class="va">dy</span> <span class="op">/</span> <span class="fl">4</span>, <span class="va">ch.col</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-6"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-6-1.png" alt="rect 函数画长方形" width="672"><p class="caption">
图 10.8: rect 函数画长方形
</p>
</div>
<p><code>clip(x1, x2, y1, y2)</code> 在用户坐标中设置剪切区域</p>
<div class="sourceCode" id="cb1312"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">x</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="va">usr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="st">"usr"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/clip.html">clip</a></span><span class="op">(</span><span class="va">usr</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="op">-</span><span class="fl">2</span>, <span class="va">usr</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">usr</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">x</span>, col <span class="op">=</span> <span class="st">"red"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/clip.html">clip</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">usr</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">usr</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">usr</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">x</span>, col <span class="op">=</span> <span class="st">"blue"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1313"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="st">"clip"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="va">usr</span><span class="op">)</span><span class="op">)</span> <span class="co"># reset to plot region</span></code></pre></div>
<div class="sourceCode" id="cb1314"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my.col</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">f</span>, <span class="va">g</span>, <span class="va">xmin</span>, <span class="va">xmax</span>, <span class="va">col</span>, <span class="va">N</span> <span class="op">=</span> <span class="fl">200</span>,
                   <span class="va">xlab</span> <span class="op">=</span> <span class="st">""</span>, <span class="va">ylab</span> <span class="op">=</span> <span class="st">""</span>, <span class="va">main</span> <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">xmin</span>, <span class="va">xmax</span>, length <span class="op">=</span> <span class="va">N</span><span class="op">)</span>
  <span class="va">fx</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
  <span class="va">gx</span> <span class="op">&lt;-</span> <span class="fu">g</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>,
    type <span class="op">=</span> <span class="st">"n"</span>,
    xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">xmin</span>, <span class="va">xmax</span><span class="op">)</span>,
    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">fx</span>, <span class="va">gx</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">fx</span>, <span class="va">gx</span><span class="op">)</span><span class="op">)</span>,
    xlab <span class="op">=</span> <span class="va">xlab</span>, ylab <span class="op">=</span> <span class="va">ylab</span>, main <span class="op">=</span> <span class="va">main</span>
  <span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html">polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">fx</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">gx</span><span class="op">)</span><span class="op">)</span>,
    col <span class="op">=</span> <span class="st">"#EA4335"</span>, border <span class="op">=</span> <span class="fl">0</span>
  <span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">fx</span>, lwd <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="st">"#34A853"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">gx</span>, lwd <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="st">"#4285f4"</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu">my.col</span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">10</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
  <span class="op">-</span><span class="fl">6</span>, <span class="fl">6</span>,
  main <span class="op">=</span> <span class="st">"The \"polygon\" function"</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-8"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-8-1.png" alt="区域重叠 polygon 函数" width="55%"><p class="caption">
图 10.9: 区域重叠 polygon 函数
</p>
</div>
<p>各种符号 <a href="chap-graphics-foundations.html#fig:cex-symbol">10.10</a></p>
<div class="sourceCode" id="cb1315"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>,
  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.5</span>, <span class="fl">4</span><span class="op">)</span>,
  axes <span class="op">=</span> <span class="cn">F</span>,
  xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>
<span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">5</span> <span class="op">*</span> <span class="va">i</span> <span class="op">+</span> <span class="va">j</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">j</span>, <span class="va">i</span>,
      pch <span class="op">=</span> <span class="va">n</span>,
      cex <span class="op">=</span> <span class="fl">3</span>
    <span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">j</span>, <span class="va">i</span> <span class="op">-</span> <span class="fl">.3</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:cex-symbol"></span>
<img src="graphics-foundations_files/figure-html/cex-symbol-1.png" alt="cex 支持的符号" width="55%"><p class="caption">
图 10.10: cex 支持的符号
</p>
</div>
<p>点、线、多边形和圆聚集在图 <a href="chap-graphics-foundations.html#fig:symbols">10.11</a> 中</p>
<div class="sourceCode" id="cb1316"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># https://jeroen.github.io/uros2018/#23</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/frame.html">plot.new</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">plot.window</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html">polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">40</span>, <span class="fl">80</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">80</span>, <span class="fl">40</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"hotpink"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">90</span>, labels <span class="op">=</span> <span class="st">"My drawing"</span>, col <span class="op">=</span> <span class="st">"navyblue"</span>, cex <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/symbols.html">symbols</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">70</span>, <span class="fl">80</span>, <span class="fl">90</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">50</span>, <span class="fl">80</span><span class="op">)</span>,
  circles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">10</span><span class="op">)</span>,
  bg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#4285f4"</span>, <span class="st">"#EA4335"</span>, <span class="st">"red"</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:symbols"></span>
<img src="graphics-foundations_files/figure-html/symbols-1.png" alt="多边形和符号元素" width="672"><p class="caption">
图 10.11: 多边形和符号元素
</p>
</div>
<p>在介绍各种统计图形之前，先介绍几个绘图函数 <code>plot</code> 和 <code>text</code> 还有 <code>par</code> 参数设置， 作为最简单的开始，尽量依次介绍其中的每个参数的含义并附上图形对比。</p>
<div class="sourceCode" id="cb1317"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, ann <span class="op">=</span> <span class="cn">F</span>, col <span class="op">=</span> <span class="st">"blue"</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>,
  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1st"</span>, <span class="st">"2nd"</span>, <span class="st">"3rd"</span>, <span class="st">"4th"</span><span class="op">)</span>,
  col <span class="op">=</span> <span class="st">"red"</span>, pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">1</span><span class="op">)</span>, offset <span class="op">=</span> <span class="fl">0.6</span>
<span class="op">)</span>
<span class="va">ahat</span> <span class="op">&lt;-</span> <span class="st">"sigma"</span>
<span class="co"># title(substitute(hat(a) == ahat, list(ahat = ahat)))</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">hat</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">==</span> <span class="fu">.</span><span class="op">(</span><span class="va">ahat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:pos"></span>
<img src="graphics-foundations_files/figure-html/pos-1.png" alt="pos 位置参数" width="55%"><p class="caption">
图 10.12: pos 位置参数
</p>
</div>
<p>其中 labels， pos 都是向量化的参数</p>
</div>
<div id="base-lines" class="section level3" number="10.1.3">
<h3>
<span class="header-section-number">10.1.3</span> 参考线<a class="anchor" aria-label="anchor" href="#base-lines"><i class="fas fa-link"></i></a>
</h3>
<p>矩形网格线是用做背景参考线的，常常是淡灰色的细密虚线，<code>plot</code> 函数的 <code>panel.first</code> 参数和 <code>grid</code> 函数常用来画这种参考线</p>
<div class="sourceCode" id="cb1318"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified from https://yihui.name/cn/2018/02/cohen-s-d/</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">30</span> <span class="co"># 样本量（只是一个例子）</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">12</span>, <span class="fl">0.01</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,
  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">x</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>,
  type <span class="op">=</span> <span class="st">"l"</span>, panel.first <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">1.2</span>, <span class="fl">2</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:bg-grid-lines"></span>
<img src="graphics-foundations_files/figure-html/bg-grid-lines-1.png" alt="添加背景参考线" width="480"><p class="caption">
图 10.13: 添加背景参考线
</p>
</div>
</div>
<div id="base-axis" class="section level3" number="10.1.4">
<h3>
<span class="header-section-number">10.1.4</span> 坐标轴<a class="anchor" aria-label="anchor" href="#base-axis"><i class="fas fa-link"></i></a>
</h3>
<p>图形控制参数默认设置下 <code>par</code> 通常的一幅图形，改变坐标轴标签是很简单的</p>
<div class="sourceCode" id="cb1319"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">100</span>, <span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1320"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, xlab <span class="op">=</span> <span class="st">"Index"</span>, ylab <span class="op">=</span> <span class="st">"Uniform draws"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-9-2.png" width="672" style="display: block; margin: auto;"></div>
<p>改变坐标轴标签和标题</p>
<div class="sourceCode" id="cb1321"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># 保存默认的 par 设置</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>cex.lab <span class="op">=</span> <span class="fl">1.5</span>, cex.axis <span class="op">=</span> <span class="fl">1.3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, xlab <span class="op">=</span> <span class="st">"Index"</span>, ylab <span class="op">=</span> <span class="st">"Uniform draws"</span><span class="op">)</span>

<span class="co"># 设置更大的坐标轴标签内容</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">6</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, cex.axis <span class="op">=</span> <span class="fl">1.5</span>, cex.lab <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, xlab <span class="op">=</span> <span class="st">"Index"</span>, ylab <span class="op">=</span> <span class="st">"Uniform draws"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></div>
<p>使用 axis 函数可以更加精细地控制坐标轴</p>
<div class="sourceCode" id="cb1322"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span> <span class="co"># 恢复默认的 par 设置</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, xaxt <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span> <span class="co"># 去掉 x 轴</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">1</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">50</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="co"># 添加指定的刻度标签</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;"></div>
<p>指定刻度标签的内容</p>
<div class="sourceCode" id="cb1323"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, yaxt <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">2</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Small"</span>, <span class="st">"Medium"</span>, <span class="st">"Big"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;"></div>
<p>控制刻度线和轴线和刻度标签</p>
<div class="sourceCode" id="cb1324"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">3</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">25</span>, <span class="fl">75</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">4</span>, lwd.ticks <span class="op">=</span> <span class="fl">2</span>, col.ticks <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;"></div>
<p>还可以把 box 移除，绘图区域的边框去掉，只保留坐标轴</p>
<div class="sourceCode" id="cb1325"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, bty <span class="op">=</span> <span class="st">"n"</span>, xaxt <span class="op">=</span> <span class="st">"n"</span>, yaxt <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">1</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span>, <span class="fl">20</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">2</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1326"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 双Y轴</span>
<span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">200</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span>, length <span class="op">=</span> <span class="va">N</span><span class="op">)</span>
<span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="va">y2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="co"># Add some space in the right margin</span>
<span class="co"># The default is c(5,4,4,2) + .1</span>
<span class="va">xlim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="va">ylim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.1</span>, <span class="fl">1.1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y1</span>,
  col <span class="op">=</span> <span class="st">"blue"</span>, type <span class="op">=</span> <span class="st">"l"</span>,
  xlim <span class="op">=</span> <span class="va">xlim</span>, ylim <span class="op">=</span> <span class="va">ylim</span>,
  axes <span class="op">=</span> <span class="cn">F</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, main <span class="op">=</span> <span class="st">"Title"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">2</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>new <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y2</span>,
  col <span class="op">=</span> <span class="st">"red"</span>, type <span class="op">=</span> <span class="st">"l"</span>,
  xlim <span class="op">=</span> <span class="va">xlim</span>, ylim <span class="op">=</span> <span class="va">ylim</span>,
  axes <span class="op">=</span> <span class="cn">F</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, main <span class="op">=</span> <span class="st">""</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">4</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"First Y axis"</span>, <span class="fl">2</span>, line <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"blue"</span>, cex <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"Second Y axis"</span>, <span class="fl">4</span>, line <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-15"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-15-1.png" alt="两个 Y 轴" width="65%"><p class="caption">
图 10.14: 两个 Y 轴
</p>
</div>
<div class="sourceCode" id="cb1327"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 1,2,3,4 分别代表下左上右四个位置</span></code></pre></div>
<p>调整坐标轴标签的距离</p>
<div class="sourceCode" id="cb1328"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Changing default gap between labels:</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"n"</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, ann <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span><span class="op">(</span><span class="st">"axis(1, .., gap.axis = f),"</span> <span class="op">~</span> <span class="op">~</span> <span class="va">f</span> <span class="op">&gt;=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">2</span>, at <span class="op">=</span> <span class="fl">5</span> <span class="op">*</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span>, gap.axis <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">4</span><span class="op">)</span>
<span class="va">gaps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">2</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">4</span>, <span class="fl">0.1</span>, <span class="fl">0</span><span class="op">)</span>
<span class="va">chG</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span>
  <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fifelse.html">ifelse</a></span><span class="op">(</span><span class="va">gaps</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">"default:  "</span>, <span class="st">""</span><span class="op">)</span>,
  <span class="st">"gap.axis="</span>, <span class="fu"><a href="https://rdrr.io/r/base/formatc.html">formatC</a></span><span class="op">(</span><span class="va">gaps</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">jj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">gaps</span><span class="op">)</span>
<span class="va">linG</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2.5</span> <span class="op">*</span> <span class="op">(</span><span class="va">jj</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="va">jj</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">isD</span> <span class="op">&lt;-</span> <span class="va">gaps</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span> <span class="co"># is default</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>,
    at <span class="op">=</span> <span class="fl">5</span> <span class="op">*</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>, gap.axis <span class="op">=</span> <span class="va">gaps</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, padj <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, line <span class="op">=</span> <span class="va">linG</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,
    col.axis <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="va">isD</span><span class="op">)</span> <span class="st">"forest green"</span> <span class="kw">else</span> <span class="fl">1</span>, font.axis <span class="op">=</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">isD</span>
  <span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="va">chG</span>,
  side <span class="op">=</span> <span class="fl">1</span>, padj <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, line <span class="op">=</span> <span class="va">linG</span> <span class="op">-</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">2</span>, cex <span class="op">=</span> <span class="fl">3</span> <span class="op">/</span> <span class="fl">4</span>,
  col <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fifelse.html">ifelse</a></span><span class="op">(</span><span class="va">gaps</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">"forest green"</span>, <span class="st">"blue3"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:gap-axis"></span>
<img src="graphics-foundations_files/figure-html/gap-axis-1.png" alt="gap.axis用法" width="55%"><p class="caption">
图 10.15: gap.axis用法
</p>
</div>
<div class="sourceCode" id="cb1329"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## now shrink the window (in x- and y-direction) and observe the axis labels drawn</span></code></pre></div>
<p>旋转坐标轴标签</p>
<div class="sourceCode" id="cb1330"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Rotated axis labels in R plots</span>
<span class="co"># https://menugget.blogspot.com/2014/08/rotated-axis-labels-in-r-plots.html</span>
<span class="co"># Example data</span>
<span class="va">tmin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html">as.Date</a></span><span class="op">(</span><span class="st">"2000-01-01"</span><span class="op">)</span>
<span class="va">tmax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html">as.Date</a></span><span class="op">(</span><span class="st">"2001-01-01"</span><span class="op">)</span>
<span class="va">tlab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">tmin</span>, <span class="va">tmax</span>, by <span class="op">=</span> <span class="st">"month"</span><span class="op">)</span>
<span class="va">lab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">tlab</span>, format <span class="op">=</span> <span class="st">"%Y-%b"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">111</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">tmin</span>, <span class="va">tmax</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Plot</span>
<span class="co"># png("plot_w_rotated_axis_labels.png", height = 3,</span>
<span class="co">#     width = 6, units = "in", res = 300)</span>
<span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, t <span class="op">=</span> <span class="st">"l"</span>, xaxt <span class="op">=</span> <span class="st">"n"</span>, xlab <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>, at <span class="op">=</span> <span class="va">tlab</span>, labels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="va">tlab</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">usr</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">usr</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">usr</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>,
  labels <span class="op">=</span> <span class="va">lab</span>, srt <span class="op">=</span> <span class="fl">45</span>, adj <span class="op">=</span> <span class="fl">1</span>, xpd <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1331"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span>
<span class="co"># dev.off()</span></code></pre></div>
<p>旋转坐标抽标签的例子来自手册《R FAQ》的第7章第27个问题 <span class="citation"><a href="#ref-R-FAQ" role="doc-biblioref">[12]</a></span>，在基础图形中，旋转坐标轴标签需要 <code><a href="https://rdrr.io/r/graphics/text.html">text()</a></code> 而不是 <code><a href="https://rdrr.io/r/graphics/mtext.html">mtext()</a></code>，因为后者不支持<code>par("srt")</code></p>
<div class="sourceCode" id="cb1332"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Increase bottom margin to make room for rotated labels</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">.5</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.1</span><span class="op">)</span>
<span class="co">## Create plot with no x axis and no x axis label</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, xaxt <span class="op">=</span> <span class="st">"n"</span>, xlab <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="co">## Set up x axis with tick marks alone</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>, labels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">## Create some text labels</span>
<span class="va">labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Label"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span>
<span class="co">## Plot x axis labels at default tick marks</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="st">"usr"</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.5</span>,
  srt <span class="op">=</span> <span class="fl">45</span>, adj <span class="op">=</span> <span class="fl">1</span>,
  labels <span class="op">=</span> <span class="va">labels</span>, xpd <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>
<span class="co">## Plot x axis label at line 6 (of 7)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">1</span>, text <span class="op">=</span> <span class="st">"X Axis Label"</span>, line <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:rotate-axis-labels"></span>
<img src="graphics-foundations_files/figure-html/rotate-axis-labels-1.png" alt="旋转坐标轴标签" width="672"><p class="caption">
图 10.16: 旋转坐标轴标签
</p>
</div>
<p><code>srt = 45</code> 表示文本旋转角度， <code>xpd = TRUE</code> 允许文本越出绘图区域，<code>adj = 1</code> to place the right end of text at the tick marks；You can adjust the value of the 0.5 offset as required to move the axis labels up or down relative to the x axis. 详细地参考 <span class="citation"><a href="#ref-Paul_2003_Integrating" role="doc-biblioref">[13]</a></span></p>
</div>
<div id="base-tick" class="section level3" number="10.1.5">
<h3>
<span class="header-section-number">10.1.5</span> 刻度线<a class="anchor" aria-label="anchor" href="#base-tick"><i class="fas fa-link"></i></a>
</h3>
<p>通过 <code>par</code> 或 <code>axis</code> 函数实现刻度线的精细操作，tcl 控制刻度线的长度，正值让刻度画在绘图区域内，负值正好相反，画在外面，mgp 参数有三个值，第一个值控制绘图区域和坐标轴标题之间的行数，第二个是绘图区域与坐标轴标签的行数，第三个绘图区域与轴线的行数，行数表示间距</p>
<div class="sourceCode" id="cb1333"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>tcl <span class="op">=</span> <span class="fl">0.4</span>, mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1334"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 又一个例子</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, xaxt <span class="op">=</span> <span class="st">"n"</span>, yaxt <span class="op">=</span> <span class="st">"n"</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">1</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">95</span>, <span class="fl">30</span><span class="op">)</span>, tcl <span class="op">=</span> <span class="fl">0.4</span>, lwd.ticks <span class="op">=</span> <span class="fl">3</span>, mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">1</span>, text <span class="op">=</span> <span class="st">"X axis"</span>, line <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> 
<span class="co"># mtext 设置坐标轴标签</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">2</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, tcl <span class="op">=</span> <span class="fl">0.3</span>, lwd.ticks <span class="op">=</span> <span class="fl">3</span>, col.ticks <span class="op">=</span> <span class="st">"orange"</span>, mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">2</span>, text <span class="op">=</span> <span class="st">"Numbers taken randomly"</span>, line <span class="op">=</span> <span class="fl">2.2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-17-2.png" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="base-title" class="section level3" number="10.1.6">
<h3>
<span class="header-section-number">10.1.6</span> 标题<a class="anchor" aria-label="anchor" href="#base-title"><i class="fas fa-link"></i></a>
</h3>
<p>添加多个标题</p>
<div class="sourceCode" id="cb1335"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">200</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">N</span>, <span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fl">.5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"Subtitle"</span>, <span class="fl">3</span>, line <span class="op">=</span> <span class="fl">.8</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"Title"</span>, <span class="fl">3</span>, line <span class="op">=</span> <span class="fl">2</span>, cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"X axis"</span>, <span class="fl">1</span>, line <span class="op">=</span> <span class="fl">2.5</span>, cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"X axis subtitle"</span>, <span class="fl">1</span>, line <span class="op">=</span> <span class="fl">3.7</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-18"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-18-1.png" alt="图标题/子标题 x轴标题/子标题" width="672"><p class="caption">
图 10.17: 图标题/子标题 x轴标题/子标题
</p>
</div>
</div>
<div id="base-annotation" class="section level3" number="10.1.7">
<h3>
<span class="header-section-number">10.1.7</span> 注释<a class="anchor" aria-label="anchor" href="#base-annotation"><i class="fas fa-link"></i></a>
</h3>
<p>数学符号注释，图<a href="chap-graphics-foundations.html#fig:math-annotation">10.18</a> 自定义坐标轴 <span class="citation"><a href="#ref-Paul_2000_Approach" role="doc-biblioref">[14]</a></span>。</p>
<div class="sourceCode" id="cb1336"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 自定义坐标轴</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1e6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">pi</span>, <span class="va">pi</span><span class="op">)</span>,
  type <span class="op">=</span> <span class="st">"n"</span>,
  axes <span class="op">=</span> <span class="cn">FALSE</span>, ann <span class="op">=</span> <span class="cn">FALSE</span>, log <span class="op">=</span> <span class="st">"x"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>,
  at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1e2</span>, <span class="fl">1e4</span>, <span class="fl">1e6</span><span class="op">)</span>,
  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">2</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">4</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">6</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">2</span>,
  at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">pi</span>, <span class="op">-</span><span class="va">pi</span> <span class="op">/</span> <span class="fl">2</span>, <span class="fl">0</span>, <span class="va">pi</span> <span class="op">/</span> <span class="fl">2</span>, <span class="va">pi</span><span class="op">)</span>,
  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="op">-</span><span class="va">pi</span>, <span class="op">-</span><span class="va">pi</span> <span class="op">/</span> <span class="fl">2</span>, <span class="fl">0</span>, <span class="va">pi</span> <span class="op">/</span> <span class="fl">2</span>, <span class="va">pi</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">1e3</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span><span class="op">(</span><span class="st">"Customized Axes"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:math-annotation"></span>
<img src="graphics-foundations_files/figure-html/math-annotation-1.png" alt="创建自定义的坐标轴和刻度标签" width="45%"><p class="caption">
图 10.18: 创建自定义的坐标轴和刻度标签
</p>
</div>
<p>在标题中添加数学公式</p>
<div class="sourceCode" id="cb1337"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span>, length <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,
  type <span class="op">=</span> <span class="st">"l"</span>,
  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span>main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span>
  <span class="st">"graph of the function f"</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-19"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-19-1.png" alt="标题含有数学公式" width="45%"><p class="caption">
图 10.19: 标题含有数学公式
</p>
</div>
<p>修改参数使用 <code>substitute</code> 函数批量生成</p>
<div class="sourceCode" id="cb1338"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span>, length <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">{</span> <span class="co"># 画四个图</span>
  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">i</span> <span class="op">+</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,
    type <span class="op">=</span> <span class="st">"l"</span>,
    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span><span class="op">)</span>,
    ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span><span class="op">(</span>
      <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">i</span> <span class="op">+</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>i <span class="op">=</span> <span class="va">i</span><span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span>main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span><span class="op">(</span>
    <span class="st">"graph of the function f"</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">i</span> <span class="op">+</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>i <span class="op">=</span> <span class="va">i</span><span class="op">)</span>
  <span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-20-1"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-20-1.png" alt="批量生成函数图形" width="45%"><p class="caption">
图 10.20: 批量生成函数图形
</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-20-2"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-20-2.png" alt="批量生成函数图形" width="45%"><p class="caption">
图 10.21: 批量生成函数图形
</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-20-3"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-20-3.png" alt="批量生成函数图形" width="45%"><p class="caption">
图 10.22: 批量生成函数图形
</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-20-4"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-20-4.png" alt="批量生成函数图形" width="45%"><p class="caption">
图 10.23: 批量生成函数图形
</p>
</div>
<p>基础绘图函数，如 plot 标签 <code>xlab</code> 支持 Unicode 代码表示的希腊字母，常用字母表备查，公式环境下，也可以用在绘图中</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:letters">表 10.1: </span> 希腊字母表</caption>
<thead><tr class="header">
<th align="left">希腊字母</th>
<th align="left">LaTeX 代码</th>
<th align="left">Unicode 代码</th>
<th align="left">希腊字母</th>
<th align="left">LaTeX 代码</th>
<th align="left">Unicode 代码</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(\alpha\)</span></td>
<td align="left"><code>\alpha</code></td>
<td align="left"><code>\u03B1</code></td>
<td align="left"><span class="math inline">\(\mu\)</span></td>
<td align="left"><code>\mu</code></td>
<td align="left"><code>\u03BC</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\beta\)</span></td>
<td align="left"><code>\beta</code></td>
<td align="left"><code>\u03B2</code></td>
<td align="left"><span class="math inline">\(\nu\)</span></td>
<td align="left"><code>\nu</code></td>
<td align="left"><code>\u03BD</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\gamma\)</span></td>
<td align="left"><code>\gamma</code></td>
<td align="left"><code>\u03B3</code></td>
<td align="left"><span class="math inline">\(\xi\)</span></td>
<td align="left"><code>\xi</code></td>
<td align="left"><code>\u03BE</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\delta\)</span></td>
<td align="left"><code>\delta</code></td>
<td align="left"><code>\u03B4</code></td>
<td align="left"><span class="math inline">\(\varphi\)</span></td>
<td align="left"><code>\varphi</code></td>
<td align="left"><code>\u03C6</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\epsilon\)</span></td>
<td align="left"><code>\epsilon</code></td>
<td align="left"><code>\u03B5</code></td>
<td align="left"><span class="math inline">\(\pi\)</span></td>
<td align="left"><code>\pi</code></td>
<td align="left"><code>\u03C0</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\zeta\)</span></td>
<td align="left"><code>\zeta</code></td>
<td align="left"><code>\u03B6</code></td>
<td align="left"><span class="math inline">\(\rho\)</span></td>
<td align="left"><code>\rho</code></td>
<td align="left"><code>\u03C1</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\eta\)</span></td>
<td align="left"><code>\eta</code></td>
<td align="left"><code>\u03B7</code></td>
<td align="left"><span class="math inline">\(\upsilon\)</span></td>
<td align="left"><code>\upsilon</code></td>
<td align="left"><code>\u03C5</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\theta\)</span></td>
<td align="left"><code>\theta</code></td>
<td align="left"><code>\u03B8</code></td>
<td align="left"><span class="math inline">\(\phi\)</span></td>
<td align="left"><code>\phi</code></td>
<td align="left"><code>\u03C6</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\iota\)</span></td>
<td align="left"><code>\iota</code></td>
<td align="left"><code>\u03B9</code></td>
<td align="left"><span class="math inline">\(\chi\)</span></td>
<td align="left"><code>\chi</code></td>
<td align="left"><code>\u03C7</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\kappa\)</span></td>
<td align="left"><code>\kappa</code></td>
<td align="left"><code>\u03BA</code></td>
<td align="left"><span class="math inline">\(\psi\)</span></td>
<td align="left"><code>\psi</code></td>
<td align="left"><code>\u03C8</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\lambda\)</span></td>
<td align="left"><code>\lambda</code></td>
<td align="left"><code>\u03BB</code></td>
<td align="left"><span class="math inline">\(\omega\)</span></td>
<td align="left"><code>\omega</code></td>
<td align="left"><code>\u03C9</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\sigma\)</span></td>
<td align="left"><code>\sigma</code></td>
<td align="left"><code>\u03C3</code></td>
<td align="left"><span class="math inline">\(\tau\)</span></td>
<td align="left"><code>\tau</code></td>
<td align="left"><code>\u03C4</code></td>
</tr>
</tbody>
</table></div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:super-sub-script">表 10.2: </span> 数字上下标</caption>
<thead><tr class="header">
<th align="left">上标数字</th>
<th align="left">LaTeX 代码</th>
<th align="left">Unicode 代码</th>
<th align="left">下标数字</th>
<th align="left">LaTeX 代码</th>
<th align="left">Unicode 代码</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\({}^0\)</span></td>
<td align="left"><code>{}^0</code></td>
<td align="left"><code>\u2070</code></td>
<td align="left"><span class="math inline">\({}_0\)</span></td>
<td align="left"><code>{}_0</code></td>
<td align="left"><code>\u2080</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\({}^1\)</span></td>
<td align="left"><code>{}^1</code></td>
<td align="left"><code>\u00B9</code></td>
<td align="left"><span class="math inline">\({}_1\)</span></td>
<td align="left"><code>{}_1</code></td>
<td align="left"><code>\u2081</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\({}^2\)</span></td>
<td align="left"><code>{}^2</code></td>
<td align="left"><code>\u00B2</code></td>
<td align="left"><span class="math inline">\({}_2\)</span></td>
<td align="left"><code>{}_2</code></td>
<td align="left"><code>\u2082</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\({}^3\)</span></td>
<td align="left"><code>{}^3</code></td>
<td align="left"><code>\u00B2</code></td>
<td align="left"><span class="math inline">\({}_3\)</span></td>
<td align="left"><code>{}_3</code></td>
<td align="left"><code>\u2083</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\({}^4\)</span></td>
<td align="left"><code>{}^4</code></td>
<td align="left"><code>\u2074</code></td>
<td align="left"><span class="math inline">\({}_4\)</span></td>
<td align="left"><code>{}_4</code></td>
<td align="left"><code>\u2084</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\({}^5\)</span></td>
<td align="left"><code>{}^5</code></td>
<td align="left"><code>\u2075</code></td>
<td align="left"><span class="math inline">\({}_5\)</span></td>
<td align="left"><code>{}_5</code></td>
<td align="left"><code>\u2085</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\({}^6\)</span></td>
<td align="left"><code>{}^6</code></td>
<td align="left"><code>\u2076</code></td>
<td align="left"><span class="math inline">\({}_6\)</span></td>
<td align="left"><code>{}_6</code></td>
<td align="left"><code>\u2086</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\({}^7\)</span></td>
<td align="left"><code>{}^7</code></td>
<td align="left"><code>\u2077</code></td>
<td align="left"><span class="math inline">\({}_7\)</span></td>
<td align="left"><code>{}_7</code></td>
<td align="left"><code>\u2087</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\({}^8\)</span></td>
<td align="left"><code>{}^8</code></td>
<td align="left"><code>\u2078</code></td>
<td align="left"><span class="math inline">\({}_8\)</span></td>
<td align="left"><code>{}_8</code></td>
<td align="left"><code>\u2088</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\({}^9\)</span></td>
<td align="left"><code>{}^9</code></td>
<td align="left"><code>\u2079</code></td>
<td align="left"><span class="math inline">\({}_9\)</span></td>
<td align="left"><code>{}_9</code></td>
<td align="left"><code>\u2089</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\({}^n\)</span></td>
<td align="left"><code>{}^n</code></td>
<td align="left"><code>\u207F</code></td>
<td align="left"><span class="math inline">\({}_n\)</span></td>
<td align="left"><code>{}_n</code></td>
<td align="left">-</td>
</tr>
</tbody>
</table></div>
<p>其它字母，请查看 <a href="https://www.ssec.wisc.edu/~tomw/java/unicode.html">Unicode 字母表</a></p>
</div>
<div id="base-legend" class="section level3" number="10.1.8">
<h3>
<span class="header-section-number">10.1.8</span> 图例<a class="anchor" aria-label="anchor" href="#base-legend"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1339"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">6</span>, length <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,
  type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">3</span>,
  ylab <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">"angle"</span>, main <span class="op">=</span> <span class="st">"Trigonometric functions"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">z</span> <span class="op">~</span> <span class="va">x</span>, type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="op">-</span><span class="fl">1</span>,
  yjust <span class="op">=</span> <span class="fl">0</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sine"</span>, <span class="st">"Cosine"</span><span class="op">)</span>,
  lwd <span class="op">=</span> <span class="fl">3</span>, lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="st">"fg"</span><span class="op">)</span>, <span class="st">"red"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-21"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-21-1.png" alt="三角函数添加图例" width="672"><p class="caption">
图 10.24: 三角函数添加图例
</p>
</div>
<div class="sourceCode" id="cb1340"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">xmin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="st">"usr"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="va">xmax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="st">"usr"</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
<span class="va">ymin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="st">"usr"</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>
<span class="va">ymax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="st">"usr"</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,
  type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">3</span>,
  ylab <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">"angle"</span>, main <span class="op">=</span> <span class="st">"Trigonometric functions"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">z</span> <span class="op">~</span> <span class="va">x</span>, type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"bottomleft"</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sine"</span>, <span class="st">"Cosine"</span><span class="op">)</span>,
  lwd <span class="op">=</span> <span class="fl">3</span>, lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="st">"fg"</span><span class="op">)</span>, <span class="st">"red"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-22"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-22-1.png" alt="设置图例的位置" width="672"><p class="caption">
图 10.25: 设置图例的位置
</p>
</div>
<div class="sourceCode" id="cb1341"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,
  type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">3</span>,
  ylab <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">"angle"</span>, main <span class="op">=</span> <span class="st">"Trigonometric functions"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">z</span> <span class="op">~</span> <span class="va">x</span>, type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"bottomleft"</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sine"</span>, <span class="st">"Cosine"</span><span class="op">)</span>,
  inset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.03</span>, <span class="fl">.03</span><span class="op">)</span>,
  lwd <span class="op">=</span> <span class="fl">3</span>, lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="st">"fg"</span><span class="op">)</span>, <span class="st">"red"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-23"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-23-1.png" alt="insert 函数微调图例位置" width="672"><p class="caption">
图 10.26: insert 函数微调图例位置
</p>
</div>
<div class="sourceCode" id="cb1342"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,
  type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">3</span>,
  ylab <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">"angle"</span>, main <span class="op">=</span> <span class="st">"Trigonometric functions"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">z</span> <span class="op">~</span> <span class="va">x</span>, type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>xpd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Do not clip to the drawing area 关键一行/允许出界</span>
<span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">.025</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="st">"usr"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
  <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">lambda</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="st">"usr"</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">-</span> <span class="va">lambda</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="st">"usr"</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sine"</span>, <span class="st">"Cosine"</span><span class="op">)</span>,
  xjust <span class="op">=</span> <span class="fl">0</span>, yjust <span class="op">=</span> <span class="fl">0</span>,
  lwd <span class="op">=</span> <span class="fl">3</span>, lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="st">"fg"</span><span class="op">)</span>, <span class="st">"red"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-24"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-24-1.png" alt="将图例放在绘图区域外面" width="672"><p class="caption">
图 10.27: 将图例放在绘图区域外面
</p>
</div>
<div class="sourceCode" id="cb1343"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></code></pre></div>
<p>Hmisc 包的 labcurve 函数可以在曲线上放置名称，而不是遥远的图例上</p>
</div>
<div id="base-par" class="section level3" number="10.1.9">
<h3>
<span class="header-section-number">10.1.9</span> 边空<a class="anchor" aria-label="anchor" href="#base-par"><i class="fas fa-link"></i></a>
</h3>
<p>边空分为内边空和外边空</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:par-mai-oma"></span>
<img src="../../../../../opt/R/4.2.0/lib/R/library/graphics/help/figures/mai.png" alt="边空" width="35%"><img src="../../../../../opt/R/4.2.0/lib/R/library/graphics/help/figures/oma.png" alt="边空" width="35%"><p class="caption">
图 10.28: 边空
</p>
</div>
<p><code>line</code> 第一行</p>
<div class="sourceCode" id="cb1344"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">200</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">N</span>, <span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fl">.5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>,
  xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>,
  main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span>
    <span class="st">"The \"mtext\" function"</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">" "</span>, <span class="fl">60</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Line"</span>, <span class="va">i</span><span class="op">)</span>, <span class="fl">3</span>, line <span class="op">=</span> <span class="va">i</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-25"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-25-1.png" alt="外边空在图的边缘添加文字" width="672"><p class="caption">
图 10.29: 外边空在图的边缘添加文字
</p>
</div>
<p><code>par</code></p>
<div class="sourceCode" id="cb1345"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 多图排列/分屏 page 47</span>
<span class="co"># 最常用的是 par mfrow mfcol分别按行/列放置图形</span>
<span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>
  mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,
  oma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">4</span>, <span class="fl">0</span><span class="op">)</span> <span class="co"># Outer margins</span>
<span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>,
    main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"random plot ("</span>, <span class="va">i</span>, <span class="st">")"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"Four plots, without enough room for this title"</span>,
  side <span class="op">=</span> <span class="fl">3</span>, font <span class="op">=</span> <span class="fl">2</span>, cex <span class="op">=</span> <span class="fl">1.5</span>, col <span class="op">=</span> <span class="st">"red"</span>
<span class="op">)</span> <span class="co"># 总/大标题放不下</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-26"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-26-1.png" alt="多图排列共享一个大标题" width="672"><p class="caption">
图 10.30: 多图排列共享一个大标题
</p>
</div>
<p><code>par</code> 的 oma 用来设置外边空的大小，默认情形下没有外边空的</p>
<div class="sourceCode" id="cb1346"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">oma</span></code></pre></div>
<pre><code>## [1] 0 0 0 0</code></pre>
<p>我们可以自己设置外边空</p>
<div class="sourceCode" id="cb1348"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>
  mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,
  oma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">0</span><span class="op">)</span> <span class="co"># Outer margins</span>
<span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>,
    main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"random plot ("</span>, <span class="va">i</span>, <span class="st">")"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"Four plots, with some room for this title"</span>,
  side <span class="op">=</span> <span class="fl">3</span>, line <span class="op">=</span> <span class="fl">1.5</span>, font <span class="op">=</span> <span class="fl">1</span>, cex <span class="op">=</span> <span class="fl">1.5</span>, col <span class="op">=</span> <span class="st">"red"</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-28"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-28-1.png" alt="设置外边空放置大标题" width="672"><p class="caption">
图 10.31: 设置外边空放置大标题
</p>
</div>
<p>除了内边空还有外边空，内外边空用来放注释说明</p>
<div class="sourceCode" id="cb1349"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>oma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, type <span class="op">=</span> <span class="st">"n"</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, xaxt <span class="op">=</span> <span class="st">"n"</span>, yaxt <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">side</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">inner</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">mar</span><span class="op">[</span><span class="va">side</span><span class="op">]</span>, <span class="fl">0</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">line</span> <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span><span class="va">inner</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Inner line "</span>, <span class="va">line</span><span class="op">)</span>, side <span class="op">=</span> <span class="va">side</span>, line <span class="op">=</span> <span class="va">line</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">outer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">oma</span><span class="op">[</span><span class="va">side</span><span class="op">]</span>, <span class="fl">0</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">line</span> <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span><span class="va">inner</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Outer line "</span>, <span class="va">line</span><span class="op">)</span>, side <span class="op">=</span> <span class="va">side</span>, line <span class="op">=</span> <span class="va">line</span>, outer <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-29-1.png" width="672" style="display: block; margin: auto;"></div>
<p>外边空可以用来放图例</p>
<div class="sourceCode" id="cb1350"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>
<span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>oma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span>, mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, col <span class="op">=</span> <span class="va">cols</span>, ylab <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"A common x-axis label"</span>, side <span class="op">=</span> <span class="fl">1</span>, line <span class="op">=</span> <span class="fl">0</span>, outer <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"A common y-axis label"</span>, side <span class="op">=</span> <span class="fl">2</span>, line <span class="op">=</span> <span class="fl">0</span>, outer <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">1.2</span>, legend <span class="op">=</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,
  col <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">cols</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">16</span>, bty <span class="op">=</span> <span class="st">"n"</span>, xpd <span class="op">=</span> <span class="cn">NA</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-30-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1351"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></code></pre></div>
<p>坐标轴标签 <code>xlab</code> 和 <code>ylab</code> 的内容很长的时候需要内边空</p>
<div class="sourceCode" id="cb1352"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>cex.lab <span class="op">=</span> <span class="fl">1.7</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>,
  ylab <span class="op">=</span> <span class="st">"A very very long axis title\nthat need special care"</span>,
  xlab <span class="op">=</span> <span class="st">""</span>, type <span class="op">=</span> <span class="st">"n"</span>
<span class="op">)</span>

<span class="co"># 增加内边空的大小</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>,
  ylab <span class="op">=</span> <span class="st">"A very very long axis title\nthat need special care"</span>,
  xlab <span class="op">=</span> <span class="st">""</span>, type <span class="op">=</span> <span class="st">"n"</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-31-1.png" width="672" style="display: block; margin: auto;"></div>
<p>有时候，仅仅增加内边空还不够，坐标轴标签内容甚至可以出现在绘图区域外面，设置 <code>outer = TRUE</code></p>
<div class="sourceCode" id="cb1353"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>oma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, ylab <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">""</span>, type <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span>
  text <span class="op">=</span> <span class="st">"A very very long axis title\nthat need special care"</span>,
  side <span class="op">=</span> <span class="fl">2</span>, line <span class="op">=</span> <span class="fl">0</span>, outer <span class="op">=</span> <span class="cn">TRUE</span>, cex <span class="op">=</span> <span class="fl">1.7</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-32-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1354"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>
  mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,
  oma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">0</span><span class="op">)</span>,
  mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">.1</span> <span class="co"># Margins</span>
<span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>,
    xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>,
    main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"random plot ("</span>, <span class="va">i</span>, <span class="st">")"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"Title"</span>,
  side <span class="op">=</span> <span class="fl">3</span>, line <span class="op">=</span> <span class="fl">1.5</span>, font <span class="op">=</span> <span class="fl">2</span>, cex <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"red"</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-33"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-33-1.png" alt="设置每个子图的边空 mar" width="672"><p class="caption">
图 10.32: 设置每个子图的边空 mar
</p>
</div>
</div>
<div id="base-layer" class="section level3" number="10.1.10">
<h3>
<span class="header-section-number">10.1.10</span> 图层<a class="anchor" aria-label="anchor" href="#base-layer"><i class="fas fa-link"></i></a>
</h3>
<p>覆盖图形 <code>add = T</code> or <code>par(new=TRUE)</code></p>
<div class="sourceCode" id="cb1355"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>,
  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>,
  col <span class="op">=</span> <span class="st">"#EA4335"</span>, pch <span class="op">=</span> <span class="fl">16</span>, cex <span class="op">=</span> <span class="fl">3</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>,
  col <span class="op">=</span> <span class="st">"blue"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span>main <span class="op">=</span> <span class="st">"Overlaying points, segments, lines..."</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-34"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-34-1.png" alt="添加图层" width="672"><p class="caption">
图 10.33: 添加图层
</p>
</div>
</div>
<div id="base-layout" class="section level3" number="10.1.11">
<h3>
<span class="header-section-number">10.1.11</span> 布局<a class="anchor" aria-label="anchor" href="#base-layout"><i class="fas fa-link"></i></a>
</h3>
<p><code>layout</code> 函数布局， 绘制复杂组合图形</p>
<div class="sourceCode" id="cb1356"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>oma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>,
  <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>,
  <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>
<span class="op">)</span>, nr <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"light blue"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"light blue"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"light blue"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"light blue"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"The \"layout\" function"</span>,
  side <span class="op">=</span> <span class="fl">3</span>, outer <span class="op">=</span> <span class="cn">TRUE</span>,
  font <span class="op">=</span> <span class="fl">2</span>, cex <span class="op">=</span> <span class="fl">1.2</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-35"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-35-1.png" alt="更加复杂的组合图形" width="672"><p class="caption">
图 10.34: 更加复杂的组合图形
</p>
</div>
</div>
<div id="base-combine" class="section level3" number="10.1.12">
<h3>
<span class="header-section-number">10.1.12</span> 组合<a class="anchor" aria-label="anchor" href="#base-combine"><i class="fas fa-link"></i></a>
</h3>
<p><code>par</code> 之 <code>fig</code> 参数很神奇，使得多个图可以叠加在一起，它接受一个数值向量<code>c(x1, x2, y1, y2)</code> ，是图形设备显示区域中的绘图区域的(NDC, normalized device coordinates)坐标。</p>
<div class="sourceCode" id="cb1357"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>,
  type <span class="op">=</span> <span class="st">"b"</span>, main <span class="op">=</span> <span class="st">"'fg' : axes, ticks and box in gray"</span>,
  fg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html">gray</a></span><span class="op">(</span><span class="fl">0.7</span><span class="op">)</span>, bty <span class="op">=</span> <span class="st">"7"</span>, sub <span class="op">=</span> <span class="va">R.version.string</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>fig <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">6</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10</span>, new <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">6</span><span class="op">:</span><span class="fl">10</span>,
  type <span class="op">=</span> <span class="st">"b"</span>, main <span class="op">=</span> <span class="st">""</span>,
  fg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html">gray</a></span><span class="op">(</span><span class="fl">0.7</span><span class="op">)</span>, bty <span class="op">=</span> <span class="st">"7"</span>, xlab <span class="op">=</span> <span class="va">R.version.string</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-36"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-36-1.png" alt="多图叠加" width="672"><p class="caption">
图 10.35: 多图叠加
</p>
</div>
<p><code>fig</code> 参数控制图形的位置，用来绘制组合图形</p>
<div class="sourceCode" id="cb1358"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">rt</a></span><span class="op">(</span><span class="va">n</span>, df <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">x</span>,
  col <span class="op">=</span> <span class="st">"light blue"</span>,
  probability <span class="op">=</span> <span class="st">"TRUE"</span>, main <span class="op">=</span> <span class="st">""</span>,
  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
  col <span class="op">=</span> <span class="st">"red"</span>,
  lwd <span class="op">=</span> <span class="fl">3</span>
<span class="op">)</span>
<span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>
  fig <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.02</span>, <span class="fl">.4</span>, <span class="fl">.5</span>, <span class="fl">.98</span><span class="op">)</span>,
  new <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">x</span>,
  xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, main <span class="op">=</span> <span class="st">""</span>,
  axes <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">x</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span><span class="op">(</span>lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-37"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-37-1.png" alt="组合图形" width="672"><p class="caption">
图 10.36: 组合图形
</p>
</div>
<div class="sourceCode" id="cb1359"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></code></pre></div>
</div>
<div id="base-screen" class="section level3" number="10.1.13">
<h3>
<span class="header-section-number">10.1.13</span> 分屏<a class="anchor" aria-label="anchor" href="#base-screen"><i class="fas fa-link"></i></a>
</h3>
<p><code>split.screen</code> 分屏组合</p>
<div class="sourceCode" id="cb1360"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">random.plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">200</span>
  <span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      <span class="va">rnorm</span>,
      <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
        <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">rt</a></span><span class="op">(</span><span class="va">x</span>, df <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
      <span class="op">}</span>,
      <span class="va">rlnorm</span>,
      <span class="va">runif</span>
    <span class="op">)</span>,
    <span class="fl">1</span>
  <span class="op">)</span> <span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">N</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">x</span>, col <span class="op">=</span> <span class="st">"lightblue"</span>, main <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, axes <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>bg <span class="op">=</span> <span class="st">"white"</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/screen.html">split.screen</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1 2</code></pre>
<div class="sourceCode" id="cb1362"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/screen.html">split.screen</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, screen <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 3 4 5</code></pre>
<div class="sourceCode" id="cb1364"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/screen.html">screen</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="fu">random.plot</span><span class="op">(</span><span class="op">)</span>
<span class="co"># screen(2); random.plot() # Screen 2 was split into three screens: 3, 4, 5</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/screen.html">screen</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>
<span class="fu">random.plot</span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/screen.html">screen</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>
<span class="fu">random.plot</span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/screen.html">screen</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>
<span class="fu">random.plot</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-38"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-38-1.png" alt="分屏" width="672"><p class="caption">
图 10.37: 分屏
</p>
</div>
<div class="sourceCode" id="cb1365"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/screen.html">close.screen</a></span><span class="op">(</span>all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></code></pre></div>
</div>
<div id="identify-locator" class="section level3" number="10.1.14">
<h3>
<span class="header-section-number">10.1.14</span> 交互<a class="anchor" aria-label="anchor" href="#identify-locator"><i class="fas fa-link"></i></a>
</h3>
<p>辅助绘图 identify locator</p>
</div>
</div>
<div id="base-graphics" class="section level2" number="10.2">
<h2>
<span class="header-section-number">10.2</span> 基础统计图形<a class="anchor" aria-label="anchor" href="#base-graphics"><i class="fas fa-link"></i></a>
</h2>
<p>按图的类型划分，最后在小结部分给出各图适用的数据类型</p>
<p>根据数据类型划分： 对于一元数据，可用什么图来描述；多元数据呢，连续数据和离散数据（分类数据）</p>
<p>先找一个不重不漏的划分，指导原则是根据数据类型选择图，根据探索到的数据中的规律，选择图</p>
<p>其它 assocplot fourfoldplot sunflowerplot</p>
<div id="plot-bar" class="section level3" number="10.2.1">
<h3>
<span class="header-section-number">10.2.1</span> 条形图<a class="anchor" aria-label="anchor" href="#plot-bar"><i class="fas fa-link"></i></a>
</h3>
<p><a href="https://rpubs.com/chidungkt/392980">条形图</a></p>
<p>简单条形图</p>
<div class="sourceCode" id="cb1366"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">diamonds</span>, package <span class="op">=</span> <span class="st">"ggplot2"</span><span class="op">)</span> <span class="co"># 加载数据</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">barCenters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">diamonds</span><span class="op">$</span><span class="va">cut</span><span class="op">)</span>,
  col <span class="op">=</span> <span class="st">"lightblue"</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>,
  axisnames <span class="op">=</span> <span class="cn">FALSE</span>, horiz <span class="op">=</span> <span class="cn">TRUE</span>, border <span class="op">=</span> <span class="st">"white"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span>
  y <span class="op">=</span> <span class="va">barCenters</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="st">"usr"</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,
  adj <span class="op">=</span> <span class="fl">1</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">diamonds</span><span class="op">$</span><span class="va">cut</span><span class="op">)</span><span class="op">)</span>, xpd <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>,
  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25000</span>, by <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25000</span>, by <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>,
  las <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"gray"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:diamonds-base-barplot"></span>
<img src="graphics-foundations_files/figure-html/diamonds-base-barplot-1.png" alt="条形图" width="672"><p class="caption">
图 10.38: 条形图
</p>
</div>
<p>简单柱形图</p>
<div class="sourceCode" id="cb1367"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123456</span><span class="op">)</span>
<span class="va">barPois</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="fl">1000</span>, lambda <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">barPois</span>, col <span class="op">=</span> <span class="st">"lightblue"</span>, type <span class="op">=</span> <span class="st">"h"</span>, lwd <span class="op">=</span> <span class="fl">10</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-39"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-39-1.png" alt="柱形图" width="672"><p class="caption">
图 10.39: 柱形图
</p>
</div>
<p>复合条形图</p>
<div class="sourceCode" id="cb1368"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4.1</span>, <span class="fl">2.1</span>, <span class="fl">0.5</span>, <span class="fl">4.5</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">VADeaths</span>,
  border <span class="op">=</span> <span class="st">"white"</span>, horiz <span class="op">=</span> <span class="cn">FALSE</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>,
  legend.text <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">VADeaths</span><span class="op">)</span>, xpd <span class="op">=</span> <span class="cn">TRUE</span>, beside <span class="op">=</span> <span class="cn">TRUE</span>,
  cex.names <span class="op">=</span> <span class="fl">0.9</span>,
  args.legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"right"</span>, border <span class="op">=</span> <span class="st">"white"</span>, title <span class="op">=</span> <span class="st">"Age"</span>,
    box.col <span class="op">=</span> <span class="cn">NA</span>, horiz <span class="op">=</span> <span class="cn">FALSE</span>, inset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.2</span>, <span class="fl">0</span><span class="op">)</span>,
    xpd <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span>,
  panel.first <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span>nx <span class="op">=</span> <span class="fl">0</span>, ny <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:barplot-VADeaths-1"></span>
<img src="graphics-foundations_files/figure-html/barplot-VADeaths-1-1.png" alt="复合条形图" width="672"><p class="caption">
图 10.40: 复合条形图
</p>
</div>
<p>堆积条形图</p>
<div class="sourceCode" id="cb1369"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4.1</span>, <span class="fl">2.1</span>, <span class="fl">0.5</span>, <span class="fl">4.5</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">VADeaths</span>,
  border <span class="op">=</span> <span class="st">"white"</span>, horiz <span class="op">=</span> <span class="cn">FALSE</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>,
  legend.text <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">VADeaths</span><span class="op">)</span>, xpd <span class="op">=</span> <span class="cn">TRUE</span>, beside <span class="op">=</span> <span class="cn">FALSE</span>,
  cex.names <span class="op">=</span> <span class="fl">0.9</span>,
  args.legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"right"</span>, border <span class="op">=</span> <span class="st">"white"</span>, title <span class="op">=</span> <span class="st">"Age"</span>,
    box.col <span class="op">=</span> <span class="cn">NA</span>, horiz <span class="op">=</span> <span class="cn">FALSE</span>, inset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.2</span>, <span class="fl">0</span><span class="op">)</span>,
    xpd <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span>,
  panel.first <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span>nx <span class="op">=</span> <span class="fl">0</span>, ny <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:barplot-VADeaths-2"></span>
<img src="graphics-foundations_files/figure-html/barplot-VADeaths-2-1.png" alt="堆积条形图" width="672"><p class="caption">
图 10.41: 堆积条形图
</p>
</div>
<ul>
<li>堆积条形图 spineplot</li>
</ul>
<p>简单条形图</p>
<div class="sourceCode" id="cb1370"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">BOD</span>, <span class="va">demand</span> <span class="op">~</span> <span class="va">Time</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span>,
  border <span class="op">=</span> <span class="st">"white"</span>, horiz <span class="op">=</span> <span class="cn">FALSE</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/barplot-BOD-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1371"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pg_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">PlantGrowth</span>, <span class="va">mean</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">pg_mean</span>, <span class="va">weight</span> <span class="op">~</span> <span class="va">group</span>,
  border <span class="op">=</span> <span class="st">"white"</span>, horiz <span class="op">=</span> <span class="cn">FALSE</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/barplot-PlantGrowth-1.png" width="672" style="display: block; margin: auto;"></div>
<p>Titanic 数据集是 table 数据类型</p>
<p>简单条形图</p>
<p>复合条形图</p>
<div class="sourceCode" id="cb1372"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">Class</span> <span class="op">+</span> <span class="va">Survived</span>,
  data <span class="op">=</span> <span class="va">Titanic</span>,
  subset <span class="op">=</span> <span class="va">Age</span> <span class="op">==</span> <span class="st">"Adult"</span> <span class="op">&amp;</span> <span class="va">Sex</span> <span class="op">==</span> <span class="st">"Male"</span>,
  beside <span class="op">=</span> <span class="cn">TRUE</span>,
  border <span class="op">=</span> <span class="st">"white"</span>, horiz <span class="op">=</span> <span class="cn">FALSE</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>,
  args.legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    border <span class="op">=</span> <span class="st">"white"</span>, title <span class="op">=</span> <span class="st">"Class"</span>,
    box.col <span class="op">=</span> <span class="cn">NA</span>, horiz <span class="op">=</span> <span class="cn">FALSE</span>,
    xpd <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span>,
  ylab <span class="op">=</span> <span class="st">"# {passengers}"</span>, legend <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-40-1.png" width="672" style="display: block; margin: auto;"></div>
<p>堆积条形图</p>
<div class="sourceCode" id="cb1373"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">Class</span> <span class="op">+</span> <span class="va">Survived</span>,
  data <span class="op">=</span> <span class="va">Titanic</span>,
  subset <span class="op">=</span> <span class="va">Age</span> <span class="op">==</span> <span class="st">"Adult"</span> <span class="op">&amp;</span> <span class="va">Sex</span> <span class="op">==</span> <span class="st">"Male"</span>,
  border <span class="op">=</span> <span class="st">"white"</span>, horiz <span class="op">=</span> <span class="cn">FALSE</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>,
  args.legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    border <span class="op">=</span> <span class="st">"white"</span>, title <span class="op">=</span> <span class="st">"Class"</span>,
    box.col <span class="op">=</span> <span class="cn">NA</span>, horiz <span class="op">=</span> <span class="cn">FALSE</span>,
    xpd <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span>,
  ylab <span class="op">=</span> <span class="st">"# {passengers}"</span>, legend <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-41-1.png" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="plot-hist" class="section level3" number="10.2.2">
<h3>
<span class="header-section-number">10.2.2</span> 直方图<a class="anchor" aria-label="anchor" href="#plot-hist"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1374"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">^</span><span class="fl">24</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>
<span class="va">delta</span> <span class="op">&lt;-</span> <span class="fl">0.01</span>
<span class="va">len</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&lt;</span> <span class="va">delta</span><span class="op">)</span>, <span class="va">n</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>
<span class="va">ylim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1800</span>, by <span class="op">=</span> <span class="fl">300</span><span class="op">)</span>
<span class="va">xlim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span>, by <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">len</span><span class="op">[</span><span class="va">len</span> <span class="op">&lt;</span> <span class="fl">101</span><span class="op">]</span>, breaks <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span> <span class="op">+</span> <span class="fl">0.5</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">p</span>, ann <span class="op">=</span> <span class="cn">FALSE</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, col <span class="op">=</span> <span class="st">"lightblue"</span>, border <span class="op">=</span> <span class="st">"white"</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>, labels <span class="op">=</span> <span class="va">xlim</span>, at <span class="op">=</span> <span class="va">xlim</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># x 轴</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">2</span>, labels <span class="op">=</span> <span class="va">ylim</span>, at <span class="op">=</span> <span class="va">ylim</span>, las <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># y 轴</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-42"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-42-1.png" alt="直方图" width="55%"><p class="caption">
图 10.42: 直方图
</p>
</div>
<div class="sourceCode" id="cb1375"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">faithful</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">eruptions</span> <span class="op">~</span> <span class="va">waiting</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-43-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1376"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">faithful</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">waiting</span>,
  main <span class="op">=</span> <span class="st">"Time between Old Faithful eruptions"</span>,
  xlab <span class="op">=</span> <span class="st">"Minutes"</span>, ylab <span class="op">=</span> <span class="st">""</span>,
  cex.main <span class="op">=</span> <span class="fl">1.5</span>, cex.lab <span class="op">=</span> <span class="fl">1.5</span>, cex.axis <span class="op">=</span> <span class="fl">1.4</span>
<span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-44-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1377"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">faithful</span>, <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">eruptions</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1.6</span>, <span class="fl">5.2</span>, <span class="fl">0.2</span><span class="op">)</span>,
    prob <span class="op">=</span> <span class="cn">TRUE</span>,
    main <span class="op">=</span> <span class="st">""</span>, col <span class="op">=</span> <span class="st">"lightblue"</span>, border <span class="op">=</span> <span class="st">"white"</span>
  <span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">eruptions</span>, bw <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"#EA4335"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/rug.html">rug</a></span><span class="op">(</span><span class="va">eruptions</span>, col <span class="op">=</span> <span class="st">"#EA4335"</span><span class="op">)</span> <span class="co"># 添加数据点</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:eruptions"></span>
<img src="graphics-foundations_files/figure-html/eruptions-1.png" alt="老忠实泉间歇性喷水的时间间隔分布" width="672"><p class="caption">
图 10.43: 老忠实泉间歇性喷水的时间间隔分布
</p>
</div>
<div class="sourceCode" id="cb1378"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">longley</span><span class="op">$</span><span class="va">Unemployed</span>,
  probability <span class="op">=</span> <span class="cn">TRUE</span>,
  col <span class="op">=</span> <span class="st">"light blue"</span>, main <span class="op">=</span> <span class="st">""</span>
<span class="op">)</span>
<span class="co"># 添加密度估计</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">longley</span><span class="op">$</span><span class="va">Unemployed</span><span class="op">)</span>,
  col <span class="op">=</span> <span class="st">"red"</span>,
  lwd <span class="op">=</span> <span class="fl">3</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-45"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-45-1.png" alt="概率密度分布" width="672"><p class="caption">
图 10.44: 概率密度分布
</p>
</div>
<p>直方图有很多花样的，添加阴影线，angle 控制倾斜的角度</p>
<div class="sourceCode" id="cb1379"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># hist(longley$Unemployed, density = 1, angle = 45)</span>
<span class="co"># hist(longley$Unemployed, density = 3, angle = 15)</span>
<span class="co"># hist(longley$Unemployed, density = 1, angle = 15)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">longley</span><span class="op">$</span><span class="va">Unemployed</span>, density <span class="op">=</span> <span class="fl">3</span>, angle <span class="op">=</span> <span class="fl">45</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-46"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-46-1.png" alt="density 数值越大阴影线越密" width="672"><p class="caption">
图 10.45: density 数值越大阴影线越密
</p>
</div>
</div>
<div id="plot-density" class="section level3" number="10.2.3">
<h3>
<span class="header-section-number">10.2.3</span> 密度图<a class="anchor" aria-label="anchor" href="#plot-density"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1380"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">galaxies</span>, package <span class="op">=</span> <span class="st">"MASS"</span><span class="op">)</span>
<span class="va">galaxies</span> <span class="op">&lt;-</span> <span class="va">galaxies</span> <span class="op">/</span> <span class="fl">1000</span>
<span class="co"># Bandwidth Selection by Pilot Estimation of Derivatives</span>
<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/width.SJ.html">width.SJ</a></span><span class="op">(</span><span class="va">galaxies</span>, method <span class="op">=</span> <span class="st">"dpi"</span><span class="op">)</span>, <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/width.SJ.html">width.SJ</a></span><span class="op">(</span><span class="va">galaxies</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 3.256151 2.566423</code></pre>
<div class="sourceCode" id="cb1382"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">40</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"n"</span>, bty <span class="op">=</span> <span class="st">"l"</span>,
  xlab <span class="op">=</span> <span class="st">"velocity of galaxy (km/s)"</span>, ylab <span class="op">=</span> <span class="st">"density"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/rug.html">rug</a></span><span class="op">(</span><span class="va">galaxies</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">galaxies</span>, width <span class="op">=</span> <span class="fl">3.25</span>, n <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">galaxies</span>, width <span class="op">=</span> <span class="fl">2.56</span>, n <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-48-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1383"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">100</span>, to <span class="op">=</span> <span class="fl">174</span>, by <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>
<span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="fl">145</span>, sd <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>
<span class="va">y2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="fl">128</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y1</span>,
  type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"firebrick3"</span>,
 main <span class="op">=</span> <span class="st">"Systolic Blood Pressure Before and After Treatment"</span>,
  xlab <span class="op">=</span> <span class="st">"Systolic Blood Pressure (mmHg)"</span>,
  ylab <span class="op">=</span> <span class="st">"Frequency"</span>, yaxt <span class="op">=</span> <span class="st">"n"</span>,
  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">175</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.05</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y2</span>, col <span class="op">=</span> <span class="st">"dodgerblue4"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html">polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">117</span>, <span class="va">x</span>, <span class="fl">175</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">y2</span>, <span class="fl">0</span><span class="op">)</span>,
  col <span class="op">=</span> <span class="st">"dodgerblue4"</span>,
  border <span class="op">=</span> <span class="st">"white"</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html">polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">x</span>, <span class="fl">175</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">y1</span>, <span class="fl">0</span><span class="op">)</span>,
  col <span class="op">=</span> <span class="st">"firebrick3"</span>,
  border <span class="op">=</span> <span class="st">"white"</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">2</span>,
  at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">0.05</span>, length.out <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,
  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">175</span>, by <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">100</span>, y <span class="op">=</span> <span class="fl">0.0445</span>, <span class="st">"Pre-Treatment BP"</span>, col <span class="op">=</span> <span class="st">"dodgerblue4"</span>, cex <span class="op">=</span> <span class="fl">0.9</span>, pos <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">100</span>, y <span class="op">=</span> <span class="fl">0.0395</span>, <span class="st">"Post-Treatment BP"</span>, col <span class="op">=</span> <span class="st">"firebrick3"</span>, cex <span class="op">=</span> <span class="fl">0.9</span>, pos <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0.0445</span>, pch <span class="op">=</span> <span class="fl">15</span>, col <span class="op">=</span> <span class="st">"dodgerblue4"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0.0395</span>, pch <span class="op">=</span> <span class="fl">15</span>, col <span class="op">=</span> <span class="st">"firebrick3"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">145</span>, <span class="fl">128</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">'gray'</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-49-1.png" width="65%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1384"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">days</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">80</span>, <span class="fl">125</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">days</span>, from <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,
  main <span class="op">=</span> <span class="st">"Density plot"</span>,
  xlab <span class="op">=</span> <span class="st">"Number of days since trial started"</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-50-1.png" width="55%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1385"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">days</span>, from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">180</span>, adjust <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>,
  main <span class="op">=</span> <span class="st">"Density plot - Up to 180 days (86% of data)"</span>,
  xlab <span class="op">=</span> <span class="st">"Number of days since trial started"</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-50-2.png" width="55%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1386"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival">survival</a></span><span class="op">)</span>
<span class="va">surv.days</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">days</span><span class="op">)</span>
<span class="va">surv.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html">survfit</a></span><span class="op">(</span><span class="va">surv.days</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">surv.fit</span>,
  main <span class="op">=</span> <span class="st">"Kaplan-Meier estimate with 95% confidence bounds (86% of data)"</span>,
  xlab <span class="op">=</span> <span class="st">"Days since trial started"</span>,
  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">180</span><span class="op">)</span>,
  ylab <span class="op">=</span> <span class="st">"Survival function"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">10</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-51-1.png" width="75%" style="display: block; margin: auto;"></div>
</div>
<div id="plot-ecdf" class="section level3" number="10.2.4">
<h3>
<span class="header-section-number">10.2.4</span> 经验图<a class="anchor" aria-label="anchor" href="#plot-ecdf"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1387"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">faithful</span>, <span class="op">{</span>
  <span class="va">long</span> <span class="op">&lt;-</span> <span class="va">eruptions</span><span class="op">[</span><span class="va">eruptions</span> <span class="op">&gt;</span> <span class="fl">3</span><span class="op">]</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ecdf.html">ecdf</a></span><span class="op">(</span><span class="va">long</span><span class="op">)</span>, do.points <span class="op">=</span> <span class="cn">FALSE</span>, verticals <span class="op">=</span> <span class="cn">TRUE</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5.4</span>, <span class="fl">0.01</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">long</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">long</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:faithful-ecdf"></span>
<img src="graphics-foundations_files/figure-html/faithful-ecdf-1.png" alt="累积经验分布图" width="672"><p class="caption">
图 10.46: 累积经验分布图
</p>
</div>
</div>
<div id="plot-qqnorm" class="section level3" number="10.2.5">
<h3>
<span class="header-section-number">10.2.5</span> QQ 图<a class="anchor" aria-label="anchor" href="#plot-qqnorm"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1388"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">faithful</span>, <span class="op">{</span>
  <span class="va">long</span> <span class="op">&lt;-</span> <span class="va">eruptions</span><span class="op">[</span><span class="va">eruptions</span> <span class="op">&gt;</span> <span class="fl">3</span><span class="op">]</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>pty <span class="op">=</span> <span class="st">"s"</span><span class="op">)</span> <span class="co"># arrange for a square figure region</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">long</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">long</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/faithful-eruptions-1.png" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="plot-ts" class="section level3" number="10.2.6">
<h3>
<span class="header-section-number">10.2.6</span> 时序图<a class="anchor" aria-label="anchor" href="#plot-ts"><i class="fas fa-link"></i></a>
</h3>
<p>时序图最适合用来描述股价走势</p>
<div class="sourceCode" id="cb1389"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html">matplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/time.html">time</a></span><span class="op">(</span><span class="va">EuStockMarkets</span><span class="op">)</span>, <span class="va">EuStockMarkets</span>,
  main <span class="op">=</span> <span class="st">""</span>,
  xlab <span class="op">=</span> <span class="st">"Date"</span>, ylab <span class="op">=</span> <span class="st">"closing prices"</span>,
  pch <span class="op">=</span> <span class="fl">17</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">EuStockMarkets</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">17</span>, lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-52"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-52-1.png" alt="1991–1998年间主要欧洲股票市场日闭市价格指数图 
 德国 DAX (Ibis), Switzerland SMI, 法国 CAC 和 英国 FTSE" width="672"><p class="caption">
图 10.47: 1991–1998年间主要欧洲股票市场日闭市价格指数图
德国 DAX (Ibis), Switzerland SMI, 法国 CAC 和 英国 FTSE
</p>
</div>
</div>
<div id="plot-pie" class="section level3" number="10.2.7">
<h3>
<span class="header-section-number">10.2.7</span> 饼图<a class="anchor" aria-label="anchor" href="#plot-pie"><i class="fas fa-link"></i></a>
</h3>
<p>clockwise 参数</p>
<div class="sourceCode" id="cb1390"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pie.sales</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.12</span>, <span class="fl">0.3</span>, <span class="fl">0.26</span>, <span class="fl">0.16</span>, <span class="fl">0.04</span>, <span class="fl">0.12</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">pie.sales</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="st">"Blueberry"</span>, <span class="st">"Cherry"</span>,
  <span class="st">"Apple"</span>, <span class="st">"Boston Cream"</span>, <span class="st">"Other"</span>, <span class="st">"Vanilla Cream"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/pie.html">pie</a></span><span class="op">(</span><span class="va">pie.sales</span>, clockwise <span class="op">=</span> <span class="cn">TRUE</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="st">"init.angle = 90"</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-53-1.png" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="plot-stem-leaf" class="section level3" number="10.2.8">
<h3>
<span class="header-section-number">10.2.8</span> 茎叶图<a class="anchor" aria-label="anchor" href="#plot-stem-leaf"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1391"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/stem.html">stem</a></span><span class="op">(</span><span class="va">longley</span><span class="op">$</span><span class="va">Unemployed</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##   The decimal point is 2 digit(s) to the right of the |
## 
##   1 | 99
##   2 | 134899
##   3 | 46789
##   4 | 078</code></pre>
</div>
<div id="plot-scatter" class="section level3" number="10.2.9">
<h3>
<span class="header-section-number">10.2.9</span> 散点图<a class="anchor" aria-label="anchor" href="#plot-scatter"><i class="fas fa-link"></i></a>
</h3>
<p>在一维空间上，绘制散点图，其实是在看散点的疏密程度随坐标轴的变化</p>
<div class="sourceCode" id="cb1393"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/stripchart.html">stripchart</a></span><span class="op">(</span><span class="va">longley</span><span class="op">$</span><span class="va">Unemployed</span>,
  method <span class="op">=</span> <span class="st">"jitter"</span>,
  jitter <span class="op">=</span> <span class="fl">0.1</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"lightblue"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/stripchart.html">stripchart</a></span><span class="op">(</span><span class="va">longley</span><span class="op">$</span><span class="va">Unemployed</span>,
  method <span class="op">=</span> <span class="st">"overplot"</span>,
  pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"lightblue"</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-55"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-55-1.png" alt="一维散点图" width="672"><img src="graphics-foundations_files/figure-html/unnamed-chunk-55-2.png" alt="一维散点图" width="672"><p class="caption">
图 10.48: 一维散点图
</p>
</div>
<p>气泡图是二维散点图的一种变体，气泡的大小可以用来描述第三个变量，下面以数据集 topo 为例展示气泡图</p>
<div class="sourceCode" id="cb1394"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 加载数据集</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">topo</span>, package <span class="op">=</span> <span class="st">"MASS"</span><span class="op">)</span>
<span class="co"># 查看数据集</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">topo</span><span class="op">)</span></code></pre></div>
<pre><code>## 'data.frame':    52 obs. of  3 variables:
##  $ x: num  0.3 1.4 2.4 3.6 5.7 1.6 2.9 3.4 3.4 4.8 ...
##  $ y: num  6.1 6.2 6.1 6.2 6.2 5.2 5.1 5.3 5.7 5.6 ...
##  $ z: int  870 793 755 690 800 800 730 728 710 780 ...</code></pre>
<p>topo 是空间地形数据集，包含有52行3列，数据点是310平方英尺范围内的海拔高度数据，x 坐标每单位50英尺，y 坐标单位同 x 坐标，海拔高度 z 单位是英尺</p>
<div class="sourceCode" id="cb1396"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,
  cex <span class="op">=</span> <span class="op">(</span><span class="fl">960</span> <span class="op">-</span> <span class="va">z</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">960</span> <span class="op">-</span> <span class="fl">690</span><span class="op">)</span> <span class="op">*</span> <span class="fl">3</span>, data <span class="op">=</span> <span class="va">topo</span>,
  xlab <span class="op">=</span> <span class="st">"X Coordinates"</span>, ylab <span class="op">=</span> <span class="st">"Y coordinates"</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-57"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-57-1.png" alt="地形图之海拔高度" width="384"><p class="caption">
图 10.49: 地形图之海拔高度
</p>
</div>
<p>散点图也适合分类数据的展示，在图中用不同颜色或符号标记数据点所属类别，即在普通散点图的基础上添加一分类变量的描述</p>
<div class="sourceCode" id="cb1397"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">hp</span>,
  data <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/subset.data.table.html">subset</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">am</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"blue"</span>,
  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">350</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">35</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">hp</span>,
  col <span class="op">=</span> <span class="st">"red"</span>, pch <span class="op">=</span> <span class="fl">16</span>,
  data <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/subset.data.table.html">subset</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">am</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">35</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"0"</span><span class="op">)</span>,
  title <span class="op">=</span> <span class="st">"am"</span>,
  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span>,
  pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">16</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:category-base"></span>
<img src="graphics-foundations_files/figure-html/category-base-1.png" alt="分类散点图" width="75%"><p class="caption">
图 10.50: 分类散点图
</p>
</div>
<p>iris 数据</p>
<div class="sourceCode" id="cb1398"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Sepal.Width</span>, data <span class="op">=</span> <span class="va">iris</span>, col <span class="op">=</span> <span class="va">Species</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,
  legend <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>, box.col <span class="op">=</span> <span class="st">"gray"</span>,
  pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:iris-scatter"></span>
<img src="graphics-foundations_files/figure-html/iris-scatter-1.png" alt="分类散点图" width="75%"><p class="caption">
图 10.51: 分类散点图
</p>
</div>
<p>分组散点图和平滑</p>
<div class="sourceCode" id="cb1399"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">carData</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/car/man/scatterplot.html">scatterplot</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Sepal.Width</span>,
  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">16</span>, <span class="fl">16</span><span class="op">)</span>,
  smooth <span class="op">=</span> <span class="cn">TRUE</span>, boxplots <span class="op">=</span> <span class="st">"xy"</span>, groups <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span>,
  xlab <span class="op">=</span> <span class="st">"Sepal.Width"</span>, ylab <span class="op">=</span> <span class="st">"Sepal.Length"</span>, data <span class="op">=</span> <span class="va">iris</span>
<span class="op">)</span></code></pre></div>
<p>有时为了实现特定的目的，需要高亮其中某些点，按类别或者因子变量分组绘制散点图，这里继续采用 <code>stripchart</code> 函数绘制二维散点图<a href="chap-graphics-foundations.html#fig:scatter-iris">10.52</a>，由左图可知，函数 <code>stripchart</code> 提供的参数 <code>pch</code> 不接受向量，实际只是取了前三个值 16 16 17 对应于 Species 的三类，关键是高亮的分界点是有区分意义的</p>
<div class="sourceCode" id="cb1400"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"iris"</span><span class="op">)</span>
<span class="va">pch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Petal.Length</span><span class="op">)</span><span class="op">)</span>
<span class="va">pch</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Petal.Length</span> <span class="op">&lt;</span> <span class="fl">1.4</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">17</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/stripchart.html">stripchart</a></span><span class="op">(</span><span class="va">Petal.Length</span> <span class="op">~</span> <span class="va">Species</span>,
  data <span class="op">=</span> <span class="va">iris</span>,
  vertical <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"jitter"</span>,
  pch <span class="op">=</span> <span class="va">pch</span>
<span class="op">)</span>
<span class="co"># 对比一下</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/stripchart.html">stripchart</a></span><span class="op">(</span><span class="va">Petal.Length</span> <span class="op">~</span> <span class="va">Species</span>,
  data <span class="op">=</span> <span class="va">iris</span>, subset <span class="op">=</span> <span class="va">Petal.Length</span> <span class="op">&gt;</span> <span class="fl">1.4</span>,
  vertical <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"jitter"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">7</span><span class="op">)</span>,
  pch <span class="op">=</span> <span class="fl">16</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/stripchart.html">stripchart</a></span><span class="op">(</span><span class="va">Petal.Length</span> <span class="op">~</span> <span class="va">Species</span>,
  data <span class="op">=</span> <span class="va">iris</span>, subset <span class="op">=</span> <span class="va">Petal.Length</span> <span class="op">&lt;</span> <span class="fl">1.4</span>,
  vertical <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"jitter"</span>, add <span class="op">=</span> <span class="cn">TRUE</span>,
  pch <span class="op">=</span> <span class="fl">17</span>, col <span class="op">=</span> <span class="st">"red"</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:scatter-iris"></span>
<img src="graphics-foundations_files/figure-html/scatter-iris-1.png" alt="高亮图中部分散点" width="45%"><img src="graphics-foundations_files/figure-html/scatter-iris-2.png" alt="高亮图中部分散点" width="45%"><p class="caption">
图 10.52: 高亮图中部分散点
</p>
</div>
<p>如果存在大量散点</p>
<div class="sourceCode" id="cb1401"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/grDevices/densCols.html">densCols</a></span><span class="op">(</span><span class="va">x</span>,
  y <span class="op">=</span> <span class="cn">NULL</span>, nbin <span class="op">=</span> <span class="fl">128</span>, <span class="va">bandwidth</span>,
  colramp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span><span class="op">(</span><span class="va">blues9</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><code>densCols</code> 函数根据点的局部密度生成颜色，密度估计采用核平滑法，由 <strong>KernSmooth</strong> 包的 <code>bkde2D</code> 函数实现。参数 <code>colramp</code> 传递一个函数，<code>colorRampPalette</code> 根据给定的几种颜色生成函数，参数 <code>bandwidth</code> 实际上是传给 <code>bkde2D</code> 函数</p>
<div class="sourceCode" id="cb1402"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">faithful</span>,
  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/densCols.html">densCols</a></span><span class="op">(</span><span class="va">faithful</span><span class="op">)</span>,
  pch <span class="op">=</span> <span class="fl">20</span>, panel.first <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:densCols"></span>
<img src="graphics-foundations_files/figure-html/densCols-1.png" alt="根据点的密度生成颜色" width="75%"><p class="caption">
图 10.53: 根据点的密度生成颜色
</p>
</div>
<p>气泡图也是散点图的一种</p>
<div class="sourceCode" id="cb1403"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Volume</span> <span class="op">~</span> <span class="va">Height</span>,
  data <span class="op">=</span> <span class="va">trees</span>, pch <span class="op">=</span> <span class="fl">16</span>, cex <span class="op">=</span> <span class="va">Girth</span> <span class="op">/</span> <span class="fl">8</span>,
  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">terrain.colors</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">trees</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-60"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-60-1.png" alt="气泡图" width="672"><p class="caption">
图 10.54: 气泡图
</p>
</div>
<p>气泡图</p>
<div class="sourceCode" id="cb1404"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 空白画布</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>, panel.first <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,
     type <span class="op">=</span> <span class="st">"n"</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, ann <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co"># 添加坐标轴</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">2</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>new <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># 在当前图形上添加图形</span>
<span class="co"># axes 坐标轴上的刻度 "xaxt" or "yaxt"  ann 坐标轴和标题的标签</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">5</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">5</span>, <span class="fl">1</span><span class="op">)</span>,
  cex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>,
  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>, <span class="fl">100</span><span class="op">)</span><span class="op">]</span>,
  bg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"gray"</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, <span class="fl">1</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  axes <span class="op">=</span> <span class="cn">FALSE</span>, ann <span class="op">=</span> <span class="cn">FALSE</span>, pch <span class="op">=</span> <span class="fl">21</span>, lwd <span class="op">=</span> <span class="fl">2</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"top"</span>,
  legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"class"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>,
  pt.lwd <span class="op">=</span> <span class="fl">2</span>, pch <span class="op">=</span> <span class="fl">21</span>, box.col <span class="op">=</span> <span class="st">"gray"</span>, horiz <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-61-1.png" width="672" style="display: block; margin: auto;"></div>
<p>除了<code>par(new=TRUE)</code>设置外，有些函数本身就具有 <code>add</code> 选项</p>
<div class="sourceCode" id="cb1405"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">~</span> <span class="va">speed</span>, data <span class="op">=</span> <span class="va">cars</span>, pch <span class="op">=</span> <span class="fl">17</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">cars</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/symbols.html">symbols</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">~</span> <span class="va">speed</span>,
  circles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">speed</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,
  pch <span class="op">=</span> <span class="fl">16</span>, inches <span class="op">=</span> <span class="fl">.5</span>, add <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span><span class="op">)</span>
<span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">~</span> <span class="va">speed</span>, data <span class="op">=</span> <span class="va">cars</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="va">z</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="va">tan</span>, from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">8</span> <span class="op">*</span> <span class="va">pi</span>, n <span class="op">=</span> <span class="fl">100</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/lowess.html">lowess</a></span><span class="op">(</span><span class="va">cars</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">100</span>, pch <span class="op">=</span> <span class="fl">16</span>, cex <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">80</span>, <span class="st">"text here"</span>, cex <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-62-1.png" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="base-jitter" class="section level3" number="10.2.10">
<h3>
<span class="header-section-number">10.2.10</span> 抖动图<a class="anchor" aria-label="anchor" href="#base-jitter"><i class="fas fa-link"></i></a>
</h3>
<p>抖动散点图</p>
<div class="sourceCode" id="cb1406"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">colors</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">9</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">colors</a></span><span class="op">(</span><span class="op">)</span>,
  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">colors</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="fl">9</span><span class="op">)</span><span class="op">)</span>,
  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">73</span>, <span class="fl">9</span><span class="op">)</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/jitter.html">jitter</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
  data <span class="op">=</span> <span class="va">df</span>, col <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">col</span>,
  pch <span class="op">=</span> <span class="fl">16</span>, main <span class="op">=</span> <span class="st">"Visualizing colors() split in 9 groups"</span>,
  xlab <span class="op">=</span> <span class="st">"Group"</span>,
  ylab <span class="op">=</span> <span class="st">"Element of the group (min = 1, max = 73)"</span>,
  sub <span class="op">=</span> <span class="st">"x = 3, y = 1 means that it's the 2 * 73 + 1 = 147th color"</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:jitter-scatter"></span>
<img src="graphics-foundations_files/figure-html/jitter-scatter-1.png" alt="抖动散点图" width="672"><p class="caption">
图 10.55: 抖动散点图
</p>
</div>
</div>
<div id="plot-box" class="section level3" number="10.2.11">
<h3>
<span class="header-section-number">10.2.11</span> 箱线图<a class="anchor" aria-label="anchor" href="#plot-box"><i class="fas fa-link"></i></a>
</h3>
<p>boxplotdbl: Double Box Plot for Two-Axes Correlation. Correlation chart of two set (x and y) of data. Using Quartiles with boxplot style. Visualize the effect of factor.</p>
<p><a href="https://tomizonor.wordpress.com/2013/03/15/double-box-plot/">复合箱线图</a></p>
<div class="sourceCode" id="cb1407"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, <span class="op">{</span>
  <span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Species</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">Species</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Petal.Length</span> <span class="op">~</span> <span class="va">Species</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Petal.Width</span> <span class="op">~</span> <span class="va">Species</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"Edgar Anderson's Iris Data"</span>, side <span class="op">=</span> <span class="fl">3</span>, line <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:iris"></span>
<img src="graphics-foundations_files/figure-html/iris-1.png" alt="安德森的鸢尾花数据" width="672"><p class="caption">
图 10.56: 安德森的鸢尾花数据
</p>
</div>
<p>箱线图的花样也很多</p>
<div class="sourceCode" id="cb1408"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">InsectSprays</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">.5</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">InsectSprays</span>, <span class="va">count</span> <span class="op">~</span> <span class="va">spray</span>,
  col <span class="op">=</span> <span class="st">"gray"</span>, xlab <span class="op">=</span> <span class="st">"Spray"</span>, ylab <span class="op">=</span> <span class="st">"Count"</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">InsectSprays</span>, <span class="va">count</span> <span class="op">~</span> <span class="va">spray</span>,
  col <span class="op">=</span> <span class="st">"gray"</span>, horizontal <span class="op">=</span> <span class="cn">TRUE</span>,
  las <span class="op">=</span> <span class="fl">1</span>, xlab <span class="op">=</span> <span class="st">"Count"</span>, ylab <span class="op">=</span> <span class="st">"Spray"</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-63"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-63-1.png" alt="箱线图" width="384"><img src="graphics-foundations_files/figure-html/unnamed-chunk-63-2.png" alt="箱线图" width="384"><p class="caption">
图 10.57: 箱线图
</p>
</div>
<p>Notched Boxplots</p>
<div class="sourceCode" id="cb1409"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">8</span>
<span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/gl.html">gl</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">100</span>, <span class="va">n</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span> <span class="co"># n水平个数 100是重复次数</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/split.html">split</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">g</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html">gray.colors</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, notch <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span>
  main <span class="op">=</span> <span class="st">"Notched Boxplots"</span>, xlab <span class="op">=</span> <span class="st">"Group"</span>,
  font.main <span class="op">=</span> <span class="fl">4</span>, font.lab <span class="op">=</span> <span class="fl">1</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-64-1.png" width="384" style="display: block; margin: auto;"></div>
<p>真实的情况是这样的</p>
<div class="sourceCode" id="cb1410"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cumcm2011A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"cumcm2011A.RDS"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">cumcm2011A</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">As</span>, xlab <span class="op">=</span> <span class="st">"As"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.8</span>, <span class="fl">3.6</span>, <span class="fl">5.4</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">cumcm2011A</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">Cd</span>, xlab <span class="op">=</span> <span class="st">"Cd"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">70</span>, <span class="fl">130</span>, <span class="fl">190</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">cumcm2011A</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">Cr</span>, xlab <span class="op">=</span> <span class="st">"Cr"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">31</span>, <span class="fl">49</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">cumcm2011A</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">Cu</span>, xlab <span class="op">=</span> <span class="st">"Cu"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6.0</span>, <span class="fl">13.2</span>, <span class="fl">20.4</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">cumcm2011A</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">Hg</span>, xlab <span class="op">=</span> <span class="st">"Hg"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">19</span>, <span class="fl">35</span>, <span class="fl">51</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">cumcm2011A</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">Ni</span>, xlab <span class="op">=</span> <span class="st">"Ni"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4.7</span>, <span class="fl">12.3</span>, <span class="fl">19.9</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">cumcm2011A</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">Pb</span>, xlab <span class="op">=</span> <span class="st">"Pb"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">19</span>, <span class="fl">31</span>, <span class="fl">43</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">cumcm2011A</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">Zn</span>, xlab <span class="op">=</span> <span class="st">"Zn"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">41</span>, <span class="fl">69</span>, <span class="fl">97</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb1411"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">As</span> <span class="op">~</span> <span class="va">area</span>,
  data <span class="op">=</span> <span class="va">cumcm2011A</span>,
  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>
  h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.8</span>, <span class="fl">3.6</span>, <span class="fl">5.4</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span>,
  lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="error-bars" class="section level3" number="10.2.12">
<h3>
<span class="header-section-number">10.2.12</span> 残差图<a class="anchor" aria-label="anchor" href="#error-bars"><i class="fas fa-link"></i></a>
</h3>
<p>iris 四个测量指标</p>
<div class="sourceCode" id="cb1412"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">vec_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span>
<span class="va">vec_sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">sd</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>, <span class="va">vec_mean</span>,
  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">vec_mean</span> <span class="op">-</span> <span class="va">vec_sd</span>, <span class="va">vec_mean</span> <span class="op">+</span> <span class="va">vec_sd</span><span class="op">)</span><span class="op">)</span>,
  xlab <span class="op">=</span> <span class="st">"Species"</span>, ylab <span class="op">=</span> <span class="st">"Mean +/- SD"</span>, lwd <span class="op">=</span> <span class="fl">1</span>, pch <span class="op">=</span> <span class="fl">19</span>,
  axes <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">2</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html">arrows</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>, <span class="va">vec_mean</span> <span class="op">-</span> <span class="va">vec_sd</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>, <span class="va">vec_mean</span> <span class="op">+</span> <span class="va">vec_sd</span>,
  length <span class="op">=</span> <span class="fl">0.05</span>, angle <span class="op">=</span> <span class="fl">90</span>, code <span class="op">=</span> <span class="fl">3</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-67"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-67-1.png" alt="带标准差的均值散点图" width="480"><p class="caption">
图 10.58: 带标准差的均值散点图
</p>
</div>
</div>
<div id="plot-violin" class="section level3" number="10.2.13">
<h3>
<span class="header-section-number">10.2.13</span> 提琴图<a class="anchor" aria-label="anchor" href="#plot-violin"><i class="fas fa-link"></i></a>
</h3>
<p>Tom Kelly 维护的 vioplot 包 <a href="https://github.com/TomKellyGenetics/vioplot" class="uri">https://github.com/TomKellyGenetics/vioplot</a></p>
</div>
<div id="plot-contour" class="section level3" number="10.2.14">
<h3>
<span class="header-section-number">10.2.14</span> 轮廓图<a class="anchor" aria-label="anchor" href="#plot-contour"><i class="fas fa-link"></i></a>
</h3>
<p>topo 是地形数据</p>
<p>等高线图</p>
</div>
<div id="plot-line" class="section level3" number="10.2.15">
<h3>
<span class="header-section-number">10.2.15</span> 折线图<a class="anchor" aria-label="anchor" href="#plot-line"><i class="fas fa-link"></i></a>
</h3>
<p>函数曲线，样条曲线，核密度曲线，平行坐标图</p>
<ul>
<li>折线图</li>
<li>点线图 <code>plot(type="b")</code> 函数曲线图 <code>curve</code> <code>matplot</code> X 样条曲线 <code>xspline</code>
</li>
<li>时序图</li>
</ul>
<p>太阳黑子活动数据</p>
<p>sunspot.month Monthly Sunspot Data, from 1749 to “Present”
sunspot.year Yearly Sunspot Data, 1700-1988
sunspots Monthly Sunspot Numbers, 1749-1983</p>
<div class="sourceCode" id="cb1413"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">AirPassengers</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-68"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-68-1.png" alt="折线图" width="672"><p class="caption">
图 10.59: 折线图
</p>
</div>
</div>
<div id="function" class="section level3" number="10.2.16">
<h3>
<span class="header-section-number">10.2.16</span> 函数图<a class="anchor" aria-label="anchor" href="#function"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1414"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x0</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">20</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>
<span class="va">nus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span>, length.out <span class="op">=</span> <span class="fl">501</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x0</span>, <span class="va">x0</span><span class="op">^</span><span class="op">-</span><span class="fl">8</span>,
  frame.plot <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># 添加绘图框</span>
  log <span class="op">=</span> <span class="st">"xy"</span>, <span class="co"># x 和 y 轴都取对数尺度</span>
  axes <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># 去掉坐标轴</span>
  xlab <span class="op">=</span> <span class="st">"$u$"</span>, ylab <span class="op">=</span> <span class="st">"$\\mathcal{K}_{\\kappa}(u)$"</span>, <span class="co"># 设置坐标轴标签</span>
  type <span class="op">=</span> <span class="st">"n"</span>, <span class="co"># 清除绘图区域的内容</span>
  ann <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># 添加标题 x和y轴标签</span>
  panel.first <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># 添加背景参考线</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>,
  at <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="op">-</span><span class="fl">8</span>, to <span class="op">=</span> <span class="fl">2</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,
  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"$\\mathsf{10^{"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="op">-</span><span class="fl">8</span>, to <span class="op">=</span> <span class="fl">2</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="st">"}}$"</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">2</span>,
  at <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="op">-</span><span class="fl">8</span>, to <span class="op">=</span> <span class="fl">56</span>, by <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,
  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"$\\mathsf{10^{"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="op">-</span><span class="fl">8</span>, to <span class="op">=</span> <span class="fl">56</span>, by <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>, <span class="st">"}}$"</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span>
<span class="op">)</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">nus</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Bessel.html">besselK</a></span><span class="op">(</span><span class="va">x0</span>, nu <span class="op">=</span> <span class="va">nus</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,
  legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"$\\kappa="</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">nus</span><span class="op">)</span>, <span class="st">"$"</span><span class="op">)</span>,
  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span><span class="fl">9</span>, rev <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>, cex <span class="op">=</span> <span class="fl">1</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:bessel-function"></span>
<img src="graphics-foundations_files/figure-html/bessel-function-1.png" alt="贝塞尔函数" width="65%"><p class="caption">
图 10.60: 贝塞尔函数
</p>
</div>
<p>还有 eta 函数和 gammaz 函数</p>
</div>
<div id="plot-mosaic" class="section level3" number="10.2.17">
<h3>
<span class="header-section-number">10.2.17</span> 马赛克图<a class="anchor" aria-label="anchor" href="#plot-mosaic"><i class="fas fa-link"></i></a>
</h3>
<p>马赛克图 mosaicplot</p>
<div class="sourceCode" id="cb1415"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">HairEyeColor</span>, col <span class="op">=</span> <span class="st">"lightblue"</span>, border <span class="op">=</span> <span class="st">"white"</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-69"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-69-1.png" alt="马赛克图" width="480"><p class="caption">
图 10.61: 马赛克图
</p>
</div>
</div>
<div id="plot-dotchart" class="section level3" number="10.2.18">
<h3>
<span class="header-section-number">10.2.18</span> 点图<a class="anchor" aria-label="anchor" href="#plot-dotchart"><i class="fas fa-link"></i></a>
</h3>
<p>dotchart 克利夫兰点图</p>
<p>条件图 coplot</p>
</div>
<div id="plot-matrix" class="section level3" number="10.2.19">
<h3>
<span class="header-section-number">10.2.19</span> 矩阵图<a class="anchor" aria-label="anchor" href="#plot-matrix"><i class="fas fa-link"></i></a>
</h3>
<p>在对角线上添加平滑曲线、密度曲线</p>
<div class="sourceCode" id="cb1416"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">longley</span>,
  gap <span class="op">=</span> <span class="fl">0</span>,
  diag.panel <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>new <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">x</span>,
      col <span class="op">=</span> <span class="st">"light blue"</span>,
      probability <span class="op">=</span> <span class="cn">TRUE</span>,
      axes <span class="op">=</span> <span class="cn">FALSE</span>,
      main <span class="op">=</span> <span class="st">""</span>
    <span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
      col <span class="op">=</span> <span class="st">"red"</span>,
      lwd <span class="op">=</span> <span class="fl">3</span>
    <span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/rug.html">rug</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-70"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-70-1.png" alt="变量关系" width="75%"><p class="caption">
图 10.62: 变量关系
</p>
</div>
<div class="sourceCode" id="cb1417"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 自带 layout</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span>, col <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-71"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-71-1.png" alt="矩阵图" width="75%"><p class="caption">
图 10.63: 矩阵图
</p>
</div>
</div>
<div id="plot-radar" class="section level3" number="10.2.20">
<h3>
<span class="header-section-number">10.2.20</span> 雷达图<a class="anchor" aria-label="anchor" href="#plot-radar"><i class="fas fa-link"></i></a>
</h3>
<p>星图 stars 多元数据</p>
</div>
<div id="plot-rose" class="section level3" number="10.2.21">
<h3>
<span class="header-section-number">10.2.21</span> 玫瑰图<a class="anchor" aria-label="anchor" href="#plot-rose"><i class="fas fa-link"></i></a>
</h3>
<p>注意与 image 函数区别</p>
<div class="sourceCode" id="cb1418"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">volcano</span><span class="op">)</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">volcano</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/image.html">image</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">volcano</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">terrain.colors</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, axes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/contour.html">contour</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">volcano</span>,
  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">200</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,
  add <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="st">"peru"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">800</span>, by <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">2</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">600</span>, by <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span>main <span class="op">=</span> <span class="st">"Maunga Whau Volcano"</span>, font.main <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-72"></span>
<img src="graphics-foundations_files/figure-html/unnamed-chunk-72-1.png" alt="image 图形" width="75%"><p class="caption">
图 10.64: image 图形
</p>
</div>
</div>
<div id="plot-persp" class="section level3" number="10.2.22">
<h3>
<span class="header-section-number">10.2.22</span> 透视图<a class="anchor" aria-label="anchor" href="#plot-persp"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1419"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">2.1</span>, <span class="fl">.5</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">)</span>
<span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span>, length <span class="op">=</span> <span class="fl">51</span><span class="op">)</span>
<span class="va">x2</span> <span class="op">&lt;-</span> <span class="va">x1</span> 
<span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">mu1</span> <span class="op">=</span> <span class="fl">0</span>, <span class="va">mu2</span> <span class="op">=</span> <span class="fl">0</span>, <span class="va">s11</span> <span class="op">=</span> <span class="fl">10</span>, <span class="va">s12</span> <span class="op">=</span> <span class="fl">15</span>, <span class="va">s22</span> <span class="op">=</span> <span class="fl">10</span>, <span class="va">rho</span> <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">term1</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">s11</span> <span class="op">*</span> <span class="va">s22</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">rho</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="va">term2</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">rho</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
  <span class="va">term3</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x1</span> <span class="op">-</span> <span class="va">mu1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">s11</span>
  <span class="va">term4</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x2</span> <span class="op">-</span> <span class="va">mu2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">s22</span>
  <span class="va">term5</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span> <span class="op">*</span> <span class="va">rho</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="va">x1</span> <span class="op">-</span> <span class="va">mu1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">x2</span> <span class="op">-</span> <span class="va">mu2</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">s11</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">s22</span><span class="op">)</span><span class="op">)</span>
  <span class="va">term1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">term2</span> <span class="op">*</span> <span class="op">(</span><span class="va">term3</span> <span class="op">+</span> <span class="va">term4</span> <span class="op">-</span> <span class="va">term5</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span> 
<span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html">outer</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">f</span><span class="op">)</span> 
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">shape</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/persp.html">persp</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">z</span>,
  xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, zlab <span class="op">=</span> <span class="st">""</span>,
  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shape/man/drapecol.html">drapecol</a></span><span class="op">(</span><span class="va">z</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">terrain.colors</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span>,
  border <span class="op">=</span> <span class="cn">NA</span>, shade <span class="op">=</span> <span class="fl">0.1</span>, r <span class="op">=</span> <span class="fl">50</span>, d <span class="op">=</span> <span class="fl">0.1</span>, expand <span class="op">=</span> <span class="fl">0.5</span>,
  theta <span class="op">=</span> <span class="fl">120</span>, phi <span class="op">=</span> <span class="fl">15</span>, ltheta <span class="op">=</span> <span class="fl">90</span>, lphi <span class="op">=</span> <span class="fl">180</span>,
  ticktype <span class="op">=</span> <span class="st">"detailed"</span>, nticks <span class="op">=</span> <span class="fl">5</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:normal-dist"></span>
<img src="graphics-foundations_files/figure-html/normal-dist-1.png" alt="统计学的世界" width="75%"><p class="caption">
图 10.65: 统计学的世界
</p>
</div>
</div>
</div>
<div id="lattice-graphics" class="section level2" number="10.3">
<h2>
<span class="header-section-number">10.3</span> 栅格统计图形<a class="anchor" aria-label="anchor" href="#lattice-graphics"><i class="fas fa-link"></i></a>
</h2>
<blockquote>
<p>If you imagine that this pen is Trellis, then Lattice is not this pen.</p>
<p>— Paul Murrell <a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Paul 在 DSC 2001 大会上的幻灯片 见&lt;a href="https://www.stat.auckland.ac.nz/~paul/Talks/dsc2001.pdf" class="uri"&gt;https://www.stat.auckland.ac.nz/~paul/Talks/dsc2001.pdf&lt;/a&gt;&lt;/p&gt;'><sup>32</sup></a></p>
</blockquote>
<p>把网站搬出来，汉化 <a href="http://latticeextra.r-forge.r-project.org/" class="uri">http://latticeextra.r-forge.r-project.org/</a></p>
<div id="lattice-boxplot" class="section level3" number="10.3.1">
<h3>
<span class="header-section-number">10.3.1</span> 箱线图<a class="anchor" aria-label="anchor" href="#lattice-boxplot"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1420"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://lattice.r-forge.r-project.org/">lattice</a></span><span class="op">)</span>
<span class="co"># plot(data = InsectSprays, count ~ spray)</span>
<span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html">bwplot</a></span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="va">spray</span>, data <span class="op">=</span> <span class="va">InsectSprays</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-73-1.png" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="lattice-line" class="section level3" number="10.3.2">
<h3>
<span class="header-section-number">10.3.2</span> 折线图<a class="anchor" aria-label="anchor" href="#lattice-line"><i class="fas fa-link"></i></a>
</h3>
<p>latticeExtra 包提供了强大的图层函数 <code><a href="https://rdrr.io/pkg/latticeExtra/man/layer.html">layer()</a></code></p>
<p>多元时间序列</p>
<div class="sourceCode" id="cb1421"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://latticeextra.r-forge.r-project.org/">latticeExtra</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html">xyplot</a></span><span class="op">(</span><span class="va">EuStockMarkets</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/layer.html">layer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/panel.scaleArrow.html">panel.scaleArrow</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fl">0.99</span>, append <span class="op">=</span> <span class="st">" units"</span>, col <span class="op">=</span> <span class="st">"grey"</span>, srt <span class="op">=</span> <span class="fl">90</span>, cex <span class="op">=</span> <span class="fl">0.8</span>
  <span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-74-1.png" width="672" style="display: block; margin: auto;"></div>
<p>如何解释</p>
<p>时序图</p>
<p>Plot many time series in parallel</p>
<div class="sourceCode" id="cb1422"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/horizonplot.html">horizonplot</a></span><span class="op">(</span><span class="va">EuStockMarkets</span>,
  colorkey <span class="op">=</span> <span class="cn">TRUE</span>,
  origin <span class="op">=</span> <span class="fl">4000</span>, horizonscale <span class="op">=</span> <span class="fl">1000</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/layer.html">layer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/panel.scaleArrow.html">panel.scaleArrow</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fl">0.99</span>, digits <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"grey"</span>,
    srt <span class="op">=</span> <span class="fl">90</span>, cex <span class="op">=</span> <span class="fl">0.7</span>
  <span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/layer.html">layer</a></span><span class="op">(</span>
    <span class="va">lim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/panel.axis.html">current.panel.limits</a></span><span class="op">(</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/llines.html">panel.text</a></span><span class="op">(</span><span class="va">lim</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">lim</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">lim</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span>,
      font <span class="op">=</span> <span class="fl">2</span>,
      cex <span class="op">=</span> <span class="fl">0.7</span>, adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.5</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"#9FC8DC"</span>
    <span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-75-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1423"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># # https://stackoverflow.com/questions/25109196/r-lattice-package-add-legend-to-a-figure</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://lattice.r-forge.r-project.org/">lattice</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/">nlme</a></span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Orange</span>,
  outer <span class="op">=</span> <span class="op">~</span><span class="fl">1</span>,
  key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    space <span class="op">=</span> <span class="st">"right"</span>, title <span class="op">=</span> <span class="st">"Tree"</span>, cex.title <span class="op">=</span> <span class="fl">1</span>,
    lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html">gray.colors</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span>,
    <span class="co"># points = list(pch = 1, col = gray.colors(5)),</span>
    text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"3"</span>, <span class="st">"1"</span>, <span class="st">"5"</span>, <span class="st">"2"</span>, <span class="st">"4"</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>,
  par.settings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="co"># plot.line = list(col = gray.colors(5), border = "transparent"),</span>
    <span class="co"># plot.symbol = list(col = gray.colors(5), border = "transparent"),</span>
    strip.background <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span>,
    strip.border <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-76-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1424"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://lattice.r-forge.r-project.org/">lattice</a></span><span class="op">)</span>
<span class="co">## Plot the claims frequency against age group by engine size and district</span>

<span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html">barchart</a></span><span class="op">(</span><span class="va">Claims</span> <span class="op">/</span> <span class="va">Holders</span> <span class="op">~</span> <span class="va">Age</span> <span class="op">|</span> <span class="va">Group</span>,
  groups <span class="op">=</span> <span class="va">District</span>,
  data <span class="op">=</span> <span class="va">Insurance</span>, origin <span class="op">=</span> <span class="fl">0</span>, auto.key <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-77-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1425"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html">barchart</a></span><span class="op">(</span><span class="va">Claims</span> <span class="op">/</span> <span class="va">Holders</span> <span class="op">~</span> <span class="va">Age</span> <span class="op">|</span> <span class="va">Group</span>,
  groups <span class="op">=</span> <span class="va">District</span>, data <span class="op">=</span> <span class="va">Insurance</span>,
  main <span class="op">=</span> <span class="st">"Claims frequency"</span>,
  auto.key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    space <span class="op">=</span> <span class="st">"top"</span>, columns <span class="op">=</span> <span class="fl">4</span>,
    title <span class="op">=</span> <span class="st">"District"</span>, cex.title <span class="op">=</span> <span class="fl">1</span>
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-78-1.png" width="672" style="display: block; margin: auto;"></div>
<p>lattice 图形的参数设置</p>
<div class="sourceCode" id="cb1426"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/trellis.par.get.html">show.settings</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/lattice-settings-1.png" width="100%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1427"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myColours</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">6</span>, <span class="st">"Blues"</span><span class="op">)</span>
<span class="va">my.settings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  superpose.polygon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">myColours</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, border <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span>,
  strip.background <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">myColours</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span>,
  strip.border <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># 获取参数设置</span>
<span class="fu"><a href="https://rdrr.io/pkg/lattice/man/trellis.par.get.html">trellis.par.get</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># 全局参数设置</span>
<span class="fu"><a href="https://rdrr.io/pkg/lattice/man/trellis.par.get.html">trellis.par.set</a></span><span class="op">(</span><span class="va">my.settings</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb1428"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://lattice.r-forge.r-project.org/">lattice</a></span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html">barchart</a></span><span class="op">(</span><span class="va">Claims</span> <span class="op">/</span> <span class="va">Holders</span> <span class="op">*</span> <span class="fl">100</span> <span class="op">~</span> <span class="va">Age</span> <span class="op">|</span> <span class="va">Group</span>,
  groups <span class="op">=</span> <span class="va">District</span>, data <span class="op">=</span> <span class="va">Insurance</span>,
  origin <span class="op">=</span> <span class="fl">0</span>, main <span class="op">=</span> <span class="st">"Motor insurance claims frequency"</span>,
  xlab <span class="op">=</span> <span class="st">"Age"</span>, ylab <span class="op">=</span> <span class="st">"Claims frequency %"</span>,
  scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>alternating <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
  auto.key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    space <span class="op">=</span> <span class="st">"top"</span>, columns <span class="op">=</span> <span class="fl">4</span>, 
    points <span class="op">=</span> <span class="cn">FALSE</span>, rectangles <span class="op">=</span> <span class="cn">TRUE</span>,
    title <span class="op">=</span> <span class="st">"District"</span>, cex.title <span class="op">=</span> <span class="fl">1</span>
  <span class="op">)</span>,
  par.settings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    superpose.polygon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html">gray.colors</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>, border <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span>,
    strip.background <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray80"</span><span class="op">)</span>,
    strip.border <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>
  <span class="op">)</span>,
  par.strip.text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray40"</span>, font <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,
  panel <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/panel.functions.html">panel.grid</a></span><span class="op">(</span>h <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, v <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/panel.barchart.html">panel.barchart</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">...</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-80-1.png" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="lattice-smooth" class="section level3" number="10.3.3">
<h3>
<span class="header-section-number">10.3.3</span> 平滑图<a class="anchor" aria-label="anchor" href="#lattice-smooth"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1429"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>,
  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">rt</a></span><span class="op">(</span><span class="fl">100</span>, df <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html">xyplot</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">xy</span>, panel <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/panel.xyplot.html">panel.xyplot</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/panel.smoother.html">panel.smoother</a></span><span class="op">(</span><span class="va">...</span>, span <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-81-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1430"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">splines</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html">xyplot</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">xy</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/layer.html">layer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/panel.smoother.html">panel.smoother</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html">ns</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">5</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-81-2.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1431"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/">nlme</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">mgcv</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html">xyplot</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">xy</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/layer.html">layer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/panel.smoother.html">panel.smoother</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"gam"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-81-3.png" width="672" style="display: block; margin: auto;"></div>
<p>Trellis Displays of Tukey’s Hanging Rootograms</p>
<div class="sourceCode" id="cb1432"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="fl">1000</span>, lambda <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/rootogram.html">rootogram</a></span><span class="op">(</span><span class="op">~</span><span class="va">x</span>, dfun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span><span class="va">x</span>, lambda <span class="op">=</span> <span class="fl">50</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-82-1.png" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="lattice-dotplot" class="section level3" number="10.3.4">
<h3>
<span class="header-section-number">10.3.4</span> 点图<a class="anchor" aria-label="anchor" href="#lattice-dotplot"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1433"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 添加背景网格线作为参考线</span>
<span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/segplot.html">segplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">county</span><span class="op">)</span>, <span class="va">rate.male</span><span class="op">)</span> <span class="op">~</span> <span class="va">LCL95.male</span> <span class="op">+</span> <span class="va">UCL95.male</span>,
  data <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/subset.data.table.html">subset</a></span><span class="op">(</span><span class="va">USCancerRates</span>, <span class="va">state</span> <span class="op">==</span> <span class="st">"Washington"</span><span class="op">)</span>,
  draw.bands <span class="op">=</span> <span class="cn">FALSE</span>, centers <span class="op">=</span> <span class="va">rate.male</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-83-1.png" width="576" style="display: block; margin: auto;"></div>
</div>
<div id="lattice-step" class="section level3" number="10.3.5">
<h3>
<span class="header-section-number">10.3.5</span> 阶梯图<a class="anchor" aria-label="anchor" href="#lattice-step"><i class="fas fa-link"></i></a>
</h3>
<p>经验累积分布图</p>
<div class="sourceCode" id="cb1434"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/ecdfplot.html">ecdfplot</a></span><span class="op">(</span><span class="op">~</span><span class="va">height</span> <span class="op">|</span> <span class="va">voice.part</span>, data <span class="op">=</span> <span class="va">singer</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-84-1.png" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="lattice-facet" class="section level3" number="10.3.6">
<h3>
<span class="header-section-number">10.3.6</span> 分面图<a class="anchor" aria-label="anchor" href="#lattice-facet"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1435"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## a variant of Figure 5.6 from Sarkar (2008)</span>
<span class="co">## http://lmdvr.r-forge.r-project.org/figures/figures.html?chapter=05;figure=05_06</span>

<span class="va">depth.ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">quakes</span><span class="op">$</span><span class="va">depth</span><span class="op">)</span><span class="op">)</span>
<span class="va">quakes</span><span class="op">$</span><span class="va">Magnitude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/shingles.html">equal.count</a></span><span class="op">(</span><span class="va">quakes</span><span class="op">$</span><span class="va">mag</span>, <span class="fl">4</span><span class="op">)</span>
<span class="va">quakes.ordered</span> <span class="op">&lt;-</span> <span class="va">quakes</span><span class="op">[</span><span class="va">depth.ord</span>, <span class="op">]</span>

<span class="fu"><a href="https://rdrr.io/pkg/lattice/man/levelplot.html">levelplot</a></span><span class="op">(</span><span class="va">depth</span> <span class="op">~</span> <span class="va">long</span> <span class="op">+</span> <span class="va">lat</span> <span class="op">|</span> <span class="va">Magnitude</span>,
  data <span class="op">=</span> <span class="va">quakes.ordered</span>,
  panel <span class="op">=</span> <span class="va">panel.levelplot.points</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="st">"g"</span><span class="op">)</span>,
  aspect <span class="op">=</span> <span class="st">"iso"</span>, prepanel <span class="op">=</span> <span class="va">prepanel.default.xyplot</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-85-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<div id="lattice-contour" class="section level3" number="10.3.7">
<h3>
<span class="header-section-number">10.3.7</span> 等高线图<a class="anchor" aria-label="anchor" href="#lattice-contour"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1436"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">xyz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span>
<span class="va">xyz</span><span class="op">$</span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">xyz</span>, <span class="va">x</span> <span class="op">*</span> <span class="va">y</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="co">## GAM smoother with smoothness by cross validation</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">mgcv</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/lattice/man/levelplot.html">levelplot</a></span><span class="op">(</span><span class="va">z</span> <span class="op">~</span> <span class="va">x</span> <span class="op">*</span> <span class="va">y</span>, <span class="va">xyz</span>,
  panel <span class="op">=</span> <span class="va">panel.2dsmoother</span>,
  form <span class="op">=</span> <span class="va">z</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"gam"</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/smoothness-1.png" width="75%" style="display: block; margin: auto;"></div>
</div>
<div id="lattice-persp" class="section level3" number="10.3.8">
<h3>
<span class="header-section-number">10.3.8</span> 透视图<a class="anchor" aria-label="anchor" href="#lattice-persp"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1437"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">shape</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/persp.html">persp</a></span><span class="op">(</span><span class="va">volcano</span>, 
  theta <span class="op">=</span> <span class="fl">30</span>, phi <span class="op">=</span> <span class="fl">20</span>, 
  r <span class="op">=</span> <span class="fl">50</span>, d <span class="op">=</span> <span class="fl">0.1</span>, expand <span class="op">=</span> <span class="fl">0.5</span>, ltheta <span class="op">=</span> <span class="fl">90</span>, lphi <span class="op">=</span> <span class="fl">180</span>,
  shade <span class="op">=</span> <span class="fl">0.1</span>, ticktype <span class="op">=</span> <span class="st">"detailed"</span>, nticks <span class="op">=</span> <span class="fl">5</span>, box <span class="op">=</span> <span class="cn">TRUE</span>,
  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shape/man/drapecol.html">drapecol</a></span><span class="op">(</span><span class="va">volcano</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">terrain.colors</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span>,
  xlab <span class="op">=</span> <span class="st">"X"</span>, ylab <span class="op">=</span> <span class="st">"Y"</span>, zlab <span class="op">=</span> <span class="st">"Z"</span>, border <span class="op">=</span> <span class="st">"transparent"</span>,
  main <span class="op">=</span> <span class="st">"Topographic Information \n on Auckland's Maunga Whau Volcano"</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:volcano-topo"></span>
<img src="graphics-foundations_files/figure-html/volcano-topo-1.png" alt="(ref:volcano-topo)" width="528"><p class="caption">
图 10.66: (ref:volcano-topo)
</p>
</div>
</div>
<div id="lattice-cluster" class="section level3" number="10.3.9">
<h3>
<span class="header-section-number">10.3.9</span> 聚类图<a class="anchor" aria-label="anchor" href="#lattice-cluster"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1438"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html">xyplot</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Petal.Length</span>,
  groups <span class="op">=</span> <span class="va">Species</span>,
  data <span class="op">=</span> <span class="va">iris</span>, scales <span class="op">=</span> <span class="st">"free"</span>,
  par.settings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    superpose.symbol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">15</span><span class="op">:</span><span class="fl">17</span><span class="op">)</span><span class="op">)</span>,
    superpose.line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>
  <span class="op">)</span>,
  panel <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/panel.xyplot.html">panel.xyplot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">...</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/panel.ellipse.html">panel.ellipse</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">...</span><span class="op">)</span>
  <span class="op">}</span>,
  auto.key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">.1</span>, y <span class="op">=</span> <span class="fl">.8</span>, corner <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="graphics-foundations_files/figure-html/unnamed-chunk-86-1.png" width="75%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1439"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># lattice 书 6.3.1 节 参数曲面</span>

<span class="va">kx</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">u</span>, <span class="va">v</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">r</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">u</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">ky</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">u</span>, <span class="va">v</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">r</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">u</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">t</span> <span class="op">*</span> <span class="va">v</span><span class="op">)</span> <span class="op">-</span>
    <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">u</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">t</span> <span class="op">*</span> <span class="va">v</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">t</span> <span class="op">*</span> <span class="va">v</span><span class="op">)</span> <span class="op">-</span>
    <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">u</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">t</span> <span class="op">*</span> <span class="va">v</span><span class="op">)</span>
<span class="op">}</span>


<span class="va">kz</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">u</span>, <span class="va">v</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">u</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">t</span> <span class="op">*</span> <span class="va">v</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">u</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">t</span> <span class="op">*</span> <span class="va">v</span><span class="op">)</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">50</span>
<span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">1.25</span>, length <span class="op">=</span> <span class="va">n</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span>
<span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length <span class="op">=</span> <span class="va">n</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span>
<span class="va">um</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">u</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span><span class="op">)</span>
<span class="va">vm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">v</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">r</span> <span class="op">&lt;-</span> <span class="fl">2</span>
<span class="va">t</span> <span class="op">&lt;-</span> <span class="fl">1</span>

<span class="fu"><a href="https://rdrr.io/pkg/lattice/man/cloud.html">wireframe</a></span><span class="op">(</span><span class="fu">kz</span><span class="op">(</span><span class="va">um</span>, <span class="va">vm</span><span class="op">)</span> <span class="op">~</span> <span class="fu">kx</span><span class="op">(</span><span class="va">um</span>, <span class="va">vm</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ky</span><span class="op">(</span><span class="va">um</span>, <span class="va">vm</span><span class="op">)</span>,
  shade <span class="op">=</span> <span class="cn">TRUE</span>, xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,
  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,
  zlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">group</a></span><span class="op">(</span><span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span>, rot <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>,
  screen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>z <span class="op">=</span> <span class="fl">170</span>, x <span class="op">=</span> <span class="op">-</span><span class="fl">60</span><span class="op">)</span>,
  alpha <span class="op">=</span> <span class="fl">0.75</span>, panel.aspect <span class="op">=</span> <span class="fl">0.6</span>, aspect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.4</span><span class="op">)</span>,
  scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>arrows <span class="op">=</span> <span class="cn">FALSE</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,
  lattice.options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    layout.widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      left.padding <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">.6</span>, units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>,
      right.padding <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">1.0</span>, units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>
    <span class="op">)</span>,
    layout.heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      bottom.padding <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">.8</span>, units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>,
      top.padding <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">1.0</span>, units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span>,
  par.settings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    axis.line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
</div>
</div>
<div id="graphics-sessioninfo" class="section level2" number="10.4">
<h2>
<span class="header-section-number">10.4</span> 运行环境<a class="anchor" aria-label="anchor" href="#graphics-sessioninfo"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb1440"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">xfun</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xfun/man/session_info.html">session_info</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## R version 4.2.0 (2022-04-22)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 20.04.5 LTS
## 
## Locale:
##   LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##   LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##   LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
##   LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##   LC_ADDRESS=C               LC_TELEPHONE=C            
##   LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## Package version:
##   base64enc_0.1.3     bookdown_0.26       brio_1.1.3         
##   bslib_0.3.1         cachem_1.0.6        cli_3.3.0          
##   compiler_4.2.0      curl_4.3.2          desc_1.4.1         
##   digest_0.6.29       downlit_0.4.0       evaluate_0.15      
##   fansi_1.0.3         fastmap_1.1.0       fs_1.5.2           
##   glue_1.6.2          graphics_4.2.0      grDevices_4.2.0    
##   grid_4.2.0          highr_0.9           htmltools_0.5.2    
##   jpeg_0.1-9          jquerylib_0.1.4     jsonlite_1.8.0     
##   KernSmooth_2.23-20  knitr_1.39          lattice_0.20-45    
##   latticeExtra_0.6-29 magrittr_2.0.3      mapproj_1.2.8      
##   maps_3.4.0          MASS_7.3-57         Matrix_1.4-1       
##   memoise_2.0.1       methods_4.2.0       mgcv_1.8-40        
##   nlme_3.1-157        png_0.1-7           R6_2.5.1           
##   rappdirs_0.3.3      RColorBrewer_1.1-3  rlang_1.0.2        
##   rmarkdown_2.14      rprojroot_2.0.3     sass_0.4.1         
##   shape_1.4.6         splines_4.2.0       stats_4.2.0        
##   stringi_1.7.6       stringr_1.4.0       survival_3.3-1     
##   sysfonts_0.8.8      tinytex_0.39        tools_4.2.0        
##   utils_4.2.0         vctrs_0.4.1         xfun_0.31          
##   xml2_1.3.3          yaml_2.3.5</code></pre>

</div>
</div>
<h3>参考文献</h3>
<div id="refs" class="references csl-bib-body">
<div id="ref-R-FAQ" class="csl-entry">
<div class="csl-left-margin">[12] </div>
<div class="csl-right-inline">K. Hornik, <span>“<span>R</span> <span>FAQ</span>: Frequently asked questions on <span>R</span>.”</span> 2020.Available: <a href="https://CRAN.R-project.org/doc/FAQ/R-FAQ.html">https://CRAN.R-project.org/doc/FAQ/R-FAQ.html</a>
</div>
</div>
<div id="ref-Paul_2003_Integrating" class="csl-entry">
<div class="csl-left-margin">[13] </div>
<div class="csl-right-inline">P. Murrell, <span>“Integrating grid graphics output with base graphics output,”</span> <em>R News</em>, vol. 3, no. 2, pp. 7–12, 2003.</div>
</div>
<div id="ref-Paul_2000_Approach" class="csl-entry">
<div class="csl-left-margin">[14] </div>
<div class="csl-right-inline">P. Murrell and R. Ihaka, <span>“An approach to providing mathematical annotation in plots,”</span> <em>Journal of Computational and Graphical Statistics</em>, vol. 9, no. 3, pp. 582–599, 2000.</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="chap-statistical-graphics.html">介绍</a></div>
<div class="next"><a href="chap-data-visualization.html"><span class="header-section-number">11</span> 数据可视化</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#chap-graphics-foundations"><span class="header-section-number">10</span> 图形基础</a></li>
<li>
<a class="nav-link" href="#graphics-elements"><span class="header-section-number">10.1</span> 绘图基本要素</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#base-points"><span class="header-section-number">10.1.1</span> 点线</a></li>
<li><a class="nav-link" href="#base-rect"><span class="header-section-number">10.1.2</span> 区域</a></li>
<li><a class="nav-link" href="#base-lines"><span class="header-section-number">10.1.3</span> 参考线</a></li>
<li><a class="nav-link" href="#base-axis"><span class="header-section-number">10.1.4</span> 坐标轴</a></li>
<li><a class="nav-link" href="#base-tick"><span class="header-section-number">10.1.5</span> 刻度线</a></li>
<li><a class="nav-link" href="#base-title"><span class="header-section-number">10.1.6</span> 标题</a></li>
<li><a class="nav-link" href="#base-annotation"><span class="header-section-number">10.1.7</span> 注释</a></li>
<li><a class="nav-link" href="#base-legend"><span class="header-section-number">10.1.8</span> 图例</a></li>
<li><a class="nav-link" href="#base-par"><span class="header-section-number">10.1.9</span> 边空</a></li>
<li><a class="nav-link" href="#base-layer"><span class="header-section-number">10.1.10</span> 图层</a></li>
<li><a class="nav-link" href="#base-layout"><span class="header-section-number">10.1.11</span> 布局</a></li>
<li><a class="nav-link" href="#base-combine"><span class="header-section-number">10.1.12</span> 组合</a></li>
<li><a class="nav-link" href="#base-screen"><span class="header-section-number">10.1.13</span> 分屏</a></li>
<li><a class="nav-link" href="#identify-locator"><span class="header-section-number">10.1.14</span> 交互</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#base-graphics"><span class="header-section-number">10.2</span> 基础统计图形</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#plot-bar"><span class="header-section-number">10.2.1</span> 条形图</a></li>
<li><a class="nav-link" href="#plot-hist"><span class="header-section-number">10.2.2</span> 直方图</a></li>
<li><a class="nav-link" href="#plot-density"><span class="header-section-number">10.2.3</span> 密度图</a></li>
<li><a class="nav-link" href="#plot-ecdf"><span class="header-section-number">10.2.4</span> 经验图</a></li>
<li><a class="nav-link" href="#plot-qqnorm"><span class="header-section-number">10.2.5</span> QQ 图</a></li>
<li><a class="nav-link" href="#plot-ts"><span class="header-section-number">10.2.6</span> 时序图</a></li>
<li><a class="nav-link" href="#plot-pie"><span class="header-section-number">10.2.7</span> 饼图</a></li>
<li><a class="nav-link" href="#plot-stem-leaf"><span class="header-section-number">10.2.8</span> 茎叶图</a></li>
<li><a class="nav-link" href="#plot-scatter"><span class="header-section-number">10.2.9</span> 散点图</a></li>
<li><a class="nav-link" href="#base-jitter"><span class="header-section-number">10.2.10</span> 抖动图</a></li>
<li><a class="nav-link" href="#plot-box"><span class="header-section-number">10.2.11</span> 箱线图</a></li>
<li><a class="nav-link" href="#error-bars"><span class="header-section-number">10.2.12</span> 残差图</a></li>
<li><a class="nav-link" href="#plot-violin"><span class="header-section-number">10.2.13</span> 提琴图</a></li>
<li><a class="nav-link" href="#plot-contour"><span class="header-section-number">10.2.14</span> 轮廓图</a></li>
<li><a class="nav-link" href="#plot-line"><span class="header-section-number">10.2.15</span> 折线图</a></li>
<li><a class="nav-link" href="#function"><span class="header-section-number">10.2.16</span> 函数图</a></li>
<li><a class="nav-link" href="#plot-mosaic"><span class="header-section-number">10.2.17</span> 马赛克图</a></li>
<li><a class="nav-link" href="#plot-dotchart"><span class="header-section-number">10.2.18</span> 点图</a></li>
<li><a class="nav-link" href="#plot-matrix"><span class="header-section-number">10.2.19</span> 矩阵图</a></li>
<li><a class="nav-link" href="#plot-radar"><span class="header-section-number">10.2.20</span> 雷达图</a></li>
<li><a class="nav-link" href="#plot-rose"><span class="header-section-number">10.2.21</span> 玫瑰图</a></li>
<li><a class="nav-link" href="#plot-persp"><span class="header-section-number">10.2.22</span> 透视图</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#lattice-graphics"><span class="header-section-number">10.3</span> 栅格统计图形</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#lattice-boxplot"><span class="header-section-number">10.3.1</span> 箱线图</a></li>
<li><a class="nav-link" href="#lattice-line"><span class="header-section-number">10.3.2</span> 折线图</a></li>
<li><a class="nav-link" href="#lattice-smooth"><span class="header-section-number">10.3.3</span> 平滑图</a></li>
<li><a class="nav-link" href="#lattice-dotplot"><span class="header-section-number">10.3.4</span> 点图</a></li>
<li><a class="nav-link" href="#lattice-step"><span class="header-section-number">10.3.5</span> 阶梯图</a></li>
<li><a class="nav-link" href="#lattice-facet"><span class="header-section-number">10.3.6</span> 分面图</a></li>
<li><a class="nav-link" href="#lattice-contour"><span class="header-section-number">10.3.7</span> 等高线图</a></li>
<li><a class="nav-link" href="#lattice-persp"><span class="header-section-number">10.3.8</span> 透视图</a></li>
<li><a class="nav-link" href="#lattice-cluster"><span class="header-section-number">10.3.9</span> 聚类图</a></li>
</ul>
</li>
<li><a class="nav-link" href="#graphics-sessioninfo"><span class="header-section-number">10.4</span> 运行环境</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/XiangyunHuang/notesdown/blob/devel/graphics-foundations.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/XiangyunHuang/notesdown/edit/devel/graphics-foundations.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R 语言学习笔记</strong>" was written by 黄湘云. It was last built on 2023-02-22.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
