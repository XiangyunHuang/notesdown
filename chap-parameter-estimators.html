<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>第 22 章 参数估计 | 现代应用统计与 R 语言</title>
<meta name="author" content="黄湘云">
<meta name="description" content="Jeremy Koster: My students were looking at the estimated varying intercepts for each higher-level group (or the “BLUP’s”, as some people seem to call them). Douglas Bates: As Alan James once said,...">
<meta name="generator" content="bookdown 0.25 with bs4_book()">
<meta property="og:title" content="第 22 章 参数估计 | 现代应用统计与 R 语言">
<meta property="og:type" content="book">
<meta property="og:image" content="/images/cover.png">
<meta property="og:description" content="Jeremy Koster: My students were looking at the estimated varying intercepts for each higher-level group (or the “BLUP’s”, as some people seem to call them). Douglas Bates: As Alan James once said,...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="第 22 章 参数估计 | 现代应用统计与 R 语言">
<meta name="twitter:description" content="Jeremy Koster: My students were looking at the estimated varying intercepts for each higher-level group (or the “BLUP’s”, as some people seem to call them). Douglas Bates: As Alan James once said,...">
<meta name="twitter:image" content="/images/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap/bootstrap.bundle.min.js"></script><script src="libs/bs3compat/transition.js"></script><script src="libs/bs3compat/tabs.js"></script><script src="libs/bs3compat/bs3compat.js"></script><link href="libs/bs4_book/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book/bs4_book.js"></script><script src="libs/htmlwidgets/htmlwidgets.js"></script><script src="libs/plotly-binding/plotly.js"></script><script src="libs/typedarray/typedarray.min.js"></script><link href="libs/crosstalk/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main/plotly-latest.min.js"></script><script src="libs/plotly-locale-zh-CN/zh-cn.js"></script><script src="libs/mathjax/cdn.js"></script><link href="libs/dygraphs/dygraph.css" rel="stylesheet">
<script src="libs/dygraphs/dygraph-combined.js"></script><script src="libs/dygraphs/shapes.js"></script><script src="libs/moment/moment.js"></script><script src="libs/moment-timezone/moment-timezone-with-data.js"></script><script src="libs/moment-fquarter/moment-fquarter.min.js"></script><script src="libs/dygraphs-binding/dygraphs.js"></script><script src="libs/Dygraph.Plugins.Unzoom/unzoom.js"></script><script src="libs/echarts4r/echarts-en.min.js"></script><script src="libs/echarts4r/ecStat.min.js"></script><script src="libs/echarts4r/dataTool.min.js"></script><script src="libs/echarts4r-binding/echarts4r.js"></script><script src="libs/d3/d3.min.js"></script><script src="libs/forceNetwork-binding/forceNetwork.js"></script><link href="libs/vis/vis-network.min.css" rel="stylesheet">
<script src="libs/vis/vis-network.min.js"></script><script src="libs/visNetwork-binding/visNetwork.js"></script><script src="libs/FileSaver/FileSaver.min.js"></script><script src="libs/Blob/Blob.js"></script><script src="libs/canvas-toBlob/canvas-toBlob.js"></script><script src="libs/html2canvas/html2canvas.js"></script><script src="libs/jspdf/jspdf.debug.js"></script><link href="libs/jquery-sparkline/jquery.sparkline.css" rel="stylesheet">
<script src="libs/jquery-sparkline/jquery.sparkline.js"></script><script src="libs/sparkline-binding/sparkline.js"></script><script src="libs/r2d3-render/r2d3-render.js"></script><script src="libs/webcomponents/webcomponents.js"></script><script src="libs/r2d3-binding/r2d3.js"></script><script src="libs/d3v6/d3.min.js"></script><script src="libs/es6shim/es6shim.js"></script><script src="libs/es7shim/es7shim.js"></script><script src="libs/graphre/graphre.js"></script><script src="libs/nomnoml/nomnoml.js"></script><script src="libs/nomnoml-binding/nomnoml.js"></script><script src="libs/d3-bundle/d3-bundle.min.js"></script><script src="libs/d3-lasso/d3-lasso.min.js"></script><script src="libs/save-svg-as-png/save-svg-as-png.min.js"></script><link href="libs/ggiraphjs/ggiraphjs.min.css" rel="stylesheet">
<script src="libs/ggiraphjs/ggiraphjs.min.js"></script><script src="libs/girafe-binding/girafe.js"></script><link href="libs/datatables-css/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding/datatables.js"></script><link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core/js/jquery.dataTables.min.js"></script><script src="libs/jszip/jszip.min.js"></script><script src="libs/pdfmake/pdfmake.js"></script><script src="libs/pdfmake/vfs_fonts.js"></script><link href="libs/dt-ext-buttons/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="libs/dt-ext-buttons/js/dataTables.buttons.min.js"></script><script src="libs/dt-ext-buttons/js/buttons.html5.min.js"></script><script src="libs/dt-ext-buttons/js/buttons.colVis.min.js"></script><script src="libs/dt-ext-buttons/js/buttons.print.min.js"></script><link href="libs/dt-ext-rowgroup/css/rowGroup.dataTables.min.css" rel="stylesheet">
<script src="libs/dt-ext-rowgroup/js/dataTables.rowGroup.min.js"></script><script src="libs/kePrint/kePrint.js"></script><link href="libs/lightable/lightable.css" rel="stylesheet">
<script src="libs/echarts-world/world.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-54GQKWF7VP"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-54GQKWF7VP');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Modern Applied Statistics with R">现代应用统计与 R 语言</a>:
        <small class="text-muted">Modern Applied Statistics with R</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">欢迎</a></li>
<li><a class="" href="chap-preface.html"><span class="header-section-number">1</span> 前言</a></li>
<li class="book-part">数据整理</li>
<li><a class="" href="chap-data-wrangling.html">介绍</a></li>
<li><a class="" href="chap-data-structure.html"><span class="header-section-number">2</span> 数据结构</a></li>
<li><a class="" href="chap-data-transportation.html"><span class="header-section-number">3</span> 数据搬运</a></li>
<li><a class="" href="chap-string-operations.html"><span class="header-section-number">4</span> 字符串操作</a></li>
<li><a class="" href="chap-regular-expressions.html"><span class="header-section-number">5</span> 正则表达式</a></li>
<li><a class="" href="chap-data-manipulation.html"><span class="header-section-number">6</span> 数据操作</a></li>
<li><a class="" href="chap-advanced-manipulation.html"><span class="header-section-number">7</span> 高级数据操作</a></li>
<li><a class="" href="chap-parallel-manipulation.html"><span class="header-section-number">8</span> 并行化操作</a></li>
<li><a class="" href="chap-dplyr-manipulation.html"><span class="header-section-number">9</span> 净土化操作</a></li>
<li class="book-part">统计图形</li>
<li><a class="" href="chap-statistical-graphics.html">介绍</a></li>
<li><a class="" href="chap-graphics-foundations.html"><span class="header-section-number">10</span> 图形基础</a></li>
<li><a class="" href="chap-data-visualization.html"><span class="header-section-number">11</span> 数据可视化</a></li>
<li><a class="" href="chap-interactive-web-graphics.html"><span class="header-section-number">12</span> 交互图形</a></li>
<li class="book-part">动态文档</li>
<li><a class="" href="chap-dynamic-documents.html">介绍</a></li>
<li><a class="" href="chap-document-elements.html"><span class="header-section-number">13</span> 文档元素</a></li>
<li><a class="" href="chap-portable-document.html"><span class="header-section-number">14</span> 便携式文档</a></li>
<li><a class="" href="chap-web-documents.html"><span class="header-section-number">15</span> 网页文档</a></li>
<li><a class="" href="chap-office-document.html"><span class="header-section-number">16</span> 办公文档</a></li>
<li><a class="" href="chap-reproducible-workflows.html"><span class="header-section-number">17</span> 工作流</a></li>
<li><a class="" href="chap-advanced-documents.html"><span class="header-section-number">18</span> 高级文档</a></li>
<li class="book-part">数据产品</li>
<li><a class="" href="chap-data-product.html">介绍</a></li>
<li><a class="" href="chap-interactive-data-tables.html"><span class="header-section-number">19</span> 交互表格</a></li>
<li><a class="" href="chap-interactive-shiny-app.html"><span class="header-section-number">20</span> 交互报表</a></li>
<li class="book-part">统计基础</li>
<li><a class="" href="chap-statistical-foundations.html">介绍</a></li>
<li><a class="" href="chap-sampling-distributions.html"><span class="header-section-number">21</span> 抽样分布</a></li>
<li><a class="active" href="chap-parameter-estimators.html"><span class="header-section-number">22</span> 参数估计</a></li>
<li><a class="" href="chap-hypothesis-test.html"><span class="header-section-number">23</span> 假设检验</a></li>
<li><a class="" href="chap-power-Analysis.html"><span class="header-section-number">24</span> 功效分析</a></li>
<li><a class="" href="chap-experimental-design.html"><span class="header-section-number">25</span> 试验设计</a></li>
<li class="book-part">统计模型</li>
<li><a class="" href="chap-statistical-models.html">介绍</a></li>
<li><a class="" href="chap-linear-models.html"><span class="header-section-number">26</span> 线性模型</a></li>
<li><a class="" href="chap-generalized-linear-models.html"><span class="header-section-number">27</span> 广义线性模型</a></li>
<li class="book-part">数据建模</li>
<li><a class="" href="chap-data-modeling.html">介绍</a></li>
<li><a class="" href="chap-text-analysis.html"><span class="header-section-number">28</span> 文本分析</a></li>
<li><a class="" href="chap-survival-analysis.html"><span class="header-section-number">29</span> 生存分析</a></li>
<li><a class="" href="chap-time-series-analysis.html"><span class="header-section-number">30</span> 时序分析</a></li>
<li class="book-part">时空数据</li>
<li><a class="" href="chap-spatio-temporal-data.html">介绍</a></li>
<li><a class="" href="chap-spatial-analysis.html"><span class="header-section-number">31</span> 空间数据分析</a></li>
<li><a class="" href="chap-spatial-viz.html"><span class="header-section-number">32</span> 空间数据可视化</a></li>
<li><a class="" href="chap-case-study.html"><span class="header-section-number">33</span> 案例研究</a></li>
<li><a class="" href="chap-data-explorer.html"><span class="header-section-number">34</span> 数据探索</a></li>
<li class="book-part">机器学习</li>
<li><a class="" href="chap-machine-learning.html">介绍</a></li>
<li><a class="" href="chap-gradient-boosting-machine.html"><span class="header-section-number">35</span> 梯度提升机</a></li>
<li><a class="" href="chap-numerical-optimization.html"><span class="header-section-number">36</span> 数值优化</a></li>
<li class="book-part">附录</li>
<li><a class="" href="chap-linux-command-bash.html"><span class="header-section-number">A</span> 命令行操作</a></li>
<li><a class="" href="chap-matrix-operations.html"><span class="header-section-number">B</span> 矩阵运算</a></li>
<li><a class="" href="chap-symbolic-computation.html"><span class="header-section-number">C</span> 符号计算</a></li>
<li><a class="" href="chap-mixed-programming.html"><span class="header-section-number">D</span> 混合编程</a></li>
<li><a class="" href="chap-object-oriented-programming.html"><span class="header-section-number">E</span> 面向对象编程</a></li>
<li><a class="" href="chap-file-operations.html"><span class="header-section-number">F</span> 文件操作</a></li>
<li><a class="" href="chap-other-softwares.html"><span class="header-section-number">G</span> 其它软件</a></li>
<li><a class="" href="chap-notations.html"><span class="header-section-number">H</span> 符号说明</a></li>
<li><a class="" href="references.html">参考文献</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/XiangyunHuang/masr">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="chap-parameter-estimators" class="section level1" number="22">
<h1>
<span class="header-section-number">第 22 章</span> 参数估计<a class="anchor" aria-label="anchor" href="#chap-parameter-estimators"><i class="fas fa-link"></i></a>
</h1>
<!-- 本章开始介绍参数估计的内容，先从第 \@ref(sec-point-estimator) 节点估计开始 -->
<blockquote>
<p>Jeremy Koster: My students were looking at the estimated varying intercepts for each higher-level group (or the “BLUP’s”, as some people seem to call them).</p>
<p>Douglas Bates: As Alan James once said, “these values are just like the BLUPs - Best Linear Unbiased Predictors - except that they aren’t linear and they aren’t unbiased and there is no clear sense in which they are”best”, but other than that …”</p>
<p>— Jeremy Koster and Douglas Bates <a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://stat.ethz.ch/pipermail/r-sig-mixed-models/2012q3/018817.html" class="uri"&gt;https://stat.ethz.ch/pipermail/r-sig-mixed-models/2012q3/018817.html&lt;/a&gt;&lt;/p&gt;'><sup>59</sup></a></p>
</blockquote>
<div id="sec-point-estimator" class="section level2" number="22.1">
<h2>
<span class="header-section-number">22.1</span> 点估计<a class="anchor" aria-label="anchor" href="#sec-point-estimator"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>矩估计</li>
<li>极大似然估计</li>
<li>最小二乘估计</li>
<li>同变估计</li>
<li>稳健估计</li>
</ul>
<p>单参数和多参数模型的参数估计，比如指数分布、泊松分布、二项分布、正态分布，线性模型各个估计的推导过程</p>
<div class="rmdnote">
<p>应当考虑 <span class="math inline">\((X^{\top}X)^{-1}\)</span> 不存在的情况，在均方误差最小的意义下，不必要求 <span class="math inline">\(\beta\)</span> 的估计 <span class="math inline">\(\hat{\beta}\)</span> 满足无偏性的要求，所以介绍岭回归估计 <span class="math inline">\(\hat{\beta}_{ridge}\)</span>、压缩估计 <span class="math inline">\(\hat{\beta}_{jse}\)</span>、主成分估计 <span class="math inline">\(\hat{\beta}_{pca}\)</span> 和偏最小二乘估计 <span class="math inline">\(\hat{\beta}_{pls}\)</span>。相比于 <span class="math inline">\(\hat{\beta}_{pca}\)</span>， <span class="math inline">\(\hat{\beta}_{pls}\)</span> 考虑了响应变量的作用。《数理统计引论》第5章第5节线性估计类从改进 LS 估计出发，牺牲一部分估计的偏差，即采用有偏的估计，达到总体均方误差更小的效果 <span class="citation"><a href="#ref-Stat_1981_Chen" role="doc-biblioref">[32]</a></span></p>
<p>James-Stein 估计可不可以看作一种压缩估计？从它牺牲一部分偏差，获取整体方差的降低来看和上面应该有某种联系</p>
</div>
<ul>
<li>
<a href="https://cosx.org/2014/04/lmm-and-me">昔日因，今日意</a> 讲线性混合效应模型和很多模型之间的联系</li>
<li>
<a href="https://cosx.org/2012/05/chase-after-eb">那些年，我们一起追的 EB</a> James-Stein 估计和岭回归估计的联系</li>
<li>
<a href="https://cosx.org/2011/12/stories-about-statistical-learning">统计学习那些事</a> lasso 和 boosting 之间的联系</li>
</ul>
<div id="sec-moments-estimation" class="section level3" number="22.1.1">
<h3>
<span class="header-section-number">22.1.1</span> 矩估计<a class="anchor" aria-label="anchor" href="#sec-moments-estimation"><i class="fas fa-link"></i></a>
</h3>
</div>
<div id="sec-lse" class="section level3" number="22.1.2">
<h3>
<span class="header-section-number">22.1.2</span> 最小二乘估计<a class="anchor" aria-label="anchor" href="#sec-lse"><i class="fas fa-link"></i></a>
</h3>
<p>谈非线性最小二乘，这段话的意思是非线性模型不要谈 ANOVA 和 R^2 之类的东西</p>
<blockquote>
<p>As one of the developers of the <code>nls</code> function I would like to state that the lack of automatic ANOVA, <span class="math inline">\(R^2\)</span> and <span class="math inline">\(adj. R^2\)</span> from <code>nls</code> is a feature, not a bug :-)</p>
<p>— Douglas Bates <a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://stat.ethz.ch/pipermail/r-help/2000-August/007778.html" class="uri"&gt;https://stat.ethz.ch/pipermail/r-help/2000-August/007778.html&lt;/a&gt;&lt;/p&gt;'><sup>60</sup></a></p>
</blockquote>
<blockquote>
<p>最小二乘估计是一种非参数估计方法（对数据分布没有假设，只要预测误差达到最小即可），而极大似然估计是一种参数估计方法（观测数据服从带参数的多元分布）</p>
</blockquote>
<p>非线性最小二乘估计</p>
<div class="sourceCode" id="cb1850"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Nonlinear least-squares using nlm()</span>
<span class="co"># demo(nlm)</span>

<span class="co"># Helical Valley Function</span>
<span class="co"># 非线性最小二乘</span>

<span class="va">theta</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">atan</a></span><span class="op">(</span><span class="va">x2</span> <span class="op">/</span> <span class="va">x1</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="kw">if</span> <span class="op">(</span><span class="va">x1</span> <span class="op">&lt;=</span> <span class="fl">0</span><span class="op">)</span> <span class="va">pi</span> <span class="kw">else</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span><span class="op">)</span>
<span class="co">## 更加简洁的表达</span>
<span class="va">theta</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">atan2</a></span><span class="op">(</span><span class="va">x2</span>, <span class="va">x1</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span><span class="op">)</span>
<span class="co"># 目标函数</span>
<span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">f1</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="fl">10</span> <span class="op">*</span> <span class="fu">theta</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
  <span class="va">f2</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>
  <span class="va">f3</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">f1</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">f2</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">f3</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
<span class="op">}</span>

<span class="co">## explore surface {at x3 = 0}</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">2</span>, length.out <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>
<span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">f</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/contour.html">contour</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>, <span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span>

<span class="va">nlm.f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nlm.html">nlm</a></span><span class="op">(</span><span class="va">f</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, hessian <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbind</a></span><span class="op">(</span><span class="va">nlm.f</span><span class="op">$</span><span class="va">estim</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span>, pch <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb1851"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### the Rosenbrock banana valley function 香蕉谷函数</span>

<span class="va">fR</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">x1</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
  <span class="va">x2</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
  <span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">x2</span> <span class="op">-</span> <span class="va">x1</span> <span class="op">*</span> <span class="va">x1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">x1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>
<span class="op">}</span>

<span class="co">## explore surface</span>
<span class="va">fx</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span> <span class="co">## `vectorized' version of fR()</span>
  <span class="va">x1</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>
  <span class="va">x2</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>
  <span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">x2</span> <span class="op">-</span> <span class="va">x1</span> <span class="op">*</span> <span class="va">x1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">x1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>
<span class="op">}</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">1.5</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="va">z</span> <span class="op">&lt;-</span> <span class="fu">fx</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span>
<span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fl">0.1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/contour.html">contour</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">nlm.f2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nlm.html">nlm</a></span><span class="op">(</span><span class="va">fR</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">1</span><span class="op">)</span>, hessian <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbind</a></span><span class="op">(</span><span class="va">nlm.f2</span><span class="op">$</span><span class="va">estim</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span>, pch <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>

<span class="co">## Zoom in :</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/rect.html">rect</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.9</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>, border <span class="op">=</span> <span class="st">"orange"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">1.1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="va">z</span> <span class="op">&lt;-</span> <span class="fu">fx</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/contour.html">contour</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"zoomed in"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbind</a></span><span class="op">(</span><span class="va">nlm.f2</span><span class="op">$</span><span class="va">estim</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span>, pch <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb1852"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span>
  <span class="va">nlm.f2</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span>
    <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/all.equal.data.table.html">all.equal</a></span><span class="op">(</span><span class="va">estimate</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, tol <span class="op">=</span> <span class="fl">1e-5</span><span class="op">)</span>,
    <span class="va">minimum</span> <span class="op">&lt;</span> <span class="fl">1e-11</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">gradient</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1e-6</span>, <span class="va">code</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb1853"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fg</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">gr</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">400</span> <span class="op">*</span> <span class="va">x1</span> <span class="op">*</span> <span class="op">(</span><span class="va">x2</span> <span class="op">-</span> <span class="va">x1</span> <span class="op">*</span> <span class="va">x1</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">x1</span><span class="op">)</span>, <span class="fl">200</span> <span class="op">*</span> <span class="op">(</span><span class="va">x2</span> <span class="op">-</span> <span class="va">x1</span> <span class="op">*</span> <span class="va">x1</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">x1</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
  <span class="va">x2</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
  <span class="fu"><a href="https://rdrr.io/r/base/structure.html">structure</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">x2</span> <span class="op">-</span> <span class="va">x1</span> <span class="op">*</span> <span class="va">x1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">x1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>,
    gradient <span class="op">=</span> <span class="fu">gr</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span>

<span class="va">nfg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nlm.html">nlm</a></span><span class="op">(</span><span class="va">fg</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">1</span><span class="op">)</span>, hessian <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">nfg</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb1854"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span>
  <span class="va">nfg</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span>
    <span class="va">minimum</span> <span class="op">&lt;</span> <span class="fl">1e-17</span>, <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/all.equal.data.table.html">all.equal</a></span><span class="op">(</span><span class="va">estimate</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">gradient</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1e-7</span>, <span class="va">code</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb1855"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## or use deriv to find the derivatives</span>

<span class="va">fd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/deriv.html">deriv</a></span><span class="op">(</span><span class="op">~</span> <span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">x2</span> <span class="op">-</span> <span class="va">x1</span> <span class="op">*</span> <span class="va">x1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">x1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span><span class="op">)</span><span class="op">)</span>
<span class="va">fdd</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span> <span class="op">{</span><span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/body.html">body</a></span><span class="op">(</span><span class="va">fdd</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">fd</span>

<span class="va">nlfd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nlm.html">nlm</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">fdd</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">1</span><span class="op">)</span>, hessian <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">nlfd</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb1856"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span>
  <span class="va">nlfd</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span>
    <span class="va">minimum</span> <span class="op">&lt;</span> <span class="fl">1e-17</span>, <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/all.equal.data.table.html">all.equal</a></span><span class="op">(</span><span class="va">estimate</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">gradient</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1e-7</span>, <span class="va">code</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb1857"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fgh</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">gr</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">400</span> <span class="op">*</span> <span class="va">x1</span> <span class="op">*</span> <span class="op">(</span><span class="va">x2</span> <span class="op">-</span> <span class="va">x1</span> <span class="op">*</span> <span class="va">x1</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">x1</span><span class="op">)</span>, <span class="fl">200</span> <span class="op">*</span> <span class="op">(</span><span class="va">x2</span> <span class="op">-</span> <span class="va">x1</span> <span class="op">*</span> <span class="va">x1</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">h</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">a11</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">-</span> <span class="fl">400</span> <span class="op">*</span> <span class="va">x2</span> <span class="op">+</span> <span class="fl">1200</span> <span class="op">*</span> <span class="va">x1</span> <span class="op">*</span> <span class="va">x1</span>
    <span class="va">a21</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">400</span> <span class="op">*</span> <span class="va">x1</span>
    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">a11</span>, <span class="va">a21</span>, <span class="va">a21</span>, <span class="fl">200</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">x1</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
  <span class="va">x2</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
  <span class="fu"><a href="https://rdrr.io/r/base/structure.html">structure</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">x2</span> <span class="op">-</span> <span class="va">x1</span> <span class="op">*</span> <span class="va">x1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">x1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>,
    gradient <span class="op">=</span> <span class="fu">gr</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span>,
    hessian  <span class="op">=</span>  <span class="fu">h</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span>

<span class="va">nlfgh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nlm.html">nlm</a></span><span class="op">(</span><span class="va">fgh</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">1</span><span class="op">)</span>, hessian <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">nlfgh</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb1858"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## NB: This did _NOT_ converge for R version &lt;= 3.4.0</span>
<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span>
  <span class="va">nlfgh</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span>
    <span class="va">minimum</span> <span class="op">&lt;</span> <span class="fl">1e-15</span>, <span class="co"># see 1.13e-17 .. slightly worse than above</span>
    <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/all.equal.data.table.html">all.equal</a></span><span class="op">(</span><span class="va">estimate</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, tol <span class="op">=</span> <span class="fl">9e-9</span><span class="op">)</span>, <span class="co"># see 1.236e-9</span>
    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">gradient</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">7e-7</span>, <span class="va">code</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>
  <span class="op">)</span>
<span class="op">)</span> <span class="co"># g[1] = 1.3e-7</span></code></pre></div>
</div>
<div id="sec-mle" class="section level3" number="22.1.3">
<h3>
<span class="header-section-number">22.1.3</span> 极大似然估计<a class="anchor" aria-label="anchor" href="#sec-mle"><i class="fas fa-link"></i></a>
</h3>
<!-- 极大似然估计最初由德国数据学家 Gauss 于 1821 年提出，但未得到重视，后来， R. A. Fisher 在 1922 年再次提出极大似然的思想，探讨了它的性质，使它得到广泛的研究和应用。 -->
<p>教材简短一句话，这里面有很多信息值得发散，一个数学家提出了统计学领域极其重要的一个核心思想，他是在研究什么的时候提出了这个想法，为什么后来没有得到重视，虽然这可能有点离题，但是对于读者可能有很多别的启迪。整整100 年以后，Fisher 又是怎么提出这一思想的呢？他做了什么使得这个思想被广泛接受和应用？</p>
<p>统计决策理论，任何统计推断都应该依赖损失函数，而极大似然估计未曾考虑到，这是它的局限性。 Lasso 和贝叶斯先验的关系，和损失函数的关系</p>
<p>是最大似然估计还是极大似然估计？当然是极大似然估计，如果有人告诉你是最大似然估计那一定是假的，这两个概念归根结底是极值和最值得区别</p>
<p>书本定义和性质，在后续章节介绍</p>
<p>介绍线性模型为何引入 REML 减少偏差</p>
<p>极大似然估计是费舍尔提出来的</p>
<ul>
<li>边际似然 Marginal Likelihood</li>
<li>条件似然 conditional lkelihood</li>
<li>完全似然 complete Likelihood</li>
<li>层次似然 Hierarchical likelihood</li>
<li>部分似然 partial likelihood</li>
<li>剖面似然 Profile Likelihood</li>
<li>限制似然 Restricted Likelihood</li>
<li>惩罚/边际拟似然 (PQL/MQL) Penalized Quasi-Likelihood/Marginal Quasi-Likelihood</li>
<li>分布 边际分布 条件分布</li>
<li>似然 边际似然 条件似然</li>
<li>极大似然估计 Maximum likelihood 简称 ML</li>
<li>限制极大似然 Restricted Maximum likelihood, 简称 REML</li>
<li>惩罚拟似然 Penalized Quasi-Likelihood, 简称 PQL 和边际拟似然 Marginal Quasi-Likelihood, 简称 MQL，Profile Maximal Likelihood, 简称 PML</li>
</ul>
<p><a href="https://en.wikipedia.org/wiki/Quasi-maximum_likelihood_estimate">拟似然估计</a>
<a href="https://en.wikipedia.org/wiki/Maximum_likelihood_estimation">极大似然估计</a>
<a href="https://en.wikipedia.org/wiki/Likelihood_function">似然函数</a></p>
<p>Penalized maximum likelihood estimates are calculated using optimization methods such as the limited memory Broyden-Fletcher-Goldfarb-Shanno algorithm (L-BFGS).</p>
<p>BFGS 拟牛顿法和采样器 <a href="https://bookdown.org/rdpeng/advstatcomp" class="uri">https://bookdown.org/rdpeng/advstatcomp</a></p>
</div>
</div>
<div id="chap-interval-estimation" class="section level2" number="22.2">
<h2>
<span class="header-section-number">22.2</span> 区间估计<a class="anchor" aria-label="anchor" href="#chap-interval-estimation"><i class="fas fa-link"></i></a>
</h2>
<div id="subsec-ci" class="section level3" number="22.2.1">
<h3>
<span class="header-section-number">22.2.1</span> 正态分布<a class="anchor" aria-label="anchor" href="#subsec-ci"><i class="fas fa-link"></i></a>
</h3>
<!-- 计算置信区间和覆盖概率 -->
<p>正态分布 <span class="math inline">\(\mathcal{N}(\mu,\sigma^2)\)</span>，<span class="math inline">\(\sigma^2\)</span> 未知，关于参数 <span class="math inline">\(\mu\)</span> 的置信水平为 <span class="math inline">\(1 - \alpha\)</span> 的区间估计</p>
<ol style="list-style-type: decimal">
<li>构造统计量 <span class="math inline">\(t = \frac{\bar{x} - \mu}{s/\sqrt{n}} \sim t(n-1)\)</span>
</li>
<li>参数 <span class="math inline">\(\mu\)</span> 的 <span class="math inline">\(1-\alpha\)</span> 置信区间为 <span class="math display">\[\bar{x} \pm t_{1-\alpha/2}(n-1)s/\sqrt{n}\]</span>
</li>
</ol>
<p>其中，<span class="math inline">\(s^2 = \frac{1}{n-1}\sum_{i=1}^{n}(x_i - \bar{x})^2\)</span> 是 <span class="math inline">\(\sigma^2\)</span> 的无偏估计。若取 <span class="math inline">\(\alpha = 0.05\)</span>，则置信水平 <span class="math inline">\(1 - \alpha = 0.95\)</span>。</p>
<div class="sourceCode" id="cb1859"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span> <span class="co"># 为了可重复，设置随机数种子</span>
<span class="va">mu_ci</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">alpha</span> <span class="op">=</span> <span class="fl">0.05</span>, <span class="va">n</span> <span class="op">=</span> <span class="fl">100</span>, <span class="va">mu</span> <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, mean <span class="op">=</span> <span class="va">mu</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
  <span class="va">x_bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
  <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span> <span class="op">/</span> <span class="fl">2</span>, df <span class="op">=</span> <span class="va">n</span> <span class="op">-</span> <span class="fl">1</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="va">mu</span>, lower <span class="op">=</span> <span class="va">x_bar</span> <span class="op">-</span> <span class="va">d</span>, upper <span class="op">=</span> <span class="va">x_bar</span> <span class="op">+</span> <span class="va">d</span><span class="op">)</span>
<span class="op">}</span>
<span class="co"># 重抽样 100 次，获得 100 个置信区间</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, <span class="fu">mu_ci</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.05</span>, n <span class="op">=</span> <span class="fl">100</span>, mu <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/transform.data.table.html">transform</a></span><span class="op">(</span><span class="va">dat</span>, idx <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, cover <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fifelse.html">ifelse</a></span><span class="op">(</span><span class="va">mu</span> <span class="op">&gt;=</span> <span class="va">lower</span> <span class="op">&amp;</span> <span class="va">mu</span> <span class="op">&lt;=</span> <span class="va">upper</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>真实的参数值 <span class="math inline">\(\mu = 4\)</span>，重抽样 100 次，覆盖真值的次数为 97 次，覆盖概率为 0.97</p>
<div class="sourceCode" id="cb1860"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 覆盖概率</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">cover</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.97</code></pre>

<div class="sourceCode" id="cb1862"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">idx</span>, xend <span class="op">=</span> <span class="va">idx</span>,
    y <span class="op">=</span> <span class="va">lower</span>, yend <span class="op">=</span> <span class="va">upper</span>, color <span class="op">=</span> <span class="va">cover</span>
  <span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ci"></span>
<img src="parameter-estimators_files/figure-html/ci-1.png" alt="\(\mu\) 的置信水平为 0.95 的置信区间" width="672"><p class="caption">
图 22.1: <span class="math inline">\(\mu\)</span> 的置信水平为 0.95 的置信区间
</p>
</div>
<p>方差 <span class="math inline">\(\sigma^2\)</span> 已知的情况下，标准正态分布 <span class="math inline">\(N(\mu, \sigma^2), \mu = 0, \sigma^2 = 1\)</span> 的参数 <span class="math inline">\(\mu\)</span> 的区间估计和覆盖概率 <a href="https://yihui.org/animation/example/conf-int/" class="uri">https://yihui.org/animation/example/conf-int/</a></p>
</div>
<div id="subsec-binomial" class="section level3" number="22.2.2">
<h3>
<span class="header-section-number">22.2.2</span> 0-1 分布<a class="anchor" aria-label="anchor" href="#subsec-binomial"><i class="fas fa-link"></i></a>
</h3>
<p>设 0-1 分布 <span class="math inline">\(B(1, p)\)</span> 的成功概率 <span class="math inline">\(p = 0.95\)</span>，假定是抛硬币的场景，成功概率对应正面朝上的概率为 0.95。一次实验，重复抛 10 次，有两次正面朝上。现在要根据这次实验结果估计成功概率 <span class="math inline">\(p\)</span> 的值，及其置信区间</p>
<div class="sourceCode" id="cb1863"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 卡方近似</span>
<span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">2</span>, n <span class="op">=</span> <span class="fl">10</span>, p <span class="op">=</span> <span class="fl">0.95</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, correct <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning in prop.test(x = 2, n = 10, p = 0.95, conf.level = 0.95, correct =
## TRUE): Chi-squared approximation may be incorrect</code></pre>
<pre><code>## 
##  1-sample proportions test with continuity correction
## 
## data:  2 out of 10, null probability 0.95
## X-squared = 103.16, df = 1, p-value &lt; 2.2e-16
## alternative hypothesis: true p is not equal to 0.95
## 95 percent confidence interval:
##  0.03542694 0.55781858
## sample estimates:
##   p 
## 0.2</code></pre>
<div class="sourceCode" id="cb1866"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 二项精确估计</span>
<span class="fu"><a href="https://rdrr.io/r/stats/binom.test.html">binom.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">2</span>, n <span class="op">=</span> <span class="fl">10</span>, p <span class="op">=</span> <span class="fl">0.95</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Exact binomial test
## 
## data:  2 and 10
## number of successes = 2, number of trials = 10, p-value = 1.605e-09
## alternative hypothesis: true probability of success is not equal to 0.95
## 95 percent confidence interval:
##  0.02521073 0.55609546
## sample estimates:
## probability of success 
##                    0.2</code></pre>
<p>可知，在置信水平都是 0.95 的情况下，带连续矫正的单样本比例检验方法获得的区间估计是 (0.0354, 0.5578)， 区间长度 0.5224。精确二项检验方法获得的区间估计是 (0.0252, 0.5560)，区间长度 0.5308。</p>
<p>从二项分布 <span class="math inline">\(B(30, 0.2)\)</span> 中随机抽取一个样本，为可重复记，设置随机数种子为 2020</p>
<div class="sourceCode" id="cb1868"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="fl">1</span>, size <span class="op">=</span> <span class="fl">30</span>, prob <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> </code></pre></div>
<pre><code>## [1] 7</code></pre>
<p>得到样本观测值为 7，</p>
<div class="sourceCode" id="cb1870"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">7</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">0.95</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">0.2</span> <span class="op">*</span> <span class="fl">0.8</span> <span class="op">/</span> <span class="fl">30</span><span class="op">)</span> <span class="co"># 6.995</span></code></pre></div>
<pre><code>## [1] 6.995421</code></pre>
<div class="sourceCode" id="cb1872"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">7</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">0.95</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">0.2</span> <span class="op">*</span> <span class="fl">0.8</span> <span class="op">/</span> <span class="fl">30</span><span class="op">)</span> <span class="co"># 7.0045</span></code></pre></div>
<pre><code>## [1] 7.004579</code></pre>
<p>样本观测值 7 对应的参数 <span class="math inline">\(p\)</span> 的区间估计，如下</p>
<div class="sourceCode" id="cb1874"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">7</span>, n <span class="op">=</span> <span class="fl">30</span>, p <span class="op">=</span> <span class="fl">0.2</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, correct <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </code></pre></div>
<pre><code>## 
##  1-sample proportions test with continuity correction
## 
## data:  7 out of 30, null probability 0.2
## X-squared = 0.052083, df = 1, p-value = 0.8195
## alternative hypothesis: true p is not equal to 0.2
## 95 percent confidence interval:
##  0.1063502 0.4270023
## sample estimates:
##         p 
## 0.2333333</code></pre>
<p>随机变量 <span class="math inline">\(X\)</span> 服从二项分布 <span class="math inline">\(B(30, 0.2)\)</span>，则概率值 <span class="math inline">\(P(x \leq 7) = 0.7607\)</span></p>
<div class="sourceCode" id="cb1876"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="fl">7</span>, size <span class="op">=</span> <span class="fl">30</span>, prob <span class="op">=</span> <span class="fl">0.2</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.7607906</code></pre>
<p>已知概率值为 0.95， 即 <span class="math inline">\(P(x \leq m) = 0.95\)</span> 且 <span class="math inline">\(X \sim B(30, 0.2)\)</span>，现在计算 m 的值，即求下分位点，为 10</p>
<div class="sourceCode" id="cb1878"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">qbinom</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.95</span>, size <span class="op">=</span> <span class="fl">30</span>, prob <span class="op">=</span> <span class="fl">0.2</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<div class="rmdtip">
<p>二项分布的特点，主要用于计算期望，概率 <span class="math inline">\(P\big\{ C_1 +1\leq x \leq C_2 -1 \big\}\)</span></p>
<p><span class="math display">\[
\sum_{x = C_1 + 1}^{C_2 -1} x \binom{n}{x} p^{x}(1-p)^{n-x} = np \sum_{x = C_1 + 1}^{C_2 -1} \binom{n -1}{x -1} p^{x -1}(1-p)^{(n -1)-(x-1)}
\]</span></p>
<div class="sourceCode" id="cb1880"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">=</span> <span class="fl">30</span> 
<span class="va">c2</span> <span class="op">=</span> <span class="fl">20</span> 
<span class="va">c1</span> <span class="op">=</span> <span class="fl">10</span>
<span class="va">p</span> <span class="op">=</span> <span class="fl">0.2</span>
<span class="va">n</span> <span class="op">*</span> <span class="va">p</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span>q <span class="op">=</span> <span class="va">c2</span> <span class="op">-</span> <span class="fl">2</span>, size <span class="op">=</span> <span class="va">n</span> <span class="op">-</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">p</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span>q <span class="op">=</span> <span class="va">c1</span> <span class="op">-</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="va">n</span> <span class="op">-</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.2955803</code></pre>
</div>
</div>
<div id="sec-confidence-fiducial-limits" class="section level3" number="22.2.3">
<h3>
<span class="header-section-number">22.2.3</span> 置信区间和信仰区间<a class="anchor" aria-label="anchor" href="#sec-confidence-fiducial-limits"><i class="fas fa-link"></i></a>
</h3>
<p>计算置信区间的覆盖概率 <a href="https://cran.r-project.org/package=binom">binom</a></p>
<p>二项分布的参数估计，包括点估计和区间估计 <span class="citation"><a href="#ref-Test_1934_binom" role="doc-biblioref">[33]</a></span></p>
<p>给定样本量 n = 10 0-1 分布 成功概率 p 分别取 0.1,0.2,…,1
置信度为 95% 观测到 x 取 1,2,3,..,10 时 估计 p 的上下限</p>
<div class="sourceCode" id="cb1882"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2019</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="co"># 结果解读</span></code></pre></div>
<p>抛掷硬币 10 次，观测到2次正面朝上，估计正面朝上的概率</p>
<p>观测到正面朝上 2 次 此时请以 95% 的信心给出 p 的区间 (p_low, p_up)</p>
<p>绘制曲线 p 关于 x 的曲线</p>
<div class="sourceCode" id="cb1883"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2019</span><span class="op">)</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>
<span class="co"># 成功概率 总体参数 p 值</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">p</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, <span class="va">rbinom</span>, n <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<pre><code>##   [1]  0  0  0  0  0  0  0  0  0  0  2  1  0  1  0  0  2  0  0  1  3  2  1  1  3
##  [26]  2  0  3  1  2  3  3  5  2  1  0  3  5  3  3  5  1  5  3  1  2  3  4  1  5
##  [51]  5  4  7  6  6  5  7  7  4  4  7  8  9  7  6  7  2  4  8  8  8  8  6  8  6
##  [76]  4  8  9  6  7  9  9  9  9  8  4  9  8  9  7 10  8  7 10  9 10  9  9  8 10
## [101] 10 10 10 10 10 10 10 10 10 10</code></pre>
<p>计算每一次抽样获得的上下限</p>
<p>Clopper-Pearson 方法，即求和搜索，在保持累积概率</p>
<p><span class="math display">\[B(x,n;n,p) = \sum_{r = x}^{n} \binom{n}{r}p^r(1-p)^{n-r} = \alpha/2\]</span></p>
<p>其中 n 表示试验次数，这里是 10， p 是未知待求，已知 <span class="math inline">\(\alpha = 0.05\)</span>，而 <span class="math inline">\(1-\alpha\)</span> 表示置信水平，意思是说对于我给出的区间估计，长期来看，我有 95% 的信心认为，真实值 <span class="math inline">\(p\)</span> 会落在此区间内。</p>
<p>对上尾部从 x 到 n 求和，计算 p，对每一个 x 都能计算出一个 p，根据二项分布的对称性，区间 <span class="math inline">\([0, x]\)</span> 和 <span class="math inline">\([x,n]\)</span> 的累积概率是相同的，各占 <span class="math inline">\(\alpha/2\)</span></p>
<div class="sourceCode" id="cb1885"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 精确计算二项分布检验的 p</span>
<span class="co"># 调用符号计算</span>
<span class="co"># x = 7</span>
<span class="va">fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span>, <span class="va">r</span> <span class="op">=</span> <span class="fl">8</span>, <span class="va">n</span> <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/Special.html">choose</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">n</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="va">p</span><span class="op">^</span><span class="va">r</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="va">r</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Special.html">choose</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">p</span><span class="op">^</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Special.html">choose</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">n</span><span class="op">)</span><span class="op">*</span><span class="va">p</span><span class="op">^</span><span class="va">n</span> <span class="op">-</span> <span class="fl">0.025</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/stats/uniroot.html">uniroot</a></span><span class="op">(</span><span class="va">fun</span>, lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code>## $root
## [1] 0.4439038
## 
## $f.root
## [1] -2.707352e-07
## 
## $iter
## [1] 9
## 
## $init.it
## [1] NA
## 
## $estim.prec
## [1] 6.103516e-05</code></pre>
<div class="sourceCode" id="cb1887"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># x = 8</span>
<span class="va">fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">{</span>
  <span class="fl">45</span><span class="op">*</span><span class="va">p</span><span class="op">^</span><span class="fl">8</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">10</span><span class="op">*</span><span class="va">p</span><span class="op">^</span><span class="fl">9</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span> <span class="op">+</span> <span class="va">p</span><span class="op">^</span><span class="fl">10</span> <span class="op">-</span> <span class="fl">0.025</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/stats/uniroot.html">uniroot</a></span><span class="op">(</span><span class="va">fun</span>, lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code>## $root
## [1] 0.4439038
## 
## $f.root
## [1] -2.707352e-07
## 
## $iter
## [1] 9
## 
## $init.it
## [1] NA
## 
## $estim.prec
## [1] 6.103516e-05</code></pre>
<div class="sourceCode" id="cb1889"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># x = 9</span>
<span class="va">fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="fl">9</span> <span class="op">*</span> <span class="va">x</span><span class="op">^</span><span class="fl">10</span> <span class="op">-</span> <span class="fl">10</span> <span class="op">*</span> <span class="va">x</span><span class="op">^</span><span class="fl">9</span> <span class="op">+</span> <span class="fl">0.025</span>
<span class="op">}</span>
<span class="co"># 0.555 计算下限</span>
<span class="fu"><a href="https://rdrr.io/r/stats/uniroot.html">uniroot</a></span><span class="op">(</span><span class="va">fun</span>, lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code>## $root
## [1] 0.5549828
## 
## $f.root
## [1] 3.773379e-07
## 
## $iter
## [1] 10
## 
## $init.it
## [1] NA
## 
## $estim.prec
## [1] 6.462529e-05</code></pre>
<div class="sourceCode" id="cb1891"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># x = 10</span>
<span class="va">fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">x</span><span class="op">^</span><span class="fl">10</span> <span class="op">-</span> <span class="fl">0.025</span>
<span class="op">}</span>
<span class="co"># 0.691</span>
<span class="fu"><a href="https://rdrr.io/r/stats/uniroot.html">uniroot</a></span><span class="op">(</span><span class="va">fun</span>, lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code>## $root
## [1] 0.6914996
## 
## $f.root
## [1] -1.194136e-06
## 
## $iter
## [1] 9
## 
## $init.it
## [1] NA
## 
## $estim.prec
## [1] 6.103516e-05</code></pre>
<p>累积二项概率</p>
<p>找到最小的 p 使得其等于 9</p>
<div class="sourceCode" id="cb1893"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 已知概率求上分位点</span>

<span class="co"># 等于</span>
<span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">qbinom</a></span><span class="op">(</span><span class="fl">0.025</span>, size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.565</span>, lower.tail <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 9</code></pre>
<p>找到使得函数为 0 的 p 中最小的那个，找到所有的根，然后取最小的那个</p>
<div class="sourceCode" id="cb1895"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span>, <span class="va">r</span> <span class="op">=</span> <span class="fl">9</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">qbinom</a></span><span class="op">(</span><span class="fl">0.025</span>, size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="va">p</span>, lower.tail <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">-</span> <span class="va">r</span>
<span class="co"># 计算每个 x 对应的 p </span>
<span class="op">(</span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/uniroot.html">uniroot</a></span><span class="op">(</span><span class="va">fun</span>, lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">root</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] 0.01666667 0.05333333 0.09375000 0.16000000 0.25000000 0.30000000
##  [7] 0.35000000 0.53333333 0.67500000 1.00000000</code></pre>
<div class="sourceCode" id="cb1897"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, y <span class="op">=</span> <span class="va">p</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="parameter-estimators_files/figure-html/unnamed-chunk-27-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1898"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 二项检验 菱形置信带</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2019</span><span class="op">)</span>

<span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="fl">3</span>, expr <span class="op">=</span> <span class="op">{</span>
  <span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, size <span class="op">=</span> <span class="fl">10</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span>
<span class="op">}</span><span class="op">)</span>

<span class="co"># 成功概率 p = 0.2 每个样本量 10</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="fl">3</span>, size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></code></pre></div>
<pre><code>## dat
##   0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 
## 119 274 304 180  82  30  10   1</code></pre>
<div class="sourceCode" id="cb1900"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 分布图 y 轴是密度</span>
<span class="co"># right = TRUE 区间形式 (a,b] 左开右闭</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">dat</span>, probability <span class="op">=</span> <span class="cn">T</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span>, to <span class="op">=</span> <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="parameter-estimators_files/figure-html/unnamed-chunk-29-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1901"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 0.2^10 左闭右开区间</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">dat</span>, probability <span class="op">=</span> <span class="cn">T</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">1.1</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,
     right <span class="op">=</span> <span class="cn">FALSE</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="parameter-estimators_files/figure-html/unnamed-chunk-29-2.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1902"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 分布</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span>
<span class="co"># 这个图里面会不会隐含什么信息，分布是怎样的？</span>
<span class="co"># 二项展开有关系吗</span>
<span class="va">dat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span>


<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dat1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dat</span>, y <span class="op">=</span> <span class="va">Freq</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="parameter-estimators_files/figure-html/unnamed-chunk-30-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1903"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="parameter-estimators_files/figure-html/unnamed-chunk-30-2.png" width="672" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="sec-least-angle-regression" class="section level2" number="22.3">
<h2>
<span class="header-section-number">22.3</span> 最小角回归<a class="anchor" aria-label="anchor" href="#sec-least-angle-regression"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>Efron, Bradley and Hastie, Trevor and Johnstone, Iain and Tibshirani, Robert. 2004. Least angle regression. The Annals of Statistics. 32(2): 407–499. <a href="https://doi.org/10.1214/009053604000000067" class="uri">https://doi.org/10.1214/009053604000000067</a>.</li>
</ol>
<p>方差缩减技术，修偏技术</p>
</div>
<div id="sec-jackknife" class="section level2" number="22.4">
<h2>
<span class="header-section-number">22.4</span> 刀切法<a class="anchor" aria-label="anchor" href="#sec-jackknife"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>Efron, B. 1979. Bootstrap Methods: Another Look at the Jackknife. The Annals of Statistics. 7(1):1–26. <a href="https://doi.org/10.1214/aos/1176344552" class="uri">https://doi.org/10.1214/aos/1176344552</a>
</li>
</ol>
</div>
<div id="sec-resampling" class="section level2" number="22.5">
<h2>
<span class="header-section-number">22.5</span> 重抽样<a class="anchor" aria-label="anchor" href="#sec-resampling"><i class="fas fa-link"></i></a>
</h2>
</div>
<div id="sec-delta-methods" class="section level2" number="22.6">
<h2>
<span class="header-section-number">22.6</span> Delta 方法<a class="anchor" aria-label="anchor" href="#sec-delta-methods"><i class="fas fa-link"></i></a>
</h2>

</div>
</div>
<h3>参考文献</h3>
<div id="refs" class="references csl-bib-body">
<div id="ref-Stat_1981_Chen" class="csl-entry">
<div class="csl-left-margin">[32] </div>
<div class="csl-right-inline">陈希孺, <em>数理统计引论</em>. 北京: 科学出版社, 1981.</div>
</div>
<div id="ref-Test_1934_binom" class="csl-entry">
<div class="csl-left-margin">[33] </div>
<div class="csl-right-inline">C. J. Clopper and E. S. Pearson, <span>“The use of confidence or fiducial limits illustrated in the case of the binomial,”</span> <em>Biometrika</em>, vol. 26, no. 4, pp. 404–413, Dec. 1934, doi: <a href="https://doi.org/10.1093/biomet/26.4.404">10.1093/biomet/26.4.404</a>.</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="chap-sampling-distributions.html"><span class="header-section-number">21</span> 抽样分布</a></div>
<div class="next"><a href="chap-hypothesis-test.html"><span class="header-section-number">23</span> 假设检验</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#chap-parameter-estimators"><span class="header-section-number">22</span> 参数估计</a></li>
<li>
<a class="nav-link" href="#sec-point-estimator"><span class="header-section-number">22.1</span> 点估计</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#sec-moments-estimation"><span class="header-section-number">22.1.1</span> 矩估计</a></li>
<li><a class="nav-link" href="#sec-lse"><span class="header-section-number">22.1.2</span> 最小二乘估计</a></li>
<li><a class="nav-link" href="#sec-mle"><span class="header-section-number">22.1.3</span> 极大似然估计</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#chap-interval-estimation"><span class="header-section-number">22.2</span> 区间估计</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#subsec-ci"><span class="header-section-number">22.2.1</span> 正态分布</a></li>
<li><a class="nav-link" href="#subsec-binomial"><span class="header-section-number">22.2.2</span> 0-1 分布</a></li>
<li><a class="nav-link" href="#sec-confidence-fiducial-limits"><span class="header-section-number">22.2.3</span> 置信区间和信仰区间</a></li>
</ul>
</li>
<li><a class="nav-link" href="#sec-least-angle-regression"><span class="header-section-number">22.3</span> 最小角回归</a></li>
<li><a class="nav-link" href="#sec-jackknife"><span class="header-section-number">22.4</span> 刀切法</a></li>
<li><a class="nav-link" href="#sec-resampling"><span class="header-section-number">22.5</span> 重抽样</a></li>
<li><a class="nav-link" href="#sec-delta-methods"><span class="header-section-number">22.6</span> Delta 方法</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/XiangyunHuang/masr/blob/devel/parameter-estimators.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/XiangyunHuang/masr/edit/devel/parameter-estimators.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>现代应用统计与 R 语言</strong>: Modern Applied Statistics with R" was written by 黄湘云. It was last built on 2022-04-03.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
