<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>第 34 章 空间数据可视化 | 现代应用统计与 R 语言</title>
<meta name="author" content="黄湘云">
<meta name="description" content="library(sp) library(rgdal) library(maps) library(mapproj) library(maptools) library(sf) library(ggplot2) library(raster) library(abind) library(cubelyr) library(stars) library(echarts4r)...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="第 34 章 空间数据可视化 | 现代应用统计与 R 语言">
<meta property="og:type" content="book">
<meta property="og:image" content="/images/cover.png">
<meta property="og:description" content="library(sp) library(rgdal) library(maps) library(mapproj) library(maptools) library(sf) library(ggplot2) library(raster) library(abind) library(cubelyr) library(stars) library(echarts4r)...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="第 34 章 空间数据可视化 | 现代应用统计与 R 语言">
<meta name="twitter:description" content="library(sp) library(rgdal) library(maps) library(mapproj) library(maptools) library(sf) library(ggplot2) library(raster) library(abind) library(cubelyr) library(stars) library(echarts4r)...">
<meta name="twitter:image" content="/images/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs/header-attrs.js"></script><script src="libs/jquery/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap/bootstrap.bundle.min.js"></script><script src="libs/bs3compat/transition.js"></script><script src="libs/bs3compat/tabs.js"></script><script src="libs/bs3compat/bs3compat.js"></script><link href="libs/bs4_book/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book/bs4_book.js"></script><script src="libs/htmlwidgets/htmlwidgets.js"></script><script src="libs/plotly-binding/plotly.js"></script><script src="libs/typedarray/typedarray.min.js"></script><link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main/plotly-latest.min.js"></script><script src="libs/proj4js/proj4.js"></script><link href="libs/highcharts/css/motion.css" rel="stylesheet">
<script src="libs/highcharts/highcharts.js"></script><script src="libs/highcharts/highcharts-3d.js"></script><script src="libs/highcharts/highcharts-more.js"></script><script src="libs/highcharts/modules/stock.js"></script><script src="libs/highcharts/modules/map.js"></script><script src="libs/highcharts/modules/annotations.js"></script><script src="libs/highcharts/modules/data.js"></script><script src="libs/highcharts/modules/drilldown.js"></script><script src="libs/highcharts/modules/item-series.js"></script><script src="libs/highcharts/modules/offline-exporting.js"></script><script src="libs/highcharts/modules/overlapping-datalabels.js"></script><script src="libs/highcharts/modules/exporting.js"></script><script src="libs/highcharts/modules/export-data.js"></script><script src="libs/highcharts/modules/funnel.js"></script><script src="libs/highcharts/modules/heatmap.js"></script><script src="libs/highcharts/modules/treemap.js"></script><script src="libs/highcharts/modules/sankey.js"></script><script src="libs/highcharts/modules/dependency-wheel.js"></script><script src="libs/highcharts/modules/organization.js"></script><script src="libs/highcharts/modules/solid-gauge.js"></script><script src="libs/highcharts/modules/streamgraph.js"></script><script src="libs/highcharts/modules/sunburst.js"></script><script src="libs/highcharts/modules/vector.js"></script><script src="libs/highcharts/modules/wordcloud.js"></script><script src="libs/highcharts/modules/xrange.js"></script><script src="libs/highcharts/modules/tilemap.js"></script><script src="libs/highcharts/modules/venn.js"></script><script src="libs/highcharts/modules/gantt.js"></script><script src="libs/highcharts/modules/timeline.js"></script><script src="libs/highcharts/modules/parallel-coordinates.js"></script><script src="libs/highcharts/modules/bullet.js"></script><script src="libs/highcharts/modules/coloraxis.js"></script><script src="libs/highcharts/modules/dumbbell.js"></script><script src="libs/highcharts/modules/lollipop.js"></script><script src="libs/highcharts/modules/series-label.js"></script><script src="libs/highcharts/plugins/motion.js"></script><script src="libs/highcharts/custom/reset.js"></script><script src="libs/highcharts/modules/boost.js"></script><script src="libs/highchart-binding/highchart.js"></script><script src="libs/plotly-locale-zh-CN/zh-cn.js"></script><script src="libs/mathjax/cdn.js"></script><link href="libs/dygraphs/dygraph.css" rel="stylesheet">
<script src="libs/dygraphs/dygraph-combined.js"></script><script src="libs/dygraphs/shapes.js"></script><script src="libs/moment/moment.js"></script><script src="libs/moment-timezone/moment-timezone-with-data.js"></script><script src="libs/moment-fquarter/moment-fquarter.min.js"></script><script src="libs/dygraphs-binding/dygraphs.js"></script><script src="libs/Dygraph.Plugins.Unzoom/unzoom.js"></script><script src="libs/echarts4r/echarts-en.min.js"></script><script src="libs/echarts4r/ecStat.min.js"></script><script src="libs/echarts4r/dataTool.min.js"></script><script src="libs/echarts4r-binding/echarts4r.js"></script><script src="libs/d3/d3.min.js"></script><script src="libs/forceNetwork-binding/forceNetwork.js"></script><link href="libs/vis/vis-network.min.css" rel="stylesheet">
<script src="libs/vis/vis-network.min.js"></script><script src="libs/visNetwork-binding/visNetwork.js"></script><script src="libs/FileSaver/FileSaver.min.js"></script><script src="libs/Blob/Blob.js"></script><script src="libs/canvas-toBlob/canvas-toBlob.js"></script><script src="libs/html2canvas/html2canvas.js"></script><script src="libs/jspdf/jspdf.debug.js"></script><link href="libs/jquery-sparkline/jquery.sparkline.css" rel="stylesheet">
<script src="libs/jquery-sparkline/jquery.sparkline.js"></script><script src="libs/sparkline-binding/sparkline.js"></script><script src="libs/r2d3-render/r2d3-render.js"></script><script src="libs/webcomponents/webcomponents.js"></script><script src="libs/r2d3-binding/r2d3.js"></script><script src="libs/d3v6/d3.min.js"></script><script src="libs/es6shim/es6shim.js"></script><script src="libs/es7shim/es7shim.js"></script><script src="libs/graphre/graphre.js"></script><script src="libs/nomnoml/nomnoml.js"></script><script src="libs/nomnoml-binding/nomnoml.js"></script><script src="libs/d3-bundle/d3-bundle.min.js"></script><script src="libs/d3-lasso/d3-lasso.min.js"></script><script src="libs/save-svg-as-png/save-svg-as-png.min.js"></script><link href="libs/ggiraphjs/ggiraphjs.min.css" rel="stylesheet">
<script src="libs/ggiraphjs/ggiraphjs.min.js"></script><script src="libs/girafe-binding/girafe.js"></script><link href="libs/datatables-css/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding/datatables.js"></script><link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core/js/jquery.dataTables.min.js"></script><script src="libs/jszip/jszip.min.js"></script><script src="libs/pdfmake/pdfmake.js"></script><script src="libs/pdfmake/vfs_fonts.js"></script><link href="libs/dt-ext-buttons/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="libs/dt-ext-buttons/js/dataTables.buttons.min.js"></script><script src="libs/dt-ext-buttons/js/buttons.flash.min.js"></script><script src="libs/dt-ext-buttons/js/buttons.html5.min.js"></script><script src="libs/dt-ext-buttons/js/buttons.colVis.min.js"></script><script src="libs/dt-ext-buttons/js/buttons.print.min.js"></script><link href="libs/dt-ext-rowgroup/css/rowGroup.dataTables.min.css" rel="stylesheet">
<script src="libs/dt-ext-rowgroup/js/dataTables.rowGroup.min.js"></script><script src="libs/kePrint/kePrint.js"></script><link href="libs/lightable/lightable.css" rel="stylesheet">
<script src="libs/echarts-world/world.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-54GQKWF7VP"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-54GQKWF7VP');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Modern Applied Statistics with R">现代应用统计与 R 语言</a>:
        <small class="text-muted">Modern Applied Statistics with R</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">欢迎</a></li>
<li><a class="" href="chap-preface.html"><span class="header-section-number">1</span> 前言</a></li>
<li class="book-part">数据整理</li>
<li><a class="" href="chap-data-wrangling.html">介绍</a></li>
<li><a class="" href="chap-data-structure.html"><span class="header-section-number">2</span> 数据结构</a></li>
<li><a class="" href="chap-data-transportation.html"><span class="header-section-number">3</span> 数据搬运</a></li>
<li><a class="" href="chap-string-operations.html"><span class="header-section-number">4</span> 字符串操作</a></li>
<li><a class="" href="chap-regular-expressions.html"><span class="header-section-number">5</span> 正则表达式</a></li>
<li><a class="" href="chap-data-manipulation.html"><span class="header-section-number">6</span> 数据操作</a></li>
<li><a class="" href="chap-advanced-manipulation.html"><span class="header-section-number">7</span> 高级数据操作</a></li>
<li><a class="" href="chap-parallel-manipulation.html"><span class="header-section-number">8</span> 并行化操作</a></li>
<li><a class="" href="chap-dplyr-manipulation.html"><span class="header-section-number">9</span> 净土化操作</a></li>
<li class="book-part">统计图形</li>
<li><a class="" href="chap-statistical-graphics.html">介绍</a></li>
<li><a class="" href="chap-graphics-foundations.html"><span class="header-section-number">10</span> 图形基础</a></li>
<li><a class="" href="chap-data-visualization.html"><span class="header-section-number">11</span> 数据可视化</a></li>
<li><a class="" href="chap-interactive-web-graphics.html"><span class="header-section-number">12</span> 交互图形</a></li>
<li class="book-part">动态文档</li>
<li><a class="" href="chap-dynamic-documents.html">介绍</a></li>
<li><a class="" href="chap-document-elements.html"><span class="header-section-number">13</span> 文档元素</a></li>
<li><a class="" href="chap-portable-document.html"><span class="header-section-number">14</span> 便携式文档</a></li>
<li><a class="" href="chap-web-documents.html"><span class="header-section-number">15</span> 网页文档</a></li>
<li><a class="" href="chap-office-document.html"><span class="header-section-number">16</span> 办公文档</a></li>
<li><a class="" href="chap-reproducible-workflows.html"><span class="header-section-number">17</span> 工作流</a></li>
<li><a class="" href="chap-advanced-documents.html"><span class="header-section-number">18</span> 高级文档</a></li>
<li class="book-part">数据产品</li>
<li><a class="" href="chap-data-product.html">介绍</a></li>
<li><a class="" href="chap-interactive-data-tables.html"><span class="header-section-number">19</span> 交互表格</a></li>
<li><a class="" href="chap-interactive-shiny-app.html"><span class="header-section-number">20</span> 交互报表</a></li>
<li class="book-part">统计基础</li>
<li><a class="" href="chap-statistical-foundations.html">介绍</a></li>
<li><a class="" href="chap-sampling-distributions.html"><span class="header-section-number">21</span> 抽样分布</a></li>
<li><a class="" href="chap-parameter-estimators.html"><span class="header-section-number">22</span> 参数估计</a></li>
<li><a class="" href="chap-hypothesis-test.html"><span class="header-section-number">23</span> 假设检验</a></li>
<li><a class="" href="chap-power-Analysis.html"><span class="header-section-number">24</span> 功效分析</a></li>
<li><a class="" href="chap-experimental-design.html"><span class="header-section-number">25</span> 试验设计</a></li>
<li class="book-part">统计模型</li>
<li><a class="" href="chap-statistical-models.html">介绍</a></li>
<li><a class="" href="chap-linear-models.html"><span class="header-section-number">26</span> 线性模型</a></li>
<li><a class="" href="chap-generalized-linear-models.html"><span class="header-section-number">27</span> 广义线性模型</a></li>
<li><a class="" href="chap-bayesian-models.html"><span class="header-section-number">28</span> 贝叶斯模型</a></li>
<li class="book-part">数据建模</li>
<li><a class="" href="chap-data-modeling.html">介绍</a></li>
<li><a class="" href="chap-text-analysis.html"><span class="header-section-number">29</span> 文本分析</a></li>
<li><a class="" href="chap-survival-analysis.html"><span class="header-section-number">30</span> 生存分析</a></li>
<li><a class="" href="chap-time-series-analysis.html"><span class="header-section-number">31</span> 时序分析</a></li>
<li class="book-part">时空数据</li>
<li><a class="" href="chap-spatio-temporal-data.html">介绍</a></li>
<li><a class="" href="chap-spatial-analysis.html"><span class="header-section-number">32</span> 空间数据分析</a></li>
<li><a class="" href="chap-spatial-modeling.html"><span class="header-section-number">33</span> 空间数据建模</a></li>
<li><a class="active" href="chap-spatial-viz.html"><span class="header-section-number">34</span> 空间数据可视化</a></li>
<li><a class="" href="chap-case-study.html"><span class="header-section-number">35</span> 案例研究</a></li>
<li><a class="" href="chap-data-explorer.html"><span class="header-section-number">36</span> 数据探索</a></li>
<li class="book-part">机器学习</li>
<li><a class="" href="chap-machine-learning.html">介绍</a></li>
<li><a class="" href="chap-gradient-boosting-machine.html"><span class="header-section-number">37</span> 梯度提升机</a></li>
<li><a class="" href="chap-numerical-optimization.html"><span class="header-section-number">38</span> 数值优化</a></li>
<li class="book-part">附录</li>
<li><a class="" href="chap-linux-command-bash.html"><span class="header-section-number">A</span> 命令行操作</a></li>
<li><a class="" href="chap-matrix-operations.html"><span class="header-section-number">B</span> 矩阵运算</a></li>
<li><a class="" href="chap-symbolic-computation.html"><span class="header-section-number">C</span> 符号计算</a></li>
<li><a class="" href="chap-mixed-programming.html"><span class="header-section-number">D</span> 混合编程</a></li>
<li><a class="" href="chap-object-oriented-programming.html"><span class="header-section-number">E</span> 面向对象编程</a></li>
<li><a class="" href="chap-file-operations.html"><span class="header-section-number">F</span> 文件操作</a></li>
<li><a class="" href="chap-other-softwares.html"><span class="header-section-number">G</span> 其它软件</a></li>
<li><a class="" href="chap-notations.html"><span class="header-section-number">H</span> 符号说明</a></li>
<li><a class="" href="references.html">参考文献</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/XiangyunHuang/masr">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="chap-spatial-viz" class="section level1" number="34">
<h1>
<span class="header-section-number">第 34 章</span> 空间数据可视化<a class="anchor" aria-label="anchor" href="#chap-spatial-viz"><i class="fas fa-link"></i></a>
</h1>
<div class="sourceCode" id="cb2369"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/">sp</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://rgdal.r-forge.r-project.org">rgdal</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">maps</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">mapproj</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://maptools.r-forge.r-project.org/">maptools</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster">raster</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">abind</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/cubelyr">cubelyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/stars/">stars</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://echarts4r.john-coene.com/">echarts4r</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jrnold/ggthemes">ggthemes</a></span><span class="op">)</span></code></pre></div>
<p><a href="https://github.com/Jianghao">王江浩</a>
<a href="https://www.beijingcitylab.com/">北京城市实验室</a>
<!-- https://segmentfault.com/a/1190000015048613 --></p>
<p>Robert J. Hijmans <a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Department of Environmental Science and Policy at the University of California, Davis. &lt;a href="https://biogeo.ucdavis.edu/"&gt;Ecology, Geography, and Agriculture&lt;/a&gt;&lt;/p&gt;'><sup>75</sup></a> 开发了 <a href="https://github.com/rspatial/raster">raster</a> 包用于网格空间数据的读、写、操作、分析和建模，同时维护了空间数据分析的网站 <a href="https://www.rspatial.org" class="uri">https://www.rspatial.org</a>。Edzer Pebesma <a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Institute for Geoinformatics of the University of Münster.&lt;/p&gt;"><sup>76</sup></a> 和 Roger Bivand 等创建了 <a href="https://github.com/edzer/sp/">sp</a> 包定义了空间数据类型和方法，提供了大量的空间数据操作方法，同时维护了空间数据对象 sp 的绘图网站 <a href="https://edzer.github.io/sp/" class="uri">https://edzer.github.io/sp/</a>，他们也一起合作写了新书 <a href="https://keen-swartz-3146c4.netlify.com/">Spatial Data Science</a>，提供了在线 <a href="https://www.r-spatial.org/book/">网页版</a> 书籍及其 <a href="https://github.com/edzer/sdsr">源代码</a>。Edzer Pebesma 后来开发了 <a href="https://github.com/r-spatial/sf/">sf</a> 包重新定义了空间数据对象和操作方法，并维护了空间数据分析、建模和可视化网站 <a href="https://www.r-spatial.org/" class="uri">https://www.r-spatial.org/</a></p>
<p>课程案例学习</p>
<ol style="list-style-type: decimal">
<li>
<a href="https://datacarpentry.org/r-raster-vector-geospatial/">2018-Introduction to Geospatial Raster and Vector Data with R</a> 空间数据分析课程</li>
<li>
<a href="http://freerangestats.info">Peter Ellis</a> 新西兰大选和普查数据 <a href="http://freerangestats.info/blog/nz.html">More cartograms of New Zealand census data: district and city level</a>
</li>
<li>
<a href="http://sharpsightlabs.com/blog/map-oil-production-country-r/">2017-Mapping oil production by country in R</a> 石油产量在全球的分布</li>
<li>
<a href="https://www.sharpsightlabs.com/blog/highlight-countries-on-map/">2017-How to highlight countries on a map</a> 高亮地图上的国家</li>
<li><a href="https://ryanpeek.github.io/2017-11-21-mapping-with-sf-part-3/">2017-Mapping With Sf: Part 3</a></li>
<li>
<a href="https://ignaciomsarmiento.github.io/software.html">Data Visualization Shiny Apps</a> 数据可视化核密度估计 In this app I identify crime hotspots using a bivariate density estimation strategy</li>
<li><a href="http://www.rpubs.com/cgarey/ProjectOneFinal">Association of Statisticians of American Religious Bodies (ASARB) viridis USA map</a></li>
<li><a href="https://www1.nyc.gov/site/tlc/about/tlc-trip-record-data.page">出租车行车轨迹数据</a></li>
<li><a href="https://carto.com/blog/geospatial-processing-with-clickhouse/">Geospatial processing with Clickhouse-CARTO Blog</a></li>
</ol>
<div id="sec-spatial-data" class="section level2" number="34.1">
<h2>
<span class="header-section-number">34.1</span> 空间数据<a class="anchor" aria-label="anchor" href="#sec-spatial-data"><i class="fas fa-link"></i></a>
</h2>
<p>空间数据存储在数据库中，比如 <a href="https://postgis.net/">PostGIS</a>，它是对象关系数据库 <a href="https://postgresql.org/">PostgreSQL</a> 在空间数据库方面的扩展。</p>
<div id="subsec-dataframe" class="section level3" number="34.1.1">
<h3>
<span class="header-section-number">34.1.1</span> data.frame<a class="anchor" aria-label="anchor" href="#subsec-dataframe"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb2370"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"quakes"</span><span class="op">)</span>
<span class="va">quakes</span></code></pre></div>
<pre><code>##         lat   long depth mag stations
## 1    -20.42 181.62   562 4.8       41
## 2    -20.62 181.03   650 4.2       15
## 3    -26.00 184.10    42 5.4       43
## 4    -17.97 181.66   626 4.1       19
## 5    -20.42 181.96   649 4.0       11
....</code></pre>
</div>
<div id="subsec-sp" class="section level3" number="34.1.2">
<h3>
<span class="header-section-number">34.1.2</span> sp<a class="anchor" aria-label="anchor" href="#subsec-sp"><i class="fas fa-link"></i></a>
</h3>
<p><a href="https://edzer.github.io/sp/">sp-gallery</a></p>
<div class="sourceCode" id="cb2372"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/">sp</a></span><span class="op">)</span></code></pre></div>
<p>空间数据对象，以类 sp 方式存储 <span class="citation"><a href="#ref-Pebesma_2005_sp" role="doc-biblioref">[88]</a></span></p>
<div class="sourceCode" id="cb2373"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/">sp</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"meuse"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html">coordinates</a></span><span class="op">(</span><span class="va">meuse</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">y</span>
<span class="fu"><a href="https://rdrr.io/pkg/sp/man/is.projected.html">proj4string</a></span><span class="op">(</span><span class="va">meuse</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+init=epsg:28992"</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO", prefer_proj =
## prefer_proj): Discarded datum Amersfoort in Proj4 definition</code></pre>
<div class="sourceCode" id="cb2375"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">meuse</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "SpatialPointsDataFrame"
## attr(,"package")
## [1] "sp"</code></pre>
<div class="sourceCode" id="cb2377"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/sp/man/is.projected.html">proj4string</a></span><span class="op">(</span><span class="va">meuse</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning in proj4string(meuse): CRS object has comment, which is lost in output</code></pre>
<pre><code>## [1] "+proj=sterea +lat_0=52.1561605555556 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +no_defs"</code></pre>
<div class="sourceCode" id="cb2380"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">meuse</span>, axes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-5"></span>
<img src="spatial-viz_files/figure-html/unnamed-chunk-5-1.png" alt="sp 对象" width="58.33%"><p class="caption">
图 10.7: sp 对象
</p>
</div>
<div class="sourceCode" id="cb2381"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://rgdal.r-forge.r-project.org">rgdal</a></span><span class="op">)</span>
<span class="va">crs.longlat</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://rgdal.r-forge.r-project.org/reference/CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+init=epsg:4326"</span><span class="op">)</span>
<span class="va">meuse.longlat</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://rgdal.r-forge.r-project.org/reference/spTransform-methods.html">spTransform</a></span><span class="op">(</span><span class="va">meuse</span>, <span class="va">crs.longlat</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">meuse.longlat</span>, axes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-6"></span>
<img src="spatial-viz_files/figure-html/unnamed-chunk-6-1.png" alt="sp 对象" width="58.33%"><p class="caption">
图 10.8: sp 对象
</p>
</div>
<div class="sourceCode" id="cb2382"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://maptools.r-forge.r-project.org/">maptools</a></span><span class="op">)</span>
<span class="va">fname</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"shapes/sids.shp"</span>, package <span class="op">=</span> <span class="st">"maptools"</span><span class="op">)</span>
<span class="va">p4s</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://rgdal.r-forge.r-project.org/reference/CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+proj=longlat +datum=NAD27"</span><span class="op">)</span>
<span class="va">nc</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://maptools.r-forge.r-project.org/reference/readShapePoly.html">readShapePoly</a></span><span class="op">(</span><span class="va">fname</span>, proj4string <span class="op">=</span> <span class="va">p4s</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: readShapePoly is deprecated; use rgdal::readOGR or sf::st_read</code></pre>
<div class="sourceCode" id="cb2384"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">nc</span>, axes <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html">grey</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">nc</span><span class="op">$</span><span class="va">SID79</span> <span class="op">/</span> <span class="fl">57</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="spatial-viz_files/figure-html/unnamed-chunk-7-1.png" width="2100" style="display: block; margin: auto;"></div>
<div class="rmdwarn">
<p>maptools 提供的 <code>readShapePoly</code> 函数去读取 shp 文件的方式已经过时，推荐使用 <code><a href="http://rgdal.r-forge.r-project.org/reference/readOGR.html">rgdal::readOGR</a></code> 或者 <code><a href="https://r-spatial.github.io/sf/reference/st_read.html">sf::st_read</a></code> 方式读取</p>
</div>
<div class="sourceCode" id="cb2385"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Trellis maps</span>
<span class="va">arrow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"SpatialPolygonsRescale"</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/sp/man/spplot.html">layout.north.arrow</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>,
  offset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">76</span>, <span class="fl">34</span><span class="op">)</span>, scale <span class="op">=</span> <span class="fl">0.5</span>, which <span class="op">=</span> <span class="fl">2</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/sp/man/spplot.html">spplot</a></span><span class="op">(</span><span class="va">nc</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="st">"SID74"</span>, <span class="st">"SID79"</span><span class="op">)</span>,
  as.table <span class="op">=</span> <span class="cn">TRUE</span>,
  scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>draw <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, sp.layout <span class="op">=</span> <span class="va">arrow</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="spatial-viz_files/figure-html/unnamed-chunk-8-1.png" width="2100" style="display: block; margin: auto;"></div>
</div>
<div id="subsec-sf" class="section level3" number="34.1.3">
<h3>
<span class="header-section-number">34.1.3</span> sf<a class="anchor" aria-label="anchor" href="#subsec-sf"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb2386"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="va">nc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">read_sf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"gpkg/nc.gpkg"</span>, package <span class="op">=</span> <span class="st">"sf"</span><span class="op">)</span><span class="op">)</span>
<span class="va">nc2</span> <span class="op">&lt;-</span> <span class="va">nc</span> |&gt; 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">SID74</span>, <span class="va">SID79</span><span class="op">)</span> |&gt; 
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span><span class="op">(</span><span class="va">VAR</span>, <span class="va">SID</span>, <span class="op">-</span><span class="va">geom</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">nc2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">SID</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">VAR</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="spatial-viz_files/figure-html/unnamed-chunk-9-1.png" width="2100" style="display: block; margin: auto;"></div>
</div>
<div id="subsec-raster" class="section level3" number="34.1.4">
<h3>
<span class="header-section-number">34.1.4</span> raster<a class="anchor" aria-label="anchor" href="#subsec-raster"><i class="fas fa-link"></i></a>
</h3>
<p>raster 包定义了获取和操作空间 raster 类型数据集的类和方法，rasterVis 补充加强了 raster 包在数据可视化和交互方面的功能。可视化是基于 lattice 的</p>
<p><a href="https://github.com/rspatial/raster">raster</a> 包的开发已经被作者 <a href="https://desp.ucdavis.edu/people/robert-j-hijmans">Robert J. Hijmans</a> 迁移到 Github 上啦，官方文档 <a href="https://www.rspatial.org/" class="uri">https://www.rspatial.org/</a></p>
<p>星号 * 标记的是 S3 方法</p>
<div class="sourceCode" id="cb2387"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/methods.html">methods</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] plot,ANY,ANY-method                       
##  [2] plot,color,ANY-method                     
##  [3] plot,Extent,missing-method                
##  [4] plot,Raster,ANY-method                    
##  [5] plot,Raster,Raster-method                 
##  [6] plot,SpatExtent,missing-method            
##  [7] plot,Spatial,missing-method               
##  [8] plot,SpatialGrid,missing-method           
##  [9] plot,SpatialGridDataFrame,missing-method  
## [10] plot,SpatialLines,missing-method          
## [11] plot,SpatialMultiPoints,missing-method    
## [12] plot,SpatialPixels,missing-method         
## [13] plot,SpatialPixelsDataFrame,missing-method
## [14] plot,SpatialPoints,missing-method         
## [15] plot,SpatialPolygons,missing-method       
## [16] plot,SpatRaster,missing-method            
## [17] plot,SpatRaster,numeric-method            
## [18] plot,SpatRaster,SpatRaster-method         
## [19] plot,SpatVector,character-method          
## [20] plot,SpatVector,missing-method            
## [21] plot,SpatVector,numeric-method            
## [22] plot.acf*                                 
## [23] plot.bclust*                              
## [24] plot.classIntervals*                      
## [25] plot.data.frame*                          
## [26] plot.decomposed.ts*                       
## [27] plot.default                              
## [28] plot.dendrogram*                          
## [29] plot.density*                             
## [30] plot.ecdf                                 
## [31] plot.factor*                              
## [32] plot.formula*                             
## [33] plot.function                             
## [34] plot.ggplot*                              
## [35] plot.gtable*                              
## [36] plot.hcl_palettes*                        
## [37] plot.hclust*                              
## [38] plot.histogram*                           
## [39] plot.HoltWinters*                         
## [40] plot.ica*                                 
## [41] plot.isoreg*                              
## [42] plot.lm*                                  
## [43] plot.medpolish*                           
## [44] plot.mlm*                                 
## [45] plot.ppr*                                 
## [46] plot.prcomp*                              
## [47] plot.princomp*                            
## [48] plot.profile.nls*                         
## [49] plot.R6*                                  
## [50] plot.raster*                              
## [51] plot.sf*                                  
## [52] plot.sfc_CIRCULARSTRING*                  
## [53] plot.sfc_GEOMETRY*                        
## [54] plot.sfc_GEOMETRYCOLLECTION*              
## [55] plot.sfc_LINESTRING*                      
## [56] plot.sfc_MULTILINESTRING*                 
## [57] plot.sfc_MULTIPOINT*                      
## [58] plot.sfc_MULTIPOLYGON*                    
## [59] plot.sfc_POINT*                           
## [60] plot.sfc_POLYGON*                         
## [61] plot.sfg*                                 
## [62] plot.shingle*                             
## [63] plot.SOM*                                 
## [64] plot.somgrid*                             
## [65] plot.spec*                                
## [66] plot.stars*                               
## [67] plot.stars_proxy*                         
## [68] plot.stepfun                              
## [69] plot.stft*                                
## [70] plot.stl*                                 
## [71] plot.svm*                                 
## [72] plot.table*                               
## [73] plot.trans*                               
## [74] plot.trellis*                             
## [75] plot.ts                                   
## [76] plot.tskernel*                            
## [77] plot.TukeyHSD*                            
## [78] plot.tune*                                
## [79] plot.units*                               
## [80] plot.wk_crc*                              
## [81] plot.wk_rct*                              
## [82] plot.wk_wkb*                              
## [83] plot.wk_wkt*                              
## [84] plot.wk_xy*                               
## see '?methods' for accessing help and source code</code></pre>
<p>查看函数的定义</p>
<div class="sourceCode" id="cb2389"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/getAnywhere.html">getAnywhere</a></span><span class="op">(</span><span class="va">plot.raster</span><span class="op">)</span></code></pre></div>
<pre><code>## A single object matching 'plot.raster' was found
## It was found in the following places
##   registered S3 method for plot from namespace graphics
##   namespace:graphics
## with value
## 
## function (x, y, xlim = c(0, ncol(x)), ylim = c(0, nrow(x)), xaxs = "i", 
##     yaxs = "i", asp = 1, add = FALSE, ...) 
## {
##     if (!add) {
##         plot.new()
##         plot.window(xlim = xlim, ylim = ylim, asp = asp, xaxs = xaxs, 
##             yaxs = yaxs)
##     }
##     rasterImage(x, 0, 0, ncol(x), nrow(x), ...)
## }
## &lt;bytecode: 0x5633fc86f3b0&gt;
## &lt;environment: namespace:graphics&gt;</code></pre>
<p>rasterImage 函数来绘制图像，如果想知道 <code>rasterImage</code> 的内容可以继续看 <code><a href="https://rdrr.io/r/utils/getAnywhere.html">getAnywhere(rasterImage)</a></code></p>
<div class="sourceCode" id="cb2391"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/getAnywhere.html">getAnywhere</a></span><span class="op">(</span><span class="va">rasterImage</span><span class="op">)</span></code></pre></div>
<pre><code>## A single object matching 'rasterImage' was found
## It was found in the following places
##   package:graphics
##   namespace:graphics
## with value
## 
## function (image, xleft, ybottom, xright, ytop, angle = 0, interpolate = TRUE, 
##     ...) 
## {
##     .External.graphics(C_raster, if (inherits(image, "nativeRaster")) image else as.raster(image), 
##         as.double(xleft), as.double(ybottom), as.double(xright), 
##         as.double(ytop), as.double(angle), as.logical(interpolate), 
##         ...)
##     invisible()
## }
## &lt;bytecode: 0x5633fca59f20&gt;
## &lt;environment: namespace:graphics&gt;</code></pre>
<p>通过查看函数的帮助 <code><a href="https://rdrr.io/r/graphics/rasterImage.html">?rasterImage</a></code> ，我们需要重点关注一下
参数 <em>image</em> 传递的 raster 对象</p>
<div class="sourceCode" id="cb2393"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">250</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">450</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"n"</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="va">image</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.raster.html">as.raster</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, ncol <span class="op">=</span> <span class="fl">5</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/rasterImage.html">rasterImage</a></span><span class="op">(</span><span class="va">image</span>, <span class="fl">100</span>, <span class="fl">300</span>, <span class="fl">150</span>, <span class="fl">350</span>, interpolate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/rasterImage.html">rasterImage</a></span><span class="op">(</span><span class="va">image</span>, <span class="fl">100</span>, <span class="fl">400</span>, <span class="fl">150</span>, <span class="fl">450</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/rasterImage.html">rasterImage</a></span><span class="op">(</span><span class="va">image</span>, <span class="fl">200</span>, <span class="fl">300</span>, <span class="fl">200</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/graphics/units.html">xinch</a></span><span class="op">(</span><span class="fl">.5</span><span class="op">)</span>, <span class="fl">300</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/graphics/units.html">yinch</a></span><span class="op">(</span><span class="fl">.3</span><span class="op">)</span>,
  interpolate <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/rasterImage.html">rasterImage</a></span><span class="op">(</span><span class="va">image</span>, <span class="fl">200</span>, <span class="fl">400</span>, <span class="fl">250</span>, <span class="fl">450</span>, 
            angle <span class="op">=</span> <span class="fl">15</span>, interpolate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-13"></span>
<img src="spatial-viz_files/figure-html/unnamed-chunk-13-1.png" alt="raster 图像" width="50%"><p class="caption">
图 34.1: raster 图像
</p>
</div>
<div class="sourceCode" id="cb2394"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster">raster</a></span><span class="op">)</span>
<span class="va">meuse.test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html">raster</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"external/test.grd"</span>, package<span class="op">=</span><span class="st">"raster"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">meuse.test</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "RasterLayer"
## attr(,"package")
## [1] "raster"</code></pre>
<div class="sourceCode" id="cb2396"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">meuse.test</span>, legend <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-15"></span>
<img src="spatial-viz_files/figure-html/unnamed-chunk-15-1.png" alt="raster 对象" width="2100"><p class="caption">
图 10.14: raster 对象
</p>
</div>
</div>
<div id="subsec-stars" class="section level3" number="34.1.5">
<h3>
<span class="header-section-number">34.1.5</span> stars<a class="anchor" aria-label="anchor" href="#subsec-stars"><i class="fas fa-link"></i></a>
</h3>
<p>Edzer Pebesma 开发了 stars 包</p>
<div class="sourceCode" id="cb2397"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># https://resources.rstudio.com/rstudio-conf-2019/spatial-data-science-in-the-tidyverse</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">abind</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/cubelyr">cubelyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/stars/">stars</a></span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/stars/reference/read_stars.html">read_stars</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"tif/L7_ETMs.tif"</span>, package <span class="op">=</span> <span class="st">"stars"</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://r-spatial.github.io/stars/reference/geom_stars.html">geom_stars</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">x</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_equal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">band</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_y_discrete</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="spatial-viz_files/figure-html/unnamed-chunk-16-1.png" width="2100" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="sec-viz-echarts4r" class="section level2" number="34.2">
<h2>
<span class="header-section-number">34.2</span> 可视化<a class="anchor" aria-label="anchor" href="#sec-viz-echarts4r"><i class="fas fa-link"></i></a>
</h2>
<div id="subsec-fiji-quakes" class="section level3" number="34.2.1">
<h3>
<span class="header-section-number">34.2.1</span> 斐济地震带分布<a class="anchor" aria-label="anchor" href="#subsec-fiji-quakes"><i class="fas fa-link"></i></a>
</h3>
<p>相比于 <strong>plotly</strong>，<strong>echarts4r</strong> 更加轻量，这得益于 JavaScript 库 <a href="https://github.com/apache/echarts">Apache ECharts</a>。
前者 MIT 协议，后者采用 Apache-2.0 协议，都可以商用。Apache ECharts 是 Apache 旗下顶级开源项目，由百度前端技术团队贡献，中文文档也比较全，学习起来门槛会低一些。</p>
<div class="sourceCode" id="cb2398"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://echarts4r.john-coene.com/">echarts4r</a></span><span class="op">)</span>
<span class="va">quakes</span> |&gt;
  <span class="fu"><a href="http://echarts4r.john-coene.com/reference/init.html">e_charts</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">long</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="http://echarts4r.john-coene.com/reference/e_geo.html">e_geo</a></span><span class="op">(</span>
    roam <span class="op">=</span> <span class="cn">TRUE</span>,
    boundingCoords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">185</span>, <span class="op">-</span><span class="fl">10</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">165</span>, <span class="op">-</span><span class="fl">40</span><span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span> |&gt;
  <span class="fu"><a href="http://echarts4r.john-coene.com/reference/scatter.html">e_scatter</a></span><span class="op">(</span>
    serie <span class="op">=</span> <span class="va">lat</span>,
    size <span class="op">=</span> <span class="va">mag</span>, <span class="co"># 点的大小映射到震级</span>
    <span class="co"># legend = F, # 是否移除图例</span>
    name <span class="op">=</span> <span class="st">"斐济地震带"</span>,
    coord_system <span class="op">=</span> <span class="st">"geo"</span>
  <span class="op">)</span> |&gt;
  <span class="fu"><a href="http://echarts4r.john-coene.com/reference/e_visual_map.html">e_visual_map</a></span><span class="op">(</span>
    serie <span class="op">=</span> <span class="va">mag</span>, scale <span class="op">=</span> <span class="va">e_scale</span>,
    inRange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">terrain.colors</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span> |&gt;
  <span class="fu"><a href="http://echarts4r.john-coene.com/reference/e-tooltip.html">e_tooltip</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fiji-quakes-echarts4r"></span>
<div id="htmlwidget-46bd6e85adef1452ebaf" style="width:100%;height:500px;" class="echarts4r html-widget"></div>
<script type="application/json" data-for="htmlwidget-46bd6e85adef1452ebaf">{"x":{"theme":"","tl":false,"draw":true,"renderer":"canvas","events":[],"buttons":[],"opts":{"geo":{"map":"world","roam":true,"boundingCoords":[[185,-10],[165,-40]]},"legend":{"data":["斐济地震带"]},"series":[{"data":[{"value":[165.67,-12.85,4.4,4.16666666666667]},{"value":[165.76,-12.08,4.5,4.95833333333333]},{"value":[165.77,-10.78,4.6,5.75]},{"value":[165.8,-11.8,4.2,2.58333333333333]},{"value":[165.8,-10.8,4.2,2.58333333333333]},{"value":[165.96,-13.64,6,16.8333333333333]},{"value":[165.96,-11.76,4.4,4.16666666666667]},{"value":[165.97,-10.96,4.9,8.125]},{"value":[165.98,-11.81,4.7,6.54166666666667]},{"value":[165.99,-10.72,4,1]},{"value":[166,-14.7,5.3,11.2916666666667]},{"value":[166.01,-14.1,4.8,7.33333333333333]},{"value":[166.02,-11.67,4.6,5.75]},{"value":[166.06,-10.79,5,8.91666666666667]},{"value":[166.07,-11.75,4.2,2.58333333333333]},{"value":[166.07,-11.4,5.6,13.6666666666667]},{"value":[166.1,-11.7,4.8,7.33333333333333]},{"value":[166.1,-10.78,4.9,8.125]},{"value":[166.14,-11.63,4.6,5.75]},{"value":[166.18,-11.54,5.4,12.0833333333333]},{"value":[166.2,-11.55,4.3,3.375]},{"value":[166.2,-13.34,4.8,7.33333333333333]},{"value":[166.2,-12,5,8.91666666666667]},{"value":[166.22,-11.49,4.6,5.75]},{"value":[166.24,-11.34,4.6,5.75]},{"value":[166.24,-11.41,5.3,11.2916666666667]},{"value":[166.26,-10.97,4.7,6.54166666666667]},{"value":[166.28,-12.72,4.8,7.33333333333333]},{"value":[166.29,-12.01,4.9,8.125]},{"value":[166.3,-11.7,4.2,2.58333333333333]},{"value":[166.32,-10.98,4.2,2.58333333333333]},{"value":[166.32,-11.77,4.4,4.16666666666667]},{"value":[166.36,-12.49,4.9,8.125]},{"value":[166.36,-11.25,5.1,9.70833333333333]},{"value":[166.37,-12.66,4.3,3.375]},{"value":[166.47,-11.64,4.7,6.54166666666667]},{"value":[166.49,-13.56,4.5,4.95833333333333]},{"value":[166.53,-13.44,4.7,6.54166666666667]},{"value":[166.53,-13.8,5.5,12.875]},{"value":[166.54,-13.66,5.1,9.70833333333333]},{"value":[166.55,-11.37,4.7,6.54166666666667]},{"value":[166.56,-13.79,4.7,6.54166666666667]},{"value":[166.6,-12.25,5,8.91666666666667]},{"value":[166.62,-15.08,4.7,6.54166666666667]},{"value":[166.64,-14.12,5.3,11.2916666666667]},{"value":[166.66,-13.65,4.9,8.125]},{"value":[166.66,-12.01,4.8,7.33333333333333]},{"value":[166.69,-15.96,4.2,2.58333333333333]},{"value":[166.72,-12.57,4.3,3.375]},{"value":[166.74,-16.32,4.7,6.54166666666667]},{"value":[166.75,-13.7,5.3,11.2916666666667]},{"value":[166.78,-12.84,4.9,8.125]},{"value":[166.8,-16.2,4.5,4.95833333333333]},{"value":[166.83,-15.79,4.6,5.75]},{"value":[166.85,-15.86,4.5,4.95833333333333]},{"value":[166.87,-13.07,4.4,4.16666666666667]},{"value":[166.9,-15.29,4.2,2.58333333333333]},{"value":[166.9,-13.4,4.8,7.33333333333333]},{"value":[166.91,-15.71,4.8,7.33333333333333]},{"value":[166.93,-12.37,4.2,2.58333333333333]},{"value":[166.94,-16.28,4.6,5.75]},{"value":[166.97,-14.65,4.8,7.33333333333333]},{"value":[166.98,-15.86,4.8,7.33333333333333]},{"value":[167,-12.26,4.6,5.75]},{"value":[167.01,-13.26,5.1,9.70833333333333]},{"value":[167.01,-15.77,5.5,12.875]},{"value":[167.01,-11.02,4.9,8.125]},{"value":[167.02,-12.23,6,16.8333333333333]},{"value":[167.03,-12.16,4.4,4.16666666666667]},{"value":[167.05,-11.38,4.5,4.95833333333333]},{"value":[167.06,-12.11,4.5,4.95833333333333]},{"value":[167.06,-13.36,4.7,6.54166666666667]},{"value":[167.06,-12.28,4.7,6.54166666666667]},{"value":[167.1,-13.23,5,8.91666666666667]},{"value":[167.1,-12.59,4.9,8.125]},{"value":[167.1,-15.34,5.3,11.2916666666667]},{"value":[167.1,-15.83,4.5,4.95833333333333]},{"value":[167.11,-12.57,4.8,7.33333333333333]},{"value":[167.14,-13.47,4.4,4.16666666666667]},{"value":[167.15,-13.62,4.7,6.54166666666667]},{"value":[167.16,-13.86,4.6,5.75]},{"value":[167.16,-15.9,4.8,7.33333333333333]},{"value":[167.18,-15.44,4.6,5.75]},{"value":[167.18,-13.9,4.2,2.58333333333333]},{"value":[167.23,-15.18,5.2,10.5]},{"value":[167.24,-14.85,4.5,4.95833333333333]},{"value":[167.24,-14.95,4.6,5.75]},{"value":[167.24,-14.57,4.5,4.95833333333333]},{"value":[167.24,-13.16,4.3,3.375]},{"value":[167.25,-16.1,4.7,6.54166666666667]},{"value":[167.26,-14.28,5.1,9.70833333333333]},{"value":[167.26,-14.43,4.4,4.16666666666667]},{"value":[167.26,-14.46,5.2,10.5]},{"value":[167.32,-14.82,4.8,7.33333333333333]},{"value":[167.32,-15.03,4.6,5.75]},{"value":[167.32,-14.3,4.8,7.33333333333333]},{"value":[167.32,-14.86,4.9,8.125]},{"value":[167.33,-14.32,5,8.91666666666667]},{"value":[167.34,-15.95,5.4,12.0833333333333]},{"value":[167.38,-15.43,4.5,4.95833333333333]},{"value":[167.39,-12.05,5,8.91666666666667]},{"value":[167.4,-14.6,4.8,7.33333333333333]},{"value":[167.41,-12.27,4.5,4.95833333333333]},{"value":[167.42,-15.9,5.5,12.875]},{"value":[167.43,-12.34,5.1,9.70833333333333]},{"value":[167.44,-15.78,4.8,7.33333333333333]},{"value":[167.5,-15.61,4.4,4.16666666666667]},{"value":[167.51,-14.72,4.6,5.75]},{"value":[167.51,-15.36,4.7,6.54166666666667]},{"value":[167.53,-15.48,5.1,9.70833333333333]},{"value":[167.54,-16.45,4.6,5.75]},{"value":[167.62,-15.56,6.4,20]},{"value":[167.68,-15.54,4.7,6.54166666666667]},{"value":[167.7,-16.96,4.7,6.54166666666667]},{"value":[167.89,-17.93,5.1,9.70833333333333]},{"value":[167.91,-16.23,4.5,4.95833333333333]},{"value":[167.91,-15.93,5.6,13.6666666666667]},{"value":[167.95,-16.24,5.1,9.70833333333333]},{"value":[167.95,-15.99,5.3,11.2916666666667]},{"value":[168.02,-16.24,4.7,6.54166666666667]},{"value":[168.08,-16.31,4.5,4.95833333333333]},{"value":[168.52,-17.97,4.8,7.33333333333333]},{"value":[168.63,-17.38,4.7,6.54166666666667]},{"value":[168.69,-20.06,5.1,9.70833333333333]},{"value":[168.71,-20.33,4.8,7.33333333333333]},{"value":[168.75,-20.09,4.6,5.75]},{"value":[168.8,-18.73,4.4,4.16666666666667]},{"value":[168.93,-18.54,4.4,4.16666666666667]},{"value":[168.98,-19.52,4.5,4.95833333333333]},{"value":[168.98,-17.99,4.7,6.54166666666667]},{"value":[169.01,-19.06,4.4,4.16666666666667]},{"value":[169.04,-18.49,4.8,7.33333333333333]},{"value":[169.05,-18.56,4.9,8.125]},{"value":[169.09,-12.95,4.5,4.95833333333333]},{"value":[169.1,-18.69,4.2,2.58333333333333]},{"value":[169.14,-20.07,4.8,7.33333333333333]},{"value":[169.15,-19.47,4.4,4.16666666666667]},{"value":[169.21,-18.8,4.4,4.16666666666667]},{"value":[169.23,-18.73,4.5,4.95833333333333]},{"value":[169.24,-18.77,5.3,11.2916666666667]},{"value":[169.28,-13.09,4.4,4.16666666666667]},{"value":[169.31,-18.56,4.7,6.54166666666667]},{"value":[169.32,-18.64,4.6,5.75]},{"value":[169.33,-18.82,4.4,4.16666666666667]},{"value":[169.33,-19.18,4.7,6.54166666666667]},{"value":[169.37,-18.92,5.3,11.2916666666667]},{"value":[169.41,-19.23,4.6,5.75]},{"value":[169.42,-18.89,4.5,4.95833333333333]},{"value":[169.44,-18.97,5,8.91666666666667]},{"value":[169.46,-12.66,4.6,5.75]},{"value":[169.46,-18.91,4.4,4.16666666666667]},{"value":[169.48,-18.96,4.2,2.58333333333333]},{"value":[169.48,-18.89,4.4,4.16666666666667]},{"value":[169.49,-20.24,4.6,5.75]},{"value":[169.5,-19.15,4.2,2.58333333333333]},{"value":[169.5,-19.64,4.6,5.75]},{"value":[169.52,-12.93,4.4,4.16666666666667]},{"value":[169.53,-19.17,4.3,3.375]},{"value":[169.58,-13.05,4.9,8.125]},{"value":[169.63,-12.93,5.1,9.70833333333333]},{"value":[169.63,-19.1,4.8,7.33333333333333]},{"value":[169.66,-20.64,4.9,8.125]},{"value":[169.71,-19.72,4.2,2.58333333333333]},{"value":[169.71,-18.76,4.4,4.16666666666667]},{"value":[169.75,-21.52,5.1,9.70833333333333]},{"value":[169.76,-20.48,4.6,5.75]},{"value":[169.84,-20.9,4.9,8.125]},{"value":[169.9,-21.6,5.2,10.5]},{"value":[169.92,-20.7,6.1,17.625]},{"value":[170.04,-21.35,5,8.91666666666667]},{"value":[170.3,-13.45,5.3,11.2916666666667]},{"value":[170.3,-22.7,4.8,7.33333333333333]},{"value":[170.34,-14.28,4.7,6.54166666666667]},{"value":[170.4,-22.5,4.9,8.125]},{"value":[170.45,-21.44,5.1,9.70833333333333]},{"value":[170.5,-21.5,4.7,6.54166666666667]},{"value":[170.52,-21.53,5.2,10.5]},{"value":[170.56,-22.95,4.7,6.54166666666667]},{"value":[170.56,-21.59,6,16.8333333333333]},{"value":[170.62,-13.84,4.6,5.75]},{"value":[170.7,-23,4.9,8.125]},{"value":[170.99,-22.75,4.8,7.33333333333333]},{"value":[171.17,-14.82,4.7,6.54166666666667]},{"value":[171.39,-14.99,4.3,3.375]},{"value":[171.4,-22.19,5.1,9.70833333333333]},{"value":[171.4,-22.42,4.7,6.54166666666667]},{"value":[171.44,-22.26,4.5,4.95833333333333]},{"value":[171.46,-22.33,4.7,6.54166666666667]},{"value":[171.5,-22.37,4.9,8.125]},{"value":[171.51,-22.33,4.6,5.75]},{"value":[171.52,-22.34,5,8.91666666666667]},{"value":[171.65,-22.36,4.6,5.75]},{"value":[171.66,-22.33,5.2,10.5]},{"value":[171.72,-22.87,4.6,5.75]},{"value":[172.23,-13.66,5.3,11.2916666666667]},{"value":[172.29,-13.47,4.7,6.54166666666667]},{"value":[172.38,-13.82,5,8.91666666666667]},{"value":[172.65,-22.87,5.1,9.70833333333333]},{"value":[172.76,-13.36,4.4,4.16666666666667]},{"value":[172.91,-22.54,5.5,12.875]},{"value":[173.2,-22.75,4.6,5.75]},{"value":[173.49,-21.27,4.9,8.125]},{"value":[173.5,-14.31,4.2,2.58333333333333]},{"value":[174.21,-21.14,5.7,14.4583333333333]},{"value":[174.46,-19.89,5.7,14.4583333333333]},{"value":[175.7,-38.59,4.7,6.54166666666667]},{"value":[176.03,-38.46,4.6,5.75]},{"value":[176.78,-37.37,4.7,6.54166666666667]},{"value":[177.01,-17.64,5.2,10.5]},{"value":[177.1,-38.28,5.4,12.0833333333333]},{"value":[177.47,-37.93,5.4,12.0833333333333]},{"value":[177.52,-37.03,5.6,13.6666666666667]},{"value":[177.77,-16.45,4.6,5.75]},{"value":[177.81,-36.95,5,8.91666666666667]},{"value":[178.29,-26.5,5,8.91666666666667]},{"value":[178.3,-26.11,4.8,7.33333333333333]},{"value":[178.3,-26.53,4.9,8.125]},{"value":[178.31,-26.13,4.2,2.58333333333333]},{"value":[178.35,-26.2,4.4,4.16666666666667]},{"value":[178.4,-24.57,5.6,13.6666666666667]},{"value":[178.41,-26.2,4.6,5.75]},{"value":[178.42,-25.14,4.1,1.79166666666666]},{"value":[178.43,-26,4.9,8.125]},{"value":[178.47,-26.16,4.8,7.33333333333333]},{"value":[178.52,-35.94,5.5,12.875]},{"value":[178.57,-26.53,5,8.91666666666667]},{"value":[178.59,-26.18,5.4,12.0833333333333]},{"value":[178.9,-19.9,4.3,3.375]},{"value":[178.98,-24.39,4.5,4.95833333333333]},{"value":[179.02,-24.18,5.3,11.2916666666667]},{"value":[179.07,-23.49,5.1,9.70833333333333]},{"value":[179.1,-34.63,4.7,6.54166666666667]},{"value":[179.15,-23.11,4.7,6.54166666666667]},{"value":[179.2,-24.2,4.3,3.375]},{"value":[179.22,-24.78,4.3,3.375]},{"value":[179.24,-22.58,4.6,5.75]},{"value":[179.27,-23.31,5.1,9.70833333333333]},{"value":[179.33,-25.82,4.3,3.375]},{"value":[179.36,-23.81,4.2,2.58333333333333]},{"value":[179.43,-34.2,5,8.91666666666667]},{"value":[179.5,-24.08,4.1,1.79166666666666]},{"value":[179.5,-26.16,4.5,4.95833333333333]},{"value":[179.52,-24.34,4.8,7.33333333333333]},{"value":[179.54,-24.97,4.9,8.125]},{"value":[179.54,-25.93,4.4,4.16666666666667]},{"value":[179.59,-17.47,4.3,3.375]},{"value":[179.6,-21.98,5.4,12.0833333333333]},{"value":[179.6,-23.7,4.2,2.58333333333333]},{"value":[179.61,-32.2,4.6,5.75]},{"value":[179.62,-21.96,5,8.91666666666667]},{"value":[179.62,-22.14,4.1,1.79166666666666]},{"value":[179.67,-24.89,4.2,2.58333333333333]},{"value":[179.68,-24.09,4.3,3.375]},{"value":[179.69,-25.31,4.6,5.75]},{"value":[179.7,-23.3,4.7,6.54166666666667]},{"value":[179.71,-22.1,5.1,9.70833333333333]},{"value":[179.77,-22.03,4.8,7.33333333333333]},{"value":[179.78,-23.5,4.4,4.16666666666667]},{"value":[179.79,-26.18,4.7,6.54166666666667]},{"value":[179.8,-32.82,4.7,6.54166666666667]},{"value":[179.82,-24.97,4.4,4.16666666666667]},{"value":[179.82,-34.68,5.6,13.6666666666667]},{"value":[179.84,-25.04,4.6,5.75]},{"value":[179.85,-24.4,4.7,6.54166666666667]},{"value":[179.85,-24.71,4.2,2.58333333333333]},{"value":[179.86,-25.25,4.2,2.58333333333333]},{"value":[179.86,-25.23,4.4,4.16666666666667]},{"value":[179.87,-24.96,4.4,4.16666666666667]},{"value":[179.88,-24.27,4.6,5.75]},{"value":[179.89,-23.79,4.9,8.125]},{"value":[179.9,-35.48,4.8,7.33333333333333]},{"value":[179.9,-23.8,4.1,1.79166666666666]},{"value":[179.9,-32.14,4.3,3.375]},{"value":[179.9,-23.9,4.4,4.16666666666667]},{"value":[179.91,-23.97,4.5,4.95833333333333]},{"value":[179.92,-24.57,4.7,6.54166666666667]},{"value":[179.93,-23.54,4,1]},{"value":[179.95,-23.47,4.1,1.79166666666666]},{"value":[179.96,-23.64,4.5,4.95833333333333]},{"value":[179.97,-24.33,4.8,7.33333333333333]},{"value":[179.97,-23.39,4.6,5.75]},{"value":[179.98,-23.73,4.6,5.75]},{"value":[179.98,-25.46,4.5,4.95833333333333]},{"value":[179.99,-23.74,5.2,10.5]},{"value":[179.99,-23.73,5.1,9.70833333333333]},{"value":[179.99,-23.53,5.4,12.0833333333333]},{"value":[180,-24.81,4.3,3.375]},{"value":[180,-23.43,4.7,6.54166666666667]},{"value":[180,-23.91,4.5,4.95833333333333]},{"value":[180,-25,4.5,4.95833333333333]},{"value":[180,-23.5,4.7,6.54166666666667]},{"value":[180,-32.14,4.5,4.95833333333333]},{"value":[180.01,-23.36,5.3,11.2916666666667]},{"value":[180.02,-25.59,4.9,8.125]},{"value":[180.03,-24.41,4.5,4.95833333333333]},{"value":[180.04,-23.54,4.3,3.375]},{"value":[180.05,-26.06,4.2,2.58333333333333]},{"value":[180.06,-23.49,4,1]},{"value":[180.08,-24.12,4.3,3.375]},{"value":[180.09,-23.46,4.6,5.75]},{"value":[180.09,-23.82,4.8,7.33333333333333]},{"value":[180.1,-30.72,4.4,4.16666666666667]},{"value":[180.1,-25.04,4.3,3.375]},{"value":[180.11,-23.46,5,8.91666666666667]},{"value":[180.12,-23.1,4.4,4.16666666666667]},{"value":[180.13,-30.66,4.7,6.54166666666667]},{"value":[180.13,-23.84,4.5,4.95833333333333]},{"value":[180.13,-23.5,4.8,7.33333333333333]},{"value":[180.15,-25.31,4.5,4.95833333333333]},{"value":[180.15,-23.87,4.4,4.16666666666667]},{"value":[180.16,-23.3,4.4,4.16666666666667]},{"value":[180.16,-23.77,4.5,4.95833333333333]},{"value":[180.17,-23.58,5.3,11.2916666666667]},{"value":[180.17,-23.46,4.6,5.75]},{"value":[180.18,-23.33,5,8.91666666666667]},{"value":[180.18,-23.93,4.6,5.75]},{"value":[180.2,-35.56,4.6,5.75]},{"value":[180.2,-32.22,5.7,14.4583333333333]},{"value":[180.2,-33.03,4.6,5.75]},{"value":[180.21,-34.02,5.2,10.5]},{"value":[180.21,-23.42,4.5,4.95833333333333]},{"value":[180.21,-23.47,4.2,2.58333333333333]},{"value":[180.21,-23.92,4.6,5.75]},{"value":[180.22,-24.96,4.8,7.33333333333333]},{"value":[180.22,-24.03,4.2,2.58333333333333]},{"value":[180.23,-23.61,4.4,4.16666666666667]},{"value":[180.23,-23.56,4.5,4.95833333333333]},{"value":[180.23,-23.45,4.2,2.58333333333333]},{"value":[180.24,-23.47,4.8,7.33333333333333]},{"value":[180.26,-23.33,4.7,6.54166666666667]},{"value":[180.26,-25.63,4.8,7.33333333333333]},{"value":[180.26,-23.85,4.3,3.375]},{"value":[180.27,-23.55,4.3,3.375]},{"value":[180.27,-23.61,5,8.91666666666667]},{"value":[180.28,-19.66,5.4,12.0833333333333]},{"value":[180.28,-22.24,4.2,2.58333333333333]},{"value":[180.3,-23.71,4.6,5.75]},{"value":[180.3,-17.72,5.2,10.5]},{"value":[180.3,-25.6,4,1]},{"value":[180.31,-22.63,4.4,4.16666666666667]},{"value":[180.31,-23.78,5.1,9.70833333333333]},{"value":[180.34,-25.68,4.6,5.75]},{"value":[180.38,-22.09,4.9,8.125]},{"value":[180.38,-22.13,5.7,14.4583333333333]},{"value":[180.38,-24.19,4.3,3.375]},{"value":[180.39,-21.88,4.7,6.54166666666667]},{"value":[180.4,-22.05,4.7,6.54166666666667]},{"value":[180.4,-22.1,4.1,1.79166666666666]},{"value":[180.47,-22.06,4.6,5.75]},{"value":[180.48,-22.23,5,8.91666666666667]},{"value":[180.49,-22.16,4.6,5.75]},{"value":[180.49,-22.12,4,1]},{"value":[180.5,-17.98,4.1,1.79166666666666]},{"value":[180.5,-34.4,4.4,4.16666666666667]},{"value":[180.5,-21.6,4,1]},{"value":[180.52,-22,4.5,4.95833333333333]},{"value":[180.53,-22,4.9,8.125]},{"value":[180.54,-21.96,5.2,10.5]},{"value":[180.54,-22.32,4.2,2.58333333333333]},{"value":[180.57,-31.94,4.7,6.54166666666667]},{"value":[180.58,-17.88,4.2,2.58333333333333]},{"value":[180.58,-22.09,4.4,4.16666666666667]},{"value":[180.58,-22.2,4.5,4.95833333333333]},{"value":[180.6,-22.06,4,1]},{"value":[180.6,-34.89,4.4,4.16666666666667]},{"value":[180.6,-31.24,4.4,4.16666666666667]},{"value":[180.6,-19.3,4.2,2.58333333333333]},{"value":[180.6,-17.94,4.5,4.95833333333333]},{"value":[180.6,-31.8,4.5,4.95833333333333]},{"value":[180.62,-30.28,4.7,6.54166666666667]},{"value":[180.62,-18,5,8.91666666666667]},{"value":[180.63,-21.68,5,8.91666666666667]},{"value":[180.63,-18.18,4.6,5.75]},{"value":[180.64,-22.64,5,8.91666666666667]},{"value":[180.64,-22.14,4.5,4.95833333333333]},{"value":[180.67,-21.37,4.3,3.375]},{"value":[180.67,-21.75,4.6,5.75]},{"value":[180.68,-21.39,4.5,4.95833333333333]},{"value":[180.69,-21.44,4.4,4.16666666666667]},{"value":[180.69,-21.33,4.6,5.75]},{"value":[180.7,-18.08,5.2,10.5]},{"value":[180.7,-20.74,4.4,4.16666666666667]},{"value":[180.74,-21.4,4.2,2.58333333333333]},{"value":[180.77,-21.63,4.3,3.375]},{"value":[180.78,-21.03,4,1]},{"value":[180.78,-21.4,4.7,6.54166666666667]},{"value":[180.79,-16.46,5.2,10.5]},{"value":[180.8,-23.55,4,1]},{"value":[180.8,-33.57,4.7,6.54166666666667]},{"value":[180.8,-30.01,4.8,7.33333333333333]},{"value":[180.8,-30.3,4,1]},{"value":[180.81,-24.64,4.3,3.375]},{"value":[180.81,-21.24,4.6,5.75]},{"value":[180.82,-21.3,4.3,3.375]},{"value":[180.84,-21.31,4.5,4.95833333333333]},{"value":[180.85,-21.29,4.5,4.95833333333333]},{"value":[180.85,-21.08,5.9,16.0416666666667]},{"value":[180.86,-18.05,4.4,4.16666666666667]},{"value":[180.86,-21.24,4.9,8.125]},{"value":[180.87,-18.14,5.5,12.875]},{"value":[180.87,-18.21,5.2,10.5]},{"value":[180.88,-20.32,4.2,2.58333333333333]},{"value":[180.89,-21.85,4.6,5.75]},{"value":[180.9,-20.2,4.1,1.79166666666666]},{"value":[180.9,-32.6,4.7,6.54166666666667]},{"value":[180.9,-21.05,4.3,3.375]},{"value":[180.9,-30.63,4.2,2.58333333333333]},{"value":[180.92,-24.5,4.8,7.33333333333333]},{"value":[180.92,-21.3,4.5,4.95833333333333]},{"value":[180.92,-21.18,4.5,4.95833333333333]},{"value":[180.94,-19.4,4.7,6.54166666666667]},{"value":[180.94,-25.48,4.6,5.75]},{"value":[180.94,-33.09,4.9,8.125]},{"value":[180.96,-17.47,4.2,2.58333333333333]},{"value":[180.97,-25.04,4.2,2.58333333333333]},{"value":[180.98,-27.23,4.5,4.95833333333333]},{"value":[180.98,-17.59,5.1,9.70833333333333]},{"value":[180.98,-18.26,4.8,7.33333333333333]},{"value":[180.99,-23.84,4.5,4.95833333333333]},{"value":[181,-22.7,4.5,4.95833333333333]},{"value":[181,-21.77,4.1,1.79166666666666]},{"value":[181.01,-20.83,4.3,3.375]},{"value":[181.02,-17.4,4.4,4.16666666666667]},{"value":[181.02,-21.46,4.2,2.58333333333333]},{"value":[181.02,-20.99,4.5,4.95833333333333]},{"value":[181.03,-20.62,4.2,2.58333333333333]},{"value":[181.03,-17.32,4.1,1.79166666666666]},{"value":[181.04,-18.44,4.2,2.58333333333333]},{"value":[181.06,-20.95,4.3,3.375]},{"value":[181.06,-21.14,4.5,4.95833333333333]},{"value":[181.09,-17.59,5.1,9.70833333333333]},{"value":[181.09,-21.23,4.6,5.75]},{"value":[181.11,-28.98,5.3,11.2916666666667]},{"value":[181.11,-27.24,4.5,4.95833333333333]},{"value":[181.11,-17.68,4.4,4.16666666666667]},{"value":[181.13,-21.07,4.9,8.125]},{"value":[181.15,-32.45,5.5,12.875]},{"value":[181.15,-30.01,4.3,3.375]},{"value":[181.16,-20.84,4.5,4.95833333333333]},{"value":[181.16,-29.9,5.1,9.70833333333333]},{"value":[181.16,-20.77,4.2,2.58333333333333]},{"value":[181.17,-25.28,4.3,3.375]},{"value":[181.18,-17.71,5.2,10.5]},{"value":[181.19,-20.36,4.2,2.58333333333333]},{"value":[181.2,-30.64,4,1]},{"value":[181.2,-21.04,4.2,2.58333333333333]},{"value":[181.2,-21.04,4.9,8.125]},{"value":[181.2,-17.61,4.1,1.79166666666666]},{"value":[181.2,-30.04,4.8,7.33333333333333]},{"value":[181.2,-26.02,4.7,6.54166666666667]},{"value":[181.2,-17.8,4,1]},{"value":[181.2,-20.97,4.5,4.95833333333333]},{"value":[181.21,-32.42,4.9,8.125]},{"value":[181.22,-17.05,4.2,2.58333333333333]},{"value":[181.23,-17.7,4.4,4.16666666666667]},{"value":[181.23,-17.56,4.1,1.79166666666666]},{"value":[181.24,-20.58,4.7,6.54166666666667]},{"value":[181.24,-18.89,4.1,1.79166666666666]},{"value":[181.25,-20.89,4.6,5.75]},{"value":[181.25,-17.74,4.1,1.79166666666666]},{"value":[181.26,-20.94,4.4,4.16666666666667]},{"value":[181.27,-17.82,4,1]},{"value":[181.28,-17.64,4.6,5.75]},{"value":[181.28,-21.91,4.5,4.95833333333333]},{"value":[181.3,-17.84,5.7,14.4583333333333]},{"value":[181.3,-17.9,4.1,1.79166666666666]},{"value":[181.3,-33.29,4.7,6.54166666666667]},{"value":[181.3,-30.51,4.4,4.16666666666667]},{"value":[181.3,-21.08,4.9,8.125]},{"value":[181.3,-17.86,4,1]},{"value":[181.31,-17.7,4.7,6.54166666666667]},{"value":[181.31,-17.74,4.6,5.75]},{"value":[181.32,-20.65,4.7,6.54166666666667]},{"value":[181.32,-17.46,4.1,1.79166666666666]},{"value":[181.32,-17.79,5,8.91666666666667]},{"value":[181.32,-17.8,4.1,1.79166666666666]},{"value":[181.33,-20.57,4.3,3.375]},{"value":[181.33,-17.44,4.2,2.58333333333333]},{"value":[181.35,-17.8,4.4,4.16666666666667]},{"value":[181.36,-17.68,4.1,1.79166666666666]},{"value":[181.37,-22.85,4.2,2.58333333333333]},{"value":[181.37,-17.95,4,1]},{"value":[181.38,-17.8,5.1,9.70833333333333]},{"value":[181.38,-21.09,4.6,5.75]},{"value":[181.38,-20.48,4.2,2.58333333333333]},{"value":[181.39,-21.38,4.6,5.75]},{"value":[181.39,-21.55,5.1,9.70833333333333]},{"value":[181.4,-17.66,4.1,1.79166666666666]},{"value":[181.4,-20.65,4,1]},{"value":[181.4,-17.44,4.6,5.75]},{"value":[181.4,-19.77,5.1,9.70833333333333]},{"value":[181.4,-30.4,4.3,3.375]},{"value":[181.4,-17.96,4.3,3.375]},{"value":[181.4,-20.3,4.6,5.75]},{"value":[181.4,-21.2,4.2,2.58333333333333]},{"value":[181.41,-20.68,4.9,8.125]},{"value":[181.41,-19.76,4.4,4.16666666666667]},{"value":[181.41,-21.34,4.5,4.95833333333333]},{"value":[181.41,-21.16,4.3,3.375]},{"value":[181.41,-20.72,4.6,5.75]},{"value":[181.41,-17.9,4.5,4.95833333333333]},{"value":[181.42,-17.72,5.3,11.2916666666667]},{"value":[181.42,-20.95,4.6,5.75]},{"value":[181.42,-17.46,4.2,2.58333333333333]},{"value":[181.42,-20.73,4.3,3.375]},{"value":[181.42,-15.45,4.3,3.375]},{"value":[181.43,-29.91,4.4,4.16666666666667]},{"value":[181.44,-17.85,5.6,13.6666666666667]},{"value":[181.47,-20.97,4.5,4.95833333333333]},{"value":[181.47,-17.88,4.4,4.16666666666667]},{"value":[181.48,-17.84,4.1,1.79166666666666]},{"value":[181.48,-17.91,4,1]},{"value":[181.48,-17.97,4.7,6.54166666666667]},{"value":[181.49,-17.94,4,1]},{"value":[181.49,-18.48,5,8.91666666666667]},{"value":[181.49,-17.82,4.2,2.58333333333333]},{"value":[181.5,-17.83,4.5,4.95833333333333]},{"value":[181.5,-17.9,4,1]},{"value":[181.5,-20.92,4.6,5.75]},{"value":[181.5,-32.62,4.8,7.33333333333333]},{"value":[181.5,-17.95,4.3,3.375]},{"value":[181.5,-21.11,5.5,12.875]},{"value":[181.5,-17.6,4.1,1.79166666666666]},{"value":[181.5,-17.9,4,1]},{"value":[181.51,-20.9,4.7,6.54166666666667]},{"value":[181.51,-17.94,4,1]},{"value":[181.51,-17.98,5.2,10.5]},{"value":[181.51,-21.22,4.8,7.33333333333333]},{"value":[181.51,-20.27,4.4,4.16666666666667]},{"value":[181.52,-18.13,4.6,5.75]},{"value":[181.53,-17.78,4.8,7.33333333333333]},{"value":[181.53,-20.74,4.5,4.95833333333333]},{"value":[181.54,-18.07,4.3,3.375]},{"value":[181.54,-20.93,5,8.91666666666667]},{"value":[181.55,-20.69,4.7,6.54166666666667]},{"value":[181.57,-18.07,4.5,4.95833333333333]},{"value":[181.57,-17.99,4.9,8.125]},{"value":[181.57,-18.04,5,8.91666666666667]},{"value":[181.57,-20.91,4.2,2.58333333333333]},{"value":[181.58,-20.94,4.3,3.375]},{"value":[181.58,-17.98,4.2,2.58333333333333]},{"value":[181.58,-18.07,5,8.91666666666667]},{"value":[181.58,-21.19,5,8.91666666666667]},{"value":[181.59,-20.85,5.1,9.70833333333333]},{"value":[181.59,-18.06,4.5,4.95833333333333]},{"value":[181.59,-17.56,4.6,5.75]},{"value":[181.59,-31.03,5.2,10.5]},{"value":[181.59,-17.99,4.1,1.79166666666666]},{"value":[181.6,-20.14,4.1,1.79166666666666]},{"value":[181.6,-33,4.7,6.54166666666667]},{"value":[181.6,-18.2,4.4,4.16666666666667]},{"value":[181.6,-33.2,4.2,2.58333333333333]},{"value":[181.6,-32.9,4.6,5.75]},{"value":[181.61,-20.63,4.6,5.75]},{"value":[181.61,-17.98,4.3,3.375]},{"value":[181.62,-20.42,4.8,7.33333333333333]},{"value":[181.62,-17.99,4.8,7.33333333333333]},{"value":[181.62,-20.18,4.5,4.95833333333333]},{"value":[181.62,-17.93,4.5,4.95833333333333]},{"value":[181.63,-30.24,4.5,4.95833333333333]},{"value":[181.63,-18.11,4.3,3.375]},{"value":[181.63,-18.1,4.4,4.16666666666667]},{"value":[181.65,-17.95,4.3,3.375]},{"value":[181.65,-18.07,4.1,1.79166666666666]},{"value":[181.66,-17.97,4.1,1.79166666666666]},{"value":[181.66,-21,4.4,4.16666666666667]},{"value":[181.66,-28.83,5.1,9.70833333333333]},{"value":[181.66,-20.54,4.9,8.125]},{"value":[181.67,-18.11,4.6,5.75]},{"value":[181.67,-20.82,5,8.91666666666667]},{"value":[181.69,-20.32,4.5,4.95833333333333]},{"value":[181.69,-20.49,4.5,4.95833333333333]},{"value":[181.69,-21.26,4.4,4.16666666666667]},{"value":[181.7,-26.4,4.5,4.95833333333333]},{"value":[181.7,-17.7,4,1]},{"value":[181.7,-27.72,4.8,7.33333333333333]},{"value":[181.7,-27.38,4.8,7.33333333333333]},{"value":[181.7,-32.7,4.4,4.16666666666667]},{"value":[181.7,-20.87,4.2,2.58333333333333]},{"value":[181.71,-21.81,4.2,2.58333333333333]},{"value":[181.71,-28.25,4.1,1.79166666666666]},{"value":[181.71,-18.12,4.6,5.75]},{"value":[181.71,-18.14,4,1]},{"value":[181.72,-20.97,4.3,3.375]},{"value":[181.72,-18.1,4.6,5.75]},{"value":[181.73,-17.95,4.7,6.54166666666667]},{"value":[181.74,-28.74,4.7,6.54166666666667]},{"value":[181.74,-20.41,4.3,3.375]},{"value":[181.74,-18.19,4.3,3.375]},{"value":[181.75,-18.04,4.5,4.95833333333333]},{"value":[181.75,-34.12,4.7,6.54166666666667]},{"value":[181.75,-20.07,4.7,6.54166666666667]},{"value":[181.77,-18.4,4.1,1.79166666666666]},{"value":[181.8,-34.1,4.3,3.375]},{"value":[181.82,-17.81,4.1,1.79166666666666]},{"value":[181.83,-17.82,4.3,3.375]},{"value":[181.84,-18.04,4.2,2.58333333333333]},{"value":[181.85,-20.45,4.1,1.79166666666666]},{"value":[181.85,-19.85,4.9,8.125]},{"value":[181.86,-20.42,4.5,4.95833333333333]},{"value":[181.87,-20.04,4.7,6.54166666666667]},{"value":[181.87,-19.6,4.2,2.58333333333333]},{"value":[181.88,-18.12,5.4,12.0833333333333]},{"value":[181.89,-17.93,4.1,1.79166666666666]},{"value":[181.9,-22.3,4.3,3.375]},{"value":[181.9,-17.46,4.2,2.58333333333333]},{"value":[181.9,-20.9,4.4,4.16666666666667]},{"value":[181.9,-21.58,4.4,4.16666666666667]},{"value":[181.9,-20.21,4.1,1.79166666666666]},{"value":[181.91,-18.6,5.4,12.0833333333333]},{"value":[181.91,-19.61,4.6,5.75]},{"value":[181.93,-28.11,4.4,4.16666666666667]},{"value":[181.96,-20.42,4,1]},{"value":[181.96,-27.98,5.2,10.5]},{"value":[181.98,-18.17,4.8,7.33333333333333]},{"value":[181.99,-20.16,4.2,2.58333333333333]},{"value":[182,-30.2,4.7,6.54166666666667]},{"value":[182,-17.87,4.6,5.75]},{"value":[182,-28,4,1]},{"value":[182.01,-20.04,5.1,9.70833333333333]},{"value":[182.02,-20.64,5.2,10.5]},{"value":[182.02,-30.17,5.5,12.875]},{"value":[182.02,-20.9,4.3,3.375]},{"value":[182.04,-19.83,4.4,4.16666666666667]},{"value":[182.04,-20.56,4.5,4.95833333333333]},{"value":[182.04,-18.18,4.4,4.16666666666667]},{"value":[182.1,-20.37,4.2,2.58333333333333]},{"value":[182.1,-29.1,4.4,4.16666666666667]},{"value":[182.1,-25.8,4.5,4.95833333333333]},{"value":[182.1,-30.69,4.9,8.125]},{"value":[182.1,-27.6,4.6,5.75]},{"value":[182.1,-20.45,4.5,4.95833333333333]},{"value":[182.1,-27.84,4.8,7.33333333333333]},{"value":[182.11,-18.54,4.4,4.16666666666667]},{"value":[182.12,-26,5.6,13.6666666666667]},{"value":[182.13,-19.85,4.4,4.16666666666667]},{"value":[182.16,-20.1,4.2,2.58333333333333]},{"value":[182.16,-30.8,4.7,6.54166666666667]},{"value":[182.18,-19.67,4.3,3.375]},{"value":[182.18,-27.18,4.5,4.95833333333333]},{"value":[182.18,-27.19,5.4,12.0833333333333]},{"value":[182.18,-27.1,4.7,6.54166666666667]},{"value":[182.2,-17.7,4,1]},{"value":[182.2,-18.85,4.2,2.58333333333333]},{"value":[182.21,-18.82,5.6,13.6666666666667]},{"value":[182.22,-20.65,4.3,3.375]},{"value":[182.22,-27.64,5.1,9.70833333333333]},{"value":[182.23,-18.55,4,1]},{"value":[182.25,-28.1,4.6,5.75]},{"value":[182.26,-27.75,4.5,4.95833333333333]},{"value":[182.26,-18.83,4.3,3.375]},{"value":[182.28,-20.6,5,8.91666666666667]},{"value":[182.28,-27.22,4.2,2.58333333333333]},{"value":[182.29,-15.03,4.1,1.79166666666666]},{"value":[182.29,-19.4,4.1,1.79166666666666]},{"value":[182.3,-30.1,4.9,8.125]},{"value":[182.3,-20.2,4.2,2.58333333333333]},{"value":[182.3,-26.1,4.4,4.16666666666667]},{"value":[182.3,-20.51,4.3,3.375]},{"value":[182.3,-20.3,4.5,4.95833333333333]},{"value":[182.3,-19.41,4.2,2.58333333333333]},{"value":[182.3,-19.19,4.9,8.125]},{"value":[182.31,-16.85,4.2,2.58333333333333]},{"value":[182.31,-29.5,4.4,4.16666666666667]},{"value":[182.32,-21.97,4.3,3.375]},{"value":[182.32,-18.98,4.2,2.58333333333333]},{"value":[182.35,-18.75,4.2,2.58333333333333]},{"value":[182.36,-27.27,4.7,6.54166666666667]},{"value":[182.37,-19.84,4.4,4.16666666666667]},{"value":[182.37,-20.21,4.6,5.75]},{"value":[182.37,-20.43,5.1,9.70833333333333]},{"value":[182.37,-18.48,4.8,7.33333333333333]},{"value":[182.38,-19.57,4.6,5.75]},{"value":[182.38,-27.27,4.5,4.95833333333333]},{"value":[182.38,-25.79,4.4,4.16666666666667]},{"value":[182.39,-18.31,4.2,2.58333333333333]},{"value":[182.39,-27.2,4.3,3.375]},{"value":[182.39,-27.38,4.5,4.95833333333333]},{"value":[182.39,-23.89,4.7,6.54166666666667]},{"value":[182.39,-28.05,5.1,9.70833333333333]},{"value":[182.39,-19.94,4.6,5.75]},{"value":[182.4,-21.16,4.1,1.79166666666666]},{"value":[182.4,-19.73,4,1]},{"value":[182.4,-26.67,4.2,2.58333333333333]},{"value":[182.4,-27.6,4.6,5.75]},{"value":[182.4,-33,4.6,5.75]},{"value":[182.4,-30.09,4.4,4.16666666666667]},{"value":[182.4,-21.62,4,1]},{"value":[182.4,-30.39,4.6,5.75]},{"value":[182.41,-17.02,4.5,4.95833333333333]},{"value":[182.41,-18.8,5.2,10.5]},{"value":[182.43,-19.22,4.5,4.95833333333333]},{"value":[182.43,-27.21,4.6,5.75]},{"value":[182.43,-18.94,4.3,3.375]},{"value":[182.44,-20.61,4.2,2.58333333333333]},{"value":[182.44,-21.48,4.3,3.375]},{"value":[182.44,-19.7,4,1]},{"value":[182.45,-19.06,4,1]},{"value":[182.47,-27.71,4.3,3.375]},{"value":[182.5,-27.27,4.5,4.95833333333333]},{"value":[182.5,-27.54,4.3,3.375]},{"value":[182.5,-26.46,4.3,3.375]},{"value":[182.5,-26.1,4.2,2.58333333333333]},{"value":[182.51,-19.13,5.2,10.5]},{"value":[182.51,-15.83,4.2,2.58333333333333]},{"value":[182.53,-23.85,4.6,5.75]},{"value":[182.53,-23.73,5,8.91666666666667]},{"value":[182.53,-27.18,4.6,5.75]},{"value":[182.54,-19.83,4.6,5.75]},{"value":[182.54,-19.22,4.1,1.79166666666666]},{"value":[182.54,-25.81,4.7,6.54166666666667]},{"value":[182.56,-23.83,4.3,3.375]},{"value":[182.6,-25.2,4.9,8.125]},{"value":[182.6,-27.33,4.4,4.16666666666667]},{"value":[182.6,-20.61,4.6,5.75]},{"value":[182.61,-28.96,4.6,5.75]},{"value":[182.62,-19.34,4.5,4.95833333333333]},{"value":[182.64,-18.51,5.2,10.5]},{"value":[182.65,-25.42,5,8.91666666666667]},{"value":[182.68,-28.23,4.4,4.16666666666667]},{"value":[182.68,-17.1,5.5,12.875]},{"value":[182.69,-26.72,5.2,10.5]},{"value":[182.72,-29.33,5.4,12.0833333333333]},{"value":[182.73,-16.4,4,1]},{"value":[182.74,-20.08,4.5,4.95833333333333]},{"value":[182.75,-24,4.5,4.95833333333333]},{"value":[182.77,-26.6,4.5,4.95833333333333]},{"value":[182.78,-19.28,4.5,4.95833333333333]},{"value":[182.8,-23.95,4.6,5.75]},{"value":[182.8,-23.19,4.3,3.375]},{"value":[182.8,-21.92,5.3,11.2916666666667]},{"value":[182.8,-17.1,4,1]},{"value":[182.8,-25.06,4,1]},{"value":[182.82,-16,4.4,4.16666666666667]},{"value":[182.82,-25.5,5,8.91666666666667]},{"value":[182.84,-24.36,4.1,1.79166666666666]},{"value":[182.85,-24.97,4.8,7.33333333333333]},{"value":[182.9,-21.55,4.2,2.58333333333333]},{"value":[182.9,-17.2,4.1,1.79166666666666]},{"value":[182.92,-27.89,5.5,12.875]},{"value":[182.93,-23.44,4.1,1.79166666666666]},{"value":[182.93,-27.63,4.3,3.375]},{"value":[182.93,-17.02,4,1]},{"value":[183,-20.3,4.2,2.58333333333333]},{"value":[183,-19.3,5,8.91666666666667]},{"value":[183,-23.73,4.3,3.375]},{"value":[183.05,-19.41,4.2,2.58333333333333]},{"value":[183.11,-21.78,4.6,5.75]},{"value":[183.13,-15.26,4.4,4.16666666666667]},{"value":[183.2,-18.3,4.5,4.95833333333333]},{"value":[183.2,-21.8,4.4,4.16666666666667]},{"value":[183.2,-29.09,4.6,5.75]},{"value":[183.2,-21,4,1]},{"value":[183.22,-20.08,4.3,3.375]},{"value":[183.23,-21.56,4.4,4.16666666666667]},{"value":[183.3,-22.7,4,1]},{"value":[183.32,-17.61,4.2,2.58333333333333]},{"value":[183.33,-24.68,4.7,6.54166666666667]},{"value":[183.34,-22.55,4.6,5.75]},{"value":[183.35,-26.72,4.5,4.95833333333333]},{"value":[183.4,-20.12,4.3,3.375]},{"value":[183.4,-18.4,4.1,1.79166666666666]},{"value":[183.4,-23.58,5.2,10.5]},{"value":[183.4,-27.28,5.1,9.70833333333333]},{"value":[183.4,-28.15,5,8.91666666666667]},{"value":[183.4,-27.87,4.7,6.54166666666667]},{"value":[183.41,-18.16,5.2,10.5]},{"value":[183.44,-27.08,4.7,6.54166666666667]},{"value":[183.45,-23.08,4.7,6.54166666666667]},{"value":[183.47,-28.56,4.8,7.33333333333333]},{"value":[183.48,-21.79,5.2,10.5]},{"value":[183.5,-19.44,4.2,2.58333333333333]},{"value":[183.5,-24.6,4.3,3.375]},{"value":[183.5,-28.1,4.4,4.16666666666667]},{"value":[183.5,-27.99,4.3,3.375]},{"value":[183.51,-19.19,4.3,3.375]},{"value":[183.52,-22.28,4.7,6.54166666666667]},{"value":[183.54,-16.04,4.2,2.58333333333333]},{"value":[183.58,-21.71,4.7,6.54166666666667]},{"value":[183.59,-16.23,4.7,6.54166666666667]},{"value":[183.59,-28.56,4.4,4.16666666666667]},{"value":[183.6,-21.8,4.4,4.16666666666667]},{"value":[183.6,-28.22,4.9,8.125]},{"value":[183.61,-26.78,4.6,5.75]},{"value":[183.63,-26.54,4.7,6.54166666666667]},{"value":[183.68,-18.2,4.8,7.33333333333333]},{"value":[183.68,-27.17,4.8,7.33333333333333]},{"value":[183.71,-20.77,4.4,4.16666666666667]},{"value":[183.78,-21.48,4.9,8.125]},{"value":[183.78,-21.07,4.3,3.375]},{"value":[183.8,-22.9,4.3,3.375]},{"value":[183.81,-22.55,5.1,9.70833333333333]},{"value":[183.81,-21.06,4.5,4.95833333333333]},{"value":[183.83,-20.21,4.4,4.16666666666667]},{"value":[183.84,-19.3,4.2,2.58333333333333]},{"value":[183.84,-19.89,5.3,11.2916666666667]},{"value":[183.84,-19.6,4.5,4.95833333333333]},{"value":[183.86,-21.57,5.1,9.70833333333333]},{"value":[183.86,-20.05,4.9,8.125]},{"value":[183.87,-19.1,5.3,11.2916666666667]},{"value":[183.88,-27,4.9,8.125]},{"value":[183.91,-19.92,4.2,2.58333333333333]},{"value":[183.95,-22.91,5.9,16.0416666666667]},{"value":[183.95,-22.06,4.5,4.95833333333333]},{"value":[183.95,-22.04,5.4,12.0833333333333]},{"value":[183.97,-19.51,4,1]},{"value":[183.99,-22.41,5.2,10.5]},{"value":[183.99,-23.6,5.4,12.0833333333333]},{"value":[184,-23.29,4.8,7.33333333333333]},{"value":[184.03,-23.07,4.7,6.54166666666667]},{"value":[184.06,-20.31,4.4,4.16666666666667]},{"value":[184.08,-19.89,5.4,12.0833333333333]},{"value":[184.09,-20.02,5.3,11.2916666666667]},{"value":[184.1,-26,5.4,12.0833333333333]},{"value":[184.1,-16.17,4.3,3.375]},{"value":[184.13,-23.7,4.8,7.33333333333333]},{"value":[184.14,-19.68,4.8,7.33333333333333]},{"value":[184.16,-18.84,4.2,2.58333333333333]},{"value":[184.2,-26.17,4.9,8.125]},{"value":[184.2,-20.13,4.5,4.95833333333333]},{"value":[184.23,-19.02,5.1,9.70833333333333]},{"value":[184.23,-19.69,4.1,1.79166666666666]},{"value":[184.24,-15.02,4.6,5.75]},{"value":[184.27,-20.16,4.4,4.16666666666667]},{"value":[184.28,-20.9,5.5,12.875]},{"value":[184.28,-18.6,4.4,4.16666666666667]},{"value":[184.3,-19.88,4.4,4.16666666666667]},{"value":[184.3,-20.7,4.3,3.375]},{"value":[184.31,-19.68,4,1]},{"value":[184.31,-19.66,4.3,3.375]},{"value":[184.35,-19.86,4.5,4.95833333333333]},{"value":[184.36,-19.14,4.7,6.54166666666667]},{"value":[184.37,-19.2,4.2,2.58333333333333]},{"value":[184.4,-20.1,4.2,2.58333333333333]},{"value":[184.41,-20.56,5,8.91666666666667]},{"value":[184.42,-19.26,4,1]},{"value":[184.42,-23.12,4.2,2.58333333333333]},{"value":[184.46,-18.89,4.8,7.33333333333333]},{"value":[184.46,-23.65,4.2,2.58333333333333]},{"value":[184.47,-23.92,4.7,6.54166666666667]},{"value":[184.47,-19.57,4.2,2.58333333333333]},{"value":[184.48,-22.43,4.9,8.125]},{"value":[184.48,-19.45,4.3,3.375]},{"value":[184.49,-23.73,4.7,6.54166666666667]},{"value":[184.5,-23.34,5.7,14.4583333333333]},{"value":[184.5,-15.7,4.4,4.16666666666667]},{"value":[184.5,-18.68,4.5,4.95833333333333]},{"value":[184.5,-23.75,5.2,10.5]},{"value":[184.5,-24.1,4.7,6.54166666666667]},{"value":[184.51,-19.85,4.4,4.16666666666667]},{"value":[184.52,-20.75,4.3,3.375]},{"value":[184.52,-19.1,4.1,1.79166666666666]},{"value":[184.52,-22.82,5,8.91666666666667]},{"value":[184.53,-19.6,4.3,3.375]},{"value":[184.53,-16,4.7,6.54166666666667]},{"value":[184.56,-22.24,4.8,7.33333333333333]},{"value":[184.6,-23.28,4.8,7.33333333333333]},{"value":[184.6,-23.44,4.8,7.33333333333333]},{"value":[184.6,-23.9,4.5,4.95833333333333]},{"value":[184.61,-23.28,4.7,6.54166666666667]},{"value":[184.62,-15,5.1,9.70833333333333]},{"value":[184.64,-23.95,5.4,12.0833333333333]},{"value":[184.68,-15.2,4.1,1.79166666666666]},{"value":[184.68,-17.95,4.4,4.16666666666667]},{"value":[184.68,-21.05,4.7,6.54166666666667]},{"value":[184.68,-23.3,4.9,8.125]},{"value":[184.7,-19.21,4.1,1.79166666666666]},{"value":[184.7,-20.81,4.3,3.375]},{"value":[184.7,-23.8,5,8.91666666666667]},{"value":[184.75,-20.25,5.6,13.6666666666667]},{"value":[184.8,-23.2,4.5,4.95833333333333]},{"value":[184.83,-15.85,4.4,4.16666666666667]},{"value":[184.84,-18.4,4.2,2.58333333333333]},{"value":[184.85,-24.04,5,8.91666666666667]},{"value":[184.87,-14.85,4.1,1.79166666666666]},{"value":[184.89,-16.09,4.6,5.75]},{"value":[184.9,-23.5,4.7,6.54166666666667]},{"value":[184.91,-22.04,4.9,8.125]},{"value":[184.93,-17.1,4.7,6.54166666666667]},{"value":[184.95,-15.94,4.3,3.375]},{"value":[184.95,-20.88,4.9,8.125]},{"value":[184.97,-19.13,4.1,1.79166666666666]},{"value":[185,-17.7,4,1]},{"value":[185,-21.79,4.1,1.79166666666666]},{"value":[185.01,-20.81,4.7,6.54166666666667]},{"value":[185.05,-15.55,4.8,7.33333333333333]},{"value":[185.1,-20.24,5.1,9.70833333333333]},{"value":[185.1,-15.39,4.5,4.95833333333333]},{"value":[185.1,-15.7,4.1,1.79166666666666]},{"value":[185.11,-15.24,4.9,8.125]},{"value":[185.13,-15.85,4.6,5.75]},{"value":[185.13,-17.63,4.5,4.95833333333333]},{"value":[185.16,-17.42,4.5,4.95833333333333]},{"value":[185.17,-17.8,4.4,4.16666666666667]},{"value":[185.17,-15.65,4.1,1.79166666666666]},{"value":[185.18,-20.88,4.6,5.75]},{"value":[185.19,-15.43,4,1]},{"value":[185.2,-21.5,4.4,4.16666666666667]},{"value":[185.2,-19.6,4.4,4.16666666666667]},{"value":[185.23,-15.75,4.5,4.95833333333333]},{"value":[185.23,-15.67,4.4,4.16666666666667]},{"value":[185.25,-18.97,5.1,9.70833333333333]},{"value":[185.25,-15.8,4.4,4.16666666666667]},{"value":[185.26,-15.44,4.2,2.58333333333333]},{"value":[185.26,-20.89,5.1,9.70833333333333]},{"value":[185.27,-18.35,4.7,6.54166666666667]},{"value":[185.3,-15.9,4.4,4.16666666666667]},{"value":[185.3,-22.1,4.6,5.75]},{"value":[185.3,-15.5,4.4,4.16666666666667]},{"value":[185.31,-17.14,4.1,1.79166666666666]},{"value":[185.32,-21.13,4.7,6.54166666666667]},{"value":[185.32,-16.1,4.7,6.54166666666667]},{"value":[185.33,-17.78,4.1,1.79166666666666]},{"value":[185.35,-19.62,4.9,8.125]},{"value":[185.4,-18.5,4,1]},{"value":[185.43,-17.43,4.5,4.95833333333333]},{"value":[185.43,-16.03,4.8,7.33333333333333]},{"value":[185.48,-21.54,5,8.91666666666667]},{"value":[185.48,-18,4.4,4.16666666666667]},{"value":[185.5,-22,4.4,4.16666666666667]},{"value":[185.5,-21.56,4.5,4.95833333333333]},{"value":[185.51,-16.65,5,8.91666666666667]},{"value":[185.6,-19,4.5,4.95833333333333]},{"value":[185.6,-21.13,5.3,11.2916666666667]},{"value":[185.61,-16.98,4.1,1.79166666666666]},{"value":[185.62,-21.57,4.9,8.125]},{"value":[185.64,-15.72,4.3,3.375]},{"value":[185.68,-20.47,5.4,12.0833333333333]},{"value":[185.7,-16.52,4.7,6.54166666666667]},{"value":[185.72,-16.9,4,1]},{"value":[185.74,-16.44,4.7,6.54166666666667]},{"value":[185.74,-17.03,4.2,2.58333333333333]},{"value":[185.75,-16.24,4.5,4.95833333333333]},{"value":[185.77,-20.76,4.6,5.75]},{"value":[185.77,-20.66,4.3,3.375]},{"value":[185.77,-21.29,5.3,11.2916666666667]},{"value":[185.8,-15.31,4,1]},{"value":[185.8,-21.29,4.9,8.125]},{"value":[185.86,-16.4,5,8.91666666666667]},{"value":[185.86,-21.47,4.9,8.125]},{"value":[185.86,-19.3,5,8.91666666666667]},{"value":[185.9,-22.55,5.7,14.4583333333333]},{"value":[185.9,-20.83,4.5,4.95833333333333]},{"value":[185.9,-17.1,5.4,12.0833333333333]},{"value":[185.9,-15.85,4.1,1.79166666666666]},{"value":[185.93,-15.18,4.1,1.79166666666666]},{"value":[185.94,-16.95,4.3,3.375]},{"value":[185.96,-17.08,4.2,2.58333333333333]},{"value":[185.98,-15.28,4.4,4.16666666666667]},{"value":[186,-16.3,4.5,4.95833333333333]},{"value":[186.04,-15.49,4.3,3.375]},{"value":[186.08,-15.97,4.6,5.75]},{"value":[186.1,-15.31,4.6,5.75]},{"value":[186.1,-20.4,4.3,3.375]},{"value":[186.16,-20.36,4.3,3.375]},{"value":[186.16,-19.33,5.4,12.0833333333333]},{"value":[186.2,-19.7,4.8,7.33333333333333]},{"value":[186.21,-15.24,5,8.91666666666667]},{"value":[186.26,-15.65,5.1,9.70833333333333]},{"value":[186.3,-15.43,4.2,2.58333333333333]},{"value":[186.3,-20.1,4.6,5.75]},{"value":[186.3,-20.7,4,1]},{"value":[186.36,-19.36,4.7,6.54166666666667]},{"value":[186.4,-15.35,4.4,4.16666666666667]},{"value":[186.42,-15.29,4.6,5.75]},{"value":[186.44,-15.41,4.3,3.375]},{"value":[186.51,-20.41,5,8.91666666666667]},{"value":[186.52,-16.21,4.8,7.33333333333333]},{"value":[186.54,-17.4,4.2,2.58333333333333]},{"value":[186.59,-19.34,5.2,10.5]},{"value":[186.66,-15.36,5.1,9.70833333333333]},{"value":[186.71,-15.36,5.5,12.875]},{"value":[186.72,-18.78,4.8,7.33333333333333]},{"value":[186.73,-15.48,4.4,4.16666666666667]},{"value":[186.73,-15.45,4.7,6.54166666666667]},{"value":[186.73,-16.43,4.1,1.79166666666666]},{"value":[186.74,-16.62,4.8,7.33333333333333]},{"value":[186.75,-15.33,5.7,14.4583333333333]},{"value":[186.78,-17.74,5.1,9.70833333333333]},{"value":[186.8,-17.68,4.5,4.95833333333333]},{"value":[186.8,-17.04,4.1,1.79166666666666]},{"value":[186.8,-15.66,4.4,4.16666666666667]},{"value":[186.83,-19.02,5.2,10.5]},{"value":[186.87,-15.4,4.7,6.54166666666667]},{"value":[186.9,-15.5,4.7,6.54166666666667]},{"value":[186.9,-19.5,4.4,4.16666666666667]},{"value":[187,-16.99,4.7,6.54166666666667]},{"value":[187.09,-17.67,4.9,8.125]},{"value":[187.1,-16.51,4.9,8.125]},{"value":[187.15,-15.61,5,8.91666666666667]},{"value":[187.15,-15.54,4.5,4.95833333333333]},{"value":[187.2,-15.17,4.7,6.54166666666667]},{"value":[187.32,-16.14,5.1,9.70833333333333]},{"value":[187.48,-16.11,4.5,4.95833333333333]},{"value":[187.55,-18.85,4.8,7.33333333333333]},{"value":[187.8,-16.49,4.5,4.95833333333333]},{"value":[187.8,-17.4,4.5,4.95833333333333]},{"value":[187.81,-15.46,5.5,12.875]},{"value":[188.1,-17.7,4.2,2.58333333333333]},{"value":[188.13,-15.87,5,8.91666666666667]}],"name":"斐济地震带","type":"scatter","symbol":null,"coordinateSystem":"geo","symbolSize":"function(data){ return data[3];}"}],"visualMap":[{"inRange":{"color":["#00A600","#2DB600","#63C600","#A0D600","#E6E600","#E8C32E","#EBB25E","#EDB48E","#F0C9C0","#F2F2F2"]},"calculable":true,"type":"continuous","min":1,"max":20}],"tooltip":{"trigger":"item"}},"dispose":true},"evals":["opts.series.0.symbolSize"],"jsHooks":[]}</script><p class="caption">
图 34.2: 斐济地震带
</p>
</div>
</div>
<div id="subsec-usa-unemp" class="section level3" number="34.2.2">
<h3>
<span class="header-section-number">34.2.2</span> 美国各城镇失业率<a class="anchor" aria-label="anchor" href="#subsec-usa-unemp"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb2399"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 数据来源 https://datasets.flowingdata.com/unemployment09.csv</span>
<span class="va">unemp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span>
  file <span class="op">=</span> <span class="st">"http://datasets.flowingdata.com/unemployment09.csv"</span>,
  header <span class="op">=</span> <span class="cn">FALSE</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/names.html">names</a></span><span class="op">(</span><span class="va">unemp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span>
  <span class="st">"id"</span>, <span class="st">"state_fips"</span>, <span class="st">"county_fips"</span>, <span class="st">"name"</span>, <span class="st">"year"</span>,
  <span class="st">"?"</span>, <span class="st">"?"</span>, <span class="st">"?"</span>, <span class="st">"rate"</span>
<span class="op">)</span>
<span class="va">unemp</span><span class="op">$</span><span class="va">county</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">" County, [A-Z]{2}"</span>, <span class="st">""</span>, <span class="va">unemp</span><span class="op">$</span><span class="va">name</span><span class="op">)</span><span class="op">)</span>
<span class="va">unemp</span><span class="op">$</span><span class="va">state</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"^.*([A-Z]{2}).*$"</span>, <span class="st">"\\1"</span>, <span class="va">unemp</span><span class="op">$</span><span class="va">name</span><span class="op">)</span>

<span class="va">county_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/map_data.html">map_data</a></span><span class="op">(</span><span class="st">"county"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/names.html">names</a></span><span class="op">(</span><span class="va">county_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="st">"long"</span>, <span class="st">"lat"</span>, <span class="st">"group"</span>, <span class="st">"order"</span>, <span class="st">"state_name"</span>, <span class="st">"county"</span><span class="op">)</span>
<span class="va">county_df</span><span class="op">$</span><span class="va">state</span> <span class="op">&lt;-</span> <span class="va">state.abb</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/match.html">match</a></span><span class="op">(</span><span class="va">county_df</span><span class="op">$</span><span class="va">state_name</span>, <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span><span class="op">(</span><span class="va">state.name</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>
<span class="va">county_df</span><span class="op">$</span><span class="va">state_name</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>

<span class="va">state_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/map_data.html">map_data</a></span><span class="op">(</span><span class="st">"state"</span><span class="op">)</span>
<span class="co"># Combine together</span>
<span class="va">choropleth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/stars/reference/merge.html">merge</a></span><span class="op">(</span><span class="va">county_df</span>, <span class="va">unemp</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="st">"state"</span>, <span class="st">"county"</span><span class="op">)</span><span class="op">)</span>
<span class="va">choropleth</span> <span class="op">&lt;-</span> <span class="va">choropleth</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">choropleth</span><span class="op">$</span><span class="va">order</span><span class="op">)</span>, <span class="op">]</span>
<span class="va">choropleth</span><span class="op">$</span><span class="va">rate_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/cut.html">cut</a></span><span class="op">(</span><span class="va">choropleth</span><span class="op">$</span><span class="va">rate</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="fl">35</span><span class="op">)</span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jrnold/ggthemes">ggthemes</a></span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">choropleth</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">long</span>, <span class="va">lat</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">rate_d</span><span class="op">)</span>, colour <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html">alpha</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">4</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">state_df</span>, colour <span class="op">=</span> <span class="st">"white"</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"PuRd"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    fill <span class="op">=</span> <span class="st">"ratio"</span>, title <span class="op">=</span> <span class="st">"ratio of unemployment by county, 2009"</span>,
    caption <span class="op">=</span> <span class="st">"data source: http://datasets.flowingdata.com/unemployment09.csv"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_map.html">coord_map</a></span><span class="op">(</span><span class="st">"polyconic"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_map.html">theme_map</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unemploymentGG"></span>
<img src="spatial-viz_files/figure-html/unemploymentGG-1.png" alt="2009年美国各城镇失业率" width="2100"><p class="caption">
图 34.3: 2009年美国各城镇失业率
</p>
</div>
<div class="sourceCode" id="cb2400"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 来自帮助文档 ?map </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">mapproj</span><span class="op">)</span>    <span class="co"># mapproj is used for  projection="polyconic"</span>
<span class="co"># color US county map by 2009 unemployment rate</span>
<span class="co"># match counties to map using FIPS county codes</span>
<span class="co"># Based on J's solution to the "Choropleth Challenge"</span>
<span class="co"># http://blog.revolutionanalytics.com/2009/11/choropleth-challenge-result.html</span>

<span class="co"># load data</span>
<span class="co"># unemp includes data for some counties not on the "lower 48 states" county</span>
<span class="co"># map, such as those in Alaska, Hawaii, Puerto Rico, and some tiny Virginia cities</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">unemp</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">county.fips</span><span class="op">)</span>

<span class="co"># define color buckets</span>
<span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="st">"#F1EEF6"</span>, <span class="st">"#D4B9DA"</span>, <span class="st">"#C994C7"</span>, <span class="st">"#DF65B0"</span>, <span class="st">"#DD1C77"</span>, <span class="st">"#980043"</span><span class="op">)</span>
<span class="va">unemp</span><span class="op">$</span><span class="va">colorBuckets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/catalyze.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/cut.html">cut</a></span><span class="op">(</span><span class="va">unemp</span><span class="op">$</span><span class="va">unemp</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">8</span>, <span class="fl">10</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">leg.txt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="st">"&lt;2%"</span>, <span class="st">"2-4%"</span>, <span class="st">"4-6%"</span>, <span class="st">"6-8%"</span>, <span class="st">"8-10%"</span>, <span class="st">"&gt;10%"</span><span class="op">)</span>

<span class="co"># align data with map definitions by (partial) matching state,county</span>
<span class="co"># names, which include multiple polygons for some counties</span>
<span class="va">cnty.fips</span> <span class="op">&lt;-</span> <span class="va">county.fips</span><span class="op">$</span><span class="va">fips</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/match.html">match</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/pkg/maps/man/map.html">map</a></span><span class="op">(</span><span class="st">"county"</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">names</span>,
  <span class="va">county.fips</span><span class="op">$</span><span class="va">polyname</span>
<span class="op">)</span><span class="op">]</span>
<span class="va">colorsmatched</span> <span class="op">&lt;-</span> <span class="va">unemp</span><span class="op">$</span><span class="va">colorBuckets</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/match.html">match</a></span><span class="op">(</span><span class="va">cnty.fips</span>, <span class="va">unemp</span><span class="op">$</span><span class="va">fips</span><span class="op">)</span><span class="op">]</span>

<span class="co"># draw map</span>
<span class="fu"><a href="https://rdrr.io/pkg/maps/man/map.html">map</a></span><span class="op">(</span><span class="st">"county"</span>,
  col <span class="op">=</span> <span class="va">colors</span><span class="op">[</span><span class="va">colorsmatched</span><span class="op">]</span>, fill <span class="op">=</span> <span class="cn">TRUE</span>, resolution <span class="op">=</span> <span class="fl">0</span>,
  lty <span class="op">=</span> <span class="fl">0</span>, projection <span class="op">=</span> <span class="st">"polyconic"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/maps/man/map.html">map</a></span><span class="op">(</span><span class="st">"state"</span>,
  col <span class="op">=</span> <span class="st">"white"</span>, fill <span class="op">=</span> <span class="cn">FALSE</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">0.2</span>,
  projection <span class="op">=</span> <span class="st">"polyconic"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span><span class="st">"unemployment by county, 2009"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, <span class="va">leg.txt</span>, horiz <span class="op">=</span> <span class="cn">TRUE</span>, fill <span class="op">=</span> <span class="va">colors</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="spatial-viz_files/figure-html/unnamed-chunk-17-1.png" width="2100" style="display: block; margin: auto;"></div>
<p>美国各地区失业率地图，配不同颜色， <a href="https://github.com/bhaskarvk/colormap">colormap</a> 适合给静态图配色</p>

</div>
</div>
</div>
<h3>参考文献</h3>
<div id="refs" class="references csl-bib-body">
<div id="ref-Pebesma_2005_sp" class="csl-entry">
<div class="csl-left-margin">[88] </div>
<div class="csl-right-inline">E. J. Pebesma and R. S. Bivand, <span>“Classes and methods for spatial data in <span>R</span>,”</span> <em>R News</em>, vol. 5, no. 2, pp. 9–13, 2005,Available: <a href="https://cran.r-project.org/doc/Rnews/Rnews_2005-2.pdf">https://cran.r-project.org/doc/Rnews/Rnews_2005-2.pdf</a>
</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="chap-spatial-modeling.html"><span class="header-section-number">33</span> 空间数据建模</a></div>
<div class="next"><a href="chap-case-study.html"><span class="header-section-number">35</span> 案例研究</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#chap-spatial-viz"><span class="header-section-number">34</span> 空间数据可视化</a></li>
<li>
<a class="nav-link" href="#sec-spatial-data"><span class="header-section-number">34.1</span> 空间数据</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#subsec-dataframe"><span class="header-section-number">34.1.1</span> data.frame</a></li>
<li><a class="nav-link" href="#subsec-sp"><span class="header-section-number">34.1.2</span> sp</a></li>
<li><a class="nav-link" href="#subsec-sf"><span class="header-section-number">34.1.3</span> sf</a></li>
<li><a class="nav-link" href="#subsec-raster"><span class="header-section-number">34.1.4</span> raster</a></li>
<li><a class="nav-link" href="#subsec-stars"><span class="header-section-number">34.1.5</span> stars</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#sec-viz-echarts4r"><span class="header-section-number">34.2</span> 可视化</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#subsec-fiji-quakes"><span class="header-section-number">34.2.1</span> 斐济地震带分布</a></li>
<li><a class="nav-link" href="#subsec-usa-unemp"><span class="header-section-number">34.2.2</span> 美国各城镇失业率</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/XiangyunHuang/masr/blob/devel/spatial-viz.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/XiangyunHuang/masr/edit/devel/spatial-viz.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>现代应用统计与 R 语言</strong>: Modern Applied Statistics with R" was written by 黄湘云. It was last built on 2021-10-20.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
