<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>第 31 章 时序分析 | 现代应用统计与 R 语言</title>
<meta name="author" content="黄湘云">
<meta name="description" content="library(formatR) `%&gt;%` &lt;- magrittr::`%&gt;%` library(ggplot2) library(ggfortify) # **ggfortify** 包提供的 `autoplot()` 函数可以根据数据对象的不同绘制不同的图形。 library(dygraphs) # library(robustbase) # Robust Statistics #...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="第 31 章 时序分析 | 现代应用统计与 R 语言">
<meta property="og:type" content="book">
<meta property="og:image" content="/images/cover.png">
<meta property="og:description" content="library(formatR) `%&gt;%` &lt;- magrittr::`%&gt;%` library(ggplot2) library(ggfortify) # **ggfortify** 包提供的 `autoplot()` 函数可以根据数据对象的不同绘制不同的图形。 library(dygraphs) # library(robustbase) # Robust Statistics #...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="第 31 章 时序分析 | 现代应用统计与 R 语言">
<meta name="twitter:description" content="library(formatR) `%&gt;%` &lt;- magrittr::`%&gt;%` library(ggplot2) library(ggfortify) # **ggfortify** 包提供的 `autoplot()` 函数可以根据数据对象的不同绘制不同的图形。 library(dygraphs) # library(robustbase) # Robust Statistics #...">
<meta name="twitter:image" content="/images/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs/header-attrs.js"></script><script src="libs/jquery/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap/bootstrap.bundle.min.js"></script><script src="libs/bs3compat/transition.js"></script><script src="libs/bs3compat/tabs.js"></script><script src="libs/bs3compat/bs3compat.js"></script><link href="libs/bs4_book/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book/bs4_book.js"></script><script src="libs/htmlwidgets/htmlwidgets.js"></script><script src="libs/plotly-binding/plotly.js"></script><script src="libs/typedarray/typedarray.min.js"></script><link href="libs/crosstalk/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main/plotly-latest.min.js"></script><script src="libs/plotly-locale-zh-CN/zh-cn.js"></script><script src="libs/mathjax/cdn.js"></script><link href="libs/dygraphs/dygraph.css" rel="stylesheet">
<script src="libs/dygraphs/dygraph-combined.js"></script><script src="libs/dygraphs/shapes.js"></script><script src="libs/moment/moment.js"></script><script src="libs/moment-timezone/moment-timezone-with-data.js"></script><script src="libs/moment-fquarter/moment-fquarter.min.js"></script><script src="libs/dygraphs-binding/dygraphs.js"></script><script src="libs/Dygraph.Plugins.Unzoom/unzoom.js"></script><script src="libs/echarts4r/echarts-en.min.js"></script><script src="libs/echarts4r/ecStat.min.js"></script><script src="libs/echarts4r/dataTool.min.js"></script><script src="libs/echarts4r-binding/echarts4r.js"></script><script src="libs/d3/d3.min.js"></script><script src="libs/forceNetwork-binding/forceNetwork.js"></script><link href="libs/vis/vis-network.min.css" rel="stylesheet">
<script src="libs/vis/vis-network.min.js"></script><script src="libs/visNetwork-binding/visNetwork.js"></script><script src="libs/FileSaver/FileSaver.min.js"></script><script src="libs/Blob/Blob.js"></script><script src="libs/canvas-toBlob/canvas-toBlob.js"></script><script src="libs/html2canvas/html2canvas.js"></script><script src="libs/jspdf/jspdf.debug.js"></script><link href="libs/jquery-sparkline/jquery.sparkline.css" rel="stylesheet">
<script src="libs/jquery-sparkline/jquery.sparkline.js"></script><script src="libs/sparkline-binding/sparkline.js"></script><script src="libs/r2d3-render/r2d3-render.js"></script><script src="libs/webcomponents/webcomponents.js"></script><script src="libs/r2d3-binding/r2d3.js"></script><script src="libs/d3v6/d3.min.js"></script><script src="libs/es6shim/es6shim.js"></script><script src="libs/es7shim/es7shim.js"></script><script src="libs/graphre/graphre.js"></script><script src="libs/nomnoml/nomnoml.js"></script><script src="libs/nomnoml-binding/nomnoml.js"></script><script src="libs/d3-bundle/d3-bundle.min.js"></script><script src="libs/d3-lasso/d3-lasso.min.js"></script><script src="libs/save-svg-as-png/save-svg-as-png.min.js"></script><link href="libs/ggiraphjs/ggiraphjs.min.css" rel="stylesheet">
<script src="libs/ggiraphjs/ggiraphjs.min.js"></script><script src="libs/girafe-binding/girafe.js"></script><link href="libs/datatables-css/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding/datatables.js"></script><link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core/js/jquery.dataTables.min.js"></script><script src="libs/jszip/jszip.min.js"></script><script src="libs/pdfmake/pdfmake.js"></script><script src="libs/pdfmake/vfs_fonts.js"></script><link href="libs/dt-ext-buttons/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="libs/dt-ext-buttons/js/dataTables.buttons.min.js"></script><script src="libs/dt-ext-buttons/js/buttons.html5.min.js"></script><script src="libs/dt-ext-buttons/js/buttons.colVis.min.js"></script><script src="libs/dt-ext-buttons/js/buttons.print.min.js"></script><link href="libs/dt-ext-rowgroup/css/rowGroup.dataTables.min.css" rel="stylesheet">
<script src="libs/dt-ext-rowgroup/js/dataTables.rowGroup.min.js"></script><script src="libs/kePrint/kePrint.js"></script><link href="libs/lightable/lightable.css" rel="stylesheet">
<script src="libs/echarts-world/world.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-54GQKWF7VP"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-54GQKWF7VP');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Modern Applied Statistics with R">现代应用统计与 R 语言</a>:
        <small class="text-muted">Modern Applied Statistics with R</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">欢迎</a></li>
<li><a class="" href="chap-preface.html"><span class="header-section-number">1</span> 前言</a></li>
<li class="book-part">数据整理</li>
<li><a class="" href="chap-data-wrangling.html">介绍</a></li>
<li><a class="" href="chap-data-structure.html"><span class="header-section-number">2</span> 数据结构</a></li>
<li><a class="" href="chap-data-transportation.html"><span class="header-section-number">3</span> 数据搬运</a></li>
<li><a class="" href="chap-string-operations.html"><span class="header-section-number">4</span> 字符串操作</a></li>
<li><a class="" href="chap-regular-expressions.html"><span class="header-section-number">5</span> 正则表达式</a></li>
<li><a class="" href="chap-data-manipulation.html"><span class="header-section-number">6</span> 数据操作</a></li>
<li><a class="" href="chap-advanced-manipulation.html"><span class="header-section-number">7</span> 高级数据操作</a></li>
<li><a class="" href="chap-parallel-manipulation.html"><span class="header-section-number">8</span> 并行化操作</a></li>
<li><a class="" href="chap-dplyr-manipulation.html"><span class="header-section-number">9</span> 净土化操作</a></li>
<li class="book-part">统计图形</li>
<li><a class="" href="chap-statistical-graphics.html">介绍</a></li>
<li><a class="" href="chap-graphics-foundations.html"><span class="header-section-number">10</span> 图形基础</a></li>
<li><a class="" href="chap-data-visualization.html"><span class="header-section-number">11</span> 数据可视化</a></li>
<li><a class="" href="chap-interactive-web-graphics.html"><span class="header-section-number">12</span> 交互图形</a></li>
<li class="book-part">动态文档</li>
<li><a class="" href="chap-dynamic-documents.html">介绍</a></li>
<li><a class="" href="chap-document-elements.html"><span class="header-section-number">13</span> 文档元素</a></li>
<li><a class="" href="chap-portable-document.html"><span class="header-section-number">14</span> 便携式文档</a></li>
<li><a class="" href="chap-web-documents.html"><span class="header-section-number">15</span> 网页文档</a></li>
<li><a class="" href="chap-office-document.html"><span class="header-section-number">16</span> 办公文档</a></li>
<li><a class="" href="chap-reproducible-workflows.html"><span class="header-section-number">17</span> 工作流</a></li>
<li><a class="" href="chap-advanced-documents.html"><span class="header-section-number">18</span> 高级文档</a></li>
<li class="book-part">数据产品</li>
<li><a class="" href="chap-data-product.html">介绍</a></li>
<li><a class="" href="chap-interactive-data-tables.html"><span class="header-section-number">19</span> 交互表格</a></li>
<li><a class="" href="chap-interactive-shiny-app.html"><span class="header-section-number">20</span> 交互报表</a></li>
<li class="book-part">统计基础</li>
<li><a class="" href="chap-statistical-foundations.html">介绍</a></li>
<li><a class="" href="chap-sampling-distributions.html"><span class="header-section-number">21</span> 抽样分布</a></li>
<li><a class="" href="chap-parameter-estimators.html"><span class="header-section-number">22</span> 参数估计</a></li>
<li><a class="" href="chap-hypothesis-test.html"><span class="header-section-number">23</span> 假设检验</a></li>
<li><a class="" href="chap-power-Analysis.html"><span class="header-section-number">24</span> 功效分析</a></li>
<li><a class="" href="chap-experimental-design.html"><span class="header-section-number">25</span> 试验设计</a></li>
<li class="book-part">统计模型</li>
<li><a class="" href="chap-statistical-models.html">介绍</a></li>
<li><a class="" href="chap-linear-models.html"><span class="header-section-number">26</span> 线性模型</a></li>
<li><a class="" href="chap-generalized-linear-models.html"><span class="header-section-number">27</span> 广义线性模型</a></li>
<li><a class="" href="chap-bayesian-models.html"><span class="header-section-number">28</span> 贝叶斯模型</a></li>
<li class="book-part">数据建模</li>
<li><a class="" href="chap-data-modeling.html">介绍</a></li>
<li><a class="" href="chap-text-analysis.html"><span class="header-section-number">29</span> 文本分析</a></li>
<li><a class="" href="chap-survival-analysis.html"><span class="header-section-number">30</span> 生存分析</a></li>
<li><a class="active" href="chap-time-series-analysis.html"><span class="header-section-number">31</span> 时序分析</a></li>
<li class="book-part">时空数据</li>
<li><a class="" href="chap-spatio-temporal-data.html">介绍</a></li>
<li><a class="" href="chap-spatial-analysis.html"><span class="header-section-number">32</span> 空间数据分析</a></li>
<li><a class="" href="chap-spatial-viz.html"><span class="header-section-number">33</span> 空间数据可视化</a></li>
<li><a class="" href="chap-case-study.html"><span class="header-section-number">34</span> 案例研究</a></li>
<li><a class="" href="chap-data-explorer.html"><span class="header-section-number">35</span> 数据探索</a></li>
<li class="book-part">机器学习</li>
<li><a class="" href="chap-machine-learning.html">介绍</a></li>
<li><a class="" href="chap-gradient-boosting-machine.html"><span class="header-section-number">36</span> 梯度提升机</a></li>
<li><a class="" href="chap-numerical-optimization.html"><span class="header-section-number">37</span> 数值优化</a></li>
<li class="book-part">附录</li>
<li><a class="" href="chap-linux-command-bash.html"><span class="header-section-number">A</span> 命令行操作</a></li>
<li><a class="" href="chap-matrix-operations.html"><span class="header-section-number">B</span> 矩阵运算</a></li>
<li><a class="" href="chap-symbolic-computation.html"><span class="header-section-number">C</span> 符号计算</a></li>
<li><a class="" href="chap-mixed-programming.html"><span class="header-section-number">D</span> 混合编程</a></li>
<li><a class="" href="chap-object-oriented-programming.html"><span class="header-section-number">E</span> 面向对象编程</a></li>
<li><a class="" href="chap-file-operations.html"><span class="header-section-number">F</span> 文件操作</a></li>
<li><a class="" href="chap-other-softwares.html"><span class="header-section-number">G</span> 其它软件</a></li>
<li><a class="" href="chap-notations.html"><span class="header-section-number">H</span> 符号说明</a></li>
<li><a class="" href="references.html">参考文献</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/XiangyunHuang/masr">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="chap-time-series-analysis" class="section level1" number="31">
<h1>
<span class="header-section-number">第 31 章</span> 时序分析<a class="anchor" aria-label="anchor" href="#chap-time-series-analysis"><i class="fas fa-link"></i></a>
</h1>
<div class="sourceCode" id="cb2318"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/yihui/formatR">formatR</a></span><span class="op">)</span>
<span class="va">`%&gt;%`</span> <span class="op">&lt;-</span> <span class="fu">magrittr</span><span class="fu">::</span><span class="va">`%&gt;%`</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sinhrks/ggfortify">ggfortify</a></span><span class="op">)</span> <span class="co"># **ggfortify** 包提供的 `autoplot()` 函数可以根据数据对象的不同绘制不同的图形。</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/dygraphs">dygraphs</a></span><span class="op">)</span> 
<span class="co"># library(robustbase) # Robust Statistics</span>
<span class="co"># library(timeDate) # 日期处理</span>
<span class="co"># library(timeSeries) # 序列处理</span>
<span class="co"># library(fPortfolio) # 投资组合</span>
<span class="co"># library(prophet) # 时间序列预测</span>
<span class="co"># https://github.com/business-science/timetk</span>
<span class="co"># library(timetk) # 处理时间序列数据的工具箱</span></code></pre></div>
<p>首先介绍时序数据对象及操作，处理时序数据的工具，包括时序图、相关图、平稳性检验，相关检验，之后才是时序建模。<a href="https://cran.r-project.org/package=timeDate">timeDate</a> <a href="https://cran.r-project.org/package=timeSeries">timeSeries</a> 是处理日期和时间序列的 R 包，有专门的官网 <a href="https://www.rmetrics.org/" class="uri">https://www.rmetrics.org/</a>，扩展到时间序列、组合优化、金融市场、投资管理等一系列书籍，非常值得一看。此外，北大李东风老师的<a href="https://www.math.pku.edu.cn/teachers/lidf/course/">金融时间序列分析讲义</a> 是这方面非常好的中文参考材料。David R. Brillinger 在 1975 年出版的书 《Time Series: Data Analysis and Theory》 <span class="citation"><a href="#ref-Brillinger_2001_TSD" role="doc-biblioref">[81]</a></span> 是经典著作，我们可以从时间序列分析的综述上开始入手，比如从 ARIMA 过渡到异方差和非高斯分布 <a href="https://mason.gmu.edu/~jgentle/talks/CompFin_Tutorial.pdf" class="uri">https://mason.gmu.edu/~jgentle/talks/CompFin_Tutorial.pdf</a>， <a href="https://www.stat.berkeley.edu/~brill/Papers/encysbs.pdf" class="uri">https://www.stat.berkeley.edu/~brill/Papers/encysbs.pdf</a> 和 ARCH or GARCH 的综述 <a href="http://public.econ.duke.edu/~boller/Papers/glossary_arch.pdf" class="uri">http://public.econ.duke.edu/~boller/Papers/glossary_arch.pdf</a> ，宾州州立大学开设的 Applied Time Series Analysis 课程 <a href="https://newonlinecourses.science.psu.edu/stat510/" class="uri">https://newonlinecourses.science.psu.edu/stat510/</a>，以及 《Time Series Analysis and Its Applications With R Examples》 已经出到第四版了，和 R 语言结合，理论和应用结合 <a href="https://www.stat.pitt.edu/stoffer/tsa4/" class="uri">https://www.stat.pitt.edu/stoffer/tsa4/</a>。从时间序列中寻找规律，这样才是真的数据建模，从数据到模型，而不是相反 <a href="https://mason.gmu.edu/~jgentle/papers/FindingPatternsTimeSeriesDraft.pdf">Finding Patterns in Time Series</a>，识别金融时间序列的模式和统计规律。现在工业界做时序分析和预测的工具，如 facebook 出品的 <a href="https://github.com/facebook/prophet/tree/master/R">prophet</a>，微软收集了一些时间序列预测的最佳实战案例 <a href="https://github.com/microsoft/forecasting" class="uri">https://github.com/microsoft/forecasting</a></p>
<p><a href="https://github.com/nredell/forecastML/">forecastML</a> 自回归模型结合机器学习方法。</p>
<p><a href="https://github.com/google/CausalImpact">CausalImpact</a> 借助贝叶斯分析方法推断时间序列中的因果关系，比如广告促销带来的点击效果。</p>
<p><a href="https://r-forge.r-project.org/projects/robustbase/">robustbase</a> <span class="citation"><a href="#ref-robustbase2006" role="doc-biblioref">[82]</a></span> 提供稳健统计方法。</p>
<p><a href="https://github.com/facebook/prophet">prophet</a> 基于可加模型的时间序列预测</p>
<p><a href="https://github.com/twitter/AnomalyDetection">AnomalyDetection</a> 时间序列数据中的异常值检测</p>
<div id="sec-ts-data" class="section level2" number="31.1">
<h2>
<span class="header-section-number">31.1</span> 时序数据<a class="anchor" aria-label="anchor" href="#sec-ts-data"><i class="fas fa-link"></i></a>
</h2>
<p>以数据集 AirPassengers 为例说明一下 R 内置的存储时间序列数据的数据结构 — ts 数据对象。函数 <code><a href="https://rdrr.io/r/base/class.html">class()</a></code> 、 <code><a href="https://rdrr.io/r/base/mode.html">mode()</a></code> 和 <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> 分别可以查看其数据类型、存储类型和数据结构。</p>
<div class="sourceCode" id="cb2319"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 数据类型</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">AirPassengers</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "ts"</code></pre>
<div class="sourceCode" id="cb2321"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 存储类型</span>
<span class="fu"><a href="https://rdrr.io/r/base/mode.html">mode</a></span><span class="op">(</span><span class="va">AirPassengers</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "numeric"</code></pre>
<div class="sourceCode" id="cb2323"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 数据结构</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">AirPassengers</span><span class="op">)</span></code></pre></div>
<pre><code>##  Time-Series [1:144] from 1949 to 1961: 112 118 132 129 121 135 148 148 136 119 ...</code></pre>
<p>查看该数据集开始和结束的时间点</p>
<div class="sourceCode" id="cb2325"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/start.html">start</a></span><span class="op">(</span><span class="va">AirPassengers</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/start.html">end</a></span><span class="op">(</span><span class="va">AirPassengers</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1949    1 1960   12</code></pre>
<p>数据集 AirPassengers 在以上时间区间的划分</p>
<div class="sourceCode" id="cb2327"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/time.html">time</a></span><span class="op">(</span><span class="va">AirPassengers</span><span class="op">)</span></code></pre></div>
<pre><code>##           Jan      Feb      Mar      Apr      May      Jun      Jul      Aug
## 1949 1949.000 1949.083 1949.167 1949.250 1949.333 1949.417 1949.500 1949.583
## 1950 1950.000 1950.083 1950.167 1950.250 1950.333 1950.417 1950.500 1950.583
## 1951 1951.000 1951.083 1951.167 1951.250 1951.333 1951.417 1951.500 1951.583
## 1952 1952.000 1952.083 1952.167 1952.250 1952.333 1952.417 1952.500 1952.583
## 1953 1953.000 1953.083 1953.167 1953.250 1953.333 1953.417 1953.500 1953.583
## 1954 1954.000 1954.083 1954.167 1954.250 1954.333 1954.417 1954.500 1954.583
## 1955 1955.000 1955.083 1955.167 1955.250 1955.333 1955.417 1955.500 1955.583
## 1956 1956.000 1956.083 1956.167 1956.250 1956.333 1956.417 1956.500 1956.583
## 1957 1957.000 1957.083 1957.167 1957.250 1957.333 1957.417 1957.500 1957.583
## 1958 1958.000 1958.083 1958.167 1958.250 1958.333 1958.417 1958.500 1958.583
## 1959 1959.000 1959.083 1959.167 1959.250 1959.333 1959.417 1959.500 1959.583
## 1960 1960.000 1960.083 1960.167 1960.250 1960.333 1960.417 1960.500 1960.583
##           Sep      Oct      Nov      Dec
## 1949 1949.667 1949.750 1949.833 1949.917
## 1950 1950.667 1950.750 1950.833 1950.917
## 1951 1951.667 1951.750 1951.833 1951.917
## 1952 1952.667 1952.750 1952.833 1952.917
## 1953 1953.667 1953.750 1953.833 1953.917
## 1954 1954.667 1954.750 1954.833 1954.917
## 1955 1955.667 1955.750 1955.833 1955.917
## 1956 1956.667 1956.750 1956.833 1956.917
## 1957 1957.667 1957.750 1957.833 1957.917
## 1958 1958.667 1958.750 1958.833 1958.917
## 1959 1959.667 1959.750 1959.833 1959.917
## 1960 1960.667 1960.750 1960.833 1960.917</code></pre>
<p>期初和期末的周期</p>
<div class="sourceCode" id="cb2329"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/tsp.html">tsp</a></span><span class="op">(</span><span class="va">AirPassengers</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1949.000 1960.917   12.000</code></pre>
<p>函数 <code><a href="https://rdrr.io/pkg/timeDate/man/base-diff.html">diff()</a></code> 实现差分算子，默认参数 <code>lag = 1</code> ，<code>differences = 1</code> 表示延迟期数为 1 的一阶差分。</p>
<div class="sourceCode" id="cb2331"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 差分前</span>
<span class="va">AirPassengers</span></code></pre></div>
<pre><code>##      Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
## 1949 112 118 132 129 121 135 148 148 136 119 104 118
## 1950 115 126 141 135 125 149 170 170 158 133 114 140
## 1951 145 150 178 163 172 178 199 199 184 162 146 166
## 1952 171 180 193 181 183 218 230 242 209 191 172 194
## 1953 196 196 236 235 229 243 264 272 237 211 180 201
## 1954 204 188 235 227 234 264 302 293 259 229 203 229
## 1955 242 233 267 269 270 315 364 347 312 274 237 278
## 1956 284 277 317 313 318 374 413 405 355 306 271 306
## 1957 315 301 356 348 355 422 465 467 404 347 305 336
## 1958 340 318 362 348 363 435 491 505 404 359 310 337
## 1959 360 342 406 396 420 472 548 559 463 407 362 405
## 1960 417 391 419 461 472 535 622 606 508 461 390 432</code></pre>
<div class="sourceCode" id="cb2333"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 差分后</span>
<span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-diff.html">diff</a></span><span class="op">(</span><span class="va">AirPassengers</span><span class="op">)</span></code></pre></div>
<pre><code>##       Jan  Feb  Mar  Apr  May  Jun  Jul  Aug  Sep  Oct  Nov  Dec
## 1949         6   14   -3   -8   14   13    0  -12  -17  -15   14
## 1950   -3   11   15   -6  -10   24   21    0  -12  -25  -19   26
## 1951    5    5   28  -15    9    6   21    0  -15  -22  -16   20
## 1952    5    9   13  -12    2   35   12   12  -33  -18  -19   22
## 1953    2    0   40   -1   -6   14   21    8  -35  -26  -31   21
## 1954    3  -16   47   -8    7   30   38   -9  -34  -30  -26   26
## 1955   13   -9   34    2    1   45   49  -17  -35  -38  -37   41
## 1956    6   -7   40   -4    5   56   39   -8  -50  -49  -35   35
## 1957    9  -14   55   -8    7   67   43    2  -63  -57  -42   31
## 1958    4  -22   44  -14   15   72   56   14 -101  -45  -49   27
## 1959   23  -18   64  -10   24   52   76   11  -96  -56  -45   43
## 1960   12  -26   28   42   11   63   87  -16  -98  -47  -71   42</code></pre>
<div class="sourceCode" id="cb2335"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 延迟一期的二阶差分</span>
<span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-diff.html">diff</a></span><span class="op">(</span><span class="va">AirPassengers</span>, lag <span class="op">=</span> <span class="fl">1</span>, differences <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>##       Jan  Feb  Mar  Apr  May  Jun  Jul  Aug  Sep  Oct  Nov  Dec
## 1949              8  -17   -5   22   -1  -13  -12   -5    2   29
## 1950  -17   14    4  -21   -4   34   -3  -21  -12  -13    6   45
## 1951  -21    0   23  -43   24   -3   15  -21  -15   -7    6   36
## 1952  -15    4    4  -25   14   33  -23    0  -45   15   -1   41
## 1953  -20   -2   40  -41   -5   20    7  -13  -43    9   -5   52
## 1954  -18  -19   63  -55   15   23    8  -47  -25    4    4   52
## 1955  -13  -22   43  -32   -1   44    4  -66  -18   -3    1   78
## 1956  -35  -13   47  -44    9   51  -17  -47  -42    1   14   70
## 1957  -26  -23   69  -63   15   60  -24  -41  -65    6   15   73
## 1958  -27  -26   66  -58   29   57  -16  -42 -115   56   -4   76
## 1959   -4  -41   82  -74   34   28   24  -65 -107   40   11   88
## 1960  -31  -38   54   14  -31   52   24 -103  -82   51  -24  113</code></pre>
</div>
<div id="sec-ts-plot" class="section level2" number="31.2">
<h2>
<span class="header-section-number">31.2</span> 时序图<a class="anchor" aria-label="anchor" href="#sec-ts-plot"><i class="fas fa-link"></i></a>
</h2>
<p>美国纽黑文自1912年至1971年的年平均气温变化见图 <a href="chap-time-series-analysis.html#fig:new-haven-temp">31.1</a>。</p>
<div class="sourceCode" id="cb2337"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">nhtemp</span>, main <span class="op">=</span> <span class="st">"美国纽黑文的年平均气温"</span>, family <span class="op">=</span> <span class="st">"Noto Serif CJK SC"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:new-haven-temp"></span>
<img src="time-series-analysis_files/figure-html/new-haven-temp-1.png" alt="美国纽黑文的年平均气温，单位：华氏温度" width="672"><p class="caption">
图 31.1: 美国纽黑文的年平均气温，单位：华氏温度
</p>
</div>
<div class="sourceCode" id="cb2338"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 构造多个 ts 序列</span>
<span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    pay_one <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>,
    pay_two <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>,
    pay_three <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>
  <span class="op">)</span>,
  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-c.html">c</a></span><span class="op">(</span><span class="fl">1961</span>, <span class="fl">1</span><span class="op">)</span>, frequency <span class="op">=</span> <span class="fl">12</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">tmp</span>, main <span class="op">=</span> <span class="st">"pay cnt"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="time-series-analysis_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb2339"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">tmp</span>, plot.type <span class="op">=</span> <span class="st">"single"</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, ylab <span class="op">=</span> <span class="st">"pay cnt"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="time-series-analysis_files/figure-html/unnamed-chunk-7-2.png" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="sec:frequency" class="section level2" number="31.3">
<h2>
<span class="header-section-number">31.3</span> 基本概念<a class="anchor" aria-label="anchor" href="#sec:frequency"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb2340"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 从某个完整的一天开始统计数据</span>
<span class="co"># 分钟级 ts 数据</span>
<span class="va">time_min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.POSIXt.html">seq.POSIXt</a></span><span class="op">(</span>
  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">"2020-01-01 00:00"</span><span class="op">)</span>,
  to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">"2020-01-01 23:59"</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"1 min"</span>
<span class="op">)</span>,
format <span class="op">=</span> <span class="st">"%H:%M"</span>
<span class="op">)</span>
<span class="va">tmp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1440</span> <span class="op">*</span> <span class="fl">3</span><span class="op">)</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-c.html">c</a></span><span class="op">(</span><span class="fl">2020</span>, <span class="fl">12</span><span class="op">)</span>,
         frequency <span class="op">=</span> <span class="fl">24</span><span class="op">*</span><span class="fl">60</span><span class="op">*</span><span class="fl">365.25</span>, names <span class="op">=</span> <span class="st">"访问量"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="time-series-analysis_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></div>
<p>frequency: the number of observations per unit of time.</p>
<p>frequency 里面乘以 365.25 而不是 365 是因为每隔 4 年出现一次 366 天，多出的这一天分摊到每一年。
frequency 表示单位时间内发生的次数，ts 对象的时间基准为 1 年，所以，frequency = 4 表示一年出现四次，依此类推。关于季节性周期的说明 <a href="https://robjhyndman.com/hyndsight/seasonal-periods/" class="uri">https://robjhyndman.com/hyndsight/seasonal-periods/</a>。</p>
<p>序列长度一样，但是周期不一样，这里的单位时间指的是1年</p>
<div class="sourceCode" id="cb2341"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 季数据</span>
<span class="va">op</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">tmp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-c.html">c</a></span><span class="op">(</span><span class="fl">1961</span>, <span class="fl">1</span><span class="op">)</span>, frequency <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">tmp</span>, main <span class="op">=</span> <span class="st">"Quarterly"</span>, type <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span>
<span class="co"># 月数据</span>
<span class="va">tmp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-c.html">c</a></span><span class="op">(</span><span class="fl">1961</span>, <span class="fl">1</span><span class="op">)</span>, frequency <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="co"># 自然时间周期是一年，每月采样</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">tmp</span>, main <span class="op">=</span> <span class="st">"Monthly"</span>, type <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span>
<span class="co"># 日数据</span>
<span class="va">tmp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-c.html">c</a></span><span class="op">(</span><span class="fl">1961</span>, <span class="fl">1</span><span class="op">)</span>, frequency <span class="op">=</span> <span class="fl">365.25</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">tmp</span>, main <span class="op">=</span> <span class="st">"Daily"</span>, type <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span>
<span class="co"># 分钟数据</span>
<span class="va">tmp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-c.html">c</a></span><span class="op">(</span><span class="fl">1961</span>, <span class="fl">1</span><span class="op">)</span>, frequency <span class="op">=</span> <span class="fl">24</span><span class="op">*</span><span class="fl">60</span><span class="op">*</span><span class="fl">365.25</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">tmp</span>, main <span class="op">=</span> <span class="st">"Minutely"</span>, type <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="time-series-analysis_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb2342"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></code></pre></div>
<p>默认情况下，自然时间周期是一年，每月采样。那可不可以设置自然时间周期是一周，每天采样呢？
当然可以，只是 Base R 暂不支持，其实表达数据粒度的能力没有变化，以年或周为基准，都可以表达上面的季、月、日、分钟数据。</p>
<p>deltat 和 frequency 只需提供一个参数值即可 deltat = 1/12 和 frequency = 12 表示同样的含义。</p>
<p>R 4.0.0 开始，frequency 不必是整数，还可以是小数，frequency = .2 表示每 5 个时间单位抽样一次，根据周期 T 和频率 f 的关系 T = 1/f</p>
<div class="sourceCode" id="cb2343"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tmp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-c.html">c</a></span><span class="op">(</span><span class="fl">1961</span>, <span class="fl">1</span><span class="op">)</span>, frequency <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">tmp</span>, type <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="time-series-analysis_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></div>
<p>ts 和 seq 构造时间向量的关系是什么？</p>
<div class="sourceCode" id="cb2344"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">1961</span>, to <span class="op">=</span> <span class="fl">2056</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] 1961 1966 1971 1976 1981 1986 1991 1996 2001 2006 2011 2016 2021 2026 2031
## [16] 2036 2041 2046 2051 2056</code></pre>
<p>即每隔5年抽样一次，采一个数据点</p>
<div class="sourceCode" id="cb2346"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-c.html">c</a></span><span class="op">(</span><span class="fl">1961</span>, <span class="fl">1</span><span class="op">)</span>, frequency <span class="op">=</span> <span class="fl">365.25</span><span class="op">/</span><span class="fl">7</span><span class="op">)</span></code></pre></div>
<pre><code>## Time Series:
## Start = 1961 
## End = 1961.36413415469 
## Frequency = 52.1785714285714 
##  [1] -0.63330240 -1.22686674 -0.39431070  0.55937107  1.80096432 -1.71271047
##  [7] -1.05552485  0.93258727 -0.85579720  1.83501166 -0.50218598 -0.06953427
## [13] -1.11473737  0.60628044 -0.93107880 -0.13551142  0.66851022  0.19312566
## [19]  0.75405854  0.30840568</code></pre>
<p>周数据，一周采一个点，采了 20 个点</p>
</div>
<div id="sec-ts-tests" class="section level2" number="31.4">
<h2>
<span class="header-section-number">31.4</span> 时序检验<a class="anchor" aria-label="anchor" href="#sec-ts-tests"><i class="fas fa-link"></i></a>
</h2>
<p>参数的计算公式，实现的 R 代码</p>
<ul>
<li>Applies linear filtering to a univariate time series or to each series separately of a multivariate time series. 过滤</li>
</ul>
<p>一元时间序列的线性过滤，或者对多元时间序列的单个序列分别做线性过滤</p>
<p><span class="math display">\[
y[i] = x[i] + f[1]*y[i-1] +\ldots+ f[p]*y[i-p]
\]</span></p>
<p><span class="math display">\[
y[i] = f[1]*x[i+o] + \ldots + f[p]*x[i+o-(p-1)]
\]</span></p>
<p>其中 <span class="math inline">\(o\)</span> 代表 offset</p>
<p>介绍 FTT 算法细节</p>
<p>不同的方法对时间序列平滑的影响 FTT 快速傅里叶变换算法</p>
<div class="sourceCode" id="cb2348"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/formatR/man/usage.html">usage</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">)</span></code></pre></div>
<pre><code>## filter(x, filter, method = c("convolution", "recursive"), sides = 2L,
##     circular = FALSE, init = NULL)</code></pre>
<ul>
<li>
<code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code> 时间序列线性过滤</li>
<li>
<code><a href="https://rdrr.io/r/stats/fft.html">fft()</a></code> 快速离散傅里叶变换</li>
</ul>
</div>
<div id="sec-exponential-smoothing" class="section level2" number="31.5">
<h2>
<span class="header-section-number">31.5</span> 指数平滑<a class="anchor" aria-label="anchor" href="#sec-exponential-smoothing"><i class="fas fa-link"></i></a>
</h2>
</div>
<div id="sec-holt-winters" class="section level2" number="31.6">
<h2>
<span class="header-section-number">31.6</span> Holt-Winters<a class="anchor" aria-label="anchor" href="#sec-holt-winters"><i class="fas fa-link"></i></a>
</h2>
<p><strong>可加</strong> Holt-Winters <span class="citation"><a href="#ref-Winters_1960_Forecasting" role="doc-biblioref">[83]</a>, <a href="#ref-Holt_2004_Forecasting" role="doc-biblioref">[84]</a></span> 预测函数，周期长度为 p</p>
<p><span class="math display">\[
\hat{Y}[t+h] = a[t] + h * b[t] + s[t - p + 1 + (h - 1) \mod p
\]</span></p>
<p>其中 <span class="math inline">\(a[t], b[t], s[t]\)</span> 由以下决定</p>
<p><span class="math display">\[\begin{align}
a[t] &amp;= \alpha (Y[t] - s[t-p]) + (1-\alpha) (a[t-1] + b[t-1]) \\
b[t] &amp;= \beta (a[t] - a[t-1]) + (1-\beta) b[t-1] \\
s[t] &amp;= \gamma (Y[t] - a[t]) + (1-\gamma) s[t-p]
\end{align}\]</span></p>
<p>可乘 Holt-Winters</p>
<p><span class="math display">\[
\hat{Y}[t+h] = (a[t] + h * b[t]) * s[t - p + 1 + (h - 1) \mod p]
\]</span></p>
<p>其中 <span class="math inline">\(a[t], b[t], s[t]\)</span> 由如下决定</p>
<p><span class="math display">\[\begin{align}
a[t] &amp;= \alpha (Y[t] / s[t-p]) + (1-\alpha) (a[t-1] + b[t-1]) \\
b[t] &amp;= \beta (a[t] - a[t-1]) + (1-\beta) b[t-1] \\
s[t] &amp;= \gamma (Y[t] / a[t]) + (1-\gamma) s[t-p]
\end{align}\]</span></p>
<p><code><a href="https://rdrr.io/r/stats/HoltWinters.html">HoltWinters()</a></code> 用 Shiny App / 动画的形式展示 <span class="math inline">\(\alpha, \beta, \gamma\)</span> 三个参数对模型预测的影响，参数的确定通过最小化预测均方误差</p>
<div class="sourceCode" id="cb2350"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Seasonal Holt-Winters</span>
<span class="op">(</span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/HoltWinters.html">HoltWinters</a></span><span class="op">(</span><span class="va">co2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">m</span>, <span class="fl">50</span>, prediction.interval <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">p</span><span class="op">)</span>

<span class="op">(</span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/HoltWinters.html">HoltWinters</a></span><span class="op">(</span><span class="va">AirPassengers</span>, seasonal <span class="op">=</span> <span class="st">"mult"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>

<span class="co">## 指数平滑 Exponential Smoothing</span>
<span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/HoltWinters.html">HoltWinters</a></span><span class="op">(</span><span class="va">x</span>, gamma <span class="op">=</span> <span class="cn">FALSE</span>, beta <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
</div>
<div id="sec-sunspots" class="section level2" number="31.7">
<h2>
<span class="header-section-number">31.7</span> 1749-2013 年太阳黑子数据<a class="anchor" aria-label="anchor" href="#sec-sunspots"><i class="fas fa-link"></i></a>
</h2>
<p>再从官网拿到最近的数据</p>
<div class="sourceCode" id="cb2351"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sunspot.month</span>, xlab <span class="op">=</span> <span class="st">"Year"</span>, ylab <span class="op">=</span> <span class="st">"Monthly sunspot numbers"</span>,
     main <span class="op">=</span> <span class="st">"Monthly mean relative sunspot numbers from 1749 to 2013"</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">sunspot.month</span>,
  main <span class="op">=</span> <span class="st">"Monthly mean relative sunspot numbers from 1749 to 2013"</span>,
  xlab <span class="op">=</span> <span class="st">"Year"</span>, ylab <span class="op">=</span> <span class="st">"Monthly sunspot numbers"</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sunspot-month"></span>
<img src="time-series-analysis_files/figure-html/sunspot-month-1.png" alt="时序图：太阳黑子月均数量" width="768"><img src="time-series-analysis_files/figure-html/sunspot-month-2.png" alt="时序图：太阳黑子月均数量" width="768"><p class="caption">
图 31.2: 时序图：太阳黑子月均数量
</p>
</div>
<div class="sourceCode" id="cb2352"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">sunspots</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="time-series-analysis_files/figure-html/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb2353"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">sunspot.year</span>, xlab <span class="op">=</span> <span class="st">"Year"</span>, ylab <span class="op">=</span> <span class="st">"Yearly Sunspot Data, 1700-1988"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sunspots-year-tsplot"></span>
<img src="time-series-analysis_files/figure-html/sunspots-year-tsplot-1.png" alt="太阳黑子数量年平均时序图" width="672"><p class="caption">
图 31.3: 太阳黑子数量年平均时序图
</p>
</div>
<div class="sourceCode" id="cb2354"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/dygraphs">dygraphs</a></span><span class="op">)</span>
<span class="va">hw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/HoltWinters.html">HoltWinters</a></span><span class="op">(</span><span class="va">sunspot.month</span><span class="op">)</span>
<span class="va">predicted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">hw</span>, n.ahead <span class="op">=</span> <span class="fl">72</span>, prediction.interval <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/dygraphs/man/dygraph.html">dygraph</a></span><span class="op">(</span><span class="va">predicted</span>, main <span class="op">=</span> <span class="st">"Predicted sunspot numbers"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/dygraphs/man/dygraphs-exports.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dygraphs/man/dyAxis.html">dyAxis</a></span><span class="op">(</span><span class="st">"x"</span>, drawGrid <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/dygraphs/man/dygraphs-exports.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dygraphs/man/dySeries.html">dySeries</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-c.html">c</a></span><span class="op">(</span><span class="st">"lwr"</span>, <span class="st">"fit"</span>, <span class="st">"upr"</span><span class="op">)</span>, label <span class="op">=</span> <span class="st">"sunspot"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/dygraphs/man/dygraphs-exports.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dygraphs/man/dyOptions.html">dyOptions</a></span><span class="op">(</span>colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-fce43d71b46c3fabf180" style="width:672px;height:480px;" class="dygraphs html-widget"></div>
<script type="application/json" data-for="htmlwidget-fce43d71b46c3fabf180">{"x":{"attrs":{"axes":{"x":{"pixelsPerLabel":60,"drawGrid":false,"drawAxis":true},"y":{"drawAxis":true}},"title":"Predicted sunspot numbers","labels":["month","sunspot"],"legend":"auto","retainDateWindow":false,"customBars":true,"series":{"sunspot":{"axis":"y"}},"stackedGraph":false,"fillGraph":false,"fillAlpha":0.15,"stepPlot":false,"drawPoints":false,"pointSize":1,"drawGapEdgePoints":false,"connectSeparatedPoints":false,"strokeWidth":1,"strokeBorderColor":"white","colors":["#4B0055","#009B95","#FDE333"],"colorValue":0.5,"colorSaturation":1,"includeZero":false,"drawAxesAtZero":false,"logscale":false,"axisTickSize":3,"axisLineColor":"black","axisLineWidth":0.3,"axisLabelColor":"black","axisLabelFontSize":14,"axisLabelWidth":60,"drawGrid":true,"gridLineWidth":0.3,"rightGap":5,"digitsAfterDecimal":2,"labelsKMB":false,"labelsKMG2":false,"labelsUTC":false,"maxNumberWidth":6,"animatedZooms":false,"mobileDisableYTouch":true,"disableZoom":false},"scale":"monthly","annotations":[],"shadings":[],"events":[],"format":"date","data":[["2013-10-01T00:00:00.000Z","2013-11-01T00:00:00.000Z","2013-12-01T00:00:00.000Z","2014-01-01T00:00:00.000Z","2014-02-01T00:00:00.000Z","2014-03-01T00:00:00.000Z","2014-04-01T00:00:00.000Z","2014-05-01T00:00:00.000Z","2014-06-01T00:00:00.000Z","2014-07-01T00:00:00.000Z","2014-08-01T00:00:00.000Z","2014-09-01T00:00:00.000Z","2014-10-01T00:00:00.000Z","2014-11-01T00:00:00.000Z","2014-12-01T00:00:00.000Z","2015-01-01T00:00:00.000Z","2015-02-01T00:00:00.000Z","2015-03-01T00:00:00.000Z","2015-04-01T00:00:00.000Z","2015-05-01T00:00:00.000Z","2015-06-01T00:00:00.000Z","2015-07-01T00:00:00.000Z","2015-08-01T00:00:00.000Z","2015-09-01T00:00:00.000Z","2015-10-01T00:00:00.000Z","2015-11-01T00:00:00.000Z","2015-12-01T00:00:00.000Z","2016-01-01T00:00:00.000Z","2016-02-01T00:00:00.000Z","2016-03-01T00:00:00.000Z","2016-04-01T00:00:00.000Z","2016-05-01T00:00:00.000Z","2016-06-01T00:00:00.000Z","2016-07-01T00:00:00.000Z","2016-08-01T00:00:00.000Z","2016-09-01T00:00:00.000Z","2016-10-01T00:00:00.000Z","2016-11-01T00:00:00.000Z","2016-12-01T00:00:00.000Z","2017-01-01T00:00:00.000Z","2017-02-01T00:00:00.000Z","2017-03-01T00:00:00.000Z","2017-04-01T00:00:00.000Z","2017-05-01T00:00:00.000Z","2017-06-01T00:00:00.000Z","2017-07-01T00:00:00.000Z","2017-08-01T00:00:00.000Z","2017-09-01T00:00:00.000Z","2017-10-01T00:00:00.000Z","2017-11-01T00:00:00.000Z","2017-12-01T00:00:00.000Z","2018-01-01T00:00:00.000Z","2018-02-01T00:00:00.000Z","2018-03-01T00:00:00.000Z","2018-04-01T00:00:00.000Z","2018-05-01T00:00:00.000Z","2018-06-01T00:00:00.000Z","2018-07-01T00:00:00.000Z","2018-08-01T00:00:00.000Z","2018-09-01T00:00:00.000Z","2018-10-01T00:00:00.000Z","2018-11-01T00:00:00.000Z","2018-12-01T00:00:00.000Z","2019-01-01T00:00:00.000Z","2019-02-01T00:00:00.000Z","2019-03-01T00:00:00.000Z","2019-04-01T00:00:00.000Z","2019-05-01T00:00:00.000Z","2019-06-01T00:00:00.000Z","2019-07-01T00:00:00.000Z","2019-08-01T00:00:00.000Z","2019-09-01T00:00:00.000Z"],[[17.132528632674,50.2357681319726,83.3390076312712],[14.3298475165923,51.2079764150803,88.0861053135683],[5.84413039414104,46.1535922042659,86.4630540143908],[2.14362651582584,45.6222915349252,89.1009565540246],[-4.33572014637315,42.1037251313946,88.5431704091623],[1.46098184816437,50.6904130291456,99.9198442101269],[-3.13625371037402,48.7399416717229,100.61613705382],[-5.31219350929583,49.0884610993779,103.489115708052],[-8.99347636193467,47.8256445691833,104.644765500301],[-9.00953383014712,50.1350718182951,109.279677466737],[-10.4168168698536,50.9708669846159,112.358550839085],[-15.5357881341561,48.021299935504,111.578388005164],[-16.1631457407242,50.1890733464048,116.541292433534],[-17.2131293381704,51.1612816295125,119.535692597195],[-24.2365329206741,46.1068974186981,116.45032775807],[-26.6880331994198,45.5755967493574,117.839226698135],[-32.0817788229111,42.0570303458267,116.195839514565],[-25.328589290511,50.6437182435778,126.616025777667],[-29.073832010063,48.693246886155,126.460325782373],[-30.4839845744254,49.04176631381,128.567517202045],[-33.4717233231673,47.7789497836154,129.029622890398],[-32.8555794881868,50.0883770327272,133.032333553641],[-33.6833337850047,50.9241721990481,135.531678183101],[-38.2684421187564,47.9746051499361,134.217652418629],[-38.2355763466169,50.142378560837,138.520333468291],[-38.8382045459963,51.1145868439446,141.067378233886],[-45.4441802568727,46.0602026331303,137.564585523133],[-47.5049952281906,45.5289019637895,138.56279915577],[-52.5320749240051,42.0103355602589,136.552746044523],[-45.4338936146265,50.59702345801,146.627940530646],[-48.8537857092241,48.6465521005872,146.146889910398],[-49.9564559142999,48.9950715282422,147.946598970784],[-52.6530260433282,47.7322549980476,148.117536039423],[-51.7606574020287,50.0416822471594,151.844021896348],[-52.3259178479163,50.8774774134803,154.080872674877],[-56.6611848675918,47.9279103643683,152.517005596328],[-56.3068172599867,50.0956837752691,156.498184810525],[-56.6858092968174,51.0678920583768,158.821593413571],[-63.0779416506881,46.0135078475624,155.104957345813],[-64.9340312362542,45.4822071782217,155.898445592698],[-69.7648922732881,41.9636407746911,153.69217382267],[-62.4784438298379,50.5503286724421,163.579101174722],[-65.7175146804418,48.5998573150193,162.91722931048],[-66.6463478868375,48.9483767426744,164.543101372186],[-69.1756427825012,47.6855602124798,164.546763207461],[-68.1221731676874,49.9949874615916,168.112148090871],[-68.5321507166934,50.8307826279124,170.193715972518],[-72.7176248606573,47.8812155788005,168.480056018258],[-72.1665373164288,50.0489889897013,172.264515295831],[-72.4075532660385,51.021197272809,174.449947811656],[-78.666268189551,45.9668130619946,170.59989431354],[-80.3932649346896,45.4355123926539,171.264289719997],[-85.0991401153164,41.9169459891232,168.933032093563],[-77.6916101919639,50.5036338868743,178.698877965713],[-80.8133150237057,48.5531625294515,177.919640082609],[-81.6283212793761,48.9016819571065,179.431685193589],[-84.0471633727929,47.6388654269119,179.324894226617],[-82.8864607142805,49.9482926760237,182.783046066328],[-83.1922802677995,50.7840878423446,184.760455952489],[-87.2765356662304,47.8345207932326,182.945577252696],[-86.5906075093202,50.0022942041335,186.595195917587],[-86.7368751982979,50.9745024872411,188.68588017278],[-92.903380482437,45.9201182764268,184.743617035291],[-94.540602011164,45.388817607086,185.318237225336],[-99.1590380614167,41.8702512035554,182.899540468528],[-91.6663122008319,50.4569391013065,192.580190403445],[-94.7049764580829,48.5064677438837,191.71791194585],[-95.4390143847964,48.8549871715387,193.148988727874],[-97.7788816705265,47.5921706413441,192.963222953215],[-96.5411231002638,49.9015978904559,196.344318881176],[-96.7717348412792,50.7373930567768,198.246520954833],[-100.782563309615,47.7878260076648,196.358215324945]]],"fixedtz":false,"tzone":""},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb2355"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Noto Serif CJK SC"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sunspot.month</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">sunspots</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-c.html">c</a></span><span class="op">(</span><span class="st">"1749 至今"</span>, <span class="st">"1749-1983"</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"red"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sunspot"></span>
<img src="time-series-analysis_files/figure-html/sunspot-1.png" alt="月均太阳黑子数" width="672"><p class="caption">
图 31.4: 月均太阳黑子数
</p>
</div>
</div>
<div id="sec-EuStockMarkets" class="section level2" number="31.8">
<h2>
<span class="header-section-number">31.8</span> 1991-1998 年欧洲主要股票市场日闭市价格指数<a class="anchor" aria-label="anchor" href="#sec-EuStockMarkets"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb2356"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html">matplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/time.html">time</a></span><span class="op">(</span><span class="va">EuStockMarkets</span><span class="op">)</span>, <span class="va">EuStockMarkets</span>,
  main <span class="op">=</span> <span class="st">""</span>,
  xlab <span class="op">=</span> <span class="st">"Date"</span>, ylab <span class="op">=</span> <span class="st">"closing prices"</span>,
  pch <span class="op">=</span> <span class="fl">17</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">EuStockMarkets</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">17</span>, lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-16"></span>
<img src="time-series-analysis_files/figure-html/unnamed-chunk-16-1.png" alt="1991-1998年间欧洲主要股票市场日闭市价格指数图 
 德国 DAX (Ibis), Switzerland SMI, 法国 CAC 和 英国 FTSE" width="672"><p class="caption">
图 31.5: 1991-1998年间欧洲主要股票市场日闭市价格指数图
德国 DAX (Ibis), Switzerland SMI, 法国 CAC 和 英国 FTSE
</p>
</div>
<div class="sourceCode" id="cb2357"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 考虑收集加入最新的数据 1991~1998年的数据</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">EuStockMarkets</span>, plot.type <span class="op">=</span> <span class="st">"single"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">EuStockMarkets</span><span class="op">)</span>,
  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>, text.col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>,
  box.col <span class="op">=</span> <span class="cn">NA</span>, inset <span class="op">=</span> <span class="fl">0.05</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="time-series-analysis_files/figure-html/EuStockMarkets-1.png" width="576" style="display: block; margin: auto;"></div>
</div>
<div id="sec-autoregressive" class="section level2" number="31.9">
<h2>
<span class="header-section-number">31.9</span> 自回归模型<a class="anchor" aria-label="anchor" href="#sec-autoregressive"><i class="fas fa-link"></i></a>
</h2>
<p><code><a href="https://rdrr.io/r/stats/ar.html">ar()</a></code></p>
</div>
<div id="sec-moving-average" class="section level2" number="31.10">
<h2>
<span class="header-section-number">31.10</span> 移动平均模型<a class="anchor" aria-label="anchor" href="#sec-moving-average"><i class="fas fa-link"></i></a>
</h2>
<p><code><a href="https://rdrr.io/r/stats/arima.html">arima()</a></code></p>
</div>
<div id="sec-autoregressive-movement-average" class="section level2" number="31.11">
<h2>
<span class="header-section-number">31.11</span> 自回归移动平均模型<a class="anchor" aria-label="anchor" href="#sec-autoregressive-movement-average"><i class="fas fa-link"></i></a>
</h2>
<p><code><a href="https://rdrr.io/r/stats/arima.html">arima()</a></code> ARIMA</p>
</div>
<div id="sec-autoregressive-conditional-heteroskedasticity" class="section level2" number="31.12">
<h2>
<span class="header-section-number">31.12</span> 自回归条件异方差模型<a class="anchor" aria-label="anchor" href="#sec-autoregressive-conditional-heteroskedasticity"><i class="fas fa-link"></i></a>
</h2>
<p>自回归条件异方差模型 ARCH</p>
</div>
<div id="sec-generalized-autoregressive-conditional-heteroskedasticity" class="section level2" number="31.13">
<h2>
<span class="header-section-number">31.13</span> 广义自回归条件异方差模型<a class="anchor" aria-label="anchor" href="#sec-generalized-autoregressive-conditional-heteroskedasticity"><i class="fas fa-link"></i></a>
</h2>
<p>广义自回归条件异方差模型 （Generalized Autoregressive Conditional Heteroskedasticity，简称 GARCH ）</p>
</div>
<div id="sec-other-ts" class="section level2" number="31.14">
<h2>
<span class="header-section-number">31.14</span> 其它特征的时间序列<a class="anchor" aria-label="anchor" href="#sec-other-ts"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb2358"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">JohnsonJohnson</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">AirPassengers</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">nottem</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lynx</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:other-ts"></span>
<img src="time-series-analysis_files/figure-html/other-ts-1.png" alt="时间序列：非平稳、周期性、非线性" width="45%"><img src="time-series-analysis_files/figure-html/other-ts-2.png" alt="时间序列：非平稳、周期性、非线性" width="45%"><img src="time-series-analysis_files/figure-html/other-ts-3.png" alt="时间序列：非平稳、周期性、非线性" width="45%"><img src="time-series-analysis_files/figure-html/other-ts-4.png" alt="时间序列：非平稳、周期性、非线性" width="45%"><p class="caption">
图 31.6: 时间序列：非平稳、周期性、非线性
</p>
</div>
</div>
<div id="sec-hk-stock" class="section level2" number="31.15">
<h2>
<span class="header-section-number">31.15</span> 港股走势<a class="anchor" aria-label="anchor" href="#sec-hk-stock"><i class="fas fa-link"></i></a>
</h2>
<p>美团、阿里巴巴在香港上市</p>
<div class="sourceCode" id="cb2359"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 美团</span>
<span class="va">meituan</span> <span class="op">&lt;-</span> <span class="fu">quantmod</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/quantmod/man/getSymbols.html">getSymbols</a></span><span class="op">(</span><span class="st">"3690.HK"</span>, auto.assign <span class="op">=</span> <span class="cn">FALSE</span>, src <span class="op">=</span> <span class="st">"yahoo"</span>, from <span class="op">=</span> <span class="st">'2019-06-30'</span><span class="op">)</span>
<span class="co"># 阿里</span>
<span class="va">ali</span> <span class="op">&lt;-</span> <span class="fu">quantmod</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/quantmod/man/getSymbols.html">getSymbols</a></span><span class="op">(</span><span class="st">"9988.HK"</span>, auto.assign <span class="op">=</span> <span class="cn">FALSE</span>, src <span class="op">=</span> <span class="st">"yahoo"</span>, from <span class="op">=</span> <span class="st">'2019-06-30'</span><span class="op">)</span>
<span class="co"># 京东</span>
<span class="va">sw</span> <span class="op">&lt;-</span> <span class="fu">quantmod</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/quantmod/man/getSymbols.html">getSymbols</a></span><span class="op">(</span><span class="st">"9618.HK"</span>, auto.assign <span class="op">=</span> <span class="cn">FALSE</span>, src <span class="op">=</span> <span class="st">"yahoo"</span>, from <span class="op">=</span> <span class="st">'2019-06-30'</span><span class="op">)</span>
<span class="co"># 腾讯</span>
<span class="va">tx</span> <span class="op">&lt;-</span> <span class="fu">quantmod</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/quantmod/man/getSymbols.html">getSymbols</a></span><span class="op">(</span><span class="st">"0700.HK"</span>, auto.assign <span class="op">=</span> <span class="cn">FALSE</span>, src <span class="op">=</span> <span class="st">"yahoo"</span>, from <span class="op">=</span> <span class="st">'2019-06-30'</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2360"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 如何共 x 轴，右对齐</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">as.ts</a></span><span class="op">(</span><span class="va">meituan</span><span class="op">[</span>, <span class="st">"3690.HK.Close"</span><span class="op">]</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"orange"</span>, ylab <span class="op">=</span> <span class="st">"股价"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">as.ts</a></span><span class="op">(</span><span class="va">ali</span><span class="op">[</span>, <span class="st">"9988.HK.Close"</span><span class="op">]</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"springgreen4"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">as.ts</a></span><span class="op">(</span><span class="va">sw</span><span class="op">[</span>, <span class="st">"9618.HK.Close"</span><span class="op">]</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"purple4"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">as.ts</a></span><span class="op">(</span><span class="va">tx</span><span class="op">[</span>, <span class="st">"0700.HK.Close"</span><span class="op">]</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"lightsteelblue4"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-c.html">c</a></span><span class="op">(</span><span class="st">"Orange"</span>, <span class="st">"springgreen4"</span>, <span class="st">"purple4"</span>, <span class="st">"lightsteelblue4"</span><span class="op">)</span>, 
       lty <span class="op">=</span> <span class="fl">1</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-c.html">c</a></span><span class="op">(</span><span class="st">"美团"</span>, <span class="st">"阿里"</span>, <span class="st">"京东"</span>, <span class="st">"腾讯"</span><span class="op">)</span> <span class="op">)</span></code></pre></div>
</div>
<div id="sec-us-stock" class="section level2" number="31.16">
<h2>
<span class="header-section-number">31.16</span> 美股走势<a class="anchor" aria-label="anchor" href="#sec-us-stock"><i class="fas fa-link"></i></a>
</h2>
<p>拼多多、京东、阿里巴巴、51Talk 在美股上市</p>
<div class="sourceCode" id="cb2361"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 拼多多</span>
<span class="va">pdd</span> <span class="op">&lt;-</span> <span class="fu">quantmod</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/quantmod/man/getSymbols.html">getSymbols</a></span><span class="op">(</span><span class="st">"PDD"</span>, auto.assign <span class="op">=</span> <span class="cn">FALSE</span>, src <span class="op">=</span> <span class="st">"yahoo"</span><span class="op">)</span>
<span class="co"># 京东</span>
<span class="va">jd</span> <span class="op">&lt;-</span> <span class="fu">quantmod</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/quantmod/man/getSymbols.html">getSymbols</a></span><span class="op">(</span><span class="st">"JD"</span>, auto.assign <span class="op">=</span> <span class="cn">FALSE</span>, src <span class="op">=</span> <span class="st">"yahoo"</span><span class="op">)</span>
<span class="co"># 阿里巴巴</span>
<span class="va">baba</span> <span class="op">&lt;-</span> <span class="fu">quantmod</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/quantmod/man/getSymbols.html">getSymbols</a></span><span class="op">(</span><span class="st">"BABA"</span>, auto.assign <span class="op">=</span> <span class="cn">FALSE</span>, src <span class="op">=</span> <span class="st">"yahoo"</span><span class="op">)</span>
<span class="co"># 51Talk</span>
<span class="va">coe</span> <span class="op">&lt;-</span> <span class="fu">quantmod</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/quantmod/man/getSymbols.html">getSymbols</a></span><span class="op">(</span><span class="st">"COE"</span>, auto.assign <span class="op">=</span> <span class="cn">FALSE</span>, src <span class="op">=</span> <span class="st">"yahoo"</span>, from <span class="op">=</span> <span class="st">'2016-06-30'</span><span class="op">)</span></code></pre></div>
</div>
<div id="sec-coe-stock" class="section level2" number="31.17">
<h2>
<span class="header-section-number">31.17</span> 51Talk 股价走势<a class="anchor" aria-label="anchor" href="#sec-coe-stock"><i class="fas fa-link"></i></a>
</h2>
<p>Joshua M. Ulrich 开发维护的 <a href="https://github.com/joshuaulrich/quantmod">quantmod</a> 包可以下载国内外股票市场的数据</p>
<p>51talk 于 2016年6月10日在美国纽交所上市，股票代码 COE， 2020年1月22日，武汉封城，受新冠肺炎病毒影响，政府停课不停学的号召，线下教育纷纷转线上，线上教育的春天来临，股价开始回升到发行价的水平，在公司将资源转变为能力后，预期公司股价继续翻倍，回到理性的水平。</p>
<div class="sourceCode" id="cb2362"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">coe</span> <span class="op">&lt;-</span> <span class="fu">quantmod</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/quantmod/man/getSymbols.html">getSymbols</a></span><span class="op">(</span><span class="st">"COE"</span>, auto.assign <span class="op">=</span> <span class="cn">FALSE</span>, src <span class="op">=</span> <span class="st">"yahoo"</span>, from <span class="op">=</span> <span class="st">'2016-06-30'</span><span class="op">)</span></code></pre></div>
<p>读者可以从雅虎财经获取数据源 <a href="https://finance.yahoo.com/" class="uri">https://finance.yahoo.com/</a></p>
<p>COE 股价变化趋势见下图，包含开盘价 Open、最低价 Low、最高价 High、闭市价 Close 和调整价 Adjust 和交易额 Volume</p>
<div class="sourceCode" id="cb2363"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">coe</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:coe-price"></span>
<img src="time-series-analysis_files/figure-html/coe-price-1.png" alt="CEO 股价变化趋势" width="85%"><p class="caption">
图 31.7: CEO 股价变化趋势
</p>
</div>
</div>
<div id="sec-tsa-sessioninfo" class="section level2" number="31.18">
<h2>
<span class="header-section-number">31.18</span> 运行环境<a class="anchor" aria-label="anchor" href="#sec-tsa-sessioninfo"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb2364"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## R version 4.1.2 (2021-11-01)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 20.04.4 LTS
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] dygraphs_1.1.1.6 ggfortify_0.4.14 ggplot2_3.3.5    formatR_1.11    
## 
## loaded via a namespace (and not attached):
##  [1] zoo_1.8-9         tidyselect_1.1.1  xfun_0.29         bslib_0.3.1      
##  [5] purrr_0.3.4       lattice_0.20-45   colorspace_2.0-2  vctrs_0.3.8      
##  [9] generics_0.1.1    htmltools_0.5.2   yaml_2.2.1        utf8_1.2.2       
## [13] rlang_0.4.12      jquerylib_0.1.4   pillar_1.6.4      glue_1.6.0       
## [17] withr_2.4.3       DBI_1.1.2         TTR_0.24.3        lifecycle_1.0.1  
## [21] quantmod_0.4.18   stringr_1.4.0     munsell_0.5.0     gtable_0.3.0     
## [25] htmlwidgets_1.5.4 memoise_2.0.1     evaluate_0.14     labeling_0.4.2   
## [29] knitr_1.37        fastmap_1.1.0     curl_4.3.2        fansi_0.5.0      
## [33] highr_0.9         xts_0.12.1        scales_1.1.1      cachem_1.0.6     
## [37] showtext_0.9-4    jsonlite_1.7.2    sysfonts_0.8.5    farver_2.1.0     
## [41] fs_1.5.2          gridExtra_2.3     digest_0.6.29     stringi_1.7.6    
## [45] showtextdb_3.0    bookdown_0.24     dplyr_1.0.7       grid_4.1.2       
## [49] tools_4.1.2       magrittr_2.0.1    sass_0.4.0        tibble_3.1.6     
## [53] crayon_1.4.2      tidyr_1.1.4       pkgconfig_2.0.3   downlit_0.4.0    
## [57] ellipsis_0.3.2    xml2_1.3.3        assertthat_0.2.1  rmarkdown_2.11   
## [61] R6_2.5.1          compiler_4.1.2</code></pre>

</div>
</div>



<h3>参考文献</h3>
<div id="refs" class="references csl-bib-body">
<div id="ref-Brillinger_2001_TSD" class="csl-entry">
<div class="csl-left-margin">[81] </div>
<div class="csl-right-inline">D. R. Brillinger, <em>Time series: Data analysis and theory</em>. Philadelphia, PA, USA: Society for Industrial; Applied Mathematics, 2001.</div>
</div>
<div id="ref-robustbase2006" class="csl-entry">
<div class="csl-left-margin">[82] </div>
<div class="csl-right-inline">R. A. Maronna, R. D. Martin, and V. J. Yohai, <em>Robust statistics, theory and methods</em>. John Wiley &amp; Sons, Ltd, 2006.</div>
</div>
<div id="ref-Winters_1960_Forecasting" class="csl-entry">
<div class="csl-left-margin">[83] </div>
<div class="csl-right-inline">P. R. Winters, <span>“Forecasting sales by exponentially weighted moving averages,”</span> <em>Management Science</em>, vol. 6, no. 3, pp. 324–342, 1960, doi: <a href="https://doi.org/10.1287/mnsc.6.3.324">10.1287/mnsc.6.3.324</a>.</div>
</div>
<div id="ref-Holt_2004_Forecasting" class="csl-entry">
<div class="csl-left-margin">[84] </div>
<div class="csl-right-inline">C. C. Holt, <span>“Forecasting seasonals and trends by exponentially weighted moving averages,”</span> <em>International Journal of Forecasting</em>, vol. 20, no. 1, pp. 5–10, 2004, doi: <a href="https://doi.org/10.1016/j.ijforecast.2003.09.015">10.1016/j.ijforecast.2003.09.015</a>.</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="chap-survival-analysis.html"><span class="header-section-number">30</span> 生存分析</a></div>
<div class="next"><a href="chap-spatio-temporal-data.html">介绍</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#chap-time-series-analysis"><span class="header-section-number">31</span> 时序分析</a></li>
<li><a class="nav-link" href="#sec-ts-data"><span class="header-section-number">31.1</span> 时序数据</a></li>
<li><a class="nav-link" href="#sec-ts-plot"><span class="header-section-number">31.2</span> 时序图</a></li>
<li><a class="nav-link" href="#sec:frequency"><span class="header-section-number">31.3</span> 基本概念</a></li>
<li><a class="nav-link" href="#sec-ts-tests"><span class="header-section-number">31.4</span> 时序检验</a></li>
<li><a class="nav-link" href="#sec-exponential-smoothing"><span class="header-section-number">31.5</span> 指数平滑</a></li>
<li><a class="nav-link" href="#sec-holt-winters"><span class="header-section-number">31.6</span> Holt-Winters</a></li>
<li><a class="nav-link" href="#sec-sunspots"><span class="header-section-number">31.7</span> 1749-2013 年太阳黑子数据</a></li>
<li><a class="nav-link" href="#sec-EuStockMarkets"><span class="header-section-number">31.8</span> 1991-1998 年欧洲主要股票市场日闭市价格指数</a></li>
<li><a class="nav-link" href="#sec-autoregressive"><span class="header-section-number">31.9</span> 自回归模型</a></li>
<li><a class="nav-link" href="#sec-moving-average"><span class="header-section-number">31.10</span> 移动平均模型</a></li>
<li><a class="nav-link" href="#sec-autoregressive-movement-average"><span class="header-section-number">31.11</span> 自回归移动平均模型</a></li>
<li><a class="nav-link" href="#sec-autoregressive-conditional-heteroskedasticity"><span class="header-section-number">31.12</span> 自回归条件异方差模型</a></li>
<li><a class="nav-link" href="#sec-generalized-autoregressive-conditional-heteroskedasticity"><span class="header-section-number">31.13</span> 广义自回归条件异方差模型</a></li>
<li><a class="nav-link" href="#sec-other-ts"><span class="header-section-number">31.14</span> 其它特征的时间序列</a></li>
<li><a class="nav-link" href="#sec-hk-stock"><span class="header-section-number">31.15</span> 港股走势</a></li>
<li><a class="nav-link" href="#sec-us-stock"><span class="header-section-number">31.16</span> 美股走势</a></li>
<li><a class="nav-link" href="#sec-coe-stock"><span class="header-section-number">31.17</span> 51Talk 股价走势</a></li>
<li><a class="nav-link" href="#sec-tsa-sessioninfo"><span class="header-section-number">31.18</span> 运行环境</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/XiangyunHuang/masr/blob/devel/time-series-analysis.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/XiangyunHuang/masr/edit/devel/time-series-analysis.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>现代应用统计与 R 语言</strong>: Modern Applied Statistics with R" was written by 黄湘云. It was last built on 2022-03-13.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
