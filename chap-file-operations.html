<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>附录 F 文件操作 | 现代应用统计与 R 语言</title>

    <meta name="author" content="黄湘云" />
  
   <meta name="description" content="线性模型理论及其应用，注意模型的适用范围、参数估计方法、模型检验和诊断，理论和应用并重，同时附以真实的案例分析。将线性模型、广义线性模型、广义可加模型、线性混合效应模型、广义线性混合效应模型和广义可加混合效应模型融合到同一框架下。应用层面，要考虑数据集的平衡问题、缺失问题和异常问题。应用场景包括环境污染、流行病学和风险控制等领域。" />
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="附录 F 文件操作 | 现代应用统计与 R 语言" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/images/cover.png" />
  <meta property="og:description" content="线性模型理论及其应用，注意模型的适用范围、参数估计方法、模型检验和诊断，理论和应用并重，同时附以真实的案例分析。将线性模型、广义线性模型、广义可加模型、线性混合效应模型、广义线性混合效应模型和广义可加混合效应模型融合到同一框架下。应用层面，要考虑数据集的平衡问题、缺失问题和异常问题。应用场景包括环境污染、流行病学和风险控制等领域。" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="附录 F 文件操作 | 现代应用统计与 R 语言" />
  
  <meta name="twitter:description" content="线性模型理论及其应用，注意模型的适用范围、参数估计方法、模型检验和诊断，理论和应用并重，同时附以真实的案例分析。将线性模型、广义线性模型、广义可加模型、线性混合效应模型、广义线性混合效应模型和广义可加混合效应模型融合到同一框架下。应用层面，要考虑数据集的平衡问题、缺失问题和异常问题。应用场景包括环境污染、流行病学和风险控制等领域。" />
  <meta name="twitter:image" content="/images/cover.png" />
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/header-attrs/header-attrs.js"></script>
    <script src="libs/jquery/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat/transition.js"></script>
    <script src="libs/bs3compat/tabs.js"></script>
    <script src="libs/bs3compat/bs3compat.js"></script>
    <link href="libs/bs4_book/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book/bs4_book.js"></script>
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/plotly-binding/plotly.js"></script>
    <script src="libs/typedarray/typedarray.min.js"></script>
    <link href="libs/crosstalk/css/crosstalk.min.css" rel="stylesheet" />
    <script src="libs/crosstalk/js/crosstalk.min.js"></script>
    <link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="libs/plotly-main/plotly-latest.min.js"></script>
    <script src="libs/plotly-locale-zh-CN/zh-cn.js"></script>
    <script src="libs/mathjax/cdn.js"></script>
    <link href="libs/dygraphs/dygraph.css" rel="stylesheet" />
    <script src="libs/dygraphs/dygraph-combined.js"></script>
    <script src="libs/dygraphs/shapes.js"></script>
    <script src="libs/moment/moment.js"></script>
    <script src="libs/moment-timezone/moment-timezone-with-data.js"></script>
    <script src="libs/moment-fquarter/moment-fquarter.min.js"></script>
    <script src="libs/dygraphs-binding/dygraphs.js"></script>
    <script src="libs/Dygraph.Plugins.Unzoom/unzoom.js"></script>
    <script src="libs/echarts4r/echarts-en.min.js"></script>
    <script src="libs/echarts4r/ecStat.min.js"></script>
    <script src="libs/echarts4r/dataTool.min.js"></script>
    <script src="libs/echarts4r-binding/echarts4r.js"></script>
    <script src="libs/d3/d3.min.js"></script>
    <script src="libs/forceNetwork-binding/forceNetwork.js"></script>
    <link href="libs/vis/vis-network.min.css" rel="stylesheet" />
    <script src="libs/vis/vis-network.min.js"></script>
    <script src="libs/visNetwork-binding/visNetwork.js"></script>
    <script src="libs/FileSaver/FileSaver.min.js"></script>
    <script src="libs/Blob/Blob.js"></script>
    <script src="libs/canvas-toBlob/canvas-toBlob.js"></script>
    <script src="libs/html2canvas/html2canvas.js"></script>
    <script src="libs/jspdf/jspdf.debug.js"></script>
    <link href="libs/jquery-sparkline/jquery.sparkline.css" rel="stylesheet" />
    <script src="libs/jquery-sparkline/jquery.sparkline.js"></script>
    <script src="libs/sparkline-binding/sparkline.js"></script>
    <script src="libs/r2d3-render/r2d3-render.js"></script>
    <script src="libs/webcomponents/webcomponents.js"></script>
    <script src="libs/r2d3-binding/r2d3.js"></script>
    <script src="libs/d3v6/d3.min.js"></script>
    <script src="libs/es6shim/es6shim.js"></script>
    <script src="libs/es7shim/es7shim.js"></script>
    <script src="libs/graphre/graphre.js"></script>
    <script src="libs/nomnoml/nomnoml.js"></script>
    <script src="libs/nomnoml-binding/nomnoml.js"></script>
    <script src="libs/d3-bundle/d3-bundle.min.js"></script>
    <script src="libs/d3-lasso/d3-lasso.min.js"></script>
    <script src="libs/save-svg-as-png/save-svg-as-png.min.js"></script>
    <link href="libs/ggiraphjs/ggiraphjs.min.css" rel="stylesheet" />
    <script src="libs/ggiraphjs/ggiraphjs.min.js"></script>
    <script src="libs/girafe-binding/girafe.js"></script>
    <link href="libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding/datatables.js"></script>
    <link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core/js/jquery.dataTables.min.js"></script>
    <script src="libs/jszip/jszip.min.js"></script>
    <script src="libs/pdfmake/pdfmake.js"></script>
    <script src="libs/pdfmake/vfs_fonts.js"></script>
    <link href="libs/dt-ext-buttons/css/buttons.dataTables.min.css" rel="stylesheet" />
    <script src="libs/dt-ext-buttons/js/dataTables.buttons.min.js"></script>
    <script src="libs/dt-ext-buttons/js/buttons.html5.min.js"></script>
    <script src="libs/dt-ext-buttons/js/buttons.colVis.min.js"></script>
    <script src="libs/dt-ext-buttons/js/buttons.print.min.js"></script>
    <link href="libs/dt-ext-rowgroup/css/rowGroup.dataTables.min.css" rel="stylesheet" />
    <script src="libs/dt-ext-rowgroup/js/dataTables.rowGroup.min.js"></script>
    <script src="libs/kePrint/kePrint.js"></script>
    <link href="libs/lightable/lightable.css" rel="stylesheet" />
    <script src="libs/echarts-world/world.js"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-54GQKWF7VP"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-54GQKWF7VP');
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
    <link rel="stylesheet" href="style.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Modern Applied Statistics with R">现代应用统计与 R 语言</a>:
        <small class="text-muted">Modern Applied Statistics with R</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<div id="chap-file-operations" class="section level1" number="43">
<h1><span class="header-section-number">附录 F</span> 文件操作</h1>
<blockquote>
<p>考虑添加 Shell 下的命令实现，参考 <a href="https://github.com/jlevy/the-art-of-command-line/blob/master/README-zh.md">命令行的艺术</a></p>
</blockquote>
<div class="sourceCode" id="cb3075"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3075-1"><a href="chap-file-operations.html#cb3075-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr) <span class="co"># 提供管道命令 %&gt;%</span></span></code></pre></div>
<p><a href="https://github.com/r-lib/fs">fs</a> 由 <a href="https://www.jimhester.com/">Jim Hester</a> 开发，提供文件系统操作的统一接口，相比于 R 默认的文件系统的操作函数有显而易见的优点，详情请看 <a href="https://fs.r-lib.org/" class="uri">https://fs.r-lib.org/</a></p>
<p>对于文件操作，Jim Hester 开发了 <a href="https://github.com/r-lib/fs">fs 包</a> 目的是统一文件操作的命令，由于时间和历史原因，R内置的文件操作函数的命名很不统一，如 <code>path.expand()</code> 和 <code>normalizePath()</code>，<code>Sys.chmod()</code> 和 <code>file.access()</code> 等</p>
<div class="sourceCode" id="cb3076"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3076-1"><a href="chap-file-operations.html#cb3076-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 加载 R 包</span></span>
<span id="cb3076-2"><a href="chap-file-operations.html#cb3076-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fs)</span></code></pre></div>
<div id="list" class="section level2" number="43.1">
<h2><span class="header-section-number">F.1</span> 查看文件</h2>
<p>文件夹只包含文件，目录既包含文件又包含文件夹，<code>list.dirs</code> 列出目录或文件夹，<code>list.files</code> 列出文件或文件夹</p>
<ul>
<li><p><code>list.dirs(path = ".", full.names = TRUE, recursive = TRUE)</code></p>
<ul>
<li>path: 指定完整路径名，默认使用当前路径 <code>getwd()</code></li>
<li>full.names: TRUE 返回相对路径，FALSE 返回目录的名称</li>
<li>recursive: 是否递归的方式列出目录，如果是的话，目录下的子目录也会列出</li>
</ul>
<div class="sourceCode" id="cb3077"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3077-1"><a href="chap-file-operations.html#cb3077-1" aria-hidden="true" tabindex="-1"></a><span class="co"># list.dirs(path = &#39;.&#39;, full.names = TRUE, recursive = TRUE)</span></span>
<span id="cb3077-2"><a href="chap-file-operations.html#cb3077-2" aria-hidden="true" tabindex="-1"></a><span class="fu">list.dirs</span>(<span class="at">path =</span> <span class="st">&#39;.&#39;</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>, <span class="at">recursive =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;./_book&quot;                           &quot;./_bookdown_files&quot;                
##  [3] &quot;./.git&quot;                            &quot;./.github&quot;                        
##  [5] &quot;./bayesian-models_files&quot;           &quot;./case-study_cache&quot;               
##  [7] &quot;./case-study_files&quot;                &quot;./code&quot;                           
##  [9] &quot;./dashboard&quot;                       &quot;./data&quot;                           
## [11] &quot;./data-manipulation_files&quot;         &quot;./data-transportation_files&quot;      
....</code></pre>
<div class="sourceCode" id="cb3079"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3079-1"><a href="chap-file-operations.html#cb3079-1" aria-hidden="true" tabindex="-1"></a><span class="fu">list.dirs</span>(<span class="at">path =</span> <span class="st">&#39;.&#39;</span>, <span class="at">full.names =</span> <span class="cn">FALSE</span>, <span class="at">recursive =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;_book&quot;                           &quot;_bookdown_files&quot;                
##  [3] &quot;.git&quot;                            &quot;.github&quot;                        
##  [5] &quot;bayesian-models_files&quot;           &quot;case-study_cache&quot;               
##  [7] &quot;case-study_files&quot;                &quot;code&quot;                           
##  [9] &quot;dashboard&quot;                       &quot;data&quot;                           
## [11] &quot;data-manipulation_files&quot;         &quot;data-transportation_files&quot;      
....</code></pre></li>
<li><p><code>list.files(path = ".", pattern = NULL, all.files = FALSE, full.names = FALSE, recursive = FALSE,ignore.case = FALSE, include.dirs = FALSE, no.. = FALSE)</code></p>
<p>是否递归的方式列出目录，如果是的话，目录下的子目录也会列出</p>
<ul>
<li>path: 指定完整路径名，默认使用当前路径 <code>getwd()</code></li>
<li>full.names: TRUE 返回相对路径，FALSE 返回目录的名称</li>
<li>recursive: 是否递归的方式列出目录，如果是的话，目录下的子目录也会列出</li>
</ul></li>
<li><p><code>file.show(..., header = rep("", nfiles), title = "R Information", delete.file = FALSE, pager = getOption("pager"),encoding = "")</code></p>
<p>打开文件内容，<code>file.show</code> 会在R终端中新开一个窗口显示文件</p>
<div class="sourceCode" id="cb3081"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3081-1"><a href="chap-file-operations.html#cb3081-1" aria-hidden="true" tabindex="-1"></a>rinternals <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="fu">R.home</span>(<span class="st">&quot;include&quot;</span>), <span class="st">&quot;Rinternals.h&quot;</span>)</span>
<span id="cb3081-2"><a href="chap-file-operations.html#cb3081-2" aria-hidden="true" tabindex="-1"></a><span class="co"># file.show(rinternals)</span></span></code></pre></div></li>
<li><p><code>file.info(..., extra_cols = TRUE)</code></p>
<p>获取文件信息，此外 <code>file.mode(...)</code> 、 <code>file.mtime(...)</code> 和 <code>file.size(...)</code> 分别表示文件的读写权限，修改时间和文件大小。</p>
<div class="sourceCode" id="cb3082"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3082-1"><a href="chap-file-operations.html#cb3082-1" aria-hidden="true" tabindex="-1"></a><span class="fu">file.info</span>(rinternals)</span></code></pre></div>
<pre><code>##                                          size isdir mode               mtime
## /opt/R/4.1.2/lib/R/include/Rinternals.h 63180 FALSE  644 2022-02-08 00:33:14
##                                                       ctime               atime
## /opt/R/4.1.2/lib/R/include/Rinternals.h 2022-03-13 13:14:48 2022-03-13 13:24:36
##                                         uid gid uname grname
## /opt/R/4.1.2/lib/R/include/Rinternals.h   0   0  root   root</code></pre>
<div class="sourceCode" id="cb3084"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3084-1"><a href="chap-file-operations.html#cb3084-1" aria-hidden="true" tabindex="-1"></a><span class="fu">file.mode</span>(rinternals)</span></code></pre></div>
<pre><code>## [1] &quot;644&quot;</code></pre>
<div class="sourceCode" id="cb3086"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3086-1"><a href="chap-file-operations.html#cb3086-1" aria-hidden="true" tabindex="-1"></a><span class="fu">file.mtime</span>(rinternals)</span></code></pre></div>
<pre><code>## [1] &quot;2022-02-08 00:33:14 UTC&quot;</code></pre>
<div class="sourceCode" id="cb3088"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3088-1"><a href="chap-file-operations.html#cb3088-1" aria-hidden="true" tabindex="-1"></a><span class="fu">file.size</span>(rinternals)</span></code></pre></div>
<pre><code>## [1] 63180</code></pre>
<div class="sourceCode" id="cb3090"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3090-1"><a href="chap-file-operations.html#cb3090-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看当前目录的权限</span></span>
<span id="cb3090-2"><a href="chap-file-operations.html#cb3090-2" aria-hidden="true" tabindex="-1"></a><span class="fu">file.info</span>(<span class="st">&quot;.&quot;</span>)</span></code></pre></div>
<pre><code>##    size isdir mode               mtime               ctime               atime
## . 12288  TRUE  755 2022-03-13 13:35:05 2022-03-13 13:35:05 2022-03-13 13:35:06
##    uid gid  uname grname
## . 1001 121 runner docker</code></pre>
<div class="sourceCode" id="cb3092"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3092-1"><a href="chap-file-operations.html#cb3092-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看指定目录权限</span></span>
<span id="cb3092-2"><a href="chap-file-operations.html#cb3092-2" aria-hidden="true" tabindex="-1"></a><span class="fu">file.info</span>(<span class="st">&quot;./_book/&quot;</span>)    </span></code></pre></div>
<pre><code>##          size isdir mode               mtime               ctime
## ./_book/ 4096  TRUE  755 2022-03-13 13:26:42 2022-03-13 13:26:42
##                        atime  uid gid  uname grname
## ./_book/ 2022-03-13 13:28:57 1001 121 runner docker</code></pre></li>
<li><p><code>file.access(names, mode = 0)</code></p>
<p>文件是否可以被访问，第二个参数 mode 一共有四种取值 0，1，2，4，分别表示文件的存在性，可执行，可写和可读四种，返回值 0 表示成功，返回值 -1 表示失败。</p>
<div class="sourceCode" id="cb3094"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3094-1"><a href="chap-file-operations.html#cb3094-1" aria-hidden="true" tabindex="-1"></a><span class="fu">file.access</span>(rinternals,<span class="at">mode =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## /opt/R/4.1.2/lib/R/include/Rinternals.h 
##                                       0</code></pre>
<div class="sourceCode" id="cb3096"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3096-1"><a href="chap-file-operations.html#cb3096-1" aria-hidden="true" tabindex="-1"></a><span class="fu">file.access</span>(rinternals,<span class="at">mode =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## /opt/R/4.1.2/lib/R/include/Rinternals.h 
##                                      -1</code></pre>
<div class="sourceCode" id="cb3098"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3098-1"><a href="chap-file-operations.html#cb3098-1" aria-hidden="true" tabindex="-1"></a><span class="fu">file.access</span>(rinternals,<span class="at">mode =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## /opt/R/4.1.2/lib/R/include/Rinternals.h 
##                                      -1</code></pre>
<div class="sourceCode" id="cb3100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3100-1"><a href="chap-file-operations.html#cb3100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">file.access</span>(rinternals,<span class="at">mode =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## /opt/R/4.1.2/lib/R/include/Rinternals.h 
##                                       0</code></pre></li>
<li><p><code>dir(path = ".", pattern = NULL, all.files = FALSE, full.names = FALSE, recursive = FALSE, ignore.case = FALSE, include.dirs = FALSE, no.. = FALSE)</code></p>
<p>查看目录，首先看看和目录操作有关的函数列表</p>
<div class="sourceCode" id="cb3102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3102-1"><a href="chap-file-operations.html#cb3102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apropos</span>(<span class="st">&quot;^dir.&quot;</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;dir_copy&quot;   &quot;dir_create&quot; &quot;dir_delete&quot; &quot;dir_exists&quot; &quot;dir_info&quot;  
##  [6] &quot;dir_ls&quot;     &quot;dir_map&quot;    &quot;dir_tree&quot;   &quot;dir_walk&quot;   &quot;dir.create&quot;
## [11] &quot;dir.exists&quot; &quot;dirname&quot;</code></pre>
<p>显而易见，<code>dir.create</code> 和 <code>dir.exists</code> 分别是创建目录和查看目录的存在性。<code>dirname</code> 和 <code>basename</code> 是一对函数用来操作文件路径。以当前目录/home/runner/work/masr/masr为例，<code>dirname(getwd())</code> 返回 /home/runner/work/masr 而 <code>basename(getwd())</code> 返回 masr。对于文件路径而言，<code>dirname(rinternals)</code> 返回文件所在的目录/opt/R/4.1.2/lib/R/include， <code>basename(rinternals)</code> 返回文件名Rinternals.h。<code>dir</code> 函数查看指定路径或目录下的文件，支持以模式匹配和递归的方式查找目录下的文件</p>
<div class="sourceCode" id="cb3104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3104-1"><a href="chap-file-operations.html#cb3104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 当前目录下的子目录和文件</span></span>
<span id="cb3104-2"><a href="chap-file-operations.html#cb3104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dir</span>()</span></code></pre></div>
<pre><code>##   [1] &quot;_book&quot;                                      
##   [2] &quot;_bookdown_files&quot;                            
##   [3] &quot;_bookdown.yml&quot;                              
##   [4] &quot;_build.sh&quot;                                  
##   [5] &quot;_common.R&quot;                                  
##   [6] &quot;_deploy-book.R&quot;                             
....</code></pre>
<div class="sourceCode" id="cb3106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3106-1"><a href="chap-file-operations.html#cb3106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看指定目录的子目录和文件</span></span>
<span id="cb3106-2"><a href="chap-file-operations.html#cb3106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dir</span>(<span class="at">path =</span> <span class="st">&quot;./&quot;</span>)</span></code></pre></div>
<pre><code>##   [1] &quot;_book&quot;                                      
##   [2] &quot;_bookdown_files&quot;                            
##   [3] &quot;_bookdown.yml&quot;                              
##   [4] &quot;_build.sh&quot;                                  
##   [5] &quot;_common.R&quot;                                  
##   [6] &quot;_deploy-book.R&quot;                             
....</code></pre>
<div class="sourceCode" id="cb3108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3108-1"><a href="chap-file-operations.html#cb3108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 只列出以字母R开头的子目录和文件</span></span>
<span id="cb3108-2"><a href="chap-file-operations.html#cb3108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dir</span>(<span class="at">path =</span> <span class="st">&quot;./&quot;</span>, <span class="at">pattern =</span> <span class="st">&quot;^R&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;README.md&quot;</code></pre>
<div class="sourceCode" id="cb3110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3110-1"><a href="chap-file-operations.html#cb3110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 列出目录下所有目录和文件，包括隐藏文件</span></span>
<span id="cb3110-2"><a href="chap-file-operations.html#cb3110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dir</span>(<span class="at">path =</span> <span class="st">&quot;./&quot;</span>, <span class="at">all.files =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##   [1] &quot;_book&quot;                                      
##   [2] &quot;_bookdown_files&quot;                            
##   [3] &quot;_bookdown.yml&quot;                              
##   [4] &quot;_build.sh&quot;                                  
##   [5] &quot;_common.R&quot;                                  
##   [6] &quot;_deploy-book.R&quot;                             
....</code></pre>
<div class="sourceCode" id="cb3112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3112-1"><a href="chap-file-operations.html#cb3112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 支持正则表达式</span></span>
<span id="cb3112-2"><a href="chap-file-operations.html#cb3112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dir</span>(<span class="at">pattern =</span> <span class="st">&#39;^[A-Z]+[.]txt$&#39;</span>, <span class="at">full.names=</span><span class="cn">TRUE</span>, <span class="fu">system.file</span>(<span class="st">&#39;doc&#39;</span>, <span class="st">&#39;SuiteSparse&#39;</span>, <span class="at">package=</span><span class="st">&#39;Matrix&#39;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;/home/runner/work/_temp/Library/Matrix/doc/SuiteSparse/AMD.txt&quot;    
## [2] &quot;/home/runner/work/_temp/Library/Matrix/doc/SuiteSparse/CHOLMOD.txt&quot;
## [3] &quot;/home/runner/work/_temp/Library/Matrix/doc/SuiteSparse/COLAMD.txt&quot; 
## [4] &quot;/home/runner/work/_temp/Library/Matrix/doc/SuiteSparse/SPQR.txt&quot;</code></pre>
<div class="sourceCode" id="cb3114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3114-1"><a href="chap-file-operations.html#cb3114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 在临时目录下递归创建一个目录</span></span>
<span id="cb3114-2"><a href="chap-file-operations.html#cb3114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="fu">paste0</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;/_book/tmp&quot;</span>), <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span></code></pre></div></li>
</ul>
<p>查看当前目录下的文件和文件夹 <code>tree -L 2 .</code> 或者 <code>ls -l .</code></p>
</div>
<div id="manipulation" class="section level2" number="43.2">
<h2><span class="header-section-number">F.2</span> 操作文件</h2>
<p>实现文件增删改查的函数如下</p>
<div class="sourceCode" id="cb3115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3115-1"><a href="chap-file-operations.html#cb3115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apropos</span>(<span class="st">&quot;^file.&quot;</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;file_access&quot;    &quot;file_chmod&quot;     &quot;file_chown&quot;     &quot;file_copy&quot;     
##  [5] &quot;file_create&quot;    &quot;file_delete&quot;    &quot;file_exists&quot;    &quot;file_info&quot;     
##  [9] &quot;file_move&quot;      &quot;file_show&quot;      &quot;file_size&quot;      &quot;file_temp&quot;     
## [13] &quot;file_temp_pop&quot;  &quot;file_temp_push&quot; &quot;file_test&quot;      &quot;file_touch&quot;    
## [17] &quot;file.access&quot;    &quot;file.append&quot;    &quot;file.choose&quot;    &quot;file.copy&quot;     
## [21] &quot;file.create&quot;    &quot;file.edit&quot;      &quot;file.exists&quot;    &quot;file.info&quot;     
## [25] &quot;file.link&quot;      &quot;file.mode&quot;      &quot;file.mtime&quot;     &quot;file.path&quot;     
## [29] &quot;file.remove&quot;    &quot;file.rename&quot;    &quot;file.show&quot;      &quot;file.size&quot;     
## [33] &quot;file.symlink&quot;   &quot;fileSnapshot&quot;</code></pre>
<ol style="list-style-type: decimal">
<li><p><code>file.create(..., showWarnings = TRUE)</code></p>
<p>创建/删除文件，检查文件的存在性</p>
<div class="sourceCode" id="cb3117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3117-1"><a href="chap-file-operations.html#cb3117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">file.create</span>(<span class="st">&#39;demo.txt&#39;</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb3119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3119-1"><a href="chap-file-operations.html#cb3119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">file.exists</span>(<span class="st">&#39;demo.txt&#39;</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb3121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3121-1"><a href="chap-file-operations.html#cb3121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">file.remove</span>(<span class="st">&#39;demo.txt&#39;</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb3123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3123-1"><a href="chap-file-operations.html#cb3123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">file.exists</span>(<span class="st">&#39;demo.txt&#39;</span>)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre></li>
<li><p><code>file.rename(from, to)</code> 文件重命名</p>
<div class="sourceCode" id="cb3125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3125-1"><a href="chap-file-operations.html#cb3125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">file.create</span>(<span class="st">&#39;demo.txt&#39;</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb3127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3127-1"><a href="chap-file-operations.html#cb3127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">file.rename</span>(<span class="at">from =</span> <span class="st">&#39;demo.txt&#39;</span>, <span class="at">to =</span> <span class="st">&#39;tmp.txt&#39;</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb3129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3129-1"><a href="chap-file-operations.html#cb3129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">file.exists</span>(<span class="st">&#39;tmp.txt&#39;</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre></li>
<li><p><code>file.append(file1, file2)</code> 追加文件 <code>file2</code> 的内容到文件 <code>file1</code> 上</p>
<div class="sourceCode" id="cb3131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3131-1"><a href="chap-file-operations.html#cb3131-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="at">paths =</span> <span class="st">&#39;data/&#39;</span>)) <span class="fu">dir.create</span>(<span class="at">path =</span> <span class="st">&#39;data/&#39;</span>)</span>
<span id="cb3131-2"><a href="chap-file-operations.html#cb3131-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 创建两个临时文件</span></span>
<span id="cb3131-3"><a href="chap-file-operations.html#cb3131-3" aria-hidden="true" tabindex="-1"></a><span class="co"># file.create(c(&#39;data/tmp1.md&#39;,&#39;data/tmp2.md&#39;))</span></span>
<span id="cb3131-4"><a href="chap-file-operations.html#cb3131-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 写入内容</span></span>
<span id="cb3131-5"><a href="chap-file-operations.html#cb3131-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;AAA</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">file =</span> <span class="st">&#39;data/tmp1.md&#39;</span>)</span>
<span id="cb3131-6"><a href="chap-file-operations.html#cb3131-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;BBB</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">file =</span> <span class="st">&#39;data/tmp2.md&#39;</span>)</span>
<span id="cb3131-7"><a href="chap-file-operations.html#cb3131-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 追加文件</span></span>
<span id="cb3131-8"><a href="chap-file-operations.html#cb3131-8" aria-hidden="true" tabindex="-1"></a><span class="fu">file.append</span>(<span class="at">file1 =</span> <span class="st">&#39;data/tmp1.md&#39;</span>, <span class="at">file2 =</span> <span class="st">&#39;data/tmp2.md&#39;</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb3133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3133-1"><a href="chap-file-operations.html#cb3133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 展示文件内容</span></span>
<span id="cb3133-2"><a href="chap-file-operations.html#cb3133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">readLines</span>(<span class="st">&#39;data/tmp1.md&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;AAA&quot; &quot;BBB&quot;</code></pre></li>
<li><p><code>file.copy(from, to, overwrite = recursive, recursive = FALSE,copy.mode = TRUE, copy.date = FALSE)</code> 复制文件，参考 <a href="https://blog.csdn.net/wzj_110/article/details/86497860" class="uri">https://blog.csdn.net/wzj_110/article/details/86497860</a></p>
<div class="sourceCode" id="cb3135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3135-1"><a href="chap-file-operations.html#cb3135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">file.copy</span>(<span class="at">from =</span> <span class="st">&#39;Makefile&#39;</span>, <span class="at">to =</span> <span class="st">&#39;data/Makefile&#39;</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre></li>
<li><p><code>file.symlink(from, to)</code> 创建符号链接 <code>file.link(from, to)</code> 创建硬链接</p></li>
<li><p><code>Sys.junction(from, to)</code> windows 平台上的函数，提供类似符号链接的功能</p></li>
<li><p><code>Sys.readlink(paths)</code> 读取文件的符号链接（软链接）</p></li>
<li><p><code>choose.files</code> 在 Windows 环境下交互式地选择一个或多个文件，所以该函数只运行于 Windows 环境</p>
<div class="sourceCode" id="cb3137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3137-1"><a href="chap-file-operations.html#cb3137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 选择 zip 格式的压缩文件或其它</span></span>
<span id="cb3137-2"><a href="chap-file-operations.html#cb3137-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">interactive</span>())</span>
<span id="cb3137-3"><a href="chap-file-operations.html#cb3137-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">choose.files</span>(<span class="at">filters =</span> Filters[<span class="fu">c</span>(<span class="st">&quot;zip&quot;</span>, <span class="st">&quot;All&quot;</span>),])</span></code></pre></div>
<p><code>Filters</code> 参数传递一个矩阵，用来描述或标记R识别的文件类型，上面这个例子就能筛选出 zip 格式的文件</p></li>
<li><p><code>download.file</code> 文件下载</p>
<div class="sourceCode" id="cb3138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3138-1"><a href="chap-file-operations.html#cb3138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="at">url =</span> <span class="st">&#39;https://mirrors.tuna.tsinghua.edu.cn/CRAN/src/base/R-latest.tar.gz&#39;</span>,</span>
<span id="cb3138-2"><a href="chap-file-operations.html#cb3138-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">destfile =</span> <span class="st">&#39;data/R-latest.tar.gz&#39;</span>, <span class="at">method =</span> <span class="st">&#39;auto&#39;</span>)</span></code></pre></div></li>
</ol>
</div>
<div id="compression" class="section level2" number="43.3">
<h2><span class="header-section-number">F.3</span> 压缩文件</h2>
<p>tar 和 zip 是两种常见的压缩文件工具，具有免费和跨平台的特点，因此应用范围广<a href="references.html#fn86" class="footnote-ref" id="fnref86"><sup>86</sup></a>。 R 内对应的压缩与解压缩命令是 <code>tar/untar</code></p>
<div class="sourceCode" id="cb3139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3139-1"><a href="chap-file-operations.html#cb3139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar</span>(tarfile, <span class="at">files =</span> <span class="cn">NULL</span>,</span>
<span id="cb3139-2"><a href="chap-file-operations.html#cb3139-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">compression =</span> <span class="fu">c</span>(<span class="st">&quot;none&quot;</span>, <span class="st">&quot;gzip&quot;</span>, <span class="st">&quot;bzip2&quot;</span>, <span class="st">&quot;xz&quot;</span>),</span>
<span id="cb3139-3"><a href="chap-file-operations.html#cb3139-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">compression_level =</span> <span class="dv">6</span>, <span class="at">tar =</span> <span class="fu">Sys.getenv</span>(<span class="st">&quot;tar&quot;</span>),</span>
<span id="cb3139-4"><a href="chap-file-operations.html#cb3139-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">extra_flags =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p>比较常用的压缩文件格式是 <code>.tar.gz</code> 和 <code>.tar.bz2</code>，将目录 <code>_book/</code>及其文件分别压缩成 <code>_book.tar.gz</code> 和 <code>_book.tar.bz2</code> 压缩包的名字可以任意取，后者压缩比率高。<code>.tar.xz</code> 的压缩比率最高，需要确保系统中安装了 gzip，bzip2 和 xz-utils 软件，R 软件自带的 tar 软件来自 <a href="https://github.com/rwinlib/rtools35">Rtools</a><a href="references.html#fn87" class="footnote-ref" id="fnref87"><sup>87</sup></a>，我们可以通过设置系统环境变量 <code>Sys.setenv(tar="path/to/tar")</code> 指定外部 tar。<code>tar</code> 实际支持的压缩类型只有 <code>.tar.gz</code><a href="references.html#fn88" class="footnote-ref" id="fnref88"><sup>88</sup></a>。<code>zip/unzip</code> 压缩与解压缩就不赘述了。</p>
<div class="sourceCode" id="cb3140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3140-1"><a href="chap-file-operations.html#cb3140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 打包目录 _book</span></span>
<span id="cb3140-2"><a href="chap-file-operations.html#cb3140-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tar</span>(<span class="at">tarfile =</span> <span class="st">&#39;data/_book.tar&#39;</span>, <span class="at">files =</span> <span class="st">&#39;_book&#39;</span>, <span class="at">compression =</span> <span class="st">&#39;none&#39;</span>)</span>
<span id="cb3140-3"><a href="chap-file-operations.html#cb3140-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 文件压缩成 _book.xz 格式</span></span>
<span id="cb3140-4"><a href="chap-file-operations.html#cb3140-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tar</span>(<span class="at">tarfile =</span> <span class="st">&#39;data/_book.tar.xz&#39;</span>, <span class="at">files =</span> <span class="st">&#39;data/_book&#39;</span>, <span class="at">compression =</span> <span class="st">&#39;xz&#39;</span>)</span>
<span id="cb3140-5"><a href="chap-file-operations.html#cb3140-5" aria-hidden="true" tabindex="-1"></a><span class="co"># tar -cf data/_book.tar _book 然后 xz -z data/_book.tar.xz data/_book.tar</span></span>
<span id="cb3140-6"><a href="chap-file-operations.html#cb3140-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 或者一次压缩到位 tar -Jcf data/_book.tar.xz _book/</span></span>
<span id="cb3140-7"><a href="chap-file-operations.html#cb3140-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3140-8"><a href="chap-file-operations.html#cb3140-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 解压 xz -d data/_book.tar.xz 再次解压 tar -xf data/_book.tar</span></span>
<span id="cb3140-9"><a href="chap-file-operations.html#cb3140-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 或者一次解压 tar -Jxf data/_book.tar.xz</span></span>
<span id="cb3140-10"><a href="chap-file-operations.html#cb3140-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3140-11"><a href="chap-file-operations.html#cb3140-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 文件压缩成 _book.tar.gz 格式</span></span>
<span id="cb3140-12"><a href="chap-file-operations.html#cb3140-12" aria-hidden="true" tabindex="-1"></a><span class="co"># tar -czf data/_book.tar.gz _book</span></span>
<span id="cb3140-13"><a href="chap-file-operations.html#cb3140-13" aria-hidden="true" tabindex="-1"></a><span class="fu">tar</span>(<span class="at">tarfile =</span> <span class="st">&#39;data/_book.tar.gz&#39;</span>, <span class="at">files =</span> <span class="st">&#39;_book&#39;</span>, <span class="at">compression =</span> <span class="st">&#39;gzip&#39;</span>)</span>
<span id="cb3140-14"><a href="chap-file-operations.html#cb3140-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 解压 tar -xzf data/_book.tar.gz</span></span>
<span id="cb3140-15"><a href="chap-file-operations.html#cb3140-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3140-16"><a href="chap-file-operations.html#cb3140-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 文件压缩成 .tar.bz2 格式</span></span>
<span id="cb3140-17"><a href="chap-file-operations.html#cb3140-17" aria-hidden="true" tabindex="-1"></a><span class="co"># tar -cjf data/book2.tar.bz2 _book</span></span>
<span id="cb3140-18"><a href="chap-file-operations.html#cb3140-18" aria-hidden="true" tabindex="-1"></a><span class="fu">tar</span>(<span class="at">tarfile =</span> <span class="st">&#39;data/_book.tar.bz2&#39;</span>, <span class="at">files =</span> <span class="st">&#39;_book&#39;</span>, <span class="at">compression =</span> <span class="st">&#39;bzip2&#39;</span>)</span>
<span id="cb3140-19"><a href="chap-file-operations.html#cb3140-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 解压 tar -xjf data/book2.tar.bz2</span></span></code></pre></div>
<div class="sourceCode" id="cb3141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3141-1"><a href="chap-file-operations.html#cb3141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">untar</span>(tarfile, <span class="at">files =</span> <span class="cn">NULL</span>, <span class="at">list =</span> <span class="cn">FALSE</span>, <span class="at">exdir =</span> <span class="st">&quot;.&quot;</span>,</span>
<span id="cb3141-2"><a href="chap-file-operations.html#cb3141-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">compressed =</span> <span class="cn">NA</span>, <span class="at">extras =</span> <span class="cn">NULL</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb3141-3"><a href="chap-file-operations.html#cb3141-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">restore_times =</span>  <span class="cn">TRUE</span>, <span class="at">tar =</span> <span class="fu">Sys.getenv</span>(<span class="st">&quot;TAR&quot;</span>))</span></code></pre></div>
</div>
<div id="paths" class="section level2" number="43.4">
<h2><span class="header-section-number">F.4</span> 路径操作</h2>
<p>环境变量算是路径操作</p>
<div class="sourceCode" id="cb3142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3142-1"><a href="chap-file-operations.html#cb3142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取环境变量</span></span>
<span id="cb3142-2"><a href="chap-file-operations.html#cb3142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.getenv</span>(<span class="st">&quot;PATH&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;/home/runner/.TinyTeX/bin/x86_64-linux:/home/linuxbrew/.linuxbrew/bin:/home/linuxbrew/.linuxbrew/sbin:/home/runner/.local/bin:/opt/pipx_bin:/home/runner/.cargo/bin:/home/runner/.config/composer/vendor/bin:/usr/local/.ghcup/bin:/home/runner/.dotnet/tools:/snap/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin&quot;</code></pre>
<div class="sourceCode" id="cb3144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3144-1"><a href="chap-file-operations.html#cb3144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置环境变量 Windows</span></span>
<span id="cb3144-2"><a href="chap-file-operations.html#cb3144-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Sys.setenv(R_GSCMD = &quot;C:/Program Files/gs/gs9.26/bin/gswin64c.exe&quot;)</span></span>
<span id="cb3144-3"><a href="chap-file-operations.html#cb3144-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置 pandoc 环境变量</span></span>
<span id="cb3144-4"><a href="chap-file-operations.html#cb3144-4" aria-hidden="true" tabindex="-1"></a>pandoc_path <span class="ot">&lt;-</span> <span class="fu">Sys.getenv</span>(<span class="st">&quot;RSTUDIO_PANDOC&quot;</span>, <span class="cn">NA</span>)</span>
<span id="cb3144-5"><a href="chap-file-operations.html#cb3144-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">Sys.which</span>(<span class="st">&quot;pandoc&quot;</span>) <span class="sc">==</span> <span class="st">&quot;&quot;</span> <span class="sc">&amp;&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(pandoc_path)) {</span>
<span id="cb3144-6"><a href="chap-file-operations.html#cb3144-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.setenv</span>(<span class="at">PATH =</span> <span class="fu">paste</span>(</span>
<span id="cb3144-7"><a href="chap-file-operations.html#cb3144-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Sys.getenv</span>(<span class="st">&quot;PATH&quot;</span>), pandoc_path,</span>
<span id="cb3144-8"><a href="chap-file-operations.html#cb3144-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep =</span> <span class="cf">if</span> (.Platform<span class="sc">$</span>OS.type <span class="sc">==</span> <span class="st">&quot;unix&quot;</span>) <span class="st">&quot;:&quot;</span> <span class="cf">else</span> <span class="st">&quot;;&quot;</span></span>
<span id="cb3144-9"><a href="chap-file-operations.html#cb3144-9" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb3144-10"><a href="chap-file-operations.html#cb3144-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>操作文件路径</p>
<ol style="list-style-type: decimal">
<li><p><code>file.path</code> Construct Path to File</p>
<div class="sourceCode" id="cb3145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3145-1"><a href="chap-file-operations.html#cb3145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">file.path</span>(<span class="st">&#39;./_book&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;./_book&quot;</code></pre></li>
<li><p><code>path.expand(path)</code> Expand File Paths</p>
<div class="sourceCode" id="cb3147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3147-1"><a href="chap-file-operations.html#cb3147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">path.expand</span>(<span class="st">&#39;./_book&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;./_book&quot;</code></pre>
<div class="sourceCode" id="cb3149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3149-1"><a href="chap-file-operations.html#cb3149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">path.expand</span>(<span class="st">&#39;~&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;/home/runner&quot;</code></pre></li>
<li><p><code>normalizePath()</code> Express File Paths in Canonical Form</p>
<div class="sourceCode" id="cb3151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3151-1"><a href="chap-file-operations.html#cb3151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">normalizePath</span>(<span class="st">&#39;~&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;/home/runner&quot;</code></pre>
<div class="sourceCode" id="cb3153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3153-1"><a href="chap-file-operations.html#cb3153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">normalizePath</span>(<span class="st">&#39;./_book&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;/home/runner/work/masr/masr/_book&quot;</code></pre></li>
<li><p><code>shortPathName(path)</code> 只在 Windows 下可用，Express File Paths in Short Form</p>
<div class="sourceCode" id="cb3155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3155-1"><a href="chap-file-operations.html#cb3155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">shortPathName</span>(<span class="fu">c</span>(<span class="fu">R.home</span>(), <span class="fu">tempdir</span>())), <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div></li>
<li><p><code>Sys.glob</code> Wildcard Expansion on File Paths</p>
<div class="sourceCode" id="cb3156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3156-1"><a href="chap-file-operations.html#cb3156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.glob</span>(<span class="fu">file.path</span>(<span class="fu">R.home</span>(), <span class="st">&quot;library&quot;</span>, <span class="st">&quot;compiler&quot;</span>, <span class="st">&quot;R&quot;</span>, <span class="st">&quot;*.rdx&quot;</span>)) </span></code></pre></div>
<pre><code>## [1] &quot;/opt/R/4.1.2/lib/R/library/compiler/R/compiler.rdx&quot;</code></pre></li>
</ol>
</div>
<div id="find" class="section level2" number="43.5">
<h2><span class="header-section-number">F.5</span> 查找文件</h2>
<p><a href="https://github.com/r-lib/here">here</a> 包用来查找你的文件，查找文件、可执行文件的完整路径、R 包</p>
<ol style="list-style-type: decimal">
<li><p><code>Sys.which</code> Find Full Paths to Executables</p>
<div class="sourceCode" id="cb3158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3158-1"><a href="chap-file-operations.html#cb3158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.which</span>(<span class="st">&#39;pandoc&#39;</span>)</span></code></pre></div>
<pre><code>##            pandoc 
## &quot;/usr/bin/pandoc&quot;</code></pre></li>
<li><p><code>system.file</code> Find Names of R System Files</p>
<div class="sourceCode" id="cb3160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3160-1"><a href="chap-file-operations.html#cb3160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system.file</span>(<span class="st">&#39;CITATION&#39;</span>,<span class="at">package =</span> <span class="st">&#39;base&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;/opt/R/4.1.2/lib/R/library/base/CITATION&quot;</code></pre></li>
<li><p><code>R.home</code></p>
<div class="sourceCode" id="cb3162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3162-1"><a href="chap-file-operations.html#cb3162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R 安装目录</span></span>
<span id="cb3162-2"><a href="chap-file-operations.html#cb3162-2" aria-hidden="true" tabindex="-1"></a><span class="fu">R.home</span>()</span></code></pre></div>
<pre><code>## [1] &quot;/opt/R/4.1.2/lib/R&quot;</code></pre>
<div class="sourceCode" id="cb3164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3164-1"><a href="chap-file-operations.html#cb3164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R执行文件目录</span></span>
<span id="cb3164-2"><a href="chap-file-operations.html#cb3164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">R.home</span>(<span class="st">&#39;bin&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;/opt/R/4.1.2/lib/R/bin&quot;</code></pre>
<div class="sourceCode" id="cb3166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3166-1"><a href="chap-file-operations.html#cb3166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 配置文件目录</span></span>
<span id="cb3166-2"><a href="chap-file-operations.html#cb3166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">R.home</span>(<span class="st">&#39;etc&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;/opt/R/4.1.2/lib/R/etc&quot;</code></pre>
<div class="sourceCode" id="cb3168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3168-1"><a href="chap-file-operations.html#cb3168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R 基础扩展包存放目录</span></span>
<span id="cb3168-2"><a href="chap-file-operations.html#cb3168-2" aria-hidden="true" tabindex="-1"></a><span class="fu">R.home</span>(<span class="st">&#39;library&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;/opt/R/4.1.2/lib/R/library&quot;</code></pre></li>
<li><p><code>.libPaths()</code> R 包存放的路径有哪些</p>
<div class="sourceCode" id="cb3170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3170-1"><a href="chap-file-operations.html#cb3170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">.libPaths</span>()</span></code></pre></div>
<pre><code>## [1] &quot;/home/runner/work/_temp/Library&quot; &quot;/opt/R/4.1.2/lib/R/library&quot;</code></pre></li>
<li><p><code>find.package</code> 查找R包所在目录</p>
<div class="sourceCode" id="cb3172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3172-1"><a href="chap-file-operations.html#cb3172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">find.package</span>(<span class="at">package =</span> <span class="st">&#39;MASS&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;/opt/R/4.1.2/lib/R/library/MASS&quot;</code></pre></li>
<li><p><code>file.exist</code> 检查文件是否存在</p>
<div class="sourceCode" id="cb3174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3174-1"><a href="chap-file-operations.html#cb3174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">file.exists</span>(<span class="fu">paste</span>(<span class="fu">R.home</span>(<span class="st">&#39;etc&#39;</span>),<span class="st">&quot;Rprofile.site&quot;</span>,<span class="at">sep =</span> .Platform<span class="sc">$</span>file.sep))</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre></li>
<li><p><code>apropos</code> 和 <code>find</code> 查找对象</p></li>
</ol>
<div class="sourceCode" id="cb3176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3176-1"><a href="chap-file-operations.html#cb3176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apropos</span>(what, <span class="at">where =</span> <span class="cn">FALSE</span>, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>, <span class="at">mode =</span> <span class="st">&quot;any&quot;</span>)</span>
<span id="cb3176-2"><a href="chap-file-operations.html#cb3176-2" aria-hidden="true" tabindex="-1"></a><span class="fu">find</span>(what, <span class="at">mode =</span> <span class="st">&quot;any&quot;</span>, <span class="at">numeric =</span> <span class="cn">FALSE</span>, <span class="at">simple.words =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>匹配含有 find 的函数</p>
<div class="sourceCode" id="cb3177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3177-1"><a href="chap-file-operations.html#cb3177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apropos</span>(<span class="st">&quot;find&quot;</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;find&quot;                 &quot;Find&quot;                 &quot;find.package&quot;        
##  [4] &quot;findClass&quot;            &quot;findFunction&quot;         &quot;findInterval&quot;        
##  [7] &quot;findLineNum&quot;          &quot;findMethod&quot;           &quot;findMethods&quot;         
## [10] &quot;findMethodSignatures&quot; &quot;findPackageEnv&quot;       &quot;findRestart&quot;         
## [13] &quot;findUnique&quot;</code></pre>
<p>问号 <code>?</code> 加函数名搜索R软件内置函数的帮助文档，如 <code>?regrex</code>。如果不知道具体的函数名，可采用关键词搜索，如</p>
<div class="sourceCode" id="cb3179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3179-1"><a href="chap-file-operations.html#cb3179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">help.search</span>(<span class="at">keyword =</span> <span class="st">&quot;character&quot;</span>, <span class="at">package =</span> <span class="st">&quot;base&quot;</span>)</span></code></pre></div>
<p><code>browseEnv</code> 函数用来在浏览器中查看当前环境下，对象的列表，默认环境是 <code>sys.frame()</code></p>
</div>
<div id="permissions" class="section level2" number="43.6">
<h2><span class="header-section-number">F.6</span> 文件权限</h2>
<p>操作目录和文件的权限 Manipulation of Directories and File Permissions</p>
<ol style="list-style-type: decimal">
<li><p><code>dir.exists(paths)</code> 检查目录是否存在</p>
<div class="sourceCode" id="cb3180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3180-1"><a href="chap-file-operations.html#cb3180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.exists</span>(<span class="fu">c</span>(<span class="st">&#39;./_book&#39;</span>,<span class="st">&#39;./book&#39;</span>))</span></code></pre></div>
<pre><code>## [1]  TRUE FALSE</code></pre></li>
<li><p><code>dir.create(path, showWarnings = TRUE, recursive = FALSE, mode = "0777")</code> 创建目录</p>
<div class="sourceCode" id="cb3182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3182-1"><a href="chap-file-operations.html#cb3182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">&#39;./_book/tmp&#39;</span>)</span></code></pre></div></li>
<li><p><code>Sys.chmod(paths, mode = "0777", use_umask = TRUE)</code> 修改权限</p>
<div class="sourceCode" id="cb3183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3183-1"><a href="chap-file-operations.html#cb3183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.chmod</span>(<span class="st">&#39;./_book/tmp&#39;</span>)</span></code></pre></div></li>
<li><p><code>Sys.umask(mode = NA)</code></p></li>
</ol>
</div>
<div id="locale" class="section level2" number="43.7">
<h2><span class="header-section-number">F.7</span> 区域设置</h2>
<ol style="list-style-type: decimal">
<li><p><code>Sys.getlocale(category = "LC_ALL")</code> 查看当前区域设置</p>
<div class="sourceCode" id="cb3184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3184-1"><a href="chap-file-operations.html#cb3184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.getlocale</span>(<span class="at">category =</span> <span class="st">&quot;LC_ALL&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=en_US.UTF-8;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C&quot;</code></pre></li>
<li><p><code>Sys.setlocale(category = "LC_ALL", locale = "")</code> 设置区域</p>
<div class="sourceCode" id="cb3186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3186-1"><a href="chap-file-operations.html#cb3186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 默认设置</span></span>
<span id="cb3186-2"><a href="chap-file-operations.html#cb3186-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setlocale</span>(<span class="at">category =</span> <span class="st">&quot;LC_ALL&quot;</span>, <span class="at">locale =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=en_US.UTF-8;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C&quot;</code></pre>
<div class="sourceCode" id="cb3188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3188-1"><a href="chap-file-operations.html#cb3188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 保存当前区域设置</span></span>
<span id="cb3188-2"><a href="chap-file-operations.html#cb3188-2" aria-hidden="true" tabindex="-1"></a>old <span class="ot">&lt;-</span> <span class="fu">Sys.getlocale</span>()</span>
<span id="cb3188-3"><a href="chap-file-operations.html#cb3188-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3188-4"><a href="chap-file-operations.html#cb3188-4" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setlocale</span>(<span class="st">&quot;LC_MONETARY&quot;</span>, <span class="at">locale =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;en_US.UTF-8&quot;</code></pre>
<div class="sourceCode" id="cb3190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3190-1"><a href="chap-file-operations.html#cb3190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.localeconv</span>()</span></code></pre></div>
<pre><code>##     decimal_point     thousands_sep          grouping   int_curr_symbol 
##               &quot;.&quot;                &quot;&quot;                &quot;&quot;            &quot;USD &quot; 
##   currency_symbol mon_decimal_point mon_thousands_sep      mon_grouping 
##               &quot;$&quot;               &quot;.&quot;               &quot;,&quot;        &quot;\003\003&quot; 
##     positive_sign     negative_sign   int_frac_digits       frac_digits 
##                &quot;&quot;               &quot;-&quot;               &quot;2&quot;               &quot;2&quot; 
##     p_cs_precedes    p_sep_by_space     n_cs_precedes    n_sep_by_space 
##               &quot;1&quot;               &quot;0&quot;               &quot;1&quot;               &quot;0&quot; 
##       p_sign_posn       n_sign_posn 
##               &quot;1&quot;               &quot;1&quot;</code></pre>
<div class="sourceCode" id="cb3192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3192-1"><a href="chap-file-operations.html#cb3192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setlocale</span>(<span class="st">&quot;LC_MONETARY&quot;</span>, <span class="st">&quot;de_AT&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in Sys.setlocale(&quot;LC_MONETARY&quot;, &quot;de_AT&quot;): OS reports request to set
## locale to &quot;de_AT&quot; cannot be honored</code></pre>
<pre><code>## [1] &quot;&quot;</code></pre>
<div class="sourceCode" id="cb3195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3195-1"><a href="chap-file-operations.html#cb3195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.localeconv</span>()</span></code></pre></div>
<pre><code>##     decimal_point     thousands_sep          grouping   int_curr_symbol 
##               &quot;.&quot;                &quot;&quot;                &quot;&quot;            &quot;USD &quot; 
##   currency_symbol mon_decimal_point mon_thousands_sep      mon_grouping 
##               &quot;$&quot;               &quot;.&quot;               &quot;,&quot;        &quot;\003\003&quot; 
##     positive_sign     negative_sign   int_frac_digits       frac_digits 
##                &quot;&quot;               &quot;-&quot;               &quot;2&quot;               &quot;2&quot; 
##     p_cs_precedes    p_sep_by_space     n_cs_precedes    n_sep_by_space 
##               &quot;1&quot;               &quot;0&quot;               &quot;1&quot;               &quot;0&quot; 
##       p_sign_posn       n_sign_posn 
##               &quot;1&quot;               &quot;1&quot;</code></pre>
<div class="sourceCode" id="cb3197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3197-1"><a href="chap-file-operations.html#cb3197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 恢复区域设置</span></span>
<span id="cb3197-2"><a href="chap-file-operations.html#cb3197-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setlocale</span>(<span class="at">locale =</span> old)</span></code></pre></div>
<pre><code>## Warning in Sys.setlocale(locale = old): OS reports request to set locale to
## &quot;LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=en_US.UTF-8;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C&quot;
## cannot be honored</code></pre>
<pre><code>## [1] &quot;&quot;</code></pre></li>
<li><p><code>Sys.localeconv()</code> 当前区域设置下，数字和货币的表示</p>
<div class="sourceCode" id="cb3200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3200-1"><a href="chap-file-operations.html#cb3200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.localeconv</span>()</span></code></pre></div>
<pre><code>##     decimal_point     thousands_sep          grouping   int_curr_symbol 
##               &quot;.&quot;                &quot;&quot;                &quot;&quot;            &quot;USD &quot; 
##   currency_symbol mon_decimal_point mon_thousands_sep      mon_grouping 
##               &quot;$&quot;               &quot;.&quot;               &quot;,&quot;        &quot;\003\003&quot; 
##     positive_sign     negative_sign   int_frac_digits       frac_digits 
##                &quot;&quot;               &quot;-&quot;               &quot;2&quot;               &quot;2&quot; 
##     p_cs_precedes    p_sep_by_space     n_cs_precedes    n_sep_by_space 
##               &quot;1&quot;               &quot;0&quot;               &quot;1&quot;               &quot;0&quot; 
##       p_sign_posn       n_sign_posn 
##               &quot;1&quot;               &quot;1&quot;</code></pre>
<p>本地化信息</p>
<div class="sourceCode" id="cb3202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3202-1"><a href="chap-file-operations.html#cb3202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">l10n_info</span>()</span></code></pre></div>
<pre><code>## $MBCS
## [1] TRUE
## 
## $`UTF-8`
## [1] TRUE
## 
## $`Latin-1`
## [1] FALSE
## 
## $codeset
## [1] &quot;UTF-8&quot;</code></pre></li>
</ol>
</div>
<div id="process" class="section level2" number="43.8">
<h2><span class="header-section-number">F.8</span> 进程管理</h2>
<p><a href="https://github.com/r-lib/ps">ps</a> 包用来查询进程信息</p>
<ul>
<li><p><code>Sys.getpid</code> 获取当前运行中的 R 控制台（会话）的进程 ID</p>
<div class="sourceCode" id="cb3204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3204-1"><a href="chap-file-operations.html#cb3204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.getpid</span>()</span></code></pre></div>
<pre><code>## [1] 23038</code></pre></li>
<li><p><code>proc.time()</code> R 会话运行时间，常用于计算R程序在当前R控制台的运行时间</p>
<div class="sourceCode" id="cb3206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3206-1"><a href="chap-file-operations.html#cb3206-1" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">proc.time</span>()</span>
<span id="cb3206-2"><a href="chap-file-operations.html#cb3206-2" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fl">1e6</span>)</span>
<span id="cb3206-3"><a href="chap-file-operations.html#cb3206-3" aria-hidden="true" tabindex="-1"></a><span class="fu">proc.time</span>() <span class="sc">-</span> t1</span></code></pre></div>
<pre><code>##    user  system elapsed 
##   0.075   0.008   0.084</code></pre></li>
<li><p><code>system.time</code> 计算 R 表达式/程序块运行耗费的CPU时间</p>
<div class="sourceCode" id="cb3208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3208-1"><a href="chap-file-operations.html#cb3208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>({</span>
<span id="cb3208-2"><a href="chap-file-operations.html#cb3208-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rnorm</span>(<span class="fl">1e6</span>)</span>
<span id="cb3208-3"><a href="chap-file-operations.html#cb3208-3" aria-hidden="true" tabindex="-1"></a>}, <span class="at">gcFirst =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##    user  system elapsed 
##   0.075   0.004   0.080</code></pre></li>
<li><p><code>gc.time</code> 报告垃圾回收耗费的时间</p>
<div class="sourceCode" id="cb3210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3210-1"><a href="chap-file-operations.html#cb3210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gc.time</span>()</span></code></pre></div>
<pre><code>## [1] 0 0 0 0 0</code></pre></li>
</ul>
</div>
<div id="system-commands" class="section level2" number="43.9">
<h2><span class="header-section-number">F.9</span> 系统命令</h2>
<p><code>system</code> 和 <code>system2</code> 调用系统命令，推荐使用后者，它更灵活更便携。此外，Jeroen Ooms 开发的 <a href="https://github.com/jeroen/sys">sys 包</a> 可看作 <code>base::system2</code> 的替代品</p>
<div class="sourceCode" id="cb3212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3212-1"><a href="chap-file-operations.html#cb3212-1" aria-hidden="true" tabindex="-1"></a>system <span class="ot">&lt;-</span> <span class="cf">function</span>(...) <span class="fu">cat</span>(base<span class="sc">::</span><span class="fu">system</span>(..., <span class="at">intern =</span> <span class="cn">TRUE</span>), <span class="at">sep =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb3212-2"><a href="chap-file-operations.html#cb3212-2" aria-hidden="true" tabindex="-1"></a>system2 <span class="ot">&lt;-</span> <span class="cf">function</span>(...) <span class="fu">cat</span>(base<span class="sc">::</span><span class="fu">system2</span>(..., <span class="at">stdout =</span> <span class="cn">TRUE</span>), <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb3213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3213-1"><a href="chap-file-operations.html#cb3213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="at">command =</span> <span class="st">&quot;xelatex --version&quot;</span>)</span></code></pre></div>
<pre><code>## XeTeX 3.141592653-2.6-0.999993 (TeX Live 2021)
## kpathsea version 6.3.3
## Copyright 2021 SIL International, Jonathan Kew and Khaled Hosny.
## There is NO warranty.  Redistribution of this software is
## covered by the terms of both the XeTeX copyright and
## the Lesser GNU General Public License.
## For more information about these matters, see the file
## named COPYING and the XeTeX source.
## Primary author of XeTeX: Jonathan Kew.
## Compiled with ICU version 68.2; using 68.2
## Compiled with zlib version 1.2.11; using 1.2.11
## Compiled with FreeType2 version 2.10.4; using 2.10.4
## Compiled with Graphite2 version 1.3.14; using 1.3.14
## Compiled with HarfBuzz version 2.7.4; using 2.7.4
## Compiled with libpng version 1.6.37; using 1.6.37
## Compiled with pplib version v2.05 less toxic i hope
## Compiled with fontconfig version 2.11.0; using 2.13.1</code></pre>
<div class="sourceCode" id="cb3215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3215-1"><a href="chap-file-operations.html#cb3215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system2</span>(<span class="at">command =</span> <span class="st">&#39;pdflatex&#39;</span>, <span class="at">args =</span> <span class="st">&#39;--version&#39;</span>)</span></code></pre></div>
<pre><code>## pdfTeX 3.141592653-2.6-1.40.23 (TeX Live 2021)
## kpathsea version 6.3.3
## Copyright 2021 Han The Thanh (pdfTeX) et al.
## There is NO warranty.  Redistribution of this software is
## covered by the terms of both the pdfTeX copyright and
## the Lesser GNU General Public License.
## For more information about these matters, see the file
## named COPYING and the pdfTeX source.
## Primary author of pdfTeX: Han The Thanh (pdfTeX) et al.
## Compiled with libpng 1.6.37; using libpng 1.6.37
## Compiled with zlib 1.2.11; using zlib 1.2.11
## Compiled with xpdf version 4.03</code></pre>
</div>
<div id="time" class="section level2" number="43.10">
<h2><span class="header-section-number">F.10</span> 时间管理</h2>
<ol style="list-style-type: decimal">
<li><p><code>Sys.timezone</code> 获取时区信息</p>
<div class="sourceCode" id="cb3217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3217-1"><a href="chap-file-operations.html#cb3217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.timezone</span>(<span class="at">location =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;UTC&quot;</code></pre></li>
<li><p><code>Sys.time</code> 系统时间，可以给定时区下，显示当前时间，精确到秒，返回数据类型为 <code>POSIXct</code></p>
<div class="sourceCode" id="cb3219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3219-1"><a href="chap-file-operations.html#cb3219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 此时美国洛杉矶时间</span></span>
<span id="cb3219-2"><a href="chap-file-operations.html#cb3219-2" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="at">tz =</span> <span class="st">&#39;America/Los_Angeles&#39;</span>, <span class="at">usetz =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2022-03-13 06:35:07 PDT&quot;</code></pre>
<div class="sourceCode" id="cb3221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3221-1"><a href="chap-file-operations.html#cb3221-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 此时加拿大东部时间</span></span>
<span id="cb3221-2"><a href="chap-file-operations.html#cb3221-2" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="at">tz =</span> <span class="st">&#39;Canada/Eastern&#39;</span>, <span class="at">usetz =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2022-03-13 09:35:07 EDT&quot;</code></pre></li>
<li><p><code>Sys.Date</code> 显示当前时区下的日期，精确到日，返回数据类型为 <code>date</code></p>
<div class="sourceCode" id="cb3223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3223-1"><a href="chap-file-operations.html#cb3223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.Date</span>()</span></code></pre></div>
<pre><code>## [1] &quot;2022-03-13&quot;</code></pre></li>
<li><p><code>date</code> 返回当前系统日期和时间，数据类型是字符串</p>
<div class="sourceCode" id="cb3225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3225-1"><a href="chap-file-operations.html#cb3225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">date</span>()</span></code></pre></div>
<pre><code>## [1] &quot;Sun Mar 13 13:35:07 2022&quot;</code></pre>
<div class="sourceCode" id="cb3227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3227-1"><a href="chap-file-operations.html#cb3227-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 也可以这样表示</span></span>
<span id="cb3227-2"><a href="chap-file-operations.html#cb3227-2" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="st">&quot;%a %b %d %H:%M:%S %Y&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Sun Mar 13 13:35:07 2022&quot;</code></pre></li>
<li><p><code>as.POSIX*</code> 是一个 Date-time 转换函数</p>
<div class="sourceCode" id="cb3229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3229-1"><a href="chap-file-operations.html#cb3229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.POSIXlt</span>(<span class="fu">Sys.time</span>(), <span class="st">&quot;GMT&quot;</span>) <span class="co"># the current time in GMT</span></span></code></pre></div>
<pre><code>## [1] &quot;2022-03-13 13:35:07 GMT&quot;</code></pre></li>
<li><p>时间计算</p>
<div class="sourceCode" id="cb3231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3231-1"><a href="chap-file-operations.html#cb3231-1" aria-hidden="true" tabindex="-1"></a>(z <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>())             <span class="co"># the current date, as class &quot;POSIXct&quot;</span></span></code></pre></div>
<pre><code>## [1] &quot;2022-03-13 13:35:07 UTC&quot;</code></pre>
<div class="sourceCode" id="cb3233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3233-1"><a href="chap-file-operations.html#cb3233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.time</span>() <span class="sc">-</span> <span class="dv">3600</span>             <span class="co"># an hour ago</span></span></code></pre></div>
<pre><code>## [1] &quot;2022-03-13 12:35:07 UTC&quot;</code></pre></li>
<li><p><code>.leap.seconds</code> 是内置的日期序列</p>
<div class="sourceCode" id="cb3235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3235-1"><a href="chap-file-operations.html#cb3235-1" aria-hidden="true" tabindex="-1"></a>.leap.seconds</span></code></pre></div>
<pre><code>##  [1] &quot;1972-07-01 GMT&quot; &quot;1973-01-01 GMT&quot; &quot;1974-01-01 GMT&quot; &quot;1975-01-01 GMT&quot;
##  [5] &quot;1976-01-01 GMT&quot; &quot;1977-01-01 GMT&quot; &quot;1978-01-01 GMT&quot; &quot;1979-01-01 GMT&quot;
##  [9] &quot;1980-01-01 GMT&quot; &quot;1981-07-01 GMT&quot; &quot;1982-07-01 GMT&quot; &quot;1983-07-01 GMT&quot;
## [13] &quot;1985-07-01 GMT&quot; &quot;1988-01-01 GMT&quot; &quot;1990-01-01 GMT&quot; &quot;1991-01-01 GMT&quot;
## [17] &quot;1992-07-01 GMT&quot; &quot;1993-07-01 GMT&quot; &quot;1994-07-01 GMT&quot; &quot;1996-01-01 GMT&quot;
## [21] &quot;1997-07-01 GMT&quot; &quot;1999-01-01 GMT&quot; &quot;2006-01-01 GMT&quot; &quot;2009-01-01 GMT&quot;
## [25] &quot;2012-07-01 GMT&quot; &quot;2015-07-01 GMT&quot; &quot;2017-01-01 GMT&quot;</code></pre>
<p>计算日期对应的星期<code>weekdays</code>，月 <code>months</code> 和季度 <code>quarters</code></p>
<div class="sourceCode" id="cb3237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3237-1"><a href="chap-file-operations.html#cb3237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">weekdays</span>(.leap.seconds)</span></code></pre></div>
<pre><code>##  [1] &quot;Saturday&quot;  &quot;Monday&quot;    &quot;Tuesday&quot;   &quot;Wednesday&quot; &quot;Thursday&quot;  &quot;Saturday&quot; 
##  [7] &quot;Sunday&quot;    &quot;Monday&quot;    &quot;Tuesday&quot;   &quot;Wednesday&quot; &quot;Thursday&quot;  &quot;Friday&quot;   
## [13] &quot;Monday&quot;    &quot;Friday&quot;    &quot;Monday&quot;    &quot;Tuesday&quot;   &quot;Wednesday&quot; &quot;Thursday&quot; 
## [19] &quot;Friday&quot;    &quot;Monday&quot;    &quot;Tuesday&quot;   &quot;Friday&quot;    &quot;Sunday&quot;    &quot;Thursday&quot; 
## [25] &quot;Sunday&quot;    &quot;Wednesday&quot; &quot;Sunday&quot;</code></pre>
<div class="sourceCode" id="cb3239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3239-1"><a href="chap-file-operations.html#cb3239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">months</span>(.leap.seconds)</span></code></pre></div>
<pre><code>##  [1] &quot;July&quot;    &quot;January&quot; &quot;January&quot; &quot;January&quot; &quot;January&quot; &quot;January&quot; &quot;January&quot;
##  [8] &quot;January&quot; &quot;January&quot; &quot;July&quot;    &quot;July&quot;    &quot;July&quot;    &quot;July&quot;    &quot;January&quot;
## [15] &quot;January&quot; &quot;January&quot; &quot;July&quot;    &quot;July&quot;    &quot;July&quot;    &quot;January&quot; &quot;July&quot;   
## [22] &quot;January&quot; &quot;January&quot; &quot;January&quot; &quot;July&quot;    &quot;July&quot;    &quot;January&quot;</code></pre>
<div class="sourceCode" id="cb3241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3241-1"><a href="chap-file-operations.html#cb3241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quarters</span>(.leap.seconds)</span></code></pre></div>
<pre><code>##  [1] &quot;Q3&quot; &quot;Q1&quot; &quot;Q1&quot; &quot;Q1&quot; &quot;Q1&quot; &quot;Q1&quot; &quot;Q1&quot; &quot;Q1&quot; &quot;Q1&quot; &quot;Q3&quot; &quot;Q3&quot; &quot;Q3&quot; &quot;Q3&quot; &quot;Q1&quot; &quot;Q1&quot;
## [16] &quot;Q1&quot; &quot;Q3&quot; &quot;Q3&quot; &quot;Q3&quot; &quot;Q1&quot; &quot;Q3&quot; &quot;Q1&quot; &quot;Q1&quot; &quot;Q1&quot; &quot;Q3&quot; &quot;Q3&quot; &quot;Q1&quot;</code></pre></li>
<li><p><code>Sys.setFileTime()</code> 使用系统调用 system call 设置文件或目录的时间</p>
<div class="sourceCode" id="cb3243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3243-1"><a href="chap-file-operations.html#cb3243-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 修改时间前</span></span>
<span id="cb3243-2"><a href="chap-file-operations.html#cb3243-2" aria-hidden="true" tabindex="-1"></a><span class="fu">file.info</span>(<span class="st">&#39;./_common.R&#39;</span>)</span></code></pre></div>
<pre><code>##             size isdir mode               mtime               ctime
## ./_common.R 3290 FALSE  644 2022-03-13 13:13:39 2022-03-13 13:13:39
##                           atime  uid gid  uname grname
## ./_common.R 2022-03-13 13:26:42 1001 121 runner docker</code></pre>
<div class="sourceCode" id="cb3245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3245-1"><a href="chap-file-operations.html#cb3245-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 修改时间后，对比一下</span></span>
<span id="cb3245-2"><a href="chap-file-operations.html#cb3245-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setFileTime</span>(<span class="at">path =</span> <span class="st">&#39;./_common.R&#39;</span>, <span class="at">time =</span> <span class="fu">Sys.time</span>())</span>
<span id="cb3245-3"><a href="chap-file-operations.html#cb3245-3" aria-hidden="true" tabindex="-1"></a><span class="fu">file.info</span>(<span class="st">&#39;./_common.R&#39;</span>)</span></code></pre></div>
<pre><code>##             size isdir mode               mtime               ctime
## ./_common.R 3290 FALSE  644 2022-03-13 13:35:07 2022-03-13 13:35:07
##                           atime  uid gid  uname grname
## ./_common.R 2022-03-13 13:35:07 1001 121 runner docker</code></pre></li>
<li><p><code>strptime</code> 用于字符串与 <code>POSIXlt</code>、 <code>POSIXct</code> 类对象之间的转化，<code>format</code> 默认 <code>tz = ""</code> 且 <code>usetz = TRUE</code></p>
<div class="sourceCode" id="cb3247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3247-1"><a href="chap-file-operations.html#cb3247-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 存放时区信息的数据库所在目录</span></span>
<span id="cb3247-2"><a href="chap-file-operations.html#cb3247-2" aria-hidden="true" tabindex="-1"></a><span class="fu">list.files</span>(<span class="fu">file.path</span>(<span class="fu">R.home</span>(<span class="st">&quot;share&quot;</span>), <span class="st">&quot;zoneinfo&quot;</span>))</span></code></pre></div>
<pre><code>## character(0)</code></pre>
<div class="sourceCode" id="cb3249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3249-1"><a href="chap-file-operations.html#cb3249-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 比较不同的打印方式</span></span>
<span id="cb3249-2"><a href="chap-file-operations.html#cb3249-2" aria-hidden="true" tabindex="-1"></a><span class="fu">strptime</span>(<span class="fu">Sys.time</span>(), <span class="at">format =</span><span class="st">&quot;%Y-%m-%d %H:%M:%S&quot;</span>, <span class="at">tz =</span> <span class="st">&quot;Asia/Taipei&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2022-03-13 13:35:07 CST&quot;</code></pre>
<div class="sourceCode" id="cb3251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3251-1"><a href="chap-file-operations.html#cb3251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="at">format =</span> <span class="st">&quot;%Y-%m-%d %H:%M:%S&quot;</span>) <span class="co"># 默认情形</span></span></code></pre></div>
<pre><code>## [1] &quot;2022-03-13 13:35:07&quot;</code></pre>
<div class="sourceCode" id="cb3253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3253-1"><a href="chap-file-operations.html#cb3253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="at">format =</span> <span class="st">&quot;%Y-%m-%d %H:%M:%S&quot;</span>, <span class="at">tz =</span> <span class="st">&quot;Asia/Taipei&quot;</span>, <span class="at">usetz =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2022-03-13 21:35:07 CST&quot;</code></pre></li>
<li><p>设置时区</p>
<div class="sourceCode" id="cb3255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3255-1"><a href="chap-file-operations.html#cb3255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.timezone</span>()</span></code></pre></div>
<pre><code>## [1] &quot;UTC&quot;</code></pre>
<div class="sourceCode" id="cb3257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3257-1"><a href="chap-file-operations.html#cb3257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setenv</span>(<span class="at">TZ =</span> <span class="st">&quot;Asia/Shanghai&quot;</span>)</span>
<span id="cb3257-2"><a href="chap-file-operations.html#cb3257-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.timezone</span>()</span></code></pre></div>
<pre><code>## [1] &quot;Asia/Shanghai&quot;</code></pre>
<p>全局修改，在文件 /opt/R/4.1.2/lib/R/etc/Rprofile.site 内添加<code>Sys.setenv(TZ="Asia/Shanghai")</code>。 局部修改，就是在本地R项目下，创建 <code>.Rprofile</code>，然后同样添加 <code>Sys.setenv(TZ="Asia/Shanghai")</code>。</p></li>
</ol>
</div>
<div id="package" class="section level2" number="43.11">
<h2><span class="header-section-number">F.11</span> R 包管理</h2>
<p>相关的函数大致有</p>
<div class="sourceCode" id="cb3259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3259-1"><a href="chap-file-operations.html#cb3259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apropos</span>(<span class="st">&#39;package&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;.packages&quot;                      &quot;.packageStartupMessage&quot;        
##  [3] &quot;$.package_version&quot;              &quot;as.package_version&quot;            
##  [5] &quot;aspell_package_C_files&quot;         &quot;aspell_package_R_files&quot;        
##  [7] &quot;aspell_package_Rd_files&quot;        &quot;aspell_package_vignettes&quot;      
##  [9] &quot;available.packages&quot;             &quot;download.packages&quot;             
## [11] &quot;find.package&quot;                   &quot;findPackageEnv&quot;                
## [13] &quot;format.packageInfo&quot;             &quot;getPackageName&quot;                
## [15] &quot;install.packages&quot;               &quot;installed.packages&quot;            
## [17] &quot;is.package_version&quot;             &quot;make.packages.html&quot;            
## [19] &quot;methodsPackageMetaName&quot;         &quot;new.packages&quot;                  
....</code></pre>
<ol style="list-style-type: decimal">
<li><p><code>.packages(T)</code> 已安装的 R 包</p>
<div class="sourceCode" id="cb3261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3261-1"><a href="chap-file-operations.html#cb3261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">.packages</span>(T) <span class="sc">%&gt;%</span> <span class="fu">length</span>()</span></code></pre></div>
<pre><code>## [1] 462</code></pre></li>
<li><p><code>available.packages</code> 查询可用的 R 包</p>
<div class="sourceCode" id="cb3263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3263-1"><a href="chap-file-operations.html#cb3263-1" aria-hidden="true" tabindex="-1"></a><span class="fu">available.packages</span>()[,<span class="st">&quot;Package&quot;</span>] <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##           A3        aaSEA     AATtools          aba       ABACUS   abbreviate 
##         &quot;A3&quot;      &quot;aaSEA&quot;   &quot;AATtools&quot;        &quot;aba&quot;     &quot;ABACUS&quot; &quot;abbreviate&quot;</code></pre>
<p>查询 repos 的 R 包</p>
<div class="sourceCode" id="cb3265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3265-1"><a href="chap-file-operations.html#cb3265-1" aria-hidden="true" tabindex="-1"></a>rforge <span class="ot">&lt;-</span> <span class="fu">available.packages</span>(<span class="at">repos =</span> <span class="st">&quot;https://r-forge.r-project.org/&quot;</span>)</span>
<span id="cb3265-2"><a href="chap-file-operations.html#cb3265-2" aria-hidden="true" tabindex="-1"></a>cran <span class="ot">&lt;-</span> <span class="fu">available.packages</span>(<span class="at">repos =</span> <span class="st">&quot;https://mirrors.tuna.tsinghua.edu.cn/CRAN/&quot;</span>)</span>
<span id="cb3265-3"><a href="chap-file-operations.html#cb3265-3" aria-hidden="true" tabindex="-1"></a><span class="fu">setdiff</span>(rforge[, <span class="st">&quot;Package&quot;</span>], cran[, <span class="st">&quot;Package&quot;</span>])</span></code></pre></div></li>
<li><p><code>download.packages</code> 下载 R 包</p>
<div class="sourceCode" id="cb3266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3266-1"><a href="chap-file-operations.html#cb3266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">download.packages</span>(<span class="st">&quot;Rbooks&quot;</span>, <span class="at">destdir =</span> <span class="st">&quot;~/&quot;</span>, <span class="at">repos =</span> <span class="st">&quot;https://r-forge.r-project.org/&quot;</span>)</span></code></pre></div></li>
<li><p><code>install.packages</code> 安装 R 包</p>
<div class="sourceCode" id="cb3267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3267-1"><a href="chap-file-operations.html#cb3267-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;rmarkdown&quot;</span>)</span></code></pre></div></li>
<li><p><code>installed.packages</code> 已安装的 R 包</p>
<div class="sourceCode" id="cb3268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3268-1"><a href="chap-file-operations.html#cb3268-1" aria-hidden="true" tabindex="-1"></a><span class="fu">installed.packages</span>(<span class="at">fields =</span> <span class="fu">c</span>(<span class="st">&quot;Package&quot;</span>,<span class="st">&quot;Version&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div></li>
<li><p><code>remove.packages</code> 卸载/删除/移除已安装的R包</p>
<div class="sourceCode" id="cb3269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3269-1"><a href="chap-file-operations.html#cb3269-1" aria-hidden="true" tabindex="-1"></a><span class="fu">remove.packages</span>(<span class="st">&#39;rmarkdown&#39;</span>)</span></code></pre></div></li>
<li><p><code>update.packages</code> 更新已安装的 R 包</p>
<div class="sourceCode" id="cb3270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3270-1"><a href="chap-file-operations.html#cb3270-1" aria-hidden="true" tabindex="-1"></a><span class="fu">update.packages</span>(<span class="at">ask =</span> <span class="cn">FALSE</span>)</span></code></pre></div></li>
<li><p><code>old.packages</code> 查看过时/可更新的 R 包</p>
<div class="sourceCode" id="cb3271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3271-1"><a href="chap-file-operations.html#cb3271-1" aria-hidden="true" tabindex="-1"></a><span class="fu">old.packages</span>() <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##             Package       LibPath                           Installed Built  
## arrow       &quot;arrow&quot;       &quot;/home/runner/work/_temp/Library&quot; &quot;6.0.1&quot;   &quot;4.1.2&quot;
## arules      &quot;arules&quot;      &quot;/home/runner/work/_temp/Library&quot; &quot;1.7-2&quot;   &quot;4.1.2&quot;
## bayesplot   &quot;bayesplot&quot;   &quot;/home/runner/work/_temp/Library&quot; &quot;1.8.1&quot;   &quot;4.1.2&quot;
## brew        &quot;brew&quot;        &quot;/home/runner/work/_temp/Library&quot; &quot;1.0-6&quot;   &quot;4.1.2&quot;
## Brobdingnag &quot;Brobdingnag&quot; &quot;/home/runner/work/_temp/Library&quot; &quot;1.2-6&quot;   &quot;4.1.2&quot;
## broom       &quot;broom&quot;       &quot;/home/runner/work/_temp/Library&quot; &quot;0.7.11&quot;  &quot;4.1.2&quot;
##             ReposVer Repository                               
## arrow       &quot;7.0.0&quot;  &quot;https://cloud.r-project.org/src/contrib&quot;
## arules      &quot;1.7-3&quot;  &quot;https://cloud.r-project.org/src/contrib&quot;
## bayesplot   &quot;1.9.0&quot;  &quot;https://cloud.r-project.org/src/contrib&quot;
## brew        &quot;1.0-7&quot;  &quot;https://cloud.r-project.org/src/contrib&quot;
## Brobdingnag &quot;1.2-7&quot;  &quot;https://cloud.r-project.org/src/contrib&quot;
## broom       &quot;0.7.12&quot; &quot;https://cloud.r-project.org/src/contrib&quot;</code></pre></li>
<li><p><code>new.packages</code> 还没有安装的 R 包</p>
<div class="sourceCode" id="cb3273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3273-1"><a href="chap-file-operations.html#cb3273-1" aria-hidden="true" tabindex="-1"></a><span class="fu">new.packages</span>() <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## [1] &quot;A3&quot;         &quot;aaSEA&quot;      &quot;AATtools&quot;   &quot;aba&quot;        &quot;ABACUS&quot;    
## [6] &quot;abbreviate&quot;</code></pre></li>
<li><p><code>packageStatus</code> 查看已安装的 R 包状态，可更新、可下载等</p>
<div class="sourceCode" id="cb3275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3275-1"><a href="chap-file-operations.html#cb3275-1" aria-hidden="true" tabindex="-1"></a><span class="fu">packageStatus</span>()</span></code></pre></div>
<pre><code>## Number of installed packages:
##                                  
##                                    ok upgrade unavailable
##   /home/runner/work/_temp/Library 330      92          12
##   /opt/R/4.1.2/lib/R/library       19      10           0
## 
## Number of available packages (each package counted only once):
##                                          
##                                           installed not installed
##   https://cloud.r-project.org/src/contrib       436         18536</code></pre></li>
<li><p><code>packageDescription</code> 查询 R 包描述信息</p>
<div class="sourceCode" id="cb3277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3277-1"><a href="chap-file-operations.html#cb3277-1" aria-hidden="true" tabindex="-1"></a><span class="fu">packageDescription</span>(<span class="st">&#39;graphics&#39;</span>)</span></code></pre></div>
<pre><code>## Package: graphics
## Version: 4.1.2
## Priority: base
## Title: The R Graphics Package
## Author: R Core Team and contributors worldwide
## Maintainer: R Core Team &lt;do-use-Contact-address@r-project.org&gt;
....</code></pre></li>
<li><p>查询 R 包的依赖关系</p>
<div class="sourceCode" id="cb3279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3279-1"><a href="chap-file-operations.html#cb3279-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rmarkdown 依赖的 R 包</span></span>
<span id="cb3279-2"><a href="chap-file-operations.html#cb3279-2" aria-hidden="true" tabindex="-1"></a>tools<span class="sc">::</span><span class="fu">package_dependencies</span>(<span class="st">&#39;rmarkdown&#39;</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## $rmarkdown
##  [1] &quot;bslib&quot;     &quot;evaluate&quot;  &quot;htmltools&quot; &quot;jquerylib&quot; &quot;jsonlite&quot;  &quot;knitr&quot;    
##  [7] &quot;methods&quot;   &quot;stringr&quot;   &quot;tinytex&quot;   &quot;tools&quot;     &quot;utils&quot;     &quot;xfun&quot;     
## [13] &quot;yaml&quot;      &quot;grDevices&quot; &quot;sass&quot;      &quot;rlang&quot;     &quot;digest&quot;    &quot;base64enc&quot;
## [19] &quot;fastmap&quot;   &quot;highr&quot;     &quot;glue&quot;      &quot;magrittr&quot;  &quot;stringi&quot;   &quot;stats&quot;    
## [25] &quot;fs&quot;        &quot;R6&quot;        &quot;rappdirs&quot;</code></pre>
<div class="sourceCode" id="cb3281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3281-1"><a href="chap-file-operations.html#cb3281-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 依赖 rmarkdown 的 R 包</span></span>
<span id="cb3281-2"><a href="chap-file-operations.html#cb3281-2" aria-hidden="true" tabindex="-1"></a>tools<span class="sc">::</span><span class="fu">dependsOnPkgs</span>(<span class="st">&#39;rmarkdown&#39;</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;bookdown&quot;       &quot;formattable&quot;    &quot;hrbrthemes&quot;     &quot;kableExtra&quot;    
## [5] &quot;prettydoc&quot;      &quot;reprex&quot;         &quot;tint&quot;           &quot;packagemetrics&quot;
## [9] &quot;tidyverse&quot;</code></pre>
<p>ggplot2 生态，仅列出以 gg 开头的 R 包</p>
<div class="sourceCode" id="cb3283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3283-1"><a href="chap-file-operations.html#cb3283-1" aria-hidden="true" tabindex="-1"></a>pdb <span class="ot">&lt;-</span> <span class="fu">available.packages</span>()</span>
<span id="cb3283-2"><a href="chap-file-operations.html#cb3283-2" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> tools<span class="sc">::</span><span class="fu">dependsOnPkgs</span>(<span class="st">&quot;ggplot2&quot;</span>, <span class="at">recursive =</span> <span class="cn">FALSE</span>, <span class="at">installed =</span> pdb)</span>
<span id="cb3283-3"><a href="chap-file-operations.html#cb3283-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">&quot;^gg&quot;</span>, gg, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##   [1] &quot;gg.gap&quot;            &quot;ggalignment&quot;       &quot;ggallin&quot;          
##   [4] &quot;ggalluvial&quot;        &quot;ggalt&quot;             &quot;gganimate&quot;        
##   [7] &quot;ggarchery&quot;         &quot;ggasym&quot;            &quot;ggbeeswarm&quot;       
##  [10] &quot;ggborderline&quot;      &quot;ggbreak&quot;           &quot;ggBubbles&quot;        
##  [13] &quot;ggbuildr&quot;          &quot;ggbump&quot;            &quot;ggchangepoint&quot;    
##  [16] &quot;ggcharts&quot;          &quot;ggChernoff&quot;        &quot;ggcleveland&quot;      
##  [19] &quot;ggconf&quot;            &quot;ggcorrplot&quot;        &quot;ggdag&quot;            
##  [22] &quot;ggdark&quot;            &quot;ggDCA&quot;             &quot;ggdemetra&quot;        
##  [25] &quot;ggdendro&quot;          &quot;ggdensity&quot;         &quot;ggdist&quot;           
##  [28] &quot;ggdmc&quot;             &quot;ggDoubleHeat&quot;      &quot;ggeasy&quot;           
##  [31] &quot;ggedit&quot;            &quot;ggenealogy&quot;        &quot;ggESDA&quot;           
##  [34] &quot;ggetho&quot;            &quot;ggExtra&quot;           &quot;ggfacto&quot;          
##  [37] &quot;ggfan&quot;             &quot;ggfittext&quot;         &quot;ggfocus&quot;          
##  [40] &quot;ggforce&quot;           &quot;ggformula&quot;         &quot;ggfortify&quot;        
##  [43] &quot;ggfun&quot;             &quot;ggfx&quot;              &quot;gggap&quot;            
##  [46] &quot;gggenes&quot;           &quot;ggghost&quot;           &quot;gggibbous&quot;        
##  [49] &quot;gggrid&quot;            &quot;ggh4x&quot;             &quot;gghalfnorm&quot;       
##  [52] &quot;gghalves&quot;          &quot;gghdr&quot;             &quot;ggheatmap&quot;        
##  [55] &quot;gghighlight&quot;       &quot;gghilbertstrings&quot;  &quot;ggHoriPlot&quot;       
##  [58] &quot;ggimage&quot;           &quot;ggimg&quot;             &quot;gginference&quot;      
##  [61] &quot;gginnards&quot;         &quot;ggip&quot;              &quot;ggiraph&quot;          
##  [64] &quot;ggiraphExtra&quot;      &quot;ggjoy&quot;             &quot;gglm&quot;             
##  [67] &quot;gglogo&quot;            &quot;ggloop&quot;            &quot;gglorenz&quot;         
##  [70] &quot;ggmap&quot;             &quot;ggmatplot&quot;         &quot;ggmcmc&quot;           
##  [73] &quot;ggmosaic&quot;          &quot;ggmotif&quot;           &quot;ggmuller&quot;         
##  [76] &quot;ggmulti&quot;           &quot;ggnetwork&quot;         &quot;ggnewscale&quot;       
##  [79] &quot;ggnormalviolin&quot;    &quot;ggnuplot&quot;          &quot;ggOceanMaps&quot;      
##  [82] &quot;ggokabeito&quot;        &quot;ggpacman&quot;          &quot;ggpage&quot;           
##  [85] &quot;ggparallel&quot;        &quot;ggparliament&quot;      &quot;ggparty&quot;          
##  [88] &quot;ggpattern&quot;         &quot;ggperiodic&quot;        &quot;ggplot.multistats&quot;
##  [91] &quot;ggplotAssist&quot;      &quot;ggplotgui&quot;         &quot;ggplotify&quot;        
##  [94] &quot;ggplotlyExtra&quot;     &quot;ggpmisc&quot;           &quot;ggPMX&quot;            
##  [97] &quot;ggpointdensity&quot;    &quot;ggpointless&quot;       &quot;ggpol&quot;            
## [100] &quot;ggpolar&quot;           &quot;ggpolypath&quot;        &quot;ggpp&quot;             
## [103] &quot;ggprism&quot;           &quot;ggpubr&quot;            &quot;ggpval&quot;           
## [106] &quot;ggQC&quot;              &quot;ggQQunif&quot;          &quot;ggquickeda&quot;       
## [109] &quot;ggquiver&quot;          &quot;ggraph&quot;            &quot;ggraptR&quot;          
## [112] &quot;ggrasp&quot;            &quot;ggrastr&quot;           &quot;ggrepel&quot;          
## [115] &quot;ggResidpanel&quot;      &quot;ggridges&quot;          &quot;ggrisk&quot;           
## [118] &quot;ggROC&quot;             &quot;ggsci&quot;             &quot;ggseas&quot;           
## [121] &quot;ggseg&quot;             &quot;ggseqlogo&quot;         &quot;ggshadow&quot;         
## [124] &quot;ggside&quot;            &quot;ggsignif&quot;          &quot;ggsn&quot;             
## [127] &quot;ggsoccer&quot;          &quot;ggsolvencyii&quot;      &quot;ggsom&quot;            
## [130] &quot;ggspatial&quot;         &quot;ggspectra&quot;         &quot;ggstance&quot;         
## [133] &quot;ggstar&quot;            &quot;ggstatsplot&quot;       &quot;ggstream&quot;         
## [136] &quot;ggstudent&quot;         &quot;ggswissmaps&quot;       &quot;ggtea&quot;            
## [139] &quot;ggtern&quot;            &quot;ggtext&quot;            &quot;ggThemeAssist&quot;    
## [142] &quot;ggthemes&quot;          &quot;ggtikz&quot;            &quot;ggTimeSeries&quot;     
## [145] &quot;ggupset&quot;           &quot;ggvenn&quot;            &quot;ggVennDiagram&quot;    
## [148] &quot;ggvoronoi&quot;         &quot;ggwordcloud&quot;       &quot;ggx&quot;</code></pre></li>
<li><p>重装R包，与 R 版本号保持一致</p>
<div class="sourceCode" id="cb3285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3285-1"><a href="chap-file-operations.html#cb3285-1" aria-hidden="true" tabindex="-1"></a>db <span class="ot">&lt;-</span> <span class="fu">installed.packages</span>()</span>
<span id="cb3285-2"><a href="chap-file-operations.html#cb3285-2" aria-hidden="true" tabindex="-1"></a>db <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(db, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3285-3"><a href="chap-file-operations.html#cb3285-3" aria-hidden="true" tabindex="-1"></a>pkgs <span class="ot">&lt;-</span> db[db<span class="sc">$</span>Built <span class="sc">&lt;</span> <span class="fu">getRversion</span>(), <span class="st">&quot;Package&quot;</span>]</span>
<span id="cb3285-4"><a href="chap-file-operations.html#cb3285-4" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(pkgs)</span></code></pre></div></li>
</ol>
</div>
<div id="lookup-function" class="section level2" number="43.12">
<h2><span class="header-section-number">F.12</span> 查找函数</h2>
<p><a href="https://github.com/jimhester/lookup">lookup</a> R 函数完整定义，包括编译的代码，S3 和 S4 方法。目前 lookup 包处于开发版，我们可以用 <code>remotes::install_github</code> 函数来安装它</p>
<div class="sourceCode" id="cb3286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3286-1"><a href="chap-file-operations.html#cb3286-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;remotes&quot;)</span></span>
<span id="cb3286-2"><a href="chap-file-operations.html#cb3286-2" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;jimhester/lookup&quot;</span>)</span></code></pre></div>
<p>R-level 的源代码都可以直接看</p>
<div class="sourceCode" id="cb3287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3287-1"><a href="chap-file-operations.html#cb3287-1" aria-hidden="true" tabindex="-1"></a>body</span></code></pre></div>
<pre><code>## function (fun = sys.function(sys.parent())) 
## {
##     if (is.character(fun)) 
##         fun &lt;- get(fun, mode = &quot;function&quot;, envir = parent.frame())
##     .Internal(body(fun))
## }
## &lt;bytecode: 0x56151ad73e08&gt;
## &lt;environment: namespace:base&gt;</code></pre>
<p>此外，<code>lookup</code> 可以定位到 C-level 的源代码，需要联网才能查看，lookup 基于 Winston Chang 在 Github 上维护的 <a href="https://github.com/wch/r-source">R 源码镜像</a></p>
<div class="sourceCode" id="cb3289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3289-1"><a href="chap-file-operations.html#cb3289-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lookup</span>(body)</span></code></pre></div>
<pre><code>base::body [closure] 
function (fun = sys.function(sys.parent())) 
{
    if (is.character(fun)) 
        fun &lt;- get(fun, mode = &quot;function&quot;, envir = parent.frame())
    .Internal(body(fun))
}
&lt;bytecode: 0x00000000140d6158&gt;
&lt;environment: namespace:base&gt;
// c source: src/main/builtin.c#L264-L277
SEXP attribute_hidden do_body(SEXP call, SEXP op, SEXP args, SEXP rho)
{
    checkArity(op, args);
    if (TYPEOF(CAR(args)) == CLOSXP) {
        SEXP b = BODY_EXPR(CAR(args));
        RAISE_NAMED(b, NAMED(CAR(args)));
        return b;
    } else {
        if(!(TYPEOF(CAR(args)) == BUILTINSXP ||
             TYPEOF(CAR(args)) == SPECIALSXP))
            warningcall(call, _(&quot;argument is not a function&quot;));
        return R_NilValue;
    }
}</code></pre>
</div>
<div id="files-session-info" class="section level2" number="43.13">
<h2><span class="header-section-number">F.13</span> 运行环境</h2>
<div class="sourceCode" id="cb3291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3291-1"><a href="chap-file-operations.html#cb3291-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.1.2 (2021-11-01)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 20.04.4 LTS
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] rmarkdown_2.11 fs_1.5.2       magrittr_2.0.1
## 
## loaded via a namespace (and not attached):
##  [1] bookdown_0.24   sysfonts_0.8.5  digest_0.6.29   R6_2.5.1       
##  [5] jsonlite_1.7.2  evaluate_0.14   stringi_1.7.6   cachem_1.0.6   
##  [9] rlang_0.4.12    curl_4.3.2      jquerylib_0.1.4 xml2_1.3.3     
## [13] bslib_0.3.1     tools_4.1.2     stringr_1.4.0   xfun_0.29      
## [17] yaml_2.2.1      fastmap_1.1.0   compiler_4.1.2  memoise_2.0.1  
## [21] htmltools_0.5.2 downlit_0.4.0   knitr_1.37      sass_0.4.0</code></pre>

</div>
</div>
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>现代应用统计与 R 语言</strong>: Modern Applied Statistics with R" was written by 黄湘云. It was last built on 2022-03-13.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
<script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>

</html>
