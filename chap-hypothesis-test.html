<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>第 23 章 假设检验 | 现代应用统计与 R 语言</title>
<meta name="author" content="黄湘云">
<meta name="description" content='The Earth is Round (\(p &lt; 0.05\)) — Jacob Cohen [37]  {"x":{"code":"\n#fill: #FEFEFF\n#lineWidth: 1\n#zoom: 4\n#direction: right\n\n#stroke: black\n#.box: fill=#8f8 dashed...'>
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="第 23 章 假设检验 | 现代应用统计与 R 语言">
<meta property="og:type" content="book">
<meta property="og:image" content="/images/cover.png">
<meta property="og:description" content='The Earth is Round (\(p &lt; 0.05\)) — Jacob Cohen [37]  {"x":{"code":"\n#fill: #FEFEFF\n#lineWidth: 1\n#zoom: 4\n#direction: right\n\n#stroke: black\n#.box: fill=#8f8 dashed...'>
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="第 23 章 假设检验 | 现代应用统计与 R 语言">
<meta name="twitter:description" content='The Earth is Round (\(p &lt; 0.05\)) — Jacob Cohen [37]  {"x":{"code":"\n#fill: #FEFEFF\n#lineWidth: 1\n#zoom: 4\n#direction: right\n\n#stroke: black\n#.box: fill=#8f8 dashed...'>
<meta name="twitter:image" content="/images/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs/header-attrs.js"></script><script src="libs/jquery/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap/bootstrap.bundle.min.js"></script><script src="libs/bs3compat/transition.js"></script><script src="libs/bs3compat/tabs.js"></script><script src="libs/bs3compat/bs3compat.js"></script><link href="libs/bs4_book/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book/bs4_book.js"></script><script src="libs/htmlwidgets/htmlwidgets.js"></script><script src="libs/plotly-binding/plotly.js"></script><script src="libs/typedarray/typedarray.min.js"></script><link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main/plotly-latest.min.js"></script><script src="libs/proj4js/proj4.js"></script><link href="libs/highcharts/css/motion.css" rel="stylesheet">
<script src="libs/highcharts/highcharts.js"></script><script src="libs/highcharts/highcharts-3d.js"></script><script src="libs/highcharts/highcharts-more.js"></script><script src="libs/highcharts/modules/stock.js"></script><script src="libs/highcharts/modules/map.js"></script><script src="libs/highcharts/modules/annotations.js"></script><script src="libs/highcharts/modules/data.js"></script><script src="libs/highcharts/modules/drilldown.js"></script><script src="libs/highcharts/modules/item-series.js"></script><script src="libs/highcharts/modules/offline-exporting.js"></script><script src="libs/highcharts/modules/overlapping-datalabels.js"></script><script src="libs/highcharts/modules/exporting.js"></script><script src="libs/highcharts/modules/export-data.js"></script><script src="libs/highcharts/modules/funnel.js"></script><script src="libs/highcharts/modules/heatmap.js"></script><script src="libs/highcharts/modules/treemap.js"></script><script src="libs/highcharts/modules/sankey.js"></script><script src="libs/highcharts/modules/dependency-wheel.js"></script><script src="libs/highcharts/modules/organization.js"></script><script src="libs/highcharts/modules/solid-gauge.js"></script><script src="libs/highcharts/modules/streamgraph.js"></script><script src="libs/highcharts/modules/sunburst.js"></script><script src="libs/highcharts/modules/vector.js"></script><script src="libs/highcharts/modules/wordcloud.js"></script><script src="libs/highcharts/modules/xrange.js"></script><script src="libs/highcharts/modules/tilemap.js"></script><script src="libs/highcharts/modules/venn.js"></script><script src="libs/highcharts/modules/gantt.js"></script><script src="libs/highcharts/modules/timeline.js"></script><script src="libs/highcharts/modules/parallel-coordinates.js"></script><script src="libs/highcharts/modules/bullet.js"></script><script src="libs/highcharts/modules/coloraxis.js"></script><script src="libs/highcharts/modules/dumbbell.js"></script><script src="libs/highcharts/modules/lollipop.js"></script><script src="libs/highcharts/modules/series-label.js"></script><script src="libs/highcharts/plugins/motion.js"></script><script src="libs/highcharts/custom/reset.js"></script><script src="libs/highcharts/modules/boost.js"></script><script src="libs/highchart-binding/highchart.js"></script><script src="libs/plotly-locale-zh-CN/zh-cn.js"></script><script src="libs/mathjax/cdn.js"></script><link href="libs/dygraphs/dygraph.css" rel="stylesheet">
<script src="libs/dygraphs/dygraph-combined.js"></script><script src="libs/dygraphs/shapes.js"></script><script src="libs/moment/moment.js"></script><script src="libs/moment-timezone/moment-timezone-with-data.js"></script><script src="libs/moment-fquarter/moment-fquarter.min.js"></script><script src="libs/dygraphs-binding/dygraphs.js"></script><script src="libs/Dygraph.Plugins.Unzoom/unzoom.js"></script><script src="libs/echarts4r/echarts-en.min.js"></script><script src="libs/echarts4r/ecStat.min.js"></script><script src="libs/echarts4r/dataTool.min.js"></script><script src="libs/echarts4r-binding/echarts4r.js"></script><script src="libs/d3/d3.min.js"></script><script src="libs/forceNetwork-binding/forceNetwork.js"></script><link href="libs/vis/vis-network.min.css" rel="stylesheet">
<script src="libs/vis/vis-network.min.js"></script><script src="libs/visNetwork-binding/visNetwork.js"></script><script src="libs/FileSaver/FileSaver.min.js"></script><script src="libs/Blob/Blob.js"></script><script src="libs/canvas-toBlob/canvas-toBlob.js"></script><script src="libs/html2canvas/html2canvas.js"></script><script src="libs/jspdf/jspdf.debug.js"></script><link href="libs/jquery-sparkline/jquery.sparkline.css" rel="stylesheet">
<script src="libs/jquery-sparkline/jquery.sparkline.js"></script><script src="libs/sparkline-binding/sparkline.js"></script><script src="libs/r2d3-render/r2d3-render.js"></script><script src="libs/webcomponents/webcomponents.js"></script><script src="libs/r2d3-binding/r2d3.js"></script><script src="libs/d3v6/d3.min.js"></script><script src="libs/es6shim/es6shim.js"></script><script src="libs/es7shim/es7shim.js"></script><script src="libs/graphre/graphre.js"></script><script src="libs/nomnoml/nomnoml.js"></script><script src="libs/nomnoml-binding/nomnoml.js"></script><script src="libs/d3-bundle/d3-bundle.min.js"></script><script src="libs/d3-lasso/d3-lasso.min.js"></script><script src="libs/save-svg-as-png/save-svg-as-png.min.js"></script><link href="libs/ggiraphjs/ggiraphjs.min.css" rel="stylesheet">
<script src="libs/ggiraphjs/ggiraphjs.min.js"></script><script src="libs/girafe-binding/girafe.js"></script><link href="libs/datatables-css/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding/datatables.js"></script><link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core/js/jquery.dataTables.min.js"></script><script src="libs/jszip/jszip.min.js"></script><script src="libs/pdfmake/pdfmake.js"></script><script src="libs/pdfmake/vfs_fonts.js"></script><link href="libs/dt-ext-buttons/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="libs/dt-ext-buttons/js/dataTables.buttons.min.js"></script><script src="libs/dt-ext-buttons/js/buttons.flash.min.js"></script><script src="libs/dt-ext-buttons/js/buttons.html5.min.js"></script><script src="libs/dt-ext-buttons/js/buttons.colVis.min.js"></script><script src="libs/dt-ext-buttons/js/buttons.print.min.js"></script><link href="libs/dt-ext-rowgroup/css/rowGroup.dataTables.min.css" rel="stylesheet">
<script src="libs/dt-ext-rowgroup/js/dataTables.rowGroup.min.js"></script><script src="libs/kePrint/kePrint.js"></script><link href="libs/lightable/lightable.css" rel="stylesheet">
<script src="libs/echarts-world/world.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-54GQKWF7VP"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-54GQKWF7VP');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Modern Applied Statistics with R">现代应用统计与 R 语言</a>:
        <small class="text-muted">Modern Applied Statistics with R</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">欢迎</a></li>
<li><a class="" href="chap-preface.html"><span class="header-section-number">1</span> 前言</a></li>
<li class="book-part">数据整理</li>
<li><a class="" href="chap-data-wrangling.html">介绍</a></li>
<li><a class="" href="chap-data-structure.html"><span class="header-section-number">2</span> 数据结构</a></li>
<li><a class="" href="chap-data-transportation.html"><span class="header-section-number">3</span> 数据搬运</a></li>
<li><a class="" href="chap-string-operations.html"><span class="header-section-number">4</span> 字符串操作</a></li>
<li><a class="" href="chap-regular-expressions.html"><span class="header-section-number">5</span> 正则表达式</a></li>
<li><a class="" href="chap-data-manipulation.html"><span class="header-section-number">6</span> 数据操作</a></li>
<li><a class="" href="chap-advanced-manipulation.html"><span class="header-section-number">7</span> 高级数据操作</a></li>
<li><a class="" href="chap-parallel-manipulation.html"><span class="header-section-number">8</span> 并行化操作</a></li>
<li><a class="" href="chap-dplyr-manipulation.html"><span class="header-section-number">9</span> 净土化操作</a></li>
<li class="book-part">统计图形</li>
<li><a class="" href="chap-statistical-graphics.html">介绍</a></li>
<li><a class="" href="chap-graphics-foundations.html"><span class="header-section-number">10</span> 图形基础</a></li>
<li><a class="" href="chap-data-visualization.html"><span class="header-section-number">11</span> 数据可视化</a></li>
<li><a class="" href="chap-interactive-web-graphics.html"><span class="header-section-number">12</span> 交互图形</a></li>
<li class="book-part">动态文档</li>
<li><a class="" href="chap-dynamic-documents.html">介绍</a></li>
<li><a class="" href="chap-document-elements.html"><span class="header-section-number">13</span> 文档元素</a></li>
<li><a class="" href="chap-portable-document.html"><span class="header-section-number">14</span> 便携式文档</a></li>
<li><a class="" href="chap-web-documents.html"><span class="header-section-number">15</span> 网页文档</a></li>
<li><a class="" href="chap-office-document.html"><span class="header-section-number">16</span> 办公文档</a></li>
<li><a class="" href="chap-reproducible-workflows.html"><span class="header-section-number">17</span> 工作流</a></li>
<li><a class="" href="chap-advanced-documents.html"><span class="header-section-number">18</span> 高级文档</a></li>
<li class="book-part">数据产品</li>
<li><a class="" href="chap-data-product.html">介绍</a></li>
<li><a class="" href="chap-interactive-data-tables.html"><span class="header-section-number">19</span> 交互表格</a></li>
<li><a class="" href="chap-interactive-shiny-app.html"><span class="header-section-number">20</span> 交互报表</a></li>
<li class="book-part">统计基础</li>
<li><a class="" href="chap-statistical-foundations.html">介绍</a></li>
<li><a class="" href="chap-sampling-distributions.html"><span class="header-section-number">21</span> 抽样分布</a></li>
<li><a class="" href="chap-parameter-estimators.html"><span class="header-section-number">22</span> 参数估计</a></li>
<li><a class="active" href="chap-hypothesis-test.html"><span class="header-section-number">23</span> 假设检验</a></li>
<li><a class="" href="chap-power-Analysis.html"><span class="header-section-number">24</span> 功效分析</a></li>
<li><a class="" href="chap-experimental-design.html"><span class="header-section-number">25</span> 试验设计</a></li>
<li class="book-part">统计模型</li>
<li><a class="" href="chap-statistical-models.html">介绍</a></li>
<li><a class="" href="chap-linear-models.html"><span class="header-section-number">26</span> 线性模型</a></li>
<li><a class="" href="chap-generalized-linear-models.html"><span class="header-section-number">27</span> 广义线性模型</a></li>
<li><a class="" href="chap-bayesian-models.html"><span class="header-section-number">28</span> 贝叶斯模型</a></li>
<li class="book-part">数据建模</li>
<li><a class="" href="chap-data-modeling.html">介绍</a></li>
<li><a class="" href="chap-text-analysis.html"><span class="header-section-number">29</span> 文本分析</a></li>
<li><a class="" href="chap-survival-analysis.html"><span class="header-section-number">30</span> 生存分析</a></li>
<li><a class="" href="chap-time-series-analysis.html"><span class="header-section-number">31</span> 时序分析</a></li>
<li class="book-part">时空数据</li>
<li><a class="" href="chap-spatio-temporal-data.html">介绍</a></li>
<li><a class="" href="chap-spatial-analysis.html"><span class="header-section-number">32</span> 空间数据分析</a></li>
<li><a class="" href="chap-spatial-modeling.html"><span class="header-section-number">33</span> 空间数据建模</a></li>
<li><a class="" href="chap-spatial-viz.html"><span class="header-section-number">34</span> 空间数据可视化</a></li>
<li><a class="" href="chap-case-study.html"><span class="header-section-number">35</span> 案例研究</a></li>
<li><a class="" href="chap-data-explorer.html"><span class="header-section-number">36</span> 数据探索</a></li>
<li class="book-part">机器学习</li>
<li><a class="" href="chap-machine-learning.html">介绍</a></li>
<li><a class="" href="chap-gradient-boosting-machine.html"><span class="header-section-number">37</span> 梯度提升机</a></li>
<li><a class="" href="chap-numerical-optimization.html"><span class="header-section-number">38</span> 数值优化</a></li>
<li class="book-part">附录</li>
<li><a class="" href="chap-linux-command-bash.html"><span class="header-section-number">A</span> 命令行操作</a></li>
<li><a class="" href="chap-matrix-operations.html"><span class="header-section-number">B</span> 矩阵运算</a></li>
<li><a class="" href="chap-symbolic-computation.html"><span class="header-section-number">C</span> 符号计算</a></li>
<li><a class="" href="chap-mixed-programming.html"><span class="header-section-number">D</span> 混合编程</a></li>
<li><a class="" href="chap-object-oriented-programming.html"><span class="header-section-number">E</span> 面向对象编程</a></li>
<li><a class="" href="chap-file-operations.html"><span class="header-section-number">F</span> 文件操作</a></li>
<li><a class="" href="chap-other-softwares.html"><span class="header-section-number">G</span> 其它软件</a></li>
<li><a class="" href="chap-notations.html"><span class="header-section-number">H</span> 符号说明</a></li>
<li><a class="" href="references.html">参考文献</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/XiangyunHuang/masr">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="chap-hypothesis-test" class="section level1" number="23">
<h1>
<span class="header-section-number">第 23 章</span> 假设检验<a class="anchor" aria-label="anchor" href="#chap-hypothesis-test"><i class="fas fa-link"></i></a>
</h1>
<blockquote>
<p>The Earth is Round (<span class="math inline">\(p &lt; 0.05\)</span>)</p>
<p>— Jacob Cohen <span class="citation"><a href="#ref-Cohen_1994_Earth" role="doc-biblioref">[37]</a></span></p>
</blockquote>
<div id="htmlwidget-b98e9d6954312d190108" style="width:69px;height:480px;" class="nomnoml html-widget"></div>
<script type="application/json" data-for="htmlwidget-b98e9d6954312d190108">{"x":{"code":"\n#fill: #FEFEFF\n#lineWidth: 1\n#zoom: 4\n#direction: right\n\n#stroke: black\n#.box: fill=#8f8 dashed visual=ellipse\n\n[假设检验]-[A1|两样本比较]\n[假设检验]-[A2|多样本比较]\n[假设检验]-[A3|列联表分析]\n\n[A1]-[B1|配对样本]\n[A1]-[B2|非配对样本]\n\n[B1]-[C1|正态分布]\n[C1]-[D1|配对T检验]\n[B1]-[C2|非正态分布]\n[C2]-[D2|配对Wilcoxon检验]\n\n[B2]-[C3|正态分布]\n[C3]-[D3|同方差（F检验）]\n[C3]-[D4|异方差（F检验）]\n\n[D3]-[F1|样本量都大于30]\n[F1]-[G1|Z检验]\n[D3]-[F2|样本量都小于30]\n[F2]-[G2|T检验]\n\n[B2]-[C4|非正态分布]\n[C4]-[D5|Mann-Whitney U检验]\n\n[D4]-[F3|T检验]\n[D4]-[F4|Mann-Whitney U检验]\n\n[A2]-[B3|正态分布]\n[B3]-[C5|同方差（F检验）]\n[C5]-[D6|ANOVA 方差分析]\n\n[B3]-[C6|异方差（F检验）]\n[C6]-[D7|Kruskal-Wallis 秩和检验]\n\n[A2]-[B4|非正态分布]\n[B4]-[C7|Kruskal-Wallis 秩和检验]\n\n[A3]-[B5|单因素]\n[A3]-[B6|多因素]\n\n[B5]-[C8|简单卡方检验]\n\n[B6]-[C9|两水平]\n[C9]-[D8|2X2列联表]\n[B6]-[C10|多水平]\n[C10]-[D9|RxC列联表]","svg":false},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb1929"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="op">-</span><span class="fl">4</span>, to <span class="op">=</span> <span class="fl">8</span>, length.out <span class="op">=</span> <span class="fl">193</span><span class="op">)</span>
<span class="va">y1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="fl">3</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> 
<span class="va">y2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span>
<span class="va">hline</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span> <span class="op">=</span> <span class="fl">0</span>, <span class="va">color</span> <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    type <span class="op">=</span> <span class="st">"line"</span>, 
    x0 <span class="op">=</span> <span class="fl">0</span>, 
    x1 <span class="op">=</span> <span class="fl">1</span>, 
    xref <span class="op">=</span> <span class="st">"paper"</span>,
    y0 <span class="op">=</span> <span class="va">y</span>, 
    y1 <span class="op">=</span> <span class="va">y</span>, 
    line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">color</span>, dash <span class="op">=</span> <span class="st">'dash'</span>, width <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span>

<span class="va">vline</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span> <span class="op">=</span> <span class="fl">0</span>, <span class="va">color</span> <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    type <span class="op">=</span> <span class="st">"line"</span>, 
    x0 <span class="op">=</span> <span class="va">x</span>, 
    x1 <span class="op">=</span> <span class="va">x</span>, 
    yref <span class="op">=</span> <span class="st">"paper"</span>,
    y0 <span class="op">=</span> <span class="fl">0</span>, 
    y1 <span class="op">=</span> <span class="fl">1</span>, 
    line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">color</span>, dash <span class="op">=</span> <span class="st">'dash'</span>, width <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span>

<span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/plot_ly.html">plot_ly</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y1</span>,
  type <span class="op">=</span> <span class="st">"scatter"</span>, mode <span class="op">=</span> <span class="st">"lines"</span>,
  fill <span class="op">=</span> <span class="st">"tozeroy"</span>, fillcolor <span class="op">=</span> <span class="st">"rgba(92, 184, 92, 0.2)"</span>,
  text <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span>
    <span class="st">"x："</span>, <span class="va">x</span>, <span class="st">"&lt;br&gt;"</span>,
    <span class="st">"y："</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">y1</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"&lt;br&gt;"</span>
  <span class="op">)</span>,
  hoverinfo <span class="op">=</span> <span class="st">"text"</span>,
  name <span class="op">=</span> <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"\\mathcal{N}(3,1^2)"</span><span class="op">)</span>,
  line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="st">"spline"</span>, color <span class="op">=</span> <span class="st">"#5CB85C"</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/add_trace.html">add_trace</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y2</span>,
    type <span class="op">=</span> <span class="st">"scatter"</span>, mode <span class="op">=</span> <span class="st">"lines"</span>,
    fill <span class="op">=</span> <span class="st">"tozeroy"</span>, fillcolor <span class="op">=</span> <span class="st">"rgba(91, 192, 222, 0.2)"</span>,
    text <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span>
      <span class="st">"x："</span>, <span class="va">x</span>, <span class="st">"&lt;br&gt;"</span>,
      <span class="st">"y："</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">y2</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"&lt;br&gt;"</span>
    <span class="op">)</span>,
    hoverinfo <span class="op">=</span> <span class="st">"text"</span>,
    name <span class="op">=</span> <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"\\mathcal{N}(2, 1.5^2)"</span><span class="op">)</span>,
    line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="st">"spline"</span>, color <span class="op">=</span> <span class="st">"#5BC0DE"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/add_trace.html">add_segments</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fl">2</span>,
    y <span class="op">=</span> <span class="fl">0.28</span>,
    xend <span class="op">=</span> <span class="fl">3</span>,
    yend <span class="op">=</span> <span class="fl">0.28</span>,
    line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,
    showlegend <span class="op">=</span> <span class="cn">F</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/add_annotations.html">add_annotations</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fl">2.5</span>, y <span class="op">=</span> <span class="fl">0.3</span>,
    showarrow <span class="op">=</span> <span class="cn">F</span>, font <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">24</span><span class="op">)</span>,
    text <span class="op">=</span> <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"d"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/add_annotations.html">add_annotations</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span><span class="op">)</span>, 
    font <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, showarrow <span class="op">=</span> <span class="cn">F</span>,
    text <span class="op">=</span> <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"\\frac{1}{\\sqrt{2\\pi}}"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/add_annotations.html">add_annotations</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1.5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span><span class="op">)</span><span class="op">)</span>, 
    font <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, showarrow <span class="op">=</span> <span class="cn">F</span>,
    text <span class="op">=</span> <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"\\frac{1}{1.5\\sqrt{2\\pi}}"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/layout.html">layout</a></span><span class="op">(</span>
    shapes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      <span class="fu">hline</span><span class="op">(</span>y <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#F27B0C"</span><span class="op">)</span>,
      <span class="fu">hline</span><span class="op">(</span>y <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1.5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#F27B0C"</span><span class="op">)</span>,
      <span class="fu">vline</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"#F27B0C"</span><span class="op">)</span>,
      <span class="fu">vline</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"#F27B0C"</span><span class="op">)</span>
    <span class="op">)</span>,
    xaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>showgrid <span class="op">=</span> <span class="cn">F</span>, title <span class="op">=</span> <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"x"</span><span class="op">)</span><span class="op">)</span>,
    yaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>showgrid <span class="op">=</span> <span class="cn">F</span>, title <span class="op">=</span> <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"f(x)"</span><span class="op">)</span><span class="op">)</span>,
    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.8</span>, y <span class="op">=</span> <span class="fl">1</span>, orientation <span class="op">=</span> <span class="st">"v"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/config.html">config</a></span><span class="op">(</span>displayModeBar <span class="op">=</span> <span class="cn">FALSE</span>, mathjax <span class="op">=</span> <span class="st">"cdn"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:hypothesis-test"></span>
<div id="htmlwidget-4d502a4ed4a287c53715" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-4d502a4ed4a287c53715">{"x":{"visdat":{"d0202fda7245":["function () ","plotlyVisDat"]},"cur_data":"d0202fda7245","attrs":{"d0202fda7245":{"x":[-4,-3.9375,-3.875,-3.8125,-3.75,-3.6875,-3.625,-3.5625,-3.5,-3.4375,-3.375,-3.3125,-3.25,-3.1875,-3.125,-3.0625,-3,-2.9375,-2.875,-2.8125,-2.75,-2.6875,-2.625,-2.5625,-2.5,-2.4375,-2.375,-2.3125,-2.25,-2.1875,-2.125,-2.0625,-2,-1.9375,-1.875,-1.8125,-1.75,-1.6875,-1.625,-1.5625,-1.5,-1.4375,-1.375,-1.3125,-1.25,-1.1875,-1.125,-1.0625,-1,-0.9375,-0.875,-0.8125,-0.75,-0.6875,-0.625,-0.5625,-0.5,-0.4375,-0.375,-0.3125,-0.25,-0.1875,-0.125,-0.0625,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,1.0625,1.125,1.1875,1.25,1.3125,1.375,1.4375,1.5,1.5625,1.625,1.6875,1.75,1.8125,1.875,1.9375,2,2.0625,2.125,2.1875,2.25,2.3125,2.375,2.4375,2.5,2.5625,2.625,2.6875,2.75,2.8125,2.875,2.9375,3,3.0625,3.125,3.1875,3.25,3.3125,3.375,3.4375,3.5,3.5625,3.625,3.6875,3.75,3.8125,3.875,3.9375,4,4.0625,4.125,4.1875,4.25,4.3125,4.375,4.4375,4.5,4.5625,4.625,4.6875,4.75,4.8125,4.875,4.9375,5,5.0625,5.125,5.1875,5.25,5.3125,5.375,5.4375,5.5,5.5625,5.625,5.6875,5.75,5.8125,5.875,5.9375,6,6.0625,6.125,6.1875,6.25,6.3125,6.375,6.4375,6.5,6.5625,6.625,6.6875,6.75,6.8125,6.875,6.9375,7,7.0625,7.125,7.1875,7.25,7.3125,7.375,7.4375,7.5,7.5625,7.625,7.6875,7.75,7.8125,7.875,7.9375,8],"y":[9.13472040836459e-12,1.41205256360855e-11,2.17425263571897e-11,3.33482220042278e-11,5.09493795884368e-11,7.7536939206216e-11,1.17538986990503e-10,1.77483821400852e-10,2.66955661476285e-10,3.99965965694357e-10,5.96912229143432e-10,8.87363279064327e-10,1.31400181815588e-09,1.93817959362031e-09,2.84770897829682e-09,4.16774106808677e-09,6.07588284982329e-09,8.82310791037702e-09,1.27625462035364e-08,1.83889359876902e-08,2.63924320357057e-08,3.77316467529389e-08,5.37323265056915e-08,7.6220021592826e-08,1.07697600425433e-07,1.51581612874024e-07,2.12515473831029e-07,2.96782390621129e-07,4.12847098863e-07,5.72063030643556e-07,7.89590774069399e-07,1.08558487793733e-06,1.4867195147343e-06,2.02813955965596e-06,2.75594259754997e-06,3.73031954825449e-06,5.02950728859245e-06,6.75473607614296e-06,9.03638788905137e-06,1.20416190057855e-05,1.59837411069055e-05,2.11336995134455e-05,2.78340342292149e-05,3.65157582304373e-05,4.7718636541205e-05,6.21153971704162e-05,8.05404485555941e-05,0.000104023714767684,0.000133830225764885,0.000171506111194723,0.000218931637764612,0.000278381896598362,0.000352595682367445,0.00044485300411281,0.000559061522232165,0.000699852010946943,0.00087268269504576,0.00108395199911465,0.00134111887349038,0.00165282942240626,0.00202904805729977,0.0024811908361033,0.00302225803519876,0.00366696234629423,0.00443184841193801,0.00533539873158631,0.00639812031072356,0.0076426058187464,0.00909356250159105,0.0107778017002709,0.0127241815968314,0.0149634957859139,0.0175283004935685,0.0204526737727814,0.0237719008299138,0.0275220808029045,0.0317396518356674,0.0364608331761921,0.0417209852563386,0.0475538912606396,0.0539909665131881,0.0610604050410663,0.0687862758266919,0.0771875844397107,0.0862773188265115,0.0960615009051134,0.106538268130585,0.11769701122432,0.129517595665892,0.141969695205216,0.155012265458293,0.168593184518115,0.182649085389022,0.197105401918587,0.211876645775699,0.226866926968813,0.241970724519143,0.257073907346735,0.272054998378544,0.286786667566414,0.301137432154804,0.314973535426593,0.328160968550375,0.340567594319831,0.3520653267643,0.362532317040445,0.371855093869769,0.379930606198628,0.386668116802849,0.391990898252572,0.39583768694475,0.398163856686887,0.398942280401433,0.398163856686887,0.39583768694475,0.391990898252572,0.386668116802849,0.379930606198628,0.371855093869769,0.362532317040445,0.3520653267643,0.340567594319831,0.328160968550375,0.314973535426593,0.301137432154804,0.286786667566414,0.272054998378544,0.257073907346735,0.241970724519143,0.226866926968813,0.211876645775699,0.197105401918587,0.182649085389022,0.168593184518115,0.155012265458293,0.141969695205216,0.129517595665892,0.11769701122432,0.106538268130585,0.0960615009051134,0.0862773188265115,0.0771875844397107,0.0687862758266919,0.0610604050410663,0.0539909665131881,0.0475538912606396,0.0417209852563386,0.0364608331761921,0.0317396518356674,0.0275220808029045,0.0237719008299138,0.0204526737727814,0.0175283004935685,0.0149634957859139,0.0127241815968314,0.0107778017002709,0.00909356250159105,0.0076426058187464,0.00639812031072356,0.00533539873158631,0.00443184841193801,0.00366696234629423,0.00302225803519876,0.0024811908361033,0.00202904805729977,0.00165282942240626,0.00134111887349038,0.00108395199911465,0.00087268269504576,0.000699852010946943,0.000559061522232165,0.00044485300411281,0.000352595682367445,0.000278381896598362,0.000218931637764612,0.000171506111194723,0.000133830225764885,0.000104023714767684,8.05404485555941e-05,6.21153971704162e-05,4.7718636541205e-05,3.65157582304373e-05,2.78340342292149e-05,2.11336995134455e-05,1.59837411069055e-05,1.20416190057855e-05,9.03638788905137e-06,6.75473607614296e-06,5.02950728859245e-06,3.73031954825449e-06,2.75594259754997e-06,2.02813955965596e-06,1.4867195147343e-06],"mode":"lines","fill":"tozeroy","fillcolor":"rgba(92, 184, 92, 0.2)","text":{},"hoverinfo":"text","line":{"shape":"spline","color":"#5CB85C"},"name":"$\\mathcal{N}(3,1^2)$","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"d0202fda7245.1":{"x":[-4,-3.9375,-3.875,-3.8125,-3.75,-3.6875,-3.625,-3.5625,-3.5,-3.4375,-3.375,-3.3125,-3.25,-3.1875,-3.125,-3.0625,-3,-2.9375,-2.875,-2.8125,-2.75,-2.6875,-2.625,-2.5625,-2.5,-2.4375,-2.375,-2.3125,-2.25,-2.1875,-2.125,-2.0625,-2,-1.9375,-1.875,-1.8125,-1.75,-1.6875,-1.625,-1.5625,-1.5,-1.4375,-1.375,-1.3125,-1.25,-1.1875,-1.125,-1.0625,-1,-0.9375,-0.875,-0.8125,-0.75,-0.6875,-0.625,-0.5625,-0.5,-0.4375,-0.375,-0.3125,-0.25,-0.1875,-0.125,-0.0625,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,1.0625,1.125,1.1875,1.25,1.3125,1.375,1.4375,1.5,1.5625,1.625,1.6875,1.75,1.8125,1.875,1.9375,2,2.0625,2.125,2.1875,2.25,2.3125,2.375,2.4375,2.5,2.5625,2.625,2.6875,2.75,2.8125,2.875,2.9375,3,3.0625,3.125,3.1875,3.25,3.3125,3.375,3.4375,3.5,3.5625,3.625,3.6875,3.75,3.8125,3.875,3.9375,4,4.0625,4.125,4.1875,4.25,4.3125,4.375,4.4375,4.5,4.5625,4.625,4.6875,4.75,4.8125,4.875,4.9375,5,5.0625,5.125,5.1875,5.25,5.3125,5.375,5.4375,5.5,5.5625,5.625,5.6875,5.75,5.8125,5.875,5.9375,6,6.0625,6.125,6.1875,6.25,6.3125,6.375,6.4375,6.5,6.5625,6.625,6.6875,6.75,6.8125,6.875,6.9375,7,7.0625,7.125,7.1875,7.25,7.3125,7.375,7.4375,7.5,7.5625,7.625,7.6875,7.75,7.8125,7.875,7.9375,8],"y":[8.92201505099236e-05,0.000105309699484658,0.000124085150530496,0.000145954425176408,0.000171380236708204,0.000200886256755444,0.000235063788244964,0.000274578957593722,0.00032018043441388,0.00037270768148811,0.000433099731279709,0.000502404477714495,0.00058178846336384,0.000672547132437612,0.000776115509144256,0.000894079248993585,0.0010281859975274,0.00118035697680993,0.00135269870486651,0.00154751473722805,0.0017673173029534,0.0020148386901325,0.00229304221812166,0.00260513261587192,0.00295456560795867,0.00334505649262177,0.00378058747963059,0.00426541354048237,0.00480406650973948,0.00540135716465233,0.0060623750010607,0.00679248541739243,0.00759732401586496,0.00848278773122096,0.0094550225029582,0.0105204072174879,0.011685533662379,0.0129571822561766,0.0143422933445158,0.0158479338866092,0.0174812593958063,0.0192494710438316,0.0211597678904449,0.0232192942584229,0.025435082337612,0.0278139901708924,0.0303626352486037,0.0330873240155727,0.0359939776754587,0.0390880547596564,0.0423744710113082,0.0458575172177946,0.0495407757059954,0.0534270362921773,0.0575182125510077,0.0618152593343438,0.0663180925284991,0.0710255120870567,0.0759351294134613,0.0810433001921206,0.0863450637772612,0.0918340902441319,0.0975026361863571,0.103341510305529,0.109340049783996,0.115486108359012,0.121766056926015,0.128164797391188,0.134665790369373,0.1412510971838,0.147901436470491,0.154596255524162,0.161313816346096,0.16803129617003,0.174724902052201,0.181369998919029,0.187941250273535,0.194412770572437,0.200758288103203,0.206951317017228,0.212965337014902,0.218773979033583,0.224351215163302,0.229671550909808,0.234710217842866,0.239443364611206,0.243848244276002,0.247903395913179,0.251588818461995,0.254886134853278,0.257778744535233,0.260251962626908,0.26229314406796,0.2638917912965,0.265039644172228,0.265730751067124,0.265961520267622,0.265730751067124,0.265039644172228,0.2638917912965,0.26229314406796,0.260251962626908,0.257778744535233,0.254886134853278,0.251588818461995,0.247903395913179,0.243848244276002,0.239443364611206,0.234710217842866,0.229671550909808,0.224351215163302,0.218773979033583,0.212965337014902,0.206951317017228,0.200758288103203,0.194412770572437,0.187941250273535,0.181369998919029,0.174724902052201,0.16803129617003,0.161313816346096,0.154596255524162,0.147901436470491,0.1412510971838,0.134665790369373,0.128164797391188,0.121766056926015,0.115486108359012,0.109340049783996,0.103341510305529,0.0975026361863571,0.0918340902441319,0.0863450637772612,0.0810433001921206,0.0759351294134613,0.0710255120870567,0.0663180925284991,0.0618152593343438,0.0575182125510077,0.0534270362921773,0.0495407757059954,0.0458575172177946,0.0423744710113082,0.0390880547596564,0.0359939776754587,0.0330873240155727,0.0303626352486037,0.0278139901708924,0.025435082337612,0.0232192942584229,0.0211597678904449,0.0192494710438316,0.0174812593958063,0.0158479338866092,0.0143422933445158,0.0129571822561766,0.011685533662379,0.0105204072174879,0.0094550225029582,0.00848278773122096,0.00759732401586496,0.00679248541739243,0.0060623750010607,0.00540135716465233,0.00480406650973948,0.00426541354048237,0.00378058747963059,0.00334505649262177,0.00295456560795867,0.00260513261587192,0.00229304221812166,0.0020148386901325,0.0017673173029534,0.00154751473722805,0.00135269870486651,0.00118035697680993,0.0010281859975274,0.000894079248993585,0.000776115509144256,0.000672547132437612,0.00058178846336384,0.000502404477714495,0.000433099731279709,0.00037270768148811,0.00032018043441388,0.000274578957593722,0.000235063788244964,0.000200886256755444,0.000171380236708204,0.000145954425176408,0.000124085150530496,0.000105309699484658,8.92201505099236e-05],"mode":"lines","fill":"tozeroy","fillcolor":"rgba(91, 192, 222, 0.2)","text":{},"hoverinfo":"text","line":{"shape":"spline","color":"#5BC0DE"},"name":"$\\mathcal{N}(2, 1.5^2)$","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true},"d0202fda7245.2":{"x":2,"y":0.28,"mode":"lines","fill":"tozeroy","fillcolor":"rgba(92, 184, 92, 0.2)","text":{},"hoverinfo":"text","line":{"shape":"spline","color":"black"},"name":"$\\mathcal{N}(3,1^2)$","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","xend":3,"yend":0.28,"showlegend":false,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"annotations":[{"text":"$d$","x":2.5,"y":0.3,"showarrow":false,"font":{"size":24}},{"text":"$\\frac{1}{\\sqrt{2\\pi}}$","x":0,"y":0.398942280401433,"font":{"size":100},"showarrow":false},{"text":"$\\frac{1}{1.5\\sqrt{2\\pi}}$","x":0,"y":0.265961520267622,"font":{"size":100},"showarrow":false}],"shapes":[{"type":"line","x0":0,"x1":1,"xref":"paper","y0":0.398942280401433,"y1":0.398942280401433,"line":{"color":"#F27B0C","dash":"dash","width":0.5}},{"type":"line","x0":0,"x1":1,"xref":"paper","y0":0.265961520267622,"y1":0.265961520267622,"line":{"color":"#F27B0C","dash":"dash","width":0.5}},{"type":"line","x0":3,"x1":3,"yref":"paper","y0":0,"y1":1,"line":{"color":"#F27B0C","dash":"dash","width":0.5}},{"type":"line","x0":2,"x1":2,"yref":"paper","y0":0,"y1":1,"line":{"color":"#F27B0C","dash":"dash","width":0.5}}],"xaxis":{"domain":[0,1],"automargin":true,"showgrid":false,"title":"$x$"},"yaxis":{"domain":[0,1],"automargin":true,"showgrid":false,"title":"$f(x)$"},"legend":{"x":0.8,"y":1,"orientation":"v"},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false,"displayModeBar":false},"data":[{"fillcolor":"rgba(92, 184, 92, 0.2)","x":[-4,-3.9375,-3.875,-3.8125,-3.75,-3.6875,-3.625,-3.5625,-3.5,-3.4375,-3.375,-3.3125,-3.25,-3.1875,-3.125,-3.0625,-3,-2.9375,-2.875,-2.8125,-2.75,-2.6875,-2.625,-2.5625,-2.5,-2.4375,-2.375,-2.3125,-2.25,-2.1875,-2.125,-2.0625,-2,-1.9375,-1.875,-1.8125,-1.75,-1.6875,-1.625,-1.5625,-1.5,-1.4375,-1.375,-1.3125,-1.25,-1.1875,-1.125,-1.0625,-1,-0.9375,-0.875,-0.8125,-0.75,-0.6875,-0.625,-0.5625,-0.5,-0.4375,-0.375,-0.3125,-0.25,-0.1875,-0.125,-0.0625,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,1.0625,1.125,1.1875,1.25,1.3125,1.375,1.4375,1.5,1.5625,1.625,1.6875,1.75,1.8125,1.875,1.9375,2,2.0625,2.125,2.1875,2.25,2.3125,2.375,2.4375,2.5,2.5625,2.625,2.6875,2.75,2.8125,2.875,2.9375,3,3.0625,3.125,3.1875,3.25,3.3125,3.375,3.4375,3.5,3.5625,3.625,3.6875,3.75,3.8125,3.875,3.9375,4,4.0625,4.125,4.1875,4.25,4.3125,4.375,4.4375,4.5,4.5625,4.625,4.6875,4.75,4.8125,4.875,4.9375,5,5.0625,5.125,5.1875,5.25,5.3125,5.375,5.4375,5.5,5.5625,5.625,5.6875,5.75,5.8125,5.875,5.9375,6,6.0625,6.125,6.1875,6.25,6.3125,6.375,6.4375,6.5,6.5625,6.625,6.6875,6.75,6.8125,6.875,6.9375,7,7.0625,7.125,7.1875,7.25,7.3125,7.375,7.4375,7.5,7.5625,7.625,7.6875,7.75,7.8125,7.875,7.9375,8],"y":[9.13472040836459e-12,1.41205256360855e-11,2.17425263571897e-11,3.33482220042278e-11,5.09493795884368e-11,7.7536939206216e-11,1.17538986990503e-10,1.77483821400852e-10,2.66955661476285e-10,3.99965965694357e-10,5.96912229143432e-10,8.87363279064327e-10,1.31400181815588e-09,1.93817959362031e-09,2.84770897829682e-09,4.16774106808677e-09,6.07588284982329e-09,8.82310791037702e-09,1.27625462035364e-08,1.83889359876902e-08,2.63924320357057e-08,3.77316467529389e-08,5.37323265056915e-08,7.6220021592826e-08,1.07697600425433e-07,1.51581612874024e-07,2.12515473831029e-07,2.96782390621129e-07,4.12847098863e-07,5.72063030643556e-07,7.89590774069399e-07,1.08558487793733e-06,1.4867195147343e-06,2.02813955965596e-06,2.75594259754997e-06,3.73031954825449e-06,5.02950728859245e-06,6.75473607614296e-06,9.03638788905137e-06,1.20416190057855e-05,1.59837411069055e-05,2.11336995134455e-05,2.78340342292149e-05,3.65157582304373e-05,4.7718636541205e-05,6.21153971704162e-05,8.05404485555941e-05,0.000104023714767684,0.000133830225764885,0.000171506111194723,0.000218931637764612,0.000278381896598362,0.000352595682367445,0.00044485300411281,0.000559061522232165,0.000699852010946943,0.00087268269504576,0.00108395199911465,0.00134111887349038,0.00165282942240626,0.00202904805729977,0.0024811908361033,0.00302225803519876,0.00366696234629423,0.00443184841193801,0.00533539873158631,0.00639812031072356,0.0076426058187464,0.00909356250159105,0.0107778017002709,0.0127241815968314,0.0149634957859139,0.0175283004935685,0.0204526737727814,0.0237719008299138,0.0275220808029045,0.0317396518356674,0.0364608331761921,0.0417209852563386,0.0475538912606396,0.0539909665131881,0.0610604050410663,0.0687862758266919,0.0771875844397107,0.0862773188265115,0.0960615009051134,0.106538268130585,0.11769701122432,0.129517595665892,0.141969695205216,0.155012265458293,0.168593184518115,0.182649085389022,0.197105401918587,0.211876645775699,0.226866926968813,0.241970724519143,0.257073907346735,0.272054998378544,0.286786667566414,0.301137432154804,0.314973535426593,0.328160968550375,0.340567594319831,0.3520653267643,0.362532317040445,0.371855093869769,0.379930606198628,0.386668116802849,0.391990898252572,0.39583768694475,0.398163856686887,0.398942280401433,0.398163856686887,0.39583768694475,0.391990898252572,0.386668116802849,0.379930606198628,0.371855093869769,0.362532317040445,0.3520653267643,0.340567594319831,0.328160968550375,0.314973535426593,0.301137432154804,0.286786667566414,0.272054998378544,0.257073907346735,0.241970724519143,0.226866926968813,0.211876645775699,0.197105401918587,0.182649085389022,0.168593184518115,0.155012265458293,0.141969695205216,0.129517595665892,0.11769701122432,0.106538268130585,0.0960615009051134,0.0862773188265115,0.0771875844397107,0.0687862758266919,0.0610604050410663,0.0539909665131881,0.0475538912606396,0.0417209852563386,0.0364608331761921,0.0317396518356674,0.0275220808029045,0.0237719008299138,0.0204526737727814,0.0175283004935685,0.0149634957859139,0.0127241815968314,0.0107778017002709,0.00909356250159105,0.0076426058187464,0.00639812031072356,0.00533539873158631,0.00443184841193801,0.00366696234629423,0.00302225803519876,0.0024811908361033,0.00202904805729977,0.00165282942240626,0.00134111887349038,0.00108395199911465,0.00087268269504576,0.000699852010946943,0.000559061522232165,0.00044485300411281,0.000352595682367445,0.000278381896598362,0.000218931637764612,0.000171506111194723,0.000133830225764885,0.000104023714767684,8.05404485555941e-05,6.21153971704162e-05,4.7718636541205e-05,3.65157582304373e-05,2.78340342292149e-05,2.11336995134455e-05,1.59837411069055e-05,1.20416190057855e-05,9.03638788905137e-06,6.75473607614296e-06,5.02950728859245e-06,3.73031954825449e-06,2.75594259754997e-06,2.02813955965596e-06,1.4867195147343e-06],"mode":"lines","fill":"tozeroy","text":["x：-4<br>y：0<br>","x：-3.9375<br>y：0<br>","x：-3.875<br>y：0<br>","x：-3.8125<br>y：0<br>","x：-3.75<br>y：0<br>","x：-3.6875<br>y：0<br>","x：-3.625<br>y：0<br>","x：-3.5625<br>y：0<br>","x：-3.5<br>y：0<br>","x：-3.4375<br>y：0<br>","x：-3.375<br>y：0<br>","x：-3.3125<br>y：0<br>","x：-3.25<br>y：0<br>","x：-3.1875<br>y：0<br>","x：-3.125<br>y：0<br>","x：-3.0625<br>y：0<br>","x：-3<br>y：0<br>","x：-2.9375<br>y：0<br>","x：-2.875<br>y：0<br>","x：-2.8125<br>y：0<br>","x：-2.75<br>y：0<br>","x：-2.6875<br>y：0<br>","x：-2.625<br>y：0<br>","x：-2.5625<br>y：0<br>","x：-2.5<br>y：0<br>","x：-2.4375<br>y：0<br>","x：-2.375<br>y：0<br>","x：-2.3125<br>y：0<br>","x：-2.25<br>y：0<br>","x：-2.1875<br>y：0<br>","x：-2.125<br>y：0<br>","x：-2.0625<br>y：0<br>","x：-2<br>y：0<br>","x：-1.9375<br>y：0<br>","x：-1.875<br>y：0<br>","x：-1.8125<br>y：0<br>","x：-1.75<br>y：0<br>","x：-1.6875<br>y：0<br>","x：-1.625<br>y：0<br>","x：-1.5625<br>y：0<br>","x：-1.5<br>y：0<br>","x：-1.4375<br>y：0<br>","x：-1.375<br>y：0<br>","x：-1.3125<br>y：0<br>","x：-1.25<br>y：0<br>","x：-1.1875<br>y：0<br>","x：-1.125<br>y：0<br>","x：-1.0625<br>y：0<br>","x：-1<br>y：0<br>","x：-0.9375<br>y：0<br>","x：-0.875<br>y：0<br>","x：-0.8125<br>y：0<br>","x：-0.75<br>y：0<br>","x：-0.6875<br>y：0<br>","x：-0.625<br>y：0.001<br>","x：-0.5625<br>y：0.001<br>","x：-0.5<br>y：0.001<br>","x：-0.4375<br>y：0.001<br>","x：-0.375<br>y：0.001<br>","x：-0.3125<br>y：0.002<br>","x：-0.25<br>y：0.002<br>","x：-0.1875<br>y：0.002<br>","x：-0.125<br>y：0.003<br>","x：-0.0625<br>y：0.004<br>","x：0<br>y：0.004<br>","x：0.0625<br>y：0.005<br>","x：0.125<br>y：0.006<br>","x：0.1875<br>y：0.008<br>","x：0.25<br>y：0.009<br>","x：0.3125<br>y：0.011<br>","x：0.375<br>y：0.013<br>","x：0.4375<br>y：0.015<br>","x：0.5<br>y：0.018<br>","x：0.5625<br>y：0.02<br>","x：0.625<br>y：0.024<br>","x：0.6875<br>y：0.028<br>","x：0.75<br>y：0.032<br>","x：0.8125<br>y：0.036<br>","x：0.875<br>y：0.042<br>","x：0.9375<br>y：0.048<br>","x：1<br>y：0.054<br>","x：1.0625<br>y：0.061<br>","x：1.125<br>y：0.069<br>","x：1.1875<br>y：0.077<br>","x：1.25<br>y：0.086<br>","x：1.3125<br>y：0.096<br>","x：1.375<br>y：0.107<br>","x：1.4375<br>y：0.118<br>","x：1.5<br>y：0.13<br>","x：1.5625<br>y：0.142<br>","x：1.625<br>y：0.155<br>","x：1.6875<br>y：0.169<br>","x：1.75<br>y：0.183<br>","x：1.8125<br>y：0.197<br>","x：1.875<br>y：0.212<br>","x：1.9375<br>y：0.227<br>","x：2<br>y：0.242<br>","x：2.0625<br>y：0.257<br>","x：2.125<br>y：0.272<br>","x：2.1875<br>y：0.287<br>","x：2.25<br>y：0.301<br>","x：2.3125<br>y：0.315<br>","x：2.375<br>y：0.328<br>","x：2.4375<br>y：0.341<br>","x：2.5<br>y：0.352<br>","x：2.5625<br>y：0.363<br>","x：2.625<br>y：0.372<br>","x：2.6875<br>y：0.38<br>","x：2.75<br>y：0.387<br>","x：2.8125<br>y：0.392<br>","x：2.875<br>y：0.396<br>","x：2.9375<br>y：0.398<br>","x：3<br>y：0.399<br>","x：3.0625<br>y：0.398<br>","x：3.125<br>y：0.396<br>","x：3.1875<br>y：0.392<br>","x：3.25<br>y：0.387<br>","x：3.3125<br>y：0.38<br>","x：3.375<br>y：0.372<br>","x：3.4375<br>y：0.363<br>","x：3.5<br>y：0.352<br>","x：3.5625<br>y：0.341<br>","x：3.625<br>y：0.328<br>","x：3.6875<br>y：0.315<br>","x：3.75<br>y：0.301<br>","x：3.8125<br>y：0.287<br>","x：3.875<br>y：0.272<br>","x：3.9375<br>y：0.257<br>","x：4<br>y：0.242<br>","x：4.0625<br>y：0.227<br>","x：4.125<br>y：0.212<br>","x：4.1875<br>y：0.197<br>","x：4.25<br>y：0.183<br>","x：4.3125<br>y：0.169<br>","x：4.375<br>y：0.155<br>","x：4.4375<br>y：0.142<br>","x：4.5<br>y：0.13<br>","x：4.5625<br>y：0.118<br>","x：4.625<br>y：0.107<br>","x：4.6875<br>y：0.096<br>","x：4.75<br>y：0.086<br>","x：4.8125<br>y：0.077<br>","x：4.875<br>y：0.069<br>","x：4.9375<br>y：0.061<br>","x：5<br>y：0.054<br>","x：5.0625<br>y：0.048<br>","x：5.125<br>y：0.042<br>","x：5.1875<br>y：0.036<br>","x：5.25<br>y：0.032<br>","x：5.3125<br>y：0.028<br>","x：5.375<br>y：0.024<br>","x：5.4375<br>y：0.02<br>","x：5.5<br>y：0.018<br>","x：5.5625<br>y：0.015<br>","x：5.625<br>y：0.013<br>","x：5.6875<br>y：0.011<br>","x：5.75<br>y：0.009<br>","x：5.8125<br>y：0.008<br>","x：5.875<br>y：0.006<br>","x：5.9375<br>y：0.005<br>","x：6<br>y：0.004<br>","x：6.0625<br>y：0.004<br>","x：6.125<br>y：0.003<br>","x：6.1875<br>y：0.002<br>","x：6.25<br>y：0.002<br>","x：6.3125<br>y：0.002<br>","x：6.375<br>y：0.001<br>","x：6.4375<br>y：0.001<br>","x：6.5<br>y：0.001<br>","x：6.5625<br>y：0.001<br>","x：6.625<br>y：0.001<br>","x：6.6875<br>y：0<br>","x：6.75<br>y：0<br>","x：6.8125<br>y：0<br>","x：6.875<br>y：0<br>","x：6.9375<br>y：0<br>","x：7<br>y：0<br>","x：7.0625<br>y：0<br>","x：7.125<br>y：0<br>","x：7.1875<br>y：0<br>","x：7.25<br>y：0<br>","x：7.3125<br>y：0<br>","x：7.375<br>y：0<br>","x：7.4375<br>y：0<br>","x：7.5<br>y：0<br>","x：7.5625<br>y：0<br>","x：7.625<br>y：0<br>","x：7.6875<br>y：0<br>","x：7.75<br>y：0<br>","x：7.8125<br>y：0<br>","x：7.875<br>y：0<br>","x：7.9375<br>y：0<br>","x：8<br>y：0<br>"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"#5CB85C","shape":"spline"},"name":"$\\mathcal{N}(3,1^2)$","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(91, 192, 222, 0.2)","x":[-4,-3.9375,-3.875,-3.8125,-3.75,-3.6875,-3.625,-3.5625,-3.5,-3.4375,-3.375,-3.3125,-3.25,-3.1875,-3.125,-3.0625,-3,-2.9375,-2.875,-2.8125,-2.75,-2.6875,-2.625,-2.5625,-2.5,-2.4375,-2.375,-2.3125,-2.25,-2.1875,-2.125,-2.0625,-2,-1.9375,-1.875,-1.8125,-1.75,-1.6875,-1.625,-1.5625,-1.5,-1.4375,-1.375,-1.3125,-1.25,-1.1875,-1.125,-1.0625,-1,-0.9375,-0.875,-0.8125,-0.75,-0.6875,-0.625,-0.5625,-0.5,-0.4375,-0.375,-0.3125,-0.25,-0.1875,-0.125,-0.0625,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,1.0625,1.125,1.1875,1.25,1.3125,1.375,1.4375,1.5,1.5625,1.625,1.6875,1.75,1.8125,1.875,1.9375,2,2.0625,2.125,2.1875,2.25,2.3125,2.375,2.4375,2.5,2.5625,2.625,2.6875,2.75,2.8125,2.875,2.9375,3,3.0625,3.125,3.1875,3.25,3.3125,3.375,3.4375,3.5,3.5625,3.625,3.6875,3.75,3.8125,3.875,3.9375,4,4.0625,4.125,4.1875,4.25,4.3125,4.375,4.4375,4.5,4.5625,4.625,4.6875,4.75,4.8125,4.875,4.9375,5,5.0625,5.125,5.1875,5.25,5.3125,5.375,5.4375,5.5,5.5625,5.625,5.6875,5.75,5.8125,5.875,5.9375,6,6.0625,6.125,6.1875,6.25,6.3125,6.375,6.4375,6.5,6.5625,6.625,6.6875,6.75,6.8125,6.875,6.9375,7,7.0625,7.125,7.1875,7.25,7.3125,7.375,7.4375,7.5,7.5625,7.625,7.6875,7.75,7.8125,7.875,7.9375,8],"y":[8.92201505099236e-05,0.000105309699484658,0.000124085150530496,0.000145954425176408,0.000171380236708204,0.000200886256755444,0.000235063788244964,0.000274578957593722,0.00032018043441388,0.00037270768148811,0.000433099731279709,0.000502404477714495,0.00058178846336384,0.000672547132437612,0.000776115509144256,0.000894079248993585,0.0010281859975274,0.00118035697680993,0.00135269870486651,0.00154751473722805,0.0017673173029534,0.0020148386901325,0.00229304221812166,0.00260513261587192,0.00295456560795867,0.00334505649262177,0.00378058747963059,0.00426541354048237,0.00480406650973948,0.00540135716465233,0.0060623750010607,0.00679248541739243,0.00759732401586496,0.00848278773122096,0.0094550225029582,0.0105204072174879,0.011685533662379,0.0129571822561766,0.0143422933445158,0.0158479338866092,0.0174812593958063,0.0192494710438316,0.0211597678904449,0.0232192942584229,0.025435082337612,0.0278139901708924,0.0303626352486037,0.0330873240155727,0.0359939776754587,0.0390880547596564,0.0423744710113082,0.0458575172177946,0.0495407757059954,0.0534270362921773,0.0575182125510077,0.0618152593343438,0.0663180925284991,0.0710255120870567,0.0759351294134613,0.0810433001921206,0.0863450637772612,0.0918340902441319,0.0975026361863571,0.103341510305529,0.109340049783996,0.115486108359012,0.121766056926015,0.128164797391188,0.134665790369373,0.1412510971838,0.147901436470491,0.154596255524162,0.161313816346096,0.16803129617003,0.174724902052201,0.181369998919029,0.187941250273535,0.194412770572437,0.200758288103203,0.206951317017228,0.212965337014902,0.218773979033583,0.224351215163302,0.229671550909808,0.234710217842866,0.239443364611206,0.243848244276002,0.247903395913179,0.251588818461995,0.254886134853278,0.257778744535233,0.260251962626908,0.26229314406796,0.2638917912965,0.265039644172228,0.265730751067124,0.265961520267622,0.265730751067124,0.265039644172228,0.2638917912965,0.26229314406796,0.260251962626908,0.257778744535233,0.254886134853278,0.251588818461995,0.247903395913179,0.243848244276002,0.239443364611206,0.234710217842866,0.229671550909808,0.224351215163302,0.218773979033583,0.212965337014902,0.206951317017228,0.200758288103203,0.194412770572437,0.187941250273535,0.181369998919029,0.174724902052201,0.16803129617003,0.161313816346096,0.154596255524162,0.147901436470491,0.1412510971838,0.134665790369373,0.128164797391188,0.121766056926015,0.115486108359012,0.109340049783996,0.103341510305529,0.0975026361863571,0.0918340902441319,0.0863450637772612,0.0810433001921206,0.0759351294134613,0.0710255120870567,0.0663180925284991,0.0618152593343438,0.0575182125510077,0.0534270362921773,0.0495407757059954,0.0458575172177946,0.0423744710113082,0.0390880547596564,0.0359939776754587,0.0330873240155727,0.0303626352486037,0.0278139901708924,0.025435082337612,0.0232192942584229,0.0211597678904449,0.0192494710438316,0.0174812593958063,0.0158479338866092,0.0143422933445158,0.0129571822561766,0.011685533662379,0.0105204072174879,0.0094550225029582,0.00848278773122096,0.00759732401586496,0.00679248541739243,0.0060623750010607,0.00540135716465233,0.00480406650973948,0.00426541354048237,0.00378058747963059,0.00334505649262177,0.00295456560795867,0.00260513261587192,0.00229304221812166,0.0020148386901325,0.0017673173029534,0.00154751473722805,0.00135269870486651,0.00118035697680993,0.0010281859975274,0.000894079248993585,0.000776115509144256,0.000672547132437612,0.00058178846336384,0.000502404477714495,0.000433099731279709,0.00037270768148811,0.00032018043441388,0.000274578957593722,0.000235063788244964,0.000200886256755444,0.000171380236708204,0.000145954425176408,0.000124085150530496,0.000105309699484658,8.92201505099236e-05],"mode":"lines","fill":"tozeroy","text":["x：-4<br>y：0<br>","x：-3.9375<br>y：0<br>","x：-3.875<br>y：0<br>","x：-3.8125<br>y：0<br>","x：-3.75<br>y：0<br>","x：-3.6875<br>y：0<br>","x：-3.625<br>y：0<br>","x：-3.5625<br>y：0<br>","x：-3.5<br>y：0<br>","x：-3.4375<br>y：0<br>","x：-3.375<br>y：0<br>","x：-3.3125<br>y：0.001<br>","x：-3.25<br>y：0.001<br>","x：-3.1875<br>y：0.001<br>","x：-3.125<br>y：0.001<br>","x：-3.0625<br>y：0.001<br>","x：-3<br>y：0.001<br>","x：-2.9375<br>y：0.001<br>","x：-2.875<br>y：0.001<br>","x：-2.8125<br>y：0.002<br>","x：-2.75<br>y：0.002<br>","x：-2.6875<br>y：0.002<br>","x：-2.625<br>y：0.002<br>","x：-2.5625<br>y：0.003<br>","x：-2.5<br>y：0.003<br>","x：-2.4375<br>y：0.003<br>","x：-2.375<br>y：0.004<br>","x：-2.3125<br>y：0.004<br>","x：-2.25<br>y：0.005<br>","x：-2.1875<br>y：0.005<br>","x：-2.125<br>y：0.006<br>","x：-2.0625<br>y：0.007<br>","x：-2<br>y：0.008<br>","x：-1.9375<br>y：0.008<br>","x：-1.875<br>y：0.009<br>","x：-1.8125<br>y：0.011<br>","x：-1.75<br>y：0.012<br>","x：-1.6875<br>y：0.013<br>","x：-1.625<br>y：0.014<br>","x：-1.5625<br>y：0.016<br>","x：-1.5<br>y：0.017<br>","x：-1.4375<br>y：0.019<br>","x：-1.375<br>y：0.021<br>","x：-1.3125<br>y：0.023<br>","x：-1.25<br>y：0.025<br>","x：-1.1875<br>y：0.028<br>","x：-1.125<br>y：0.03<br>","x：-1.0625<br>y：0.033<br>","x：-1<br>y：0.036<br>","x：-0.9375<br>y：0.039<br>","x：-0.875<br>y：0.042<br>","x：-0.8125<br>y：0.046<br>","x：-0.75<br>y：0.05<br>","x：-0.6875<br>y：0.053<br>","x：-0.625<br>y：0.058<br>","x：-0.5625<br>y：0.062<br>","x：-0.5<br>y：0.066<br>","x：-0.4375<br>y：0.071<br>","x：-0.375<br>y：0.076<br>","x：-0.3125<br>y：0.081<br>","x：-0.25<br>y：0.086<br>","x：-0.1875<br>y：0.092<br>","x：-0.125<br>y：0.098<br>","x：-0.0625<br>y：0.103<br>","x：0<br>y：0.109<br>","x：0.0625<br>y：0.115<br>","x：0.125<br>y：0.122<br>","x：0.1875<br>y：0.128<br>","x：0.25<br>y：0.135<br>","x：0.3125<br>y：0.141<br>","x：0.375<br>y：0.148<br>","x：0.4375<br>y：0.155<br>","x：0.5<br>y：0.161<br>","x：0.5625<br>y：0.168<br>","x：0.625<br>y：0.175<br>","x：0.6875<br>y：0.181<br>","x：0.75<br>y：0.188<br>","x：0.8125<br>y：0.194<br>","x：0.875<br>y：0.201<br>","x：0.9375<br>y：0.207<br>","x：1<br>y：0.213<br>","x：1.0625<br>y：0.219<br>","x：1.125<br>y：0.224<br>","x：1.1875<br>y：0.23<br>","x：1.25<br>y：0.235<br>","x：1.3125<br>y：0.239<br>","x：1.375<br>y：0.244<br>","x：1.4375<br>y：0.248<br>","x：1.5<br>y：0.252<br>","x：1.5625<br>y：0.255<br>","x：1.625<br>y：0.258<br>","x：1.6875<br>y：0.26<br>","x：1.75<br>y：0.262<br>","x：1.8125<br>y：0.264<br>","x：1.875<br>y：0.265<br>","x：1.9375<br>y：0.266<br>","x：2<br>y：0.266<br>","x：2.0625<br>y：0.266<br>","x：2.125<br>y：0.265<br>","x：2.1875<br>y：0.264<br>","x：2.25<br>y：0.262<br>","x：2.3125<br>y：0.26<br>","x：2.375<br>y：0.258<br>","x：2.4375<br>y：0.255<br>","x：2.5<br>y：0.252<br>","x：2.5625<br>y：0.248<br>","x：2.625<br>y：0.244<br>","x：2.6875<br>y：0.239<br>","x：2.75<br>y：0.235<br>","x：2.8125<br>y：0.23<br>","x：2.875<br>y：0.224<br>","x：2.9375<br>y：0.219<br>","x：3<br>y：0.213<br>","x：3.0625<br>y：0.207<br>","x：3.125<br>y：0.201<br>","x：3.1875<br>y：0.194<br>","x：3.25<br>y：0.188<br>","x：3.3125<br>y：0.181<br>","x：3.375<br>y：0.175<br>","x：3.4375<br>y：0.168<br>","x：3.5<br>y：0.161<br>","x：3.5625<br>y：0.155<br>","x：3.625<br>y：0.148<br>","x：3.6875<br>y：0.141<br>","x：3.75<br>y：0.135<br>","x：3.8125<br>y：0.128<br>","x：3.875<br>y：0.122<br>","x：3.9375<br>y：0.115<br>","x：4<br>y：0.109<br>","x：4.0625<br>y：0.103<br>","x：4.125<br>y：0.098<br>","x：4.1875<br>y：0.092<br>","x：4.25<br>y：0.086<br>","x：4.3125<br>y：0.081<br>","x：4.375<br>y：0.076<br>","x：4.4375<br>y：0.071<br>","x：4.5<br>y：0.066<br>","x：4.5625<br>y：0.062<br>","x：4.625<br>y：0.058<br>","x：4.6875<br>y：0.053<br>","x：4.75<br>y：0.05<br>","x：4.8125<br>y：0.046<br>","x：4.875<br>y：0.042<br>","x：4.9375<br>y：0.039<br>","x：5<br>y：0.036<br>","x：5.0625<br>y：0.033<br>","x：5.125<br>y：0.03<br>","x：5.1875<br>y：0.028<br>","x：5.25<br>y：0.025<br>","x：5.3125<br>y：0.023<br>","x：5.375<br>y：0.021<br>","x：5.4375<br>y：0.019<br>","x：5.5<br>y：0.017<br>","x：5.5625<br>y：0.016<br>","x：5.625<br>y：0.014<br>","x：5.6875<br>y：0.013<br>","x：5.75<br>y：0.012<br>","x：5.8125<br>y：0.011<br>","x：5.875<br>y：0.009<br>","x：5.9375<br>y：0.008<br>","x：6<br>y：0.008<br>","x：6.0625<br>y：0.007<br>","x：6.125<br>y：0.006<br>","x：6.1875<br>y：0.005<br>","x：6.25<br>y：0.005<br>","x：6.3125<br>y：0.004<br>","x：6.375<br>y：0.004<br>","x：6.4375<br>y：0.003<br>","x：6.5<br>y：0.003<br>","x：6.5625<br>y：0.003<br>","x：6.625<br>y：0.002<br>","x：6.6875<br>y：0.002<br>","x：6.75<br>y：0.002<br>","x：6.8125<br>y：0.002<br>","x：6.875<br>y：0.001<br>","x：6.9375<br>y：0.001<br>","x：7<br>y：0.001<br>","x：7.0625<br>y：0.001<br>","x：7.125<br>y：0.001<br>","x：7.1875<br>y：0.001<br>","x：7.25<br>y：0.001<br>","x：7.3125<br>y：0.001<br>","x：7.375<br>y：0<br>","x：7.4375<br>y：0<br>","x：7.5<br>y：0<br>","x：7.5625<br>y：0<br>","x：7.625<br>y：0<br>","x：7.6875<br>y：0<br>","x：7.75<br>y：0<br>","x：7.8125<br>y：0<br>","x：7.875<br>y：0<br>","x：7.9375<br>y：0<br>","x：8<br>y：0<br>"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"#5BC0DE","shape":"spline"},"name":"$\\mathcal{N}(2, 1.5^2)$","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(92, 184, 92, 0.2)","x":[2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3,null,2,3],"y":[0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28,null,0.28,0.28],"mode":"lines","fill":"tozeroy","text":["x：-4<br>y：0<br>","x：-4<br>y：0<br>",null,"x：-3.9375<br>y：0<br>","x：-3.9375<br>y：0<br>",null,"x：-3.875<br>y：0<br>","x：-3.875<br>y：0<br>",null,"x：-3.8125<br>y：0<br>","x：-3.8125<br>y：0<br>",null,"x：-3.75<br>y：0<br>","x：-3.75<br>y：0<br>",null,"x：-3.6875<br>y：0<br>","x：-3.6875<br>y：0<br>",null,"x：-3.625<br>y：0<br>","x：-3.625<br>y：0<br>",null,"x：-3.5625<br>y：0<br>","x：-3.5625<br>y：0<br>",null,"x：-3.5<br>y：0<br>","x：-3.5<br>y：0<br>",null,"x：-3.4375<br>y：0<br>","x：-3.4375<br>y：0<br>",null,"x：-3.375<br>y：0<br>","x：-3.375<br>y：0<br>",null,"x：-3.3125<br>y：0<br>","x：-3.3125<br>y：0<br>",null,"x：-3.25<br>y：0<br>","x：-3.25<br>y：0<br>",null,"x：-3.1875<br>y：0<br>","x：-3.1875<br>y：0<br>",null,"x：-3.125<br>y：0<br>","x：-3.125<br>y：0<br>",null,"x：-3.0625<br>y：0<br>","x：-3.0625<br>y：0<br>",null,"x：-3<br>y：0<br>","x：-3<br>y：0<br>",null,"x：-2.9375<br>y：0<br>","x：-2.9375<br>y：0<br>",null,"x：-2.875<br>y：0<br>","x：-2.875<br>y：0<br>",null,"x：-2.8125<br>y：0<br>","x：-2.8125<br>y：0<br>",null,"x：-2.75<br>y：0<br>","x：-2.75<br>y：0<br>",null,"x：-2.6875<br>y：0<br>","x：-2.6875<br>y：0<br>",null,"x：-2.625<br>y：0<br>","x：-2.625<br>y：0<br>",null,"x：-2.5625<br>y：0<br>","x：-2.5625<br>y：0<br>",null,"x：-2.5<br>y：0<br>","x：-2.5<br>y：0<br>",null,"x：-2.4375<br>y：0<br>","x：-2.4375<br>y：0<br>",null,"x：-2.375<br>y：0<br>","x：-2.375<br>y：0<br>",null,"x：-2.3125<br>y：0<br>","x：-2.3125<br>y：0<br>",null,"x：-2.25<br>y：0<br>","x：-2.25<br>y：0<br>",null,"x：-2.1875<br>y：0<br>","x：-2.1875<br>y：0<br>",null,"x：-2.125<br>y：0<br>","x：-2.125<br>y：0<br>",null,"x：-2.0625<br>y：0<br>","x：-2.0625<br>y：0<br>",null,"x：-2<br>y：0<br>","x：-2<br>y：0<br>",null,"x：-1.9375<br>y：0<br>","x：-1.9375<br>y：0<br>",null,"x：-1.875<br>y：0<br>","x：-1.875<br>y：0<br>",null,"x：-1.8125<br>y：0<br>","x：-1.8125<br>y：0<br>",null,"x：-1.75<br>y：0<br>","x：-1.75<br>y：0<br>",null,"x：-1.6875<br>y：0<br>","x：-1.6875<br>y：0<br>",null,"x：-1.625<br>y：0<br>","x：-1.625<br>y：0<br>",null,"x：-1.5625<br>y：0<br>","x：-1.5625<br>y：0<br>",null,"x：-1.5<br>y：0<br>","x：-1.5<br>y：0<br>",null,"x：-1.4375<br>y：0<br>","x：-1.4375<br>y：0<br>",null,"x：-1.375<br>y：0<br>","x：-1.375<br>y：0<br>",null,"x：-1.3125<br>y：0<br>","x：-1.3125<br>y：0<br>",null,"x：-1.25<br>y：0<br>","x：-1.25<br>y：0<br>",null,"x：-1.1875<br>y：0<br>","x：-1.1875<br>y：0<br>",null,"x：-1.125<br>y：0<br>","x：-1.125<br>y：0<br>",null,"x：-1.0625<br>y：0<br>","x：-1.0625<br>y：0<br>",null,"x：-1<br>y：0<br>","x：-1<br>y：0<br>",null,"x：-0.9375<br>y：0<br>","x：-0.9375<br>y：0<br>",null,"x：-0.875<br>y：0<br>","x：-0.875<br>y：0<br>",null,"x：-0.8125<br>y：0<br>","x：-0.8125<br>y：0<br>",null,"x：-0.75<br>y：0<br>","x：-0.75<br>y：0<br>",null,"x：-0.6875<br>y：0<br>","x：-0.6875<br>y：0<br>",null,"x：-0.625<br>y：0.001<br>","x：-0.625<br>y：0.001<br>",null,"x：-0.5625<br>y：0.001<br>","x：-0.5625<br>y：0.001<br>",null,"x：-0.5<br>y：0.001<br>","x：-0.5<br>y：0.001<br>",null,"x：-0.4375<br>y：0.001<br>","x：-0.4375<br>y：0.001<br>",null,"x：-0.375<br>y：0.001<br>","x：-0.375<br>y：0.001<br>",null,"x：-0.3125<br>y：0.002<br>","x：-0.3125<br>y：0.002<br>",null,"x：-0.25<br>y：0.002<br>","x：-0.25<br>y：0.002<br>",null,"x：-0.1875<br>y：0.002<br>","x：-0.1875<br>y：0.002<br>",null,"x：-0.125<br>y：0.003<br>","x：-0.125<br>y：0.003<br>",null,"x：-0.0625<br>y：0.004<br>","x：-0.0625<br>y：0.004<br>",null,"x：0<br>y：0.004<br>","x：0<br>y：0.004<br>",null,"x：0.0625<br>y：0.005<br>","x：0.0625<br>y：0.005<br>",null,"x：0.125<br>y：0.006<br>","x：0.125<br>y：0.006<br>",null,"x：0.1875<br>y：0.008<br>","x：0.1875<br>y：0.008<br>",null,"x：0.25<br>y：0.009<br>","x：0.25<br>y：0.009<br>",null,"x：0.3125<br>y：0.011<br>","x：0.3125<br>y：0.011<br>",null,"x：0.375<br>y：0.013<br>","x：0.375<br>y：0.013<br>",null,"x：0.4375<br>y：0.015<br>","x：0.4375<br>y：0.015<br>",null,"x：0.5<br>y：0.018<br>","x：0.5<br>y：0.018<br>",null,"x：0.5625<br>y：0.02<br>","x：0.5625<br>y：0.02<br>",null,"x：0.625<br>y：0.024<br>","x：0.625<br>y：0.024<br>",null,"x：0.6875<br>y：0.028<br>","x：0.6875<br>y：0.028<br>",null,"x：0.75<br>y：0.032<br>","x：0.75<br>y：0.032<br>",null,"x：0.8125<br>y：0.036<br>","x：0.8125<br>y：0.036<br>",null,"x：0.875<br>y：0.042<br>","x：0.875<br>y：0.042<br>",null,"x：0.9375<br>y：0.048<br>","x：0.9375<br>y：0.048<br>",null,"x：1<br>y：0.054<br>","x：1<br>y：0.054<br>",null,"x：1.0625<br>y：0.061<br>","x：1.0625<br>y：0.061<br>",null,"x：1.125<br>y：0.069<br>","x：1.125<br>y：0.069<br>",null,"x：1.1875<br>y：0.077<br>","x：1.1875<br>y：0.077<br>",null,"x：1.25<br>y：0.086<br>","x：1.25<br>y：0.086<br>",null,"x：1.3125<br>y：0.096<br>","x：1.3125<br>y：0.096<br>",null,"x：1.375<br>y：0.107<br>","x：1.375<br>y：0.107<br>",null,"x：1.4375<br>y：0.118<br>","x：1.4375<br>y：0.118<br>",null,"x：1.5<br>y：0.13<br>","x：1.5<br>y：0.13<br>",null,"x：1.5625<br>y：0.142<br>","x：1.5625<br>y：0.142<br>",null,"x：1.625<br>y：0.155<br>","x：1.625<br>y：0.155<br>",null,"x：1.6875<br>y：0.169<br>","x：1.6875<br>y：0.169<br>",null,"x：1.75<br>y：0.183<br>","x：1.75<br>y：0.183<br>",null,"x：1.8125<br>y：0.197<br>","x：1.8125<br>y：0.197<br>",null,"x：1.875<br>y：0.212<br>","x：1.875<br>y：0.212<br>",null,"x：1.9375<br>y：0.227<br>","x：1.9375<br>y：0.227<br>",null,"x：2<br>y：0.242<br>","x：2<br>y：0.242<br>",null,"x：2.0625<br>y：0.257<br>","x：2.0625<br>y：0.257<br>",null,"x：2.125<br>y：0.272<br>","x：2.125<br>y：0.272<br>",null,"x：2.1875<br>y：0.287<br>","x：2.1875<br>y：0.287<br>",null,"x：2.25<br>y：0.301<br>","x：2.25<br>y：0.301<br>",null,"x：2.3125<br>y：0.315<br>","x：2.3125<br>y：0.315<br>",null,"x：2.375<br>y：0.328<br>","x：2.375<br>y：0.328<br>",null,"x：2.4375<br>y：0.341<br>","x：2.4375<br>y：0.341<br>",null,"x：2.5<br>y：0.352<br>","x：2.5<br>y：0.352<br>",null,"x：2.5625<br>y：0.363<br>","x：2.5625<br>y：0.363<br>",null,"x：2.625<br>y：0.372<br>","x：2.625<br>y：0.372<br>",null,"x：2.6875<br>y：0.38<br>","x：2.6875<br>y：0.38<br>",null,"x：2.75<br>y：0.387<br>","x：2.75<br>y：0.387<br>",null,"x：2.8125<br>y：0.392<br>","x：2.8125<br>y：0.392<br>",null,"x：2.875<br>y：0.396<br>","x：2.875<br>y：0.396<br>",null,"x：2.9375<br>y：0.398<br>","x：2.9375<br>y：0.398<br>",null,"x：3<br>y：0.399<br>","x：3<br>y：0.399<br>",null,"x：3.0625<br>y：0.398<br>","x：3.0625<br>y：0.398<br>",null,"x：3.125<br>y：0.396<br>","x：3.125<br>y：0.396<br>",null,"x：3.1875<br>y：0.392<br>","x：3.1875<br>y：0.392<br>",null,"x：3.25<br>y：0.387<br>","x：3.25<br>y：0.387<br>",null,"x：3.3125<br>y：0.38<br>","x：3.3125<br>y：0.38<br>",null,"x：3.375<br>y：0.372<br>","x：3.375<br>y：0.372<br>",null,"x：3.4375<br>y：0.363<br>","x：3.4375<br>y：0.363<br>",null,"x：3.5<br>y：0.352<br>","x：3.5<br>y：0.352<br>",null,"x：3.5625<br>y：0.341<br>","x：3.5625<br>y：0.341<br>",null,"x：3.625<br>y：0.328<br>","x：3.625<br>y：0.328<br>",null,"x：3.6875<br>y：0.315<br>","x：3.6875<br>y：0.315<br>",null,"x：3.75<br>y：0.301<br>","x：3.75<br>y：0.301<br>",null,"x：3.8125<br>y：0.287<br>","x：3.8125<br>y：0.287<br>",null,"x：3.875<br>y：0.272<br>","x：3.875<br>y：0.272<br>",null,"x：3.9375<br>y：0.257<br>","x：3.9375<br>y：0.257<br>",null,"x：4<br>y：0.242<br>","x：4<br>y：0.242<br>",null,"x：4.0625<br>y：0.227<br>","x：4.0625<br>y：0.227<br>",null,"x：4.125<br>y：0.212<br>","x：4.125<br>y：0.212<br>",null,"x：4.1875<br>y：0.197<br>","x：4.1875<br>y：0.197<br>",null,"x：4.25<br>y：0.183<br>","x：4.25<br>y：0.183<br>",null,"x：4.3125<br>y：0.169<br>","x：4.3125<br>y：0.169<br>",null,"x：4.375<br>y：0.155<br>","x：4.375<br>y：0.155<br>",null,"x：4.4375<br>y：0.142<br>","x：4.4375<br>y：0.142<br>",null,"x：4.5<br>y：0.13<br>","x：4.5<br>y：0.13<br>",null,"x：4.5625<br>y：0.118<br>","x：4.5625<br>y：0.118<br>",null,"x：4.625<br>y：0.107<br>","x：4.625<br>y：0.107<br>",null,"x：4.6875<br>y：0.096<br>","x：4.6875<br>y：0.096<br>",null,"x：4.75<br>y：0.086<br>","x：4.75<br>y：0.086<br>",null,"x：4.8125<br>y：0.077<br>","x：4.8125<br>y：0.077<br>",null,"x：4.875<br>y：0.069<br>","x：4.875<br>y：0.069<br>",null,"x：4.9375<br>y：0.061<br>","x：4.9375<br>y：0.061<br>",null,"x：5<br>y：0.054<br>","x：5<br>y：0.054<br>",null,"x：5.0625<br>y：0.048<br>","x：5.0625<br>y：0.048<br>",null,"x：5.125<br>y：0.042<br>","x：5.125<br>y：0.042<br>",null,"x：5.1875<br>y：0.036<br>","x：5.1875<br>y：0.036<br>",null,"x：5.25<br>y：0.032<br>","x：5.25<br>y：0.032<br>",null,"x：5.3125<br>y：0.028<br>","x：5.3125<br>y：0.028<br>",null,"x：5.375<br>y：0.024<br>","x：5.375<br>y：0.024<br>",null,"x：5.4375<br>y：0.02<br>","x：5.4375<br>y：0.02<br>",null,"x：5.5<br>y：0.018<br>","x：5.5<br>y：0.018<br>",null,"x：5.5625<br>y：0.015<br>","x：5.5625<br>y：0.015<br>",null,"x：5.625<br>y：0.013<br>","x：5.625<br>y：0.013<br>",null,"x：5.6875<br>y：0.011<br>","x：5.6875<br>y：0.011<br>",null,"x：5.75<br>y：0.009<br>","x：5.75<br>y：0.009<br>",null,"x：5.8125<br>y：0.008<br>","x：5.8125<br>y：0.008<br>",null,"x：5.875<br>y：0.006<br>","x：5.875<br>y：0.006<br>",null,"x：5.9375<br>y：0.005<br>","x：5.9375<br>y：0.005<br>",null,"x：6<br>y：0.004<br>","x：6<br>y：0.004<br>",null,"x：6.0625<br>y：0.004<br>","x：6.0625<br>y：0.004<br>",null,"x：6.125<br>y：0.003<br>","x：6.125<br>y：0.003<br>",null,"x：6.1875<br>y：0.002<br>","x：6.1875<br>y：0.002<br>",null,"x：6.25<br>y：0.002<br>","x：6.25<br>y：0.002<br>",null,"x：6.3125<br>y：0.002<br>","x：6.3125<br>y：0.002<br>",null,"x：6.375<br>y：0.001<br>","x：6.375<br>y：0.001<br>",null,"x：6.4375<br>y：0.001<br>","x：6.4375<br>y：0.001<br>",null,"x：6.5<br>y：0.001<br>","x：6.5<br>y：0.001<br>",null,"x：6.5625<br>y：0.001<br>","x：6.5625<br>y：0.001<br>",null,"x：6.625<br>y：0.001<br>","x：6.625<br>y：0.001<br>",null,"x：6.6875<br>y：0<br>","x：6.6875<br>y：0<br>",null,"x：6.75<br>y：0<br>","x：6.75<br>y：0<br>",null,"x：6.8125<br>y：0<br>","x：6.8125<br>y：0<br>",null,"x：6.875<br>y：0<br>","x：6.875<br>y：0<br>",null,"x：6.9375<br>y：0<br>","x：6.9375<br>y：0<br>",null,"x：7<br>y：0<br>","x：7<br>y：0<br>",null,"x：7.0625<br>y：0<br>","x：7.0625<br>y：0<br>",null,"x：7.125<br>y：0<br>","x：7.125<br>y：0<br>",null,"x：7.1875<br>y：0<br>","x：7.1875<br>y：0<br>",null,"x：7.25<br>y：0<br>","x：7.25<br>y：0<br>",null,"x：7.3125<br>y：0<br>","x：7.3125<br>y：0<br>",null,"x：7.375<br>y：0<br>","x：7.375<br>y：0<br>",null,"x：7.4375<br>y：0<br>","x：7.4375<br>y：0<br>",null,"x：7.5<br>y：0<br>","x：7.5<br>y：0<br>",null,"x：7.5625<br>y：0<br>","x：7.5625<br>y：0<br>",null,"x：7.625<br>y：0<br>","x：7.625<br>y：0<br>",null,"x：7.6875<br>y：0<br>","x：7.6875<br>y：0<br>",null,"x：7.75<br>y：0<br>","x：7.75<br>y：0<br>",null,"x：7.8125<br>y：0<br>","x：7.8125<br>y：0<br>",null,"x：7.875<br>y：0<br>","x：7.875<br>y：0<br>",null,"x：7.9375<br>y：0<br>","x：7.9375<br>y：0<br>",null,"x：8<br>y：0<br>","x：8<br>y：0<br>"],"hoverinfo":["text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text",null,"text","text"],"line":{"color":"black","shape":"spline"},"name":"$\\mathcal{N}(3,1^2)$","type":"scatter","showlegend":false,"marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p class="caption">
图 23.1: 假设检验
</p>
</div>
<p>R. A. Fisher 将抽样分布、参数估计和假设检验列为统计推断的三个中心内容，可见假设检验的重要地位</p>
<p>呈现常见检验的公式，将手写代码和 R 内置函数计算结果进行比较，每一组原假设和备择假设要说明对应的 R 函数和及其参数设置，尽量理论和代码并重，最后结合实际的数据予以解释说明。</p>
<p>Jacob Cohen 实际谈的是更加深刻的问题。开篇介绍为什么需要假设检验，做检验和不做检验有什么区别？ 杨灿老师在<a href="https://d.cosx.org/d/420930/11">讨论帖</a>提出检验的作用和实际应用问题</p>
<p>有了均值和方差，为什么还要位置参数和尺度参数？为了更一般地描述问题，扩展范围。</p>
<p><a href="https://rcompanion.org/handbook/">Summary and Analysis of Extension Program Evaluation in R</a> 介绍了各类假设检验方法</p>
<p><a href="https://mbjoseph.github.io/posts/2018-12-27-the-iquit-r-video-series/">The IQUIT R video series</a></p>
<p>假设检验， 实验 A 和 B 的区分度 适用于在线服务的 A/B 测试方法论 <a href="http://www.fengjunchen.com/" class="uri">http://www.fengjunchen.com/</a></p>
<p><a href="https://yihui.org/cn/2009/02/test-statistical-distributions/">统计分布的检验</a></p>
<p><a href="https://rpsychologist.com/d3/cohend/">从心理学和可视化的角度谈 Cohen’s d</a></p>
<p><a href="https://yihui.org/cn/2008/09/introduction-to-bootstrap-and-permutation-test/">Bootstrap 方法和置换/秩检验（Permutation Test）的入门读物</a></p>
<p><a href="https://stats.stackexchange.com/questions/471232/optimal-unbalanced-design-for-a-b-test">非平衡的 A/B 试验设计 Optimal unbalanced design for A/B test</a></p>
<p><a href="https://stats.stackexchange.com/questions/471486/wilcoxon-wmwu-test-sensitivity">Wilcoxon (WMWU) test sensitivity 检验的灵敏性</a></p>
<p><a href="https://blog.ephorie.de/from-coin-tosses-to-p-hacking-make-statistics-significant-again">从抛硬币到 P 值和统计显著性</a></p>
<p><a href="https://blog.ephorie.de/learning-data-science-a-b-testing-in-under-one-minute">一分钟学会 A/B 测试</a></p>
<p><a href="https://github.com/kassambara/rstatix">rstatix</a> 包提供了一个简明的管道友好的框架，和 tidyverse 的设计哲学保持一致，支持常见的统计检验，如 T 检验，Wilcoxon 检验，方差分析，Kruskal-Wallis 检验，相关性分析，并将结果整理成干净的数据框形式，以方便可视化。</p>
<p><a href="https://github.com/pieces201020/AB-Test-Sample-Size-Calculator" class="uri">https://github.com/pieces201020/AB-Test-Sample-Size-Calculator</a> 又一个样本量计算器</p>
<div id="sec-ansari-test" class="section level2" number="23.1">
<h2>
<span class="header-section-number">23.1</span> Ansari-Bradley 检验 <code>ansari.test</code><a class="anchor" aria-label="anchor" href="#sec-ansari-test"><i class="fas fa-link"></i></a>
</h2>
<p>Ansari-Bradley 检验目的是检验两样本的尺度参数是否有显著性差异</p>
<p>尺度参数可以理解为方差 <span class="math inline">\(\sigma^2\)</span></p>
<p>位置参数可以理解为均值 <span class="math inline">\(\mu\)</span></p>
<div class="sourceCode" id="cb1930"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">ansari.test</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/ansari.test.html">ansari.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>
<span class="fu">usage</span><span class="op">(</span><span class="st">"ansari.test.default"</span><span class="op">)</span>
<span class="co">## Default S3 method:</span>
<span class="fu"><a href="https://rdrr.io/r/stats/ansari.test.html">ansari.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, alternative <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"two.sided"</span>, <span class="st">"less"</span>, <span class="st">"greater"</span><span class="op">)</span>, exact <span class="op">=</span> <span class="cn">NULL</span>,
    conf.int <span class="op">=</span> <span class="cn">FALSE</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, <span class="va">...</span><span class="op">)</span>
<span class="fu">usage</span><span class="op">(</span><span class="st">"ansari.test.formula"</span><span class="op">)</span>
<span class="co">## S3 method for class 'formula'</span>
<span class="fu"><a href="https://rdrr.io/r/stats/ansari.test.html">ansari.test</a></span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">subset</span>, <span class="va">na.action</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
</div>
<div id="sec-bartlett-test" class="section level2" number="23.2">
<h2>
<span class="header-section-number">23.2</span> Bartlett 检验 <code>bartlett.test</code><a class="anchor" aria-label="anchor" href="#sec-bartlett-test"><i class="fas fa-link"></i></a>
</h2>
<p><code>ansari.test</code> 和 <code>mood.test</code> 是基于秩的两样本尺度参数显著性差异检验，是非参数检验</p>
<p>Bartlett 检验：检验各个组的方差是否有显著性差异，即方差齐性检验。</p>
<p><code>var.test</code> 和 <code>bartlett.test</code> 都属于参数检验，用于检验方差齐性问题，前者考虑正态总体下方差齐性检验，后者没有对总体的分布形式做限定。</p>
<div class="sourceCode" id="cb1931"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">bartlett.test</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/bartlett.test.html">bartlett.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>
<span class="fu">usage</span><span class="op">(</span><span class="st">"bartlett.test.default"</span><span class="op">)</span>
<span class="co">## Default S3 method:</span>
<span class="fu"><a href="https://rdrr.io/r/stats/bartlett.test.html">bartlett.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">g</span>, <span class="va">...</span><span class="op">)</span>
<span class="fu">usage</span><span class="op">(</span><span class="st">"bartlett.test.formula"</span><span class="op">)</span>
<span class="co">## S3 method for class 'formula'</span>
<span class="fu"><a href="https://rdrr.io/r/stats/bartlett.test.html">bartlett.test</a></span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">subset</span>, <span class="va">na.action</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
</div>
<div id="sec-binom-test" class="section level2" number="23.3">
<h2>
<span class="header-section-number">23.3</span> 二项检验 <code>binom.test</code><a class="anchor" aria-label="anchor" href="#sec-binom-test"><i class="fas fa-link"></i></a>
</h2>
<p>比例 <span class="math inline">\(p\)</span> 的检验， 做 <span class="math inline">\(n\)</span> 次独立试验，样本 <span class="math inline">\(X_1,\ldots,X_n \sim b(1, p)\)</span>，事件发生的总次数 <span class="math inline">\(\sum_{i=1}^{n}X_i\)</span></p>
<p>函数 <code>binom.test</code> 用来检验伯努利试验中成功概率 <span class="math inline">\(p\)</span> 和给定概率 <span class="math inline">\(p_0\)</span> 的关系，属于精确检验。</p>
<p>编程手动实现一个，再调用函数计算，比较结果</p>
<div class="sourceCode" id="cb1932"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 模拟一组样本</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>二项分布中成功概率的检验</p>
<div class="sourceCode" id="cb1933"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/binom.test.html">binom.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">100</span>, p <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Exact binomial test
## 
## data:  sum(x) and 100
## number of successes = 18, number of trials = 100, p-value = 6.148e-11
## alternative hypothesis: true probability of success is not equal to 0.5
## 95 percent confidence interval:
##  0.1103112 0.2694771
## sample estimates:
## probability of success 
##                   0.18</code></pre>
<p>检验成功概率 p 是否等于 0.5， P 值 <span class="math inline">\(6.148 \times 10^{-11}\)</span> 结论是拒绝原假设</p>
<div class="sourceCode" id="cb1935"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/binom.test.html">binom.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">100</span>, p <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Exact binomial test
## 
## data:  sum(x) and 100
## number of successes = 18, number of trials = 100, p-value = 0.7081
## alternative hypothesis: true probability of success is not equal to 0.2
## 95 percent confidence interval:
##  0.1103112 0.2694771
## sample estimates:
## probability of success 
##                   0.18</code></pre>
<p>检验成功概率 p 是否等于 0.2， P 值 0.7081 结论是不能拒绝原假设</p>
<p>二项检验 <span class="citation"><a href="#ref-Test_1934_binom" role="doc-biblioref">[36]</a></span></p>
<div class="sourceCode" id="cb1937"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">binom.test</span><span class="op">)</span></code></pre></div>
<pre><code><a href="https://rdrr.io/r/stats/binom.test.html">binom.test(x, n, p = 0.5, alternative = c("two.sided", "less", "greater"),
    conf.level = 0.95)</a></code></pre>
</div>
<div id="sec-Box-test" class="section level2" number="23.4">
<h2>
<span class="header-section-number">23.4</span> 时间序列独立性检验 <code>Box.test</code><a class="anchor" aria-label="anchor" href="#sec-Box-test"><i class="fas fa-link"></i></a>
</h2>
<p>计算 Box-Pierce 或 Ljung-Box 检验统计量来检查给定时间序列的独立性假设。</p>
<div class="sourceCode" id="cb1939"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">Box.test</span><span class="op">)</span></code></pre></div>
<pre><code><a href="https://rdrr.io/r/stats/box.test.html">Box.test(x, lag = 1, type = c("Box-Pierce", "Ljung-Box"), fitdf = 0)</a></code></pre>
</div>
<div id="sec-chisq-test" class="section level2" number="23.5">
<h2>
<span class="header-section-number">23.5</span> 皮尔逊卡方检验 <code>chisq.test</code><a class="anchor" aria-label="anchor" href="#sec-chisq-test"><i class="fas fa-link"></i></a>
</h2>
<p>用于计数数据的皮尔逊卡方检验：列联表独立性检验和拟合优度检验</p>
<p><code>chisq.test</code> <span class="math inline">\(\chi^2\)</span> 检验：列联表检验和拟合优度检验</p>
<div class="sourceCode" id="cb1941"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">chisq.test</span><span class="op">)</span></code></pre></div>
<pre><code><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test(x, y = NULL, correct = TRUE, p = rep(1/length(x), length(x)),
    rescale.p = FALSE, simulate.p.value = FALSE, B = 2000)</a></code></pre>
</div>
<div id="sec-fisher-test" class="section level2" number="23.6">
<h2>
<span class="header-section-number">23.6</span> 费舍尔精确检验 <code>fisher.test</code><a class="anchor" aria-label="anchor" href="#sec-fisher-test"><i class="fas fa-link"></i></a>
</h2>
<p>固定边际的情况下，检验列联表行和列之间的独立性</p>
<div class="sourceCode" id="cb1943"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">fisher.test</span><span class="op">)</span></code></pre></div>
<pre><code><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test(x, y = NULL, workspace = 2e+05, hybrid = FALSE,
    hybridPars = c(expect = 5, percent = 80, Emin = 1), control = list(),
    or = 1, alternative = "two.sided", conf.int = TRUE, conf.level = 0.95,
    simulate.p.value = FALSE, B = 2000)</a></code></pre>
</div>
<div id="sec-fligner-test" class="section level2" number="23.7">
<h2>
<span class="header-section-number">23.7</span> 方差齐性检验 <code>fligner.test</code><a class="anchor" aria-label="anchor" href="#sec-fligner-test"><i class="fas fa-link"></i></a>
</h2>
<p>Fligner-Killeen (中位数) 检验各个组的样本方差是不是一致的，也是方差齐性检验</p>
<div class="sourceCode" id="cb1945"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">fligner.test</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/fligner.test.html">fligner.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>
<span class="fu">usage</span><span class="op">(</span><span class="st">"fligner.test.default"</span><span class="op">)</span>
<span class="co">## Default S3 method:</span>
<span class="fu"><a href="https://rdrr.io/r/stats/fligner.test.html">fligner.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">g</span>, <span class="va">...</span><span class="op">)</span>
<span class="fu">usage</span><span class="op">(</span><span class="st">"fligner.test.formula"</span><span class="op">)</span>
<span class="co">## S3 method for class 'formula'</span>
<span class="fu"><a href="https://rdrr.io/r/stats/fligner.test.html">fligner.test</a></span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">subset</span>, <span class="va">na.action</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
</div>
<div id="sec-friedman-test" class="section level2" number="23.8">
<h2>
<span class="header-section-number">23.8</span> Friedman 秩和检验 <code>friedman.test</code><a class="anchor" aria-label="anchor" href="#sec-friedman-test"><i class="fas fa-link"></i></a>
</h2>
<p>Friedman 秩和检验</p>
<p>Performs a Friedman rank sum test with unreplicated blocked data.</p>
<div class="sourceCode" id="cb1946"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">friedman.test</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/friedman.test.html">friedman.test</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">...</span><span class="op">)</span>
<span class="fu">usage</span><span class="op">(</span><span class="st">"friedman.test.default"</span><span class="op">)</span>
<span class="co">## Default S3 method:</span>
<span class="fu"><a href="https://rdrr.io/r/stats/friedman.test.html">friedman.test</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">groups</span>, <span class="va">blocks</span>, <span class="va">...</span><span class="op">)</span>
<span class="fu">usage</span><span class="op">(</span><span class="st">"friedman.test.formula"</span><span class="op">)</span>
<span class="co">## S3 method for class 'formula'</span>
<span class="fu"><a href="https://rdrr.io/r/stats/friedman.test.html">friedman.test</a></span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">subset</span>, <span class="va">na.action</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
</div>
<div id="sec-kruskal-test" class="section level2" number="23.9">
<h2>
<span class="header-section-number">23.9</span> Kruskal-Wallis 秩和检验 <code>kruskal.test</code><a class="anchor" aria-label="anchor" href="#sec-kruskal-test"><i class="fas fa-link"></i></a>
</h2>
<p>Kruskal-Wallis 秩和检验</p>
<div class="sourceCode" id="cb1947"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">kruskal.test</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/kruskal.test.html">kruskal.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>
<span class="fu">usage</span><span class="op">(</span><span class="st">"kruskal.test.default"</span><span class="op">)</span>
<span class="co">## Default S3 method:</span>
<span class="fu"><a href="https://rdrr.io/r/stats/kruskal.test.html">kruskal.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">g</span>, <span class="va">...</span><span class="op">)</span>
<span class="fu">usage</span><span class="op">(</span><span class="st">"kruskal.test.formula"</span><span class="op">)</span>
<span class="co">## S3 method for class 'formula'</span>
<span class="fu"><a href="https://rdrr.io/r/stats/kruskal.test.html">kruskal.test</a></span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">subset</span>, <span class="va">na.action</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
</div>
<div id="sec-ks-test" class="section level2" number="23.10">
<h2>
<span class="header-section-number">23.10</span> 同分布检验 <code>ks.test</code><a class="anchor" aria-label="anchor" href="#sec-ks-test"><i class="fas fa-link"></i></a>
</h2>
<p>Lilliefors 检验 <a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://personal.utdallas.edu/~herve/Abdi-Lillie2007-pretty.pdf" class="uri"&gt;https://personal.utdallas.edu/~herve/Abdi-Lillie2007-pretty.pdf&lt;/a&gt;&lt;/p&gt;'><sup>62</sup></a> 和单样本的 ks 检验的关系</p>
<blockquote>
<p>As to whether you can do a <strong>Lilliefors test</strong> for several groups, that depends entirely on your ability to understand what the underlying question would be (see Adams D 1979).</p>
<p>— Knut M. Wittkowski <a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://stat.ethz.ch/pipermail/r-help/2004-February/045597.html" class="uri"&gt;https://stat.ethz.ch/pipermail/r-help/2004-February/045597.html&lt;/a&gt;&lt;/p&gt;'><sup>63</sup></a></p>
</blockquote>
<p>Kolmogorov-Smirnov 检验：单样本或两样本的同分布检验</p>
<div class="sourceCode" id="cb1948"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">ks.test</span><span class="op">)</span></code></pre></div>
<pre><code><a href="https://rdrr.io/r/stats/ks.test.html">ks.test(x, y, ..., alternative = c("two.sided", "less", "greater"),
    exact = NULL)</a></code></pre>
</div>
<div id="sec-mantelhaen-test" class="section level2" number="23.11">
<h2>
<span class="header-section-number">23.11</span> Cochran-Mantel-Haenszel 卡方检验 <code>mantelhaen.test</code><a class="anchor" aria-label="anchor" href="#sec-mantelhaen-test"><i class="fas fa-link"></i></a>
</h2>
<p>用于计数数据的 Cochran-Mantel-Haenszel 卡方检验</p>
<p>Performs a Cochran-Mantel-Haenszel chi-squared test of the null that two nominal variables are conditionally independent in each stratum, assuming that there is no three-way interaction.</p>
<div class="sourceCode" id="cb1950"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">mantelhaen.test</span><span class="op">)</span></code></pre></div>
<pre><code><a href="https://rdrr.io/r/stats/mantelhaen.test.html">mantelhaen.test(x, y = NULL, z = NULL,
    alternative = c("two.sided", "less", "greater"), correct = TRUE,
    exact = FALSE, conf.level = 0.95)</a></code></pre>
</div>
<div id="sec-mauchly-test" class="section level2" number="23.12">
<h2>
<span class="header-section-number">23.12</span> Mauchly 球形检验 <code>mauchly.test</code><a class="anchor" aria-label="anchor" href="#sec-mauchly-test"><i class="fas fa-link"></i></a>
</h2>
<p>检验：Wishart 分布的协方差矩阵是否正比于给定的矩阵</p>
<p>Mauchly’s Test of Sphericity</p>
<p>Tests whether a Wishart-distributed covariance matrix (or transformation thereof) is proportional to a given matrix.</p>
<div class="sourceCode" id="cb1952"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">mauchly.test</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/mauchly.test.html">mauchly.test</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span>
<span class="fu">usage</span><span class="op">(</span><span class="st">"mauchly.test.mlm"</span><span class="op">)</span>
<span class="co">## S3 method for class 'mlm'</span>
<span class="fu"><a href="https://rdrr.io/r/stats/mauchly.test.html">mauchly.test</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span>
<span class="fu">usage</span><span class="op">(</span><span class="st">"mauchly.test.SSD"</span><span class="op">)</span>
<span class="co">## S3 method for class 'SSD'</span>
<span class="fu"><a href="https://rdrr.io/r/stats/mauchly.test.html">mauchly.test</a></span><span class="op">(</span><span class="va">object</span>, Sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="va">p</span><span class="op">)</span>, T <span class="op">=</span> <span class="fu">Thin.row</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/proj.html">proj</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/proj.html">proj</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span>,
    M <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="va">p</span><span class="op">)</span>, X <span class="op">=</span> <span class="op">~</span><span class="fl">0</span>, idata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
</div>
<div id="sec-mcnemar-test" class="section level2" number="23.13">
<h2>
<span class="header-section-number">23.13</span> McNemar 卡方检验 <code>mcnemar.test</code><a class="anchor" aria-label="anchor" href="#sec-mcnemar-test"><i class="fas fa-link"></i></a>
</h2>
<p>两种统计量的比较 参看谢益辉的博文 <a href="https://yihui.org/cn/2010/05/asymptotia-mcnemar-test-statistics/">渐近理想国：McNemar 检验的两种统计量</a></p>
<p>用于计数数据的 McNemar’s 卡方检验</p>
<p>McNemar’s <span class="math inline">\(\chi^2\)</span> 检验：检验二维列联表行和列的对称性</p>
<!-- 怎么理解对称性？ -->
<div class="sourceCode" id="cb1953"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">mcnemar.test</span><span class="op">)</span></code></pre></div>
<pre><code><a href="https://rdrr.io/r/stats/mcnemar.test.html">mcnemar.test(x, y = NULL, correct = TRUE)</a></code></pre>
</div>
<div id="sec-mood-test" class="section level2" number="23.14">
<h2>
<span class="header-section-number">23.14</span> Mood 方差检验 <code>mood.test</code><a class="anchor" aria-label="anchor" href="#sec-mood-test"><i class="fas fa-link"></i></a>
</h2>
<p>检验方差</p>
<p>Mood’s 两样本检验：检验两样本尺度参数之间的差异性</p>
<div class="sourceCode" id="cb1955"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">mood.test</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/mood.test.html">mood.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>
<span class="fu">usage</span><span class="op">(</span><span class="st">"mood.test.default"</span><span class="op">)</span>
<span class="co">## Default S3 method:</span>
<span class="fu"><a href="https://rdrr.io/r/stats/mood.test.html">mood.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, alternative <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"two.sided"</span>, <span class="st">"less"</span>, <span class="st">"greater"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span>
<span class="fu">usage</span><span class="op">(</span><span class="st">"mood.test.formula"</span><span class="op">)</span>
<span class="co">## S3 method for class 'formula'</span>
<span class="fu"><a href="https://rdrr.io/r/stats/mood.test.html">mood.test</a></span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">subset</span>, <span class="va">na.action</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
</div>
<div id="sec-oneway-test" class="section level2" number="23.15">
<h2>
<span class="header-section-number">23.15</span> 单因素多重比较 <code>oneway.test</code><a class="anchor" aria-label="anchor" href="#sec-oneway-test"><i class="fas fa-link"></i></a>
</h2>
<p>单因素方差分析，各个组的方差不一定相同，检验两个及以上来自正态分布的样本是否有相同的均值？</p>
<div class="sourceCode" id="cb1956"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">oneway.test</span><span class="op">)</span></code></pre></div>
<pre><code><a href="https://rdrr.io/r/stats/oneway.test.html">oneway.test(formula, data, subset, na.action, var.equal = FALSE)</a></code></pre>
<div class="sourceCode" id="cb1958"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## 假定方差不等</span>
<span class="fu"><a href="https://rdrr.io/r/stats/oneway.test.html">oneway.test</a></span><span class="op">(</span><span class="va">extra</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">sleep</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  One-way analysis of means (not assuming equal variances)
## 
## data:  extra and group
## F = 3.4626, num df = 1.000, denom df = 17.776, p-value = 0.07939</code></pre>
<div class="sourceCode" id="cb1960"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## 假定方差相等</span>
<span class="fu"><a href="https://rdrr.io/r/stats/oneway.test.html">oneway.test</a></span><span class="op">(</span><span class="va">extra</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">sleep</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  One-way analysis of means
## 
## data:  extra and group
## F = 3.4626, num df = 1, denom df = 18, p-value = 0.07919</code></pre>
<div class="sourceCode" id="cb1962"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## 和线性回归结果一样</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">extra</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">sleep</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: extra
##           Df Sum Sq Mean Sq F value  Pr(&gt;F)  
## group      1 12.482 12.4820  3.4626 0.07919 .
## Residuals 18 64.886  3.6048                  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>CO2 数据</p>
<div class="sourceCode" id="cb1964"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># coplot(uptake ~ conc | Plant, data = CO2, show.given = FALSE, type = "b")</span>
<span class="co"># levels(CO2$Plant) # Plant 是有序的</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">CO2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">conc</span>, y <span class="op">=</span> <span class="va">uptake</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Treatment</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Treatment</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Plant</span>, ncol <span class="op">=</span> <span class="fl">4</span>, dir <span class="op">=</span> <span class="st">"v"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">CO2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">conc</span>, y <span class="op">=</span> <span class="va">uptake</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Plant</span>, ncol <span class="op">=</span> <span class="fl">4</span>, dir <span class="op">=</span> <span class="st">"v"</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:CO2"></span>
<img src="hypothesis-test_files/figure-html/CO2-1.png" alt="草类植物吸收 CO2" width="768"><p class="caption">
图 23.2: 草类植物吸收 CO2
</p>
</div>
</div>
<div id="sec-pairwise-test" class="section level2" number="23.16">
<h2>
<span class="header-section-number">23.16</span> 配对样本的检验<a class="anchor" aria-label="anchor" href="#sec-pairwise-test"><i class="fas fa-link"></i></a>
</h2>
<p>配对样本和单样本的等价转化</p>
<div id="subsec-pairwise-prop-test" class="section level3" number="23.16.1">
<h3>
<span class="header-section-number">23.16.1</span> 配对比例检验 <code>pairwise.prop.test</code><a class="anchor" aria-label="anchor" href="#subsec-pairwise-prop-test"><i class="fas fa-link"></i></a>
</h3>
<p>配对数据的比例检验</p>
<p>Pairwise comparisons for proportions</p>
<p>Calculate pairwise comparisons between pairs of proportions with correction for multiple testing</p>
<div class="sourceCode" id="cb1965"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">pairwise.prop.test</span><span class="op">)</span></code></pre></div>
<pre><code><a href="https://rdrr.io/r/stats/pairwise.prop.test.html">pairwise.prop.test(x, n, p.adjust.method = p.adjust.methods, ...)</a></code></pre>
</div>
<div id="subsec-pairwise-t-test" class="section level3" number="23.16.2">
<h3>
<span class="header-section-number">23.16.2</span> 配对 t 检验 <code>pairwise.t.test</code><a class="anchor" aria-label="anchor" href="#subsec-pairwise-t-test"><i class="fas fa-link"></i></a>
</h3>
<p>Calculate pairwise comparisons between group levels with corrections for multiple testing</p>
<div class="sourceCode" id="cb1967"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">pairwise.t.test</span><span class="op">)</span></code></pre></div>
<pre><code><a href="https://rdrr.io/r/stats/pairwise.t.test.html">pairwise.t.test(x, g, p.adjust.method = p.adjust.methods, pool.sd = !paired,
    paired = FALSE, alternative = c("two.sided", "less", "greater"), ...)</a></code></pre>
<p>谢益辉以配对组 t 检验谈 <a href="https://yihui.org/cn/2018/02/cohen-s-d/">Cohen’s d</a></p>
<div class="sourceCode" id="cb1969"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/pairwise.t.test.html">pairwise.t.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sleep</span><span class="op">$</span><span class="va">extra</span>, g <span class="op">=</span> <span class="va">sleep</span><span class="op">$</span><span class="va">group</span>, paired <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Pairwise comparisons using paired t tests 
## 
## data:  sleep$extra and sleep$group 
## 
##   1     
## 2 0.0028
## 
## P value adjustment method: holm</code></pre>
<p>成对的 t 检验</p>
</div>
<div id="subsec-pairwise-wilcox-test" class="section level3" number="23.16.3">
<h3>
<span class="header-section-number">23.16.3</span> 配对 Wilcoxon 检验 <code>pairwise.wilcox.test</code><a class="anchor" aria-label="anchor" href="#subsec-pairwise-wilcox-test"><i class="fas fa-link"></i></a>
</h3>
<p>Pairwise Wilcoxon Rank Sum Tests 配对的 Wilcoxon 秩和检验</p>
<p>Calculate pairwise comparisons between group levels with corrections for multiple testing.</p>
<div class="sourceCode" id="cb1971"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">pairwise.wilcox.test</span><span class="op">)</span></code></pre></div>
<pre><code><a href="https://rdrr.io/r/stats/pairwise.wilcox.test.html">pairwise.wilcox.test(x, g, p.adjust.method = p.adjust.methods, paired = FALSE,
    ...)</a></code></pre>
</div>
<div id="subsec-cor-test" class="section level3" number="23.16.4">
<h3>
<span class="header-section-number">23.16.4</span> 配对样本相关性检验 <code>cor.test</code><a class="anchor" aria-label="anchor" href="#subsec-cor-test"><i class="fas fa-link"></i></a>
</h3>
<p>配对样本的相关性检验：Pearson’s 相关系数</p>
<p>Test for association between paired samples, using one of Pearson’s product moment correlation coefficient,</p>
<p>Kendall’s <span class="math inline">\(\tau\)</span> 检验或者 Spearman’s <span class="math inline">\(\rho\)</span> 检验.</p>
<div class="sourceCode" id="cb1973"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">cor.test</span><span class="op">)</span></code></pre></div>
<pre><code><a href="https://rdrr.io/r/stats/cor.test.html">cor.test(x, ...)</a></code></pre>
<ul>
<li>
<code><a href="https://rdrr.io/pkg/Kendall/man/Kendall.html">Kendall::Kendall</a></code> <span class="citation"><a href="#ref-Kendall" role="doc-biblioref">[38]</a></span>
</li>
<li>
<code><a href="https://rdrr.io/pkg/SuppDists/man/Kendall.html">SuppDists::pKendall</a></code> 和 <code><a href="https://rdrr.io/pkg/SuppDists/man/Spearman.html">SuppDists::pSpearman</a></code> <span class="citation"><a href="#ref-SuppDists" role="doc-biblioref">[39]</a></span>
</li>
<li>
<code><a href="https://rdrr.io/pkg/pspearman/man/spearman.test.html">pspearman::spearman.test</a></code> <span class="citation"><a href="#ref-pspearman" role="doc-biblioref">[40]</a></span>
</li>
</ul>
</div>
</div>
<div id="sec-poisson-test" class="section level2" number="23.17">
<h2>
<span class="header-section-number">23.17</span> 精确泊松检验 <code>poisson.test</code><a class="anchor" aria-label="anchor" href="#sec-poisson-test"><i class="fas fa-link"></i></a>
</h2>
<p>泊松分布是 1837年由法国数学家泊松 (Poisson, 1781-1840) 首次提出</p>
<!-- 发现泊松分布的历史故事作为泊松分布的介绍怎么样？ -->
<p>泊松分布的参数 <span class="math inline">\(\lambda (&gt;0)\)</span> 的精确检验</p>
<p>Performs an exact test of a simple null hypothesis about the rate parameter in Poisson distribution, or for the ratio between two rate parameters. 适用于单样本和两样本</p>
<div class="sourceCode" id="cb1975"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">poisson.test</span><span class="op">)</span></code></pre></div>
<pre><code><a href="https://rdrr.io/r/stats/poisson.test.html">poisson.test(x, T = 1, r = 1, alternative = c("two.sided", "less", "greater"),
    conf.level = 0.95)</a></code></pre>
</div>
<div id="sec-PP-test" class="section level2" number="23.18">
<h2>
<span class="header-section-number">23.18</span> 单位根检验 <code>PP.test</code><a class="anchor" aria-label="anchor" href="#sec-PP-test"><i class="fas fa-link"></i></a>
</h2>
<p>时间序列平稳性检验</p>
<p>Phillips-Perron 的单位根检验</p>
<p>Computes the Phillips-Perron test for the null hypothesis that x has a unit root against a stationary alternative.</p>
<div class="sourceCode" id="cb1977"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">PP.test</span><span class="op">)</span></code></pre></div>
<pre><code><a href="https://rdrr.io/r/stats/pp.test.html">PP.test(x, lshort = TRUE)</a></code></pre>
</div>
<div id="sec-prop-test" class="section level2" number="23.19">
<h2>
<span class="header-section-number">23.19</span> 比例检验 <code>prop.test</code><a class="anchor" aria-label="anchor" href="#sec-prop-test"><i class="fas fa-link"></i></a>
</h2>
<p>函数 <code>prop.test</code> 用来检验两组或多组二项分布的成功概率（比例）是否相等，或等于给定的值。近似检验</p>
<div class="sourceCode" id="cb1979"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">prop.test</span><span class="op">)</span></code></pre></div>
<pre><code><a href="https://rdrr.io/r/stats/prop.test.html">prop.test(x, n, p = NULL, alternative = c("two.sided", "less", "greater"),
    conf.level = 0.95, correct = TRUE)</a></code></pre>
<p>设随机变量 X 服从参数为 <span class="math inline">\(p\)</span> 的二项分布 <span class="math inline">\(b(n, p)\)</span>， <span class="math inline">\(Y\)</span> 服从参数为 <span class="math inline">\(\theta\)</span> 的二项分布 <span class="math inline">\(b(m,\theta)\)</span>， <span class="math inline">\(m,n\)</span> 都假定为较大的正整数，检验如下问题</p>
<p><span class="math display">\[
H_0: P_A \geq P_B \quad vs. \quad H_1: P_A &lt; P_B
\]</span></p>
<p>根据中心极限定理</p>
<p><span class="math display">\[
\frac{\bar{X} - \bar{Y}}{\sqrt{\frac{p(1-p)}{n} + \frac{\theta(1-\theta)}{m}}}
\]</span>
近似服从标准正态分布 <span class="math inline">\(N(0,1)\)</span>。如果用矩估计 <span class="math inline">\(\bar{X}\)</span> 和 <span class="math inline">\(\bar{Y}\)</span> 分别替代总体参数 <span class="math inline">\(p\)</span> 和 <span class="math inline">\(\theta\)</span>，构造检验统计量</p>
<p><span class="math display">\[
T = \frac{\bar{X} - \bar{Y}}{\sqrt{\frac{\bar{X}(1-\bar{X})}{n} + \frac{\bar{Y}(1-\bar{Y})}{m}}}
\]</span>
根据 Slutsky 定理，检验统计量 <span class="math inline">\(T\)</span> 近似服从标准正态分布，当 <span class="math inline">\(T\)</span> 偏大时，拒绝 <span class="math inline">\(H_0\)</span>。该方法的优势在于当 <span class="math inline">\(n,m\)</span> 比较大时，二项分布比较复杂，无法建立统计表，利用标准正态分布表来给出检验所需要的临界值，简便易行！</p>
<p>当 <span class="math inline">\(p\)</span> 和 <span class="math inline">\(\theta\)</span> 都比较小，上述方法检验效果不好，原因在于由中心极限定理对 <span class="math inline">\(\bar{X}\)</span> 和 <span class="math inline">\(\bar{Y}\)</span> 的正态分布近似效果不好，或者间接地导致 <span class="math inline">\(\bar{X}-\bar{Y}\)</span> 的方差偏小，进而 <span class="math inline">\(T\)</span> 的分辨都不好，而且当 <span class="math inline">\(p,\theta\)</span> 很接近 1 时，上述现象也会产生！</p>
<p>下面介绍新的解决办法</p>
<p>上面的检验问题等价于</p>
<p><span class="math display">\[
H_0: \frac{P_A}{P_B} \geq 1 \quad vs. \quad H_1: \frac{P_A}{P_B} &lt; 1
\]</span></p>
<p>引入检验统计量</p>
<p><span class="math display">\[
T^{\star} = \frac{\bar{X}}{\bar{Y}}
\]</span>
同样由 Slutsky 定理和中心极限定理可知， <span class="math inline">\(\bar{X}/\bar{Y}\)</span> 近似服从 正态分布<span class="math inline">\(N(1,\frac{1-\theta}{m\theta})\)</span></p>
<p>当 <span class="math inline">\((T^\star - 1)/\hat\sigma\)</span> 偏大时接受 <span class="math inline">\(H_0\)</span>，临界值可通过 <span class="math inline">\(N(0, \hat\sigma^2)\)</span> 分布表计算得到， <span class="math inline">\(\hat\sigma^2\)</span> 是对 <span class="math inline">\(\frac{1-\theta}{m\theta}\)</span> 的估计，比如取 <span class="math inline">\(\hat\sigma^2 = \frac{1-\bar{Y}}{m}\cdot \frac{1}{\bar{Y}}\)</span> 或取 <span class="math inline">\(\hat\sigma^2 = \frac{1-\bar{Y}}{m}\cdot \frac{1}{\bar{X}}\)</span></p>
<p>由于渐近方差形如 <span class="math inline">\(\frac{1-\theta}{m\theta}\)</span>，因而在 <span class="math inline">\(\theta\)</span> 较小，渐近方差较大，克服了之前 <span class="math inline">\(\bar{X} - \bar{Y}\)</span>的方差较小的问题</p>
<p><span class="math inline">\(p,\theta\)</span> 很接近 1 时，我们取检验统计量</p>
<p><span class="math display">\[
T^{\star\star} = \frac{1-\bar{Y}}{1-\bar{X}}
\]</span>
结论和 <span class="math inline">\(T^\star\)</span> 类似，当 <span class="math inline">\(T^{\star\star}\)</span> 偏大时，拒绝 <span class="math inline">\(H_0\)</span>。</p>
<p>两个二项总体成功概率的比较 <span class="citation"><a href="#ref-Prop_2011_Song" role="doc-biblioref">[41]</a></span></p>
<div id="subsec-equivalent-test" class="section level3" number="23.19.1">
<h3>
<span class="header-section-number">23.19.1</span> 两个独立二项总体等价性检验<a class="anchor" aria-label="anchor" href="#subsec-equivalent-test"><i class="fas fa-link"></i></a>
</h3>
<p>关于比例的检验问题</p>
<p><span class="math display">\[\begin{align}
H_0: P_A = P_B \quad vs. \quad H_1: P_A &gt; P_B \\
H_0: P_A = P_B \quad vs. \quad H_1: P_A &lt; P_B
\end{align}\]</span></p>
<p><span class="math inline">\(H_0\)</span> 成立的情况下，暗示着两个样本来自同一总体。在这种假设设置下，拒绝原假设是不是意味着接受备择假设？如何判断样本点会落在哪个拒绝域内呢？</p>
<p>2009 年东南大学韦博成教授将两个独立二项总体的等价性检验应用于《红楼梦》前80回与后40回某些文风差异的统计分析 <span class="citation"><a href="#ref-Stone_2009_Wei" role="doc-biblioref">[42]</a></span></p>
</div>
<div id="subsec-ctr" class="section level3" number="23.19.2">
<h3>
<span class="header-section-number">23.19.2</span> 不同页面的点击率问题<a class="anchor" aria-label="anchor" href="#subsec-ctr"><i class="fas fa-link"></i></a>
</h3>
<p>CTR：点击率 Click Ratio</p>
<p>矩阵 x 第一行表示页面 A 的点击情况，即 1000 次展示有 500 次点击，第二行表示页面 B 的点击情况，即 100 次展示有 80 次点击。通过统计检验的方式比较页面 A 和 B 的点击率哪个更好？</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="center"></th>
<th align="center">S</th>
<th align="center">F</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">A</td>
<td align="center">500</td>
<td align="center">500</td>
</tr>
<tr class="even">
<td align="center">B</td>
<td align="center">80</td>
<td align="center">20</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb1981"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">80</span>, <span class="fl">500</span>, <span class="fl">20</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]  500  500
## [2,]   80   20</code></pre>
<div class="sourceCode" id="cb1983"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 等价于 prop.test(x, alternative = "two.sided", correct = TRUE)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># 默认参数设置情形是双边检验</span></code></pre></div>
<pre><code>## 
##  2-sample test for equality of proportions with continuity correction
## 
## data:  x
## X-squared = 31.632, df = 1, p-value = 1.863e-08
## alternative hypothesis: two.sided
## 95 percent confidence interval:
##  -0.3898012 -0.2101988
## sample estimates:
## prop 1 prop 2 
##    0.5    0.8</code></pre>
<p>默认的假设检验问题</p>
<p><span class="math display">\[
H_0: P_A = P_B \quad vs. \quad H_1: P_A \ne P_B
\]</span></p>
<p>输出结果中 alternative hypothesis 表示备择假设，参数 <code>alternative</code> 指定备择假设的形式</p>
<!-- 不要调用 **broom** 包的 `tidy()` 函数对 `prop_test` 计算结果进行整理，因为要引入新的依赖 -->
<p>备择假设 <span class="math inline">\(P_A &lt; P_B\)</span> 对应</p>
<div class="sourceCode" id="cb1985"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span><span class="va">x</span>, alternative <span class="op">=</span> <span class="st">"less"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  2-sample test for equality of proportions with continuity correction
## 
## data:  x
## X-squared = 31.632, df = 1, p-value = 9.315e-09
## alternative hypothesis: less
## 95 percent confidence interval:
##  -1.0000000 -0.2237522
## sample estimates:
## prop 1 prop 2 
##    0.5    0.8</code></pre>
<p>P 值 <span class="math inline">\(9.315\times 10^{-09}\)</span> 结论是拒绝原假设，并且接受备择假设，即 <span class="math inline">\(P_A &lt; P_B\)</span>，在原假设成立的情况下，样本落入拒绝域的概率很小，小于 0.05，即在一次实验中，样本不可能落入拒绝域，应当接受原假设，因为将备择假设设为</p>
<p>备择假设 <span class="math inline">\(P_A &gt; P_B\)</span></p>
<div class="sourceCode" id="cb1987"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span><span class="va">x</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  2-sample test for equality of proportions with continuity correction
## 
## data:  x
## X-squared = 31.632, df = 1, p-value = 1
## alternative hypothesis: greater
## 95 percent confidence interval:
##  -0.3762478  1.0000000
## sample estimates:
## prop 1 prop 2 
##    0.5    0.8</code></pre>
<p>P 值为 1 不能拒绝原假设，在原假设成立的情况下，样本落入拒绝域的概率是 1</p>
<p>备择假设和原假设在这里是对立的关系</p>
<p>页面 A 观测到的点击率为 <span class="math inline">\(50\%\)</span> 页面 B 观测到的点击率为 <span class="math inline">\(80\%\)</span>，设置检验问题</p>
<p><span class="math display">\[
H_0: P_A = P_B \quad vs. \quad H_1: P_A \leq P_B
\]</span></p>
<p>页面点击率 A 等于 B，则备择假设页面点击率 A 不大于 B</p>
<div class="rmdnote">
<p>默认启用 Yates’ 连续性校正 (continuity correction, 简称 CC)</p>
</div>
</div>
<div id="subsec-prop-home" class="section level3" number="23.19.3">
<h3>
<span class="header-section-number">23.19.3</span> 比例齐性检验<a class="anchor" aria-label="anchor" href="#subsec-prop-home"><i class="fas fa-link"></i></a>
</h3>
<p>原假设四个组里面病人中吸烟的比例是相同的，备择假设是四个组里面至少有一个组的吸烟比例是不同的</p>
<div class="sourceCode" id="cb1989"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Data from Fleiss (1981), p. 139.</span>
<span class="co">## H0: The null hypothesis is that the four populations from which</span>
<span class="co">##     the patients were drawn have the same true proportion of smokers.</span>
<span class="co">## A:  The alternative is that this proportion is different in at</span>
<span class="co">##     least one of the populations.</span>

<span class="va">smokers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">83</span>, <span class="fl">90</span>, <span class="fl">129</span>, <span class="fl">70</span><span class="op">)</span>
<span class="va">patients</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">86</span>, <span class="fl">93</span>, <span class="fl">136</span>, <span class="fl">82</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span><span class="va">smokers</span>, <span class="va">patients</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  4-sample test for equality of proportions without continuity
##  correction
## 
## data:  smokers out of patients
## X-squared = 12.6, df = 3, p-value = 0.005585
## alternative hypothesis: two.sided
## sample estimates:
##    prop 1    prop 2    prop 3    prop 4 
## 0.9651163 0.9677419 0.9485294 0.8536585</code></pre>
<p>Wilson 检验统计量 <span class="citation"><a href="#ref-Test_1927_prop" role="doc-biblioref">[43]</a></span> 考虑单样本比例 <span class="math inline">\(p\)</span> 的区间估计问题，</p>
<p>Probable Inference (Usual): 可能的推断，或然推断，概率推断</p>
<p>在某个总体中抽取 n 个样本，观测到某个比率/频率 <span class="math inline">\(p_0\)</span>，相应的标准差 <span class="math inline">\(\sigma_0 = (p_0q_0/n)^{1/2}\)</span>，常见的概率推断表述是说：比率 <span class="math inline">\(p\)</span> 的真值落在区间 <span class="math inline">\([p_0 - \lambda\sigma_0, p_0 + \lambda\sigma_0]\)</span> 外的概率小于等于 <span class="math inline">\(P_\lambda\)</span>，并且随着 <span class="math inline">\(\lambda\)</span> 增大， <span class="math inline">\(P_\lambda\)</span> 减小。</p>
<p>如果使用 Tchebysheff 切比雪夫准则，我们知道 <span class="math inline">\(P_\lambda\)</span> 本身小于 <span class="math inline">\(1/\lambda^2\)</span>，但是如果使用概率表 <span class="math inline">\(P_\lambda\)</span> 是概率密度曲线与坐标 <span class="math inline">\(\pm\lambda\sigma_0\)</span> 之外的部分围成的面积。尽管切比雪夫准则在估计 <span class="math inline">\(P_\lambda\)</span> 的时候过于保守，但是概率表给出了一个本质的估计。</p>
<p>严格来说，上面给出的概率推断的表述是简略的。真实概率<span class="math inline">\(p\)</span>落在指定范围之外的机会要么是 0 要么是 1，就是说 <span class="math inline">\(p\)</span> 要么在那个范围要么不在那个范围。观测的比率 <span class="math inline">\(p_0\)</span> 有更大或更小的机会落在真实比率 <span class="math inline">\(p\)</span> 的某个区间。观测者运气不好，观测到一个相对罕见的事件发生了，基于已有的推断理论，他会获得一个相当宽的标记。</p>
<p>Probable Inference (Improved):</p>
<p>一个更好的方式来阐述推理过程：</p>
<p>有某个比率 <span class="math inline">\(p\)</span> 它的标准差是 <span class="math inline">\((pq/n)^{1/2} = \sigma\)</span>，一个观测糟糕如 <span class="math inline">\(p_0\)</span> 发生的可能性，即 <span class="math inline">\(p_0\)</span> 落在区间 <span class="math inline">\([p - \lambda\sigma,p + \lambda\sigma]\)</span> 是小于等于 <span class="math inline">\(P_\lambda\)</span>。</p>
<p>这个表述强调了特殊观测相对于一般典型情况更容易犯的错误。</p>
<p>两样本比例 <span class="math inline">\(p\)</span> 的检验问题。</p>
<p>思路需要推导，考虑如下检验问题</p>
<p><span class="math display">\[
H_0: P_A \geq P_B \quad vs. \quad H_1: P_A &lt; P_B
\]</span></p>
<p>比例检验，未知 p 的情况下，且样本量有限，是 t 分布
多种二项检验的办法 <span class="citation"><a href="#ref-Interval_1998_Newcombe" role="doc-biblioref">[44]</a></span></p>
<div class="rmdtip">
<p>切比雪夫不等式 Chebyshev, 1821-1894</p>
<p>设随机变量 <span class="math inline">\(X\)</span> 的数学期望和方差都存在，则对任意常数 <span class="math inline">\(\epsilon &gt; 0\)</span>，有</p>
<p><span class="math display">\[\begin{align}
P(|X - EX| \geq \epsilon) &amp; \leq \frac{Var(X)}{\epsilon^2} \\
P(|X - EX| \leq \epsilon) &amp; \geq 1 - \frac{Var(X)}{\epsilon^2}
\end{align}\]</span></p>
</div>
</div>
</div>
<div id="sec-prop-trend-test" class="section level2" number="23.20">
<h2>
<span class="header-section-number">23.20</span> 比例趋势检验 <code>prop.trend.test</code><a class="anchor" aria-label="anchor" href="#sec-prop-trend-test"><i class="fas fa-link"></i></a>
</h2>
<p>Performs <span class="math inline">\(\chi^2\)</span> test for trend in proportions, i.e., a test asymptotically optimal for local alternatives where the log odds vary in proportion with score. By default, score is chosen as the group numbers.</p>
<div class="sourceCode" id="cb1991"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">prop.trend.test</span><span class="op">)</span></code></pre></div>
<pre><code><a href="https://rdrr.io/r/stats/prop.trend.test.html">prop.trend.test(x, n, score = seq_along(x))</a></code></pre>
</div>
<div id="sec-quade-test" class="section level2" number="23.21">
<h2>
<span class="header-section-number">23.21</span> Quade 检验 <code>quade.test</code><a class="anchor" aria-label="anchor" href="#sec-quade-test"><i class="fas fa-link"></i></a>
</h2>
<p>Quade Test</p>
<p>Performs a Quade test with unreplicated blocked data.</p>
<div class="sourceCode" id="cb1993"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">quade.test</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/quade.test.html">quade.test</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">...</span><span class="op">)</span>
<span class="fu">usage</span><span class="op">(</span><span class="st">"quade.test.default"</span><span class="op">)</span>
<span class="co">## Default S3 method:</span>
<span class="fu"><a href="https://rdrr.io/r/stats/quade.test.html">quade.test</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">groups</span>, <span class="va">blocks</span>, <span class="va">...</span><span class="op">)</span>
<span class="fu">usage</span><span class="op">(</span><span class="st">"quade.test.formula"</span><span class="op">)</span>
<span class="co">## S3 method for class 'formula'</span>
<span class="fu"><a href="https://rdrr.io/r/stats/quade.test.html">quade.test</a></span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">subset</span>, <span class="va">na.action</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
</div>
<div id="sec-shapiro-test" class="section level2" number="23.22">
<h2>
<span class="header-section-number">23.22</span> 正态性检验 <code>shapiro.test</code><a class="anchor" aria-label="anchor" href="#sec-shapiro-test"><i class="fas fa-link"></i></a>
</h2>
<blockquote>
<p>Usually (but not always) doing tests of normality reflect a lack of understanding of the power of rank tests, and an assumption of high power for the tests (qq plots don’t always help with that because of their subjectivity). When possible it’s good to choose a robust method. Also, doing pre-testing for normality can affect the type I error of the overall analysis.</p>
<p>— Frank Harrell <a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://stat.ethz.ch/pipermail/r-help/2005-April/070508.html" class="uri"&gt;https://stat.ethz.ch/pipermail/r-help/2005-April/070508.html&lt;/a&gt;&lt;/p&gt;'><sup>64</sup></a></p>
</blockquote>
<p>检验：拒绝原假设和接受原假设的风险，数据本身和理论的正态分布的距离，抛开 P 值</p>
<!-- nortest 包 -->
<p>Shapiro 和 Wilk’s 提出的 W 检验</p>
<p>Performs the Shapiro-Wilk test of normality.</p>
<div class="sourceCode" id="cb1994"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">shapiro.test</span><span class="op">)</span></code></pre></div>
<pre><code><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test(x)</a></code></pre>
</div>
<div id="sec-ep-test" class="section level2" number="23.23">
<h2>
<span class="header-section-number">23.23</span> 正态性检验 Epps-Pully 检验<a class="anchor" aria-label="anchor" href="#sec-ep-test"><i class="fas fa-link"></i></a>
</h2>
<blockquote>
<p>The issue really comes down to the fact that the questions: “exactly normal?”, and “normal enough?” are 2 very different questions (with the difference becoming greater with increased sample size) and while the first is the easier to answer, the second is generally the more useful one.</p>
<p>— Greg Snow <a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://stat.ethz.ch/pipermail/r-help/2009-May/390164.html" class="uri"&gt;https://stat.ethz.ch/pipermail/r-help/2009-May/390164.html&lt;/a&gt;&lt;/p&gt;'><sup>65</sup></a></p>
</blockquote>
<p>EP 检验对多种备择假设有较高的效率，利用样本的特征函数和正态分布的特征函数的差的模的平方产生的一个加权积分得到 EP 检验统计量 <span class="citation"><a href="#ref-EP_1983_normality" role="doc-biblioref">[45]</a></span></p>
<div class="rmdtip">
<p>样本量 <span class="math inline">\(n \geq 200\)</span> EP 检验统计量 <span class="math inline">\(T_{EP}\)</span> 非常接近 <span class="math inline">\(n = \infty\)</span> 时 <span class="math inline">\(T_{EP}\)</span> 的分位数。</p>
</div>
<p>设 <span class="math inline">\(x_1, \ldots, x_n\)</span> 是来自正态总体 <span class="math inline">\(N(\mu,\sigma^2)\)</span> 的样本， EP 检验统计量定义为</p>
<p><span class="math display">\[
T_{EP} = 1 + \frac{n}{\sqrt{3}} + \frac{2}{n}\sum_{i=2}^{n}\sum_{j=1}^{i-1}\exp\big\{ - \frac{(x_j - x_i)^2}{2s^2_{\star}}  \big\} - \sqrt{2} \sum_{i=1}^{n}\exp\big\{- \frac{(x_i - \bar{x})^2}{4s^2_{\star}}  \big\}
\]</span></p>
<p>其中 <span class="math inline">\(\bar{x},s^2_{\star}\)</span> 就是样本均值和（除以 <span class="math inline">\(n\)</span> 的）样本方差</p>
<div class="rmdtip">
<p>几个正态性检验的功效比较 <a href="https://arxiv.org/ftp/arxiv/papers/1605/1605.06293.pdf" class="uri">https://arxiv.org/ftp/arxiv/papers/1605/1605.06293.pdf</a> 和 PoweR 包 <span class="citation"><a href="#ref-JSS_2016_PoweR" role="doc-biblioref">[46]</a></span></p>
</div>
</div>
<div id="sec-t-test" class="section level2" number="23.24">
<h2>
<span class="header-section-number">23.24</span> 学生 t 检验 <code>t.test</code><a class="anchor" aria-label="anchor" href="#sec-t-test"><i class="fas fa-link"></i></a>
</h2>
<!-- 大写字母 X 表示随机变量，小写字母 x 表示样本，即随机变量的取值 -->
<!-- t 检验只考虑两样本的情况 -->
<blockquote>
<p>t 分布的推导、 t 分布的形式
两样本的均值检验到 Behrens-Fisher 问题到大规模推荐系统中的 A/B 检验</p>
</blockquote>
<div id="subsec-two-samples" class="section level3" number="23.24.1">
<h3>
<span class="header-section-number">23.24.1</span> 正态总体两样本的均值之差的检验<a class="anchor" aria-label="anchor" href="#subsec-two-samples"><i class="fas fa-link"></i></a>
</h3>
<p>常见检验问题</p>
<p><span class="math display">\[\begin{align}
\mathrm{I}   \quad H_0: \mu_1 - \mu_2 \leq 0 \quad vs. \quad H_1: \mu_1 - \mu_2 &gt; 0 \\
\mathrm{II}  \quad H_0: \mu_1 - \mu_2 \geq 0 \quad vs. \quad H_1: \mu_1 - \mu_2 &lt; 0 \\
\mathrm{III} \quad H_0: \mu_1 - \mu_2 = 0 \quad vs. \quad H_1: \mu_1 - \mu_2 \neq 0
\end{align}\]</span></p>
<div id="方差-sigma2_1sigma2_2-已知" class="section level4" number="23.24.1.1">
<h4>
<span class="header-section-number">23.24.1.1</span> 方差 <span class="math inline">\(\sigma^2_1,\sigma^2_2\)</span> 已知<a class="anchor" aria-label="anchor" href="#%E6%96%B9%E5%B7%AE-sigma2_1sigma2_2-%E5%B7%B2%E7%9F%A5"><i class="fas fa-link"></i></a>
</h4>
<blockquote>
<p>检验统计量服从标准正态分布</p>
</blockquote>
<div class="sourceCode" id="cb1996"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2019</span><span class="op">)</span>
<span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span>
<span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">80</span>, mean <span class="op">=</span> <span class="fl">6</span>, sd <span class="op">=</span> <span class="fl">4.5</span><span class="op">)</span>
<span class="va">u0</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y1</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2.5</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="fl">100</span> <span class="op">+</span> <span class="fl">4.5</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="fl">80</span><span class="op">)</span></code></pre></div>
<p><span class="math display">\[
u = \frac{(\bar{X} - \bar{Y}) - (\mu_1 - \mu_2)}{\sqrt{\frac{\sigma^2_1}{m} + \frac{\sigma^2_2}{n}} }
\]</span></p>
<p><span class="math inline">\(u \sim N(0,1)\)</span>，检验统计量 <span class="math inline">\(u\)</span> 对应的样本值 <span class="math inline">\(u_0\)</span>，检验的拒绝域和 <span class="math inline">\(P\)</span> 值如下</p>
<p><span class="math display">\[
W_1 = \{u \geq u_{1 - \alpha} \}, \quad p_1 = 1 - \varPhi(u_0) 
\]</span></p>
<p>对检验问题 I，给定显著性水平 <span class="math inline">\(\alpha = 0.05\)</span>，得出拒绝域 <span class="math inline">\(\{ u \geq 1.645\}\)</span>，计算样本观察值得到的检验统计量的值 <span class="math inline">\(u_0 = 7.946\)</span>，而该值落在拒绝域，所以拒绝原假设，即拒绝 <span class="math inline">\(\mu_1 - \mu_2 \leq 0\)</span>，则接受 <span class="math inline">\(\mu_1 - \mu_2 &gt; 0\)</span>。</p>
<div class="sourceCode" id="cb1997"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 计算拒绝域</span>
<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">0.05</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1.644854</code></pre>
<div class="sourceCode" id="cb1999"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 计算 P 值</span>
<span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="va">u0</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 9.992007e-16</code></pre>
</div>
<div id="方差-sigma2_1-sigma2_2-sigma2-未知" class="section level4" number="23.24.1.2">
<h4>
<span class="header-section-number">23.24.1.2</span> 方差 <span class="math inline">\(\sigma^2_1 = \sigma^2_2 = \sigma^2\)</span> 未知<a class="anchor" aria-label="anchor" href="#%E6%96%B9%E5%B7%AE-sigma2_1-sigma2_2-sigma2-%E6%9C%AA%E7%9F%A5"><i class="fas fa-link"></i></a>
</h4>
<blockquote>
<p>检验统计量服从自由度为 <span class="math inline">\(m + n - 2\)</span> 的 t 分布</p>
</blockquote>
<div class="sourceCode" id="cb2001"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2019</span><span class="op">)</span>
<span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">4.5</span><span class="op">)</span>
<span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">80</span>, mean <span class="op">=</span> <span class="fl">6</span>, sd <span class="op">=</span> <span class="fl">4.5</span><span class="op">)</span>
<span class="va">s_w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">100</span> <span class="op">+</span> <span class="fl">80</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="fl">100</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">80</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">y1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">t0</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y1</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">s_w</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">100</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">80</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>样本观察值 <span class="math inline">\(t_0 = 6.6816 &gt; t_{0.95}(100 + 80 -2) = 1.653\)</span> 落在拒绝域内，对于检验问题 I 我们要拒绝原假设</p>
<div class="sourceCode" id="cb2002"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 临界值：0.95 分位点对应的分位数</span>
<span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">0.05</span>, df <span class="op">=</span> <span class="fl">100</span> <span class="op">+</span> <span class="fl">80</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1.653459</code></pre>
<div class="sourceCode" id="cb2004"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># p 值</span>
<span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span><span class="va">t0</span>, df <span class="op">=</span> <span class="fl">100</span> <span class="op">+</span> <span class="fl">80</span> <span class="op">-</span> <span class="fl">2</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1.461666e-10</code></pre>
<p>利用 R 内置的 <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> 函数计算</p>
<div class="sourceCode" id="cb2006"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">y1</span>, alternative <span class="op">=</span> <span class="st">"greater"</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  x1 and y1
## t = 6.6816, df = 178, p-value = 1.462e-10
## alternative hypothesis: true difference in means is greater than 0
## 95 percent confidence interval:
##  3.249227      Inf
## sample estimates:
## mean of x mean of y 
##  9.669997  5.352296</code></pre>
<p>与线性回归比较</p>
<div class="sourceCode" id="cb2008"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">y1</span><span class="op">)</span>,
  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">y1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="st">"y1"</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span>
<span class="co"># fit &lt;- lm(value ~ 0 + I(group == "y1"), data = dat) # 无截距项</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = value ~ 1 + I(group == "y1"), data = dat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -11.2282  -3.0198  -0.2959   3.0161  12.1921 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)            9.6700     0.4308  22.446  &lt; 2e-16 ***
## I(group == "y1")TRUE  -4.3177     0.6462  -6.682 2.92e-10 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 4.308 on 178 degrees of freedom
## Multiple R-squared:  0.2005, Adjusted R-squared:  0.196 
## F-statistic: 44.64 on 1 and 178 DF,  p-value: 2.923e-10</code></pre>
<div class="rmdnote">
<p>lm 回归和 t 检验的差别，回归系数第二行， t 统计量为 -6.682，P 值为 2.92e-10，前者是因为截距项，后者是因为双边检验（模型系数显著性检验是和0比较），所以有2倍的关系。直观解释详见 <a href="https://cosx.org/2019/09/common-tests-as-linear-models/">翻译：常见统计检验的本质都是线性模型（或：如何教统计学）</a></p>
</div>
<p>两样本方差不齐、样本量严重不等，在大样本和小样本情况下的比较， <a href="https://yihui.org/cn/2010/01/unequal-variance-in-t-test/">t 检验方差不齐有多重要</a></p>
</div>
<div id="方差-sigma2_1-sigma2_2-已知" class="section level4" number="23.24.1.3">
<h4>
<span class="header-section-number">23.24.1.3</span> 方差 <span class="math inline">\(\sigma^2_1 / \sigma^2_2\)</span> 已知<a class="anchor" aria-label="anchor" href="#%E6%96%B9%E5%B7%AE-sigma2_1-sigma2_2-%E5%B7%B2%E7%9F%A5"><i class="fas fa-link"></i></a>
</h4>
<p>方差比 <span class="math inline">\(c = \sigma^2_1 / \sigma^2_2\)</span> 已知</p>
</div>
<div id="方差-sigma2_1-sigma2_2-未知" class="section level4" number="23.24.1.4">
<h4>
<span class="header-section-number">23.24.1.4</span> 方差 <span class="math inline">\(\sigma^2_1 / \sigma^2_2\)</span> 未知<a class="anchor" aria-label="anchor" href="#%E6%96%B9%E5%B7%AE-sigma2_1-sigma2_2-%E6%9C%AA%E7%9F%A5"><i class="fas fa-link"></i></a>
</h4>
<!-- 样本量较小 -->
<p>英国统计学家 William Sealy Gosset (1876-1937) 于 1908 年在杂志 《Biometrics》 上以笔名 Student 发表论文《The probable error of a mean》<span class="citation"><a href="#ref-Students_1908_Gosset" role="doc-biblioref">[47]</a></span>，论文中展示了独立同正态分布的样本 <span class="math inline">\(x_1, \ldots, x_n \stackrel{i.i.d}{\sim} \mathcal{N}(\mu,\sigma^2)\)</span> 的样本方差 <span class="math inline">\(s^2\)</span> 和样本标准差 <span class="math inline">\(s\)</span> 的抽样分布，根据均值和标准差不相关的性质导出 t 分布，宣告 t 分布的诞生，因其在小样本领域的突出贡献，W. S. Gosset 进入世纪名人录 <span class="citation"><a href="#ref-Statisticians_2001_Heyde" role="doc-biblioref">[48]</a></span></p>
<p><span class="math display">\[\frac{(n-1)s^2}{\sigma^2} \sim \chi^2(n-1)\]</span></p>
<p><span class="math display">\[\frac{\bar{x} - \mu}{s/\sqrt{n}} \sim t(n-1)\]</span></p>
<p><span class="math display">\[E(s^2) = \sigma^2, \quad Var(s^2) = \frac{2\sigma^4}{n-1}\]</span></p>
<ol style="list-style-type: decimal">
<li>两样本的样本量很大，总体方差未知，检验两样本均值的显著性检验，极限分布是正态，<span class="math inline">\(u\)</span> 检验</li>
<li>两个样本的样本量不是很大，总体方差也未知，检验两样本均值的显著性检验，即著名的 Behrens-Fisher 问题，Welsh 在 1938 年提出近似服从自由度为 <span class="math inline">\(\ell\)</span> 的 t 分布。</li>
</ol>
<p>Egon Pearson 接过他父亲 Karl Pearson 的职位，担任伦敦大学学院的高尔顿统计教授</p>
<p>许宝騄在 Jerzy Neyman 和 Egon Pearson 主编的杂志《Statistical Research Memoirs》发表第一篇关于 Behrens-Fisher 问题的论文</p>
<p>这里提及许宝騄（Pao-Lu Hsu）的贡献 <span class="citation"><a href="#ref-Student_1938_HSU" role="doc-biblioref">[49]</a></span>，</p>
<p>陈家鼎和郑忠国一起整理了许宝騄的生平事迹和学术成就，见<a href="https://www.math.pku.edu.cn/misc/probstat/doc.pdf">《许宝騄先生的生平和学术成就》</a>。</p>
<p>1998 年关于 Behrens-Fisher 问题的综述 <span class="citation"><a href="#ref-Behrens_1998_Kim" role="doc-biblioref">[50]</a></span></p>
<p>钟开涞（Kai-Lai Chung）将许宝騄的论文集整理出版 <span class="citation"><a href="#ref-Collected_1983_HSU" role="doc-biblioref">[51]</a></span></p>
<p><code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> 提供单样本和两样本的检验</p>
<div class="sourceCode" id="cb2010"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">t.test</span><span class="op">)</span>
<span class="co">## S3 method for class 'test'</span>
<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>
<span class="fu">usage</span><span class="op">(</span><span class="st">"t.test.default"</span><span class="op">)</span>
<span class="co">## Default S3 method:</span>
<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">x</span>, y <span class="op">=</span> <span class="cn">NULL</span>, alternative <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"two.sided"</span>, <span class="st">"less"</span>, <span class="st">"greater"</span><span class="op">)</span>, mu <span class="op">=</span> <span class="fl">0</span>,
    paired <span class="op">=</span> <span class="cn">FALSE</span>, var.equal <span class="op">=</span> <span class="cn">FALSE</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, <span class="va">...</span><span class="op">)</span>
<span class="fu">usage</span><span class="op">(</span><span class="st">"t.test.formula"</span><span class="op">)</span>
<span class="co">## S3 method for class 'formula'</span>
<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">subset</span>, <span class="va">na.action</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
<p>学生睡眠数据 sleep 见图 <a href="chap-hypothesis-test.html#fig:sleep">23.3</a></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sleep"></span>
<img src="hypothesis-test_files/figure-html/sleep-1.png" alt="学生睡眠数据 sleep" width="50%"><img src="hypothesis-test_files/figure-html/sleep-2.png" alt="学生睡眠数据 sleep" width="50%"><p class="caption">
图 23.3: 学生睡眠数据 sleep
</p>
</div>
<p>两个样本的 Welch’s t 检验，总体方差未知，样本量也不大，两样本均值差的显著性检验</p>
<div class="sourceCode" id="cb2011"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## 等价于 with(sleep, t.test(extra[group == 1], extra[group == 2]))</span>
<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">extra</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">sleep</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  extra by group
## t = -1.8608, df = 17.776, p-value = 0.07939
## alternative hypothesis: true difference in means between group 1 and group 2 is not equal to 0
## 95 percent confidence interval:
##  -3.3654832  0.2054832
## sample estimates:
## mean in group 1 mean in group 2 
##            0.75            2.33</code></pre>
<p>实际上睡眠数据是配对的，我们可以做配对数据的检验</p>
<div class="sourceCode" id="cb2013"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## 数据变形操作，长格式变为宽格式</span>
<span class="va">sleep2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/reshape.html">reshape</a></span><span class="op">(</span><span class="va">sleep</span>,
  direction <span class="op">=</span> <span class="st">"wide"</span>,
  idvar <span class="op">=</span> <span class="st">"ID"</span>, timevar <span class="op">=</span> <span class="st">"group"</span>
<span class="op">)</span>
<span class="co"># R 4.0.0</span>
<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Pair.html">Pair</a></span><span class="op">(</span><span class="va">extra.1</span>, <span class="va">extra.2</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">sleep2</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  Pair(extra.1, extra.2)
## t = -4.0621, df = 9, p-value = 0.002833
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -2.4598858 -0.7001142
## sample estimates:
## mean of the differences 
##                   -1.58</code></pre>
<div class="rmdnote">
<p>函数 <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> 和 <code><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test()</a></code> 的公式接口要求 R 版本在 4.0.0 及以上</p>
</div>
</div>
</div>
<div id="office-ttest" class="section level3" number="23.24.2">
<h3>
<span class="header-section-number">23.24.2</span> 办公软件里的 T 检验<a class="anchor" aria-label="anchor" href="#office-ttest"><i class="fas fa-link"></i></a>
</h3>
<p>以 MacOS 上的 Numbers 表格软件为例，如图<a href="chap-hypothesis-test.html#fig:numbers-ttest">23.4</a>所示，首先打开 Numbers 软件，新建工作表，输入两组数值，然后点击空白处，再从顶部导航栏找到「插入」菜单，「公式」选项，点击扩展选项「新建公式」，在弹出的会话条里输入 TTEST，依次选择第一组，第二组值，检验类型和样本类型，最后点击确认，即可得到两样本 T 检验的 P 值结果。</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:numbers-ttest"></span>
<img src="screenshots/number-ttest.png" alt="MacOS 的办公软件 Numbers 做两样本 T 检验" width="85%"><p class="caption">
图 23.4: MacOS 的办公软件 Numbers 做两样本 T 检验
</p>
</div>
<p>微软 Excel 办公软件也提供 T 检验计算器，和 MacOS 系统上的 Numbers 办公软件类似，它提供 <code>T.TEST</code> 函数，计算结果也一样，此处从略。R 软件自带 <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> 函数，也是用于做 T 检验，如下：</p>
<div class="sourceCode" id="cb2015"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">19</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">14</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">17</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  c(3, 4, 5, 8, 9, 1, 2, 4, 5) and c(6, 19, 3, 2, 14, 4, 5, 17, 1)
## t = -1.3622, df = 10.255, p-value = 0.2023
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -8.767183  2.100516
## sample estimates:
## mean of x mean of y 
##  4.555556  7.888889</code></pre>
</div>
</div>
<div id="sec-var-test" class="section level2" number="23.25">
<h2>
<span class="header-section-number">23.25</span> 方差比检验 <code>var.test</code><a class="anchor" aria-label="anchor" href="#sec-var-test"><i class="fas fa-link"></i></a>
</h2>
<p><strong>TeachingDemos</strong> 的 <code>sigma.test()</code> 方差检验，适用于正态总体，它对非正态性很敏感。</p>
<p>F 检验：来自正态总体的两个样本的方差比较</p>
<div class="sourceCode" id="cb2017"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">var.test</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/var.test.html">var.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>
<span class="fu">usage</span><span class="op">(</span><span class="st">"var.test.default"</span><span class="op">)</span>
<span class="co">## Default S3 method:</span>
<span class="fu"><a href="https://rdrr.io/r/stats/var.test.html">var.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, ratio <span class="op">=</span> <span class="fl">1</span>, alternative <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"two.sided"</span>, <span class="st">"less"</span>, <span class="st">"greater"</span><span class="op">)</span>,
    conf.level <span class="op">=</span> <span class="fl">0.95</span>, <span class="va">...</span><span class="op">)</span>
<span class="fu">usage</span><span class="op">(</span><span class="st">"var.test.formula"</span><span class="op">)</span>
<span class="co">## S3 method for class 'formula'</span>
<span class="fu"><a href="https://rdrr.io/r/stats/var.test.html">var.test</a></span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">subset</span>, <span class="va">na.action</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
</div>
<div id="sec-wilcox-test" class="section level2" number="23.26">
<h2>
<span class="header-section-number">23.26</span> Wilcoxon 秩和检验 <code>wilcox.test</code><a class="anchor" aria-label="anchor" href="#sec-wilcox-test"><i class="fas fa-link"></i></a>
</h2>
<p>单样本 Wilcoxon 秩和检验，两样本 Wilcoxon 符号秩检验，也叫 Mann-Whitney 检验</p>
<p>Wilcoxon Rank Sum and Signed Rank Tests</p>
<p>Performs one- and two-sample Wilcoxon tests on vectors of data; the latter is also known as ‘Mann-Whitney’ test.</p>
<div class="sourceCode" id="cb2018"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usage</span><span class="op">(</span><span class="va">wilcox.test</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>
<span class="fu">usage</span><span class="op">(</span><span class="st">"wilcox.test.default"</span><span class="op">)</span>
<span class="co">## Default S3 method:</span>
<span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">x</span>, y <span class="op">=</span> <span class="cn">NULL</span>, alternative <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"two.sided"</span>, <span class="st">"less"</span>, <span class="st">"greater"</span><span class="op">)</span>,
    mu <span class="op">=</span> <span class="fl">0</span>, paired <span class="op">=</span> <span class="cn">FALSE</span>, exact <span class="op">=</span> <span class="cn">NULL</span>, correct <span class="op">=</span> <span class="cn">TRUE</span>, conf.int <span class="op">=</span> <span class="cn">FALSE</span>,
    conf.level <span class="op">=</span> <span class="fl">0.95</span>, tol.root <span class="op">=</span> <span class="fl">1e-04</span>, digits.rank <span class="op">=</span> <span class="cn">Inf</span>, <span class="va">...</span><span class="op">)</span>
<span class="fu">usage</span><span class="op">(</span><span class="st">"wilcox.test.formula"</span><span class="op">)</span>
<span class="co">## S3 method for class 'formula'</span>
<span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">subset</span>, <span class="va">na.action</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
<ul>
<li>
<code>coin::wilcox_test</code> for exact, asymptotic and Monte Carlo conditional p-values, including in the presence of ties.</li>
</ul>
<p>coin 包 <span class="citation"><a href="#ref-Hothorn_2008_coin" role="doc-biblioref">[52]</a></span> 提供大量基于秩的检验</p>
<div id="wilcox-test-roc" class="section level3" number="23.26.1">
<h3>
<span class="header-section-number">23.26.1</span> ROC 曲线和 wilcox.test 检验的关系<a class="anchor" aria-label="anchor" href="#wilcox-test-roc"><i class="fas fa-link"></i></a>
</h3>
<p><a href="https://github.com/xrobin/pROC/wiki/FAQ---Frequently-asked-questions#can-i-test-if-a-single-roc-curve-is-significantly-different-from-05" class="uri">https://github.com/xrobin/pROC/wiki/FAQ---Frequently-asked-questions#can-i-test-if-a-single-roc-curve-is-significantly-different-from-05</a></p>
<p>ROC 曲线越往左上角拱越好， AUC 是 ROC 曲线下的面积，所以 AUC 指标越接近 1 越好。</p>
<p>对每个标签的预测概率指定服从均匀分布，相当于随机猜测，所以最后 ROC 会接近对角线，而且样本量越大越接近，AUC 会越来越接近 0.5</p>
<blockquote>
<p>再往深一点就是研究一下 R 内置的排序算法，因为计算 AUC 最核心的步骤是排序。
<code>order</code> 函数默认的排序方法是 <code>auto</code> 即当数据量较小的时候，自动选择 radix 排序，当数据量比较大的时候，自动选择 shell 排序<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;radix 排序翻译过来叫桶排序或基数排序，详细描述见 &lt;code&gt;?sort&lt;/code&gt;&lt;/p&gt;"><sup>66</sup></a></p>
</blockquote>
<div class="sourceCode" id="cb2019"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 模拟一些数据</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2019</span><span class="op">)</span> <span class="co"># 设置随机数种子</span>
<span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="fl">5</span> <span class="co"># 样本量</span>
<span class="va">sim_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind.data.frame</a></span><span class="op">(</span>
  pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>,
  label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="va">N</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># 计算 auc 的函数</span>
<span class="co"># dat is a data.frame as input return AUC value</span>
<span class="va">comp_auc</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dat</span>, <span class="va">show_roc</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># order label by predicted probability</span>
  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">pred</span>, <span class="va">dat</span><span class="op">$</span><span class="va">label</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="op">]</span>

  <span class="co"># total samples</span>
  <span class="va">n_total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">label</span><span class="op">)</span>

  <span class="co"># number of positive label 1</span>
  <span class="va">n_pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">label</span><span class="op">)</span>

  <span class="co"># number of negative label 0</span>
  <span class="va">n_neg</span> <span class="op">&lt;-</span> <span class="va">n_total</span> <span class="op">-</span> <span class="va">n_pos</span>

  <span class="co"># calculate TPR and FPR</span>
  <span class="va">tpr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">label</span><span class="op">)</span> <span class="op">/</span> <span class="va">n_pos</span>
  <span class="va">fpr</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_total</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">label</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">n_neg</span>

  <span class="co"># calculate auc</span>
  <span class="va">auc</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n_total</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">auc</span> <span class="op">&lt;-</span> <span class="va">auc</span> <span class="op">+</span> <span class="op">(</span><span class="va">fpr</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">fpr</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">tpr</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="op">}</span>
  <span class="co"># show ROC curve or not?</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">show_roc</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fpr</span>, <span class="va">tpr</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">auc</span>
<span class="op">}</span>

<span class="fu">comp_auc</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">sim_dat</span>, show_roc <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.5015558</code></pre>
<p>模拟一个逻辑回归模型测试自编 AUC 计算程序和 R 包 pROC 计算结果</p>
<div class="sourceCode" id="cb2021"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2018</span><span class="op">)</span>
<span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="fl">4</span> <span class="co"># 样本量</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>
<span class="va">beta_0</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>
<span class="va">beta_1</span> <span class="op">&lt;-</span> <span class="fl">0.3</span>
<span class="va">eta</span> <span class="op">&lt;-</span> <span class="va">beta_0</span> <span class="op">+</span> <span class="va">beta_1</span> <span class="op">*</span> <span class="va">x</span>
<span class="co"># 模拟数据集</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="va">N</span>, <span class="fl">1</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">eta</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">eta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co"># 数据集分隔</span>
<span class="va">is_train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, <span class="va">N</span> <span class="op">*</span> <span class="fl">0.7</span><span class="op">)</span>
<span class="va">train</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="va">is_train</span>, <span class="op">]</span>
<span class="va">test</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="op">-</span><span class="va">is_train</span>, <span class="op">]</span>
<span class="co"># 模型拟合</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">train</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span><span class="op">)</span>
<span class="co"># 预测</span>
<span class="va">y_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit</span>, newdata <span class="op">=</span> <span class="va">test</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>

<span class="va">dat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>pred <span class="op">=</span> <span class="va">y_pred</span>, label <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>
<span class="co"># 计算 auc</span>
<span class="fu">comp_auc</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat2</span>, show_roc <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.5850287</code></pre>
<p>对比 R 包 pROC 的计算结果是一致的</p>
<div class="sourceCode" id="cb2023"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pROC</span><span class="fu">::</span><span class="fu">auc</span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span>, <span class="va">y_pred</span><span class="op">)</span></code></pre></div>
<p>计算一下运行时间</p>
<div class="sourceCode" id="cb2024"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 100 万样本</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span><span class="fu">comp_auc</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat2</span>, show_roc <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##    user  system elapsed 
##   0.003   0.000   0.002</code></pre>
<p>更多关于 auc 计算的讨论见统计之都论坛帖 <a href="https://d.cosx.org/d/419436" class="uri">https://d.cosx.org/d/419436</a>，我感觉这个问题最后会归结到排序问题。</p>
<div class="sourceCode" id="cb2026"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># https://stat.ethz.ch/pipermail/r-help/2005-April/069217.html</span>
<span class="va">trap.rule</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">y</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">y</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></code></pre></div>
</div>
</div>
<div id="sec-three-plus-one-tests" class="section level2" number="23.27">
<h2>
<span class="header-section-number">23.27</span> 3 + 1 统计检验<a class="anchor" aria-label="anchor" href="#sec-three-plus-one-tests"><i class="fas fa-link"></i></a>
</h2>
<!-- https://en.wikipedia.org/wiki/Binomial_proportion_confidence_interval -->
<p>Wald 检验，似然比检验/ Wilks 检验，得分检验/Rao 检验，梯度检验</p>
<blockquote>
<p>Unfortunately, this is one of those situations where as far as I can tell all of the real statisticians are out there playing with large data sets where the small-sample corrections are not so important and leaving the rest of us to figure it out for ourselves …</p>
<p>— Ben Bolker <a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://stat.ethz.ch/pipermail/r-sig-mixed-models/2011q4/017392.html" class="uri"&gt;https://stat.ethz.ch/pipermail/r-sig-mixed-models/2011q4/017392.html&lt;/a&gt;&lt;/p&gt;'><sup>67</sup></a></p>
</blockquote>
</div>
<div id="sec-classical-case-study" class="section level2" number="23.28">
<h2>
<span class="header-section-number">23.28</span> 经典案例<a class="anchor" aria-label="anchor" href="#sec-classical-case-study"><i class="fas fa-link"></i></a>
</h2>
<div id="subsec-ucb-admissions" class="section level3" number="23.28.1">
<h3>
<span class="header-section-number">23.28.1</span> 1973 年加州大学伯克利分校的学生招生<a class="anchor" aria-label="anchor" href="#subsec-ucb-admissions"><i class="fas fa-link"></i></a>
</h3>
<p>录取人数按院系和性别分类统计，研究目标是各个院系在录取学生的时候是否有性别歧视？统计数据见表 <a href="chap-hypothesis-test.html#tab:ucb-admissions-data">23.1</a></p>
<div class="sourceCode" id="cb2027"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">UCBAdmissions</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/reshape.html">reshape</a></span><span class="op">(</span><span class="va">.</span>,
    v.names <span class="op">=</span> <span class="st">"Freq"</span>, idvar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Admit"</span>, <span class="st">"Gender"</span><span class="op">)</span>,
    timevar <span class="op">=</span> <span class="st">"Dept"</span>, direction <span class="op">=</span> <span class="st">"wide"</span>, sep <span class="op">=</span> <span class="st">""</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">.</span>,
    caption <span class="op">=</span> <span class="st">"伯克利大学各个院系的录取人数"</span>,
    row.names <span class="op">=</span> <span class="cn">FALSE</span>, col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"(Freq)"</span>, <span class="st">"Dept"</span>, <span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span>,
    align <span class="op">=</span> <span class="st">"c"</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:ucb-admissions-data">表 23.1: </span>伯克利大学各个院系的录取人数</caption>
<thead><tr class="header">
<th align="center">Admit</th>
<th align="center">Gender</th>
<th align="center">DeptA</th>
<th align="center">DeptB</th>
<th align="center">DeptC</th>
<th align="center">DeptD</th>
<th align="center">DeptE</th>
<th align="center">DeptF</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">Admitted</td>
<td align="center">Male</td>
<td align="center">512</td>
<td align="center">353</td>
<td align="center">120</td>
<td align="center">138</td>
<td align="center">53</td>
<td align="center">22</td>
</tr>
<tr class="even">
<td align="center">Rejected</td>
<td align="center">Male</td>
<td align="center">313</td>
<td align="center">207</td>
<td align="center">205</td>
<td align="center">279</td>
<td align="center">138</td>
<td align="center">351</td>
</tr>
<tr class="odd">
<td align="center">Admitted</td>
<td align="center">Female</td>
<td align="center">89</td>
<td align="center">17</td>
<td align="center">202</td>
<td align="center">131</td>
<td align="center">94</td>
<td align="center">24</td>
</tr>
<tr class="even">
<td align="center">Rejected</td>
<td align="center">Female</td>
<td align="center">19</td>
<td align="center">8</td>
<td align="center">391</td>
<td align="center">244</td>
<td align="center">299</td>
<td align="center">317</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb2028"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># plot(UCBAdmissions, col = "lightblue", border = "white")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/haleyjeppson/ggmosaic">ggmosaic</a></span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">UCBAdmissions</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggmosaic/man/geom_mosaic.html">geom_mosaic</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>weight <span class="op">=</span> <span class="va">Freq</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ggmosaic/man/product.html">product</a></span><span class="op">(</span><span class="va">Gender</span>, <span class="va">Admit</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">Dept</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Admit"</span>, y <span class="op">=</span> <span class="st">"Gender"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ucb-admissions-img"></span>
<img src="hypothesis-test_files/figure-html/ucb-admissions-img-1.png" alt="UCBAdmissions 马赛克图" width="672"><p class="caption">
图 23.5: UCBAdmissions 马赛克图
</p>
</div>
</div>
<div id="subsec-ethnicity" class="section level3" number="23.28.2">
<h3>
<span class="header-section-number">23.28.2</span> 1976~1977年美国佛罗里达州的凶杀案件中被告肤色和死刑判决的关系<a class="anchor" aria-label="anchor" href="#subsec-ethnicity"><i class="fas fa-link"></i></a>
</h3>
<!-- 高维列联表，独立性检验 -->
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="center">被告</th>
<th align="center">被害人</th>
<th align="center">判死</th>
<th align="center">不判死</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">白人</td>
<td align="center">白人</td>
<td align="center">19</td>
<td align="center">132</td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center">黑人</td>
<td align="center">0</td>
<td align="center">9</td>
</tr>
<tr class="odd">
<td align="center">黑人</td>
<td align="center">白人</td>
<td align="center">11</td>
<td align="center">32</td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center">黑人</td>
<td align="center">6</td>
<td align="center">97</td>
</tr>
</tbody>
</table></div>
</div>
<div id="subsec-HairEyeColor" class="section level3" number="23.28.3">
<h3>
<span class="header-section-number">23.28.3</span> 统计专业学生的头发和眼睛的颜色<a class="anchor" aria-label="anchor" href="#subsec-HairEyeColor"><i class="fas fa-link"></i></a>
</h3>
<!-- 用来描述标准 $\chi^2$ 检验和对数线性模型 -->
<p>HairEyeColor 是一个 table 类型的数据对象，和数组的关系 array</p>
<div class="sourceCode" id="cb2029"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">HairEyeColor</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "table"</code></pre>
<div class="sourceCode" id="cb2031"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">HairEyeColor</span><span class="op">)</span></code></pre></div>
<pre><code>##  'table' num [1:4, 1:4, 1:2] 32 53 10 3 11 50 10 30 10 25 ...
##  - attr(*, "dimnames")=List of 3
##   ..$ Hair: chr [1:4] "Black" "Brown" "Red" "Blond"
##   ..$ Eye : chr [1:4] "Brown" "Blue" "Hazel" "Green"
##   ..$ Sex : chr [1:2] "Male" "Female"</code></pre>
<div class="sourceCode" id="cb2033"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">HairEyeColor</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="va">sum</span><span class="op">)</span></code></pre></div>
<pre><code>##        Eye
## Hair    Brown Blue Hazel Green
##   Black    68   20    15     5
##   Brown   119   84    54    29
##   Red      26   17    14    14
##   Blond     7   94    10    16</code></pre>
<div class="sourceCode" id="cb2035"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># plot(HairEyeColor, col = "lightblue", border = "white")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/haleyjeppson/ggmosaic">ggmosaic</a></span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">HairEyeColor</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggmosaic/man/geom_mosaic.html">geom_mosaic</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>weight <span class="op">=</span> <span class="va">Freq</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ggmosaic/man/product.html">product</a></span><span class="op">(</span><span class="va">Hair</span>, <span class="va">Eye</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Hair"</span>, y <span class="op">=</span> <span class="st">"Eye"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:HairEyeColor"></span>
<img src="hypothesis-test_files/figure-html/HairEyeColor-1.png" alt="头发、眼睛颜色和性别的比例" width="672"><p class="caption">
图 23.6: 头发、眼睛颜色和性别的比例
</p>
</div>
</div>
</div>
<div id="sec-hypothesis-test-session" class="section level2" number="23.29">
<h2>
<span class="header-section-number">23.29</span> 运行环境<a class="anchor" aria-label="anchor" href="#sec-hypothesis-test-session"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb2036"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## R version 4.1.1 (2021-08-10)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 20.04.3 LTS
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] ggmosaic_0.3.3  patchwork_1.1.1 nomnoml_0.2.3   ggplot2_3.3.5  
## [5] magrittr_2.0.1  formatR_1.11   
## 
## loaded via a namespace (and not attached):
##  [1] tidyselect_1.1.1   xfun_0.26          bslib_0.3.0        purrr_0.3.4       
##  [5] colorspace_2.0-2   vctrs_0.3.8        generics_0.1.0     htmltools_0.5.2   
##  [9] viridisLite_0.4.0  yaml_2.2.1         utf8_1.2.2         plotly_4.9.4.1    
## [13] rlang_0.4.11       jquerylib_0.1.4    pillar_1.6.3       glue_1.4.2        
## [17] withr_2.4.2        DBI_1.1.1          plyr_1.8.6         lifecycle_1.0.1   
## [21] stringr_1.4.0      munsell_0.5.0      gtable_0.3.0       htmlwidgets_1.5.4 
## [25] evaluate_0.14      labeling_0.4.2     knitr_1.36         fastmap_1.1.0     
## [29] crosstalk_1.1.1    curl_4.3.2         fansi_0.5.0        highr_0.9         
## [33] Rcpp_1.0.7         scales_1.1.1       webshot_0.5.2      jsonlite_1.7.2    
## [37] farver_2.1.0       fs_1.5.0           digest_0.6.28      stringi_1.7.4     
## [41] ggrepel_0.9.1      bookdown_0.24      dplyr_1.0.7        grid_4.1.1        
## [45] tools_4.1.1        sass_0.4.0         productplots_0.1.1 lazyeval_0.2.2    
## [49] tibble_3.1.5       crayon_1.4.1       tidyr_1.1.4        pkgconfig_2.0.3   
## [53] downlit_0.2.1      ellipsis_0.3.2     data.table_1.14.2  xml2_1.3.2        
## [57] assertthat_0.2.1   rmarkdown_2.11     httr_1.4.2         R6_2.5.1          
## [61] compiler_4.1.1</code></pre>

</div>
</div>
<h3>参考文献</h3>
<div id="refs" class="references csl-bib-body">
<div id="ref-Test_1934_binom" class="csl-entry">
<div class="csl-left-margin">[36] </div>
<div class="csl-right-inline">C. J. Clopper and E. S. Pearson, <span>“The use of confidence or fiducial limits illustrated in the case of the binomial,”</span> <em>Biometrika</em>, vol. 26, no. 4, pp. 404–413, Dec. 1934, doi: <a href="https://doi.org/10.1093/biomet/26.4.404">10.1093/biomet/26.4.404</a>.</div>
</div>
<div id="ref-Cohen_1994_Earth" class="csl-entry">
<div class="csl-left-margin">[37] </div>
<div class="csl-right-inline">J. Cohen, <span>“The earth is round (<span class="math inline">\(p &lt; .05\)</span>),”</span> <em>American Psychologist</em>, vol. 49, no. 12, pp. 997–1003, 1994, doi: <a href="https://doi.org/10.1037/0003-066x.49.12.997">10.1037/0003-066x.49.12.997</a>.</div>
</div>
<div id="ref-Kendall" class="csl-entry">
<div class="csl-left-margin">[38] </div>
<div class="csl-right-inline">A. I. McLeod, <em>Kendall: Kendall rank correlation and mann-kendall trend test</em>. 2011.Available: <a href="http://www.stats.uwo.ca/faculty/aim">http://www.stats.uwo.ca/faculty/aim</a>
</div>
</div>
<div id="ref-SuppDists" class="csl-entry">
<div class="csl-left-margin">[39] </div>
<div class="csl-right-inline">B. Wheeler, <em>SuppDists: Supplementary distributions</em>. 2020.Available: <a href="https://CRAN.R-project.org/package=SuppDists">https://CRAN.R-project.org/package=SuppDists</a>
</div>
</div>
<div id="ref-pspearman" class="csl-entry">
<div class="csl-left-margin">[40] </div>
<div class="csl-right-inline">P. Savicky, <em>Pspearman: Spearman’s rank correlation test</em>. 2014.Available: <a href="https://CRAN.R-project.org/package=pspearman">https://CRAN.R-project.org/package=pspearman</a>
</div>
</div>
<div id="ref-Prop_2011_Song" class="csl-entry">
<div class="csl-left-margin">[41] </div>
<div class="csl-right-inline">宋泽熙, <span>“两个二项总体成功概率的比较,”</span> <em>中国校外教育（理论）</em>, vol. z1, p. 81, 2011, doi: <a href="https://doi.org/10.3969/j.issn.1004-8502-B.2011.z1.0919">10.3969/j.issn.1004-8502-B.2011.z1.0919</a>.</div>
</div>
<div id="ref-Stone_2009_Wei" class="csl-entry">
<div class="csl-left-margin">[42] </div>
<div class="csl-right-inline">韦博成, <span>“《红楼梦》前80回与后40回某些文风差异的统计分析（两个独立二项总体等价性检验的一个应用）,”</span> <em>应用概率统计</em>, vol. 25, no. 4, pp. 441–448, 2009, doi: <a href="https://doi.org/10.3969/j.issn.1001-4268.2009.04.012">10.3969/j.issn.1001-4268.2009.04.012</a>.</div>
</div>
<div id="ref-Test_1927_prop" class="csl-entry">
<div class="csl-left-margin">[43] </div>
<div class="csl-right-inline">E. B. Wilson, <span>“Probable inference, the law of succession, and statistical inference,”</span> <em>Journal of the American Statistical Association</em>, vol. 22, no. 158, pp. 209–212, Jun. 1927, doi: <a href="https://doi.org/10.1080/01621459.1927.10502953">10.1080/01621459.1927.10502953</a>.</div>
</div>
<div id="ref-Interval_1998_Newcombe" class="csl-entry">
<div class="csl-left-margin">[44] </div>
<div class="csl-right-inline">R. G. Newcombe, <span>“Interval estimation for the difference between independent proportions: Comparison of eleven methods,”</span> <em>Statistics in Medicine</em>, vol. 17, no. 8, pp. 873–890, 1998, doi: <a href="https://doi.org/10.1002/(SICI)1097-0258(19980430)17:8&lt;873::AID-SIM779&gt;3.0.CO;2-I">10.1002/(SICI)1097-0258(19980430)17:8&lt;873::AID-SIM779&gt;3.0.CO;2-I</a>.</div>
</div>
<div id="ref-EP_1983_normality" class="csl-entry">
<div class="csl-left-margin">[45] </div>
<div class="csl-right-inline">T. W. Epps and L. B. Pulley, <span>“A test for normality based on the empirical characteristic function,”</span> <em>Biometrika</em>, vol. 70, no. 3, pp. 723–726, 1983, doi: <a href="https://doi.org/10.2307/2336512">10.2307/2336512</a>.</div>
</div>
<div id="ref-JSS_2016_PoweR" class="csl-entry">
<div class="csl-left-margin">[46] </div>
<div class="csl-right-inline">P. Lafaye de Micheaux and V. A. Tran, <span>“<span>PoweR</span>: A reproducible research tool to ease monte carlo power simulation studies for goodness-of-fit tests in <span>R</span>,”</span> <em>Journal of Statistical Software</em>, vol. 69, no. 3, pp. 1–42, 2016, doi: <a href="https://doi.org/10.18637/jss.v069.i03">10.18637/jss.v069.i03</a>.</div>
</div>
<div id="ref-Students_1908_Gosset" class="csl-entry">
<div class="csl-left-margin">[47] </div>
<div class="csl-right-inline">"Student", <span>“The probable error of a mean,”</span> <em>Biometrika</em>, vol. 6, pp. 1–25, 1908.</div>
</div>
<div id="ref-Statisticians_2001_Heyde" class="csl-entry">
<div class="csl-left-margin">[48] </div>
<div class="csl-right-inline">C. C. Heyde, E. Seneta, P. Crépel, S. E. Fienberg, and J. Gani, <em>Statisticians of the centuries</em>. New York, NY: Springer-Verlag, 2001. doi: <a href="https://doi.org/10.1007/978-1-4613-0179-0">10.1007/978-1-4613-0179-0</a>.</div>
</div>
<div id="ref-Student_1938_HSU" class="csl-entry">
<div class="csl-left-margin">[49] </div>
<div class="csl-right-inline">P. L. HSU, <span>“Contribution to the theory of "student’s" <span class="math inline">\(T\)</span>-test as applied to the problem of two samples,”</span> <em>Statistical Research Memoirs</em>, vol. 2, pp. 1–24, 1938.</div>
</div>
<div id="ref-Behrens_1998_Kim" class="csl-entry">
<div class="csl-left-margin">[50] </div>
<div class="csl-right-inline">S.-H. Kim and A. S. Cohen, <span>“On the behrens-fisher problem: A review,”</span> <em>Journal of Educational and Behavioral Statistics</em>, vol. 23, no. 4, pp. 356–377, 1998, doi: <a href="https://doi.org/10.2307/1165281">10.2307/1165281</a>.</div>
</div>
<div id="ref-Collected_1983_HSU" class="csl-entry">
<div class="csl-left-margin">[51] </div>
<div class="csl-right-inline">P. L. HSU, <em>Collected papers</em>. New York, NY: Springer-Verlag, 1983.</div>
</div>
<div id="ref-Hothorn_2008_coin" class="csl-entry">
<div class="csl-left-margin">[52] </div>
<div class="csl-right-inline">T. Hothorn, K. Hornik, M. A. van de Wiel, and A. Zeileis, <span>“Implementing a class of permutation tests: The <span class="nocase">coin</span> package,”</span> <em>Journal of Statistical Software</em>, vol. 28, no. 8, pp. 1–23, 2008, doi: <a href="https://doi.org/10.18637/jss.v028.i08">10.18637/jss.v028.i08</a>.</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="chap-parameter-estimators.html"><span class="header-section-number">22</span> 参数估计</a></div>
<div class="next"><a href="chap-power-Analysis.html"><span class="header-section-number">24</span> 功效分析</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#chap-hypothesis-test"><span class="header-section-number">23</span> 假设检验</a></li>
<li><a class="nav-link" href="#sec-ansari-test"><span class="header-section-number">23.1</span> Ansari-Bradley 检验 ansari.test</a></li>
<li><a class="nav-link" href="#sec-bartlett-test"><span class="header-section-number">23.2</span> Bartlett 检验 bartlett.test</a></li>
<li><a class="nav-link" href="#sec-binom-test"><span class="header-section-number">23.3</span> 二项检验 binom.test</a></li>
<li><a class="nav-link" href="#sec-Box-test"><span class="header-section-number">23.4</span> 时间序列独立性检验 Box.test</a></li>
<li><a class="nav-link" href="#sec-chisq-test"><span class="header-section-number">23.5</span> 皮尔逊卡方检验 chisq.test</a></li>
<li><a class="nav-link" href="#sec-fisher-test"><span class="header-section-number">23.6</span> 费舍尔精确检验 fisher.test</a></li>
<li><a class="nav-link" href="#sec-fligner-test"><span class="header-section-number">23.7</span> 方差齐性检验 fligner.test</a></li>
<li><a class="nav-link" href="#sec-friedman-test"><span class="header-section-number">23.8</span> Friedman 秩和检验 friedman.test</a></li>
<li><a class="nav-link" href="#sec-kruskal-test"><span class="header-section-number">23.9</span> Kruskal-Wallis 秩和检验 kruskal.test</a></li>
<li><a class="nav-link" href="#sec-ks-test"><span class="header-section-number">23.10</span> 同分布检验 ks.test</a></li>
<li><a class="nav-link" href="#sec-mantelhaen-test"><span class="header-section-number">23.11</span> Cochran-Mantel-Haenszel 卡方检验 mantelhaen.test</a></li>
<li><a class="nav-link" href="#sec-mauchly-test"><span class="header-section-number">23.12</span> Mauchly 球形检验 mauchly.test</a></li>
<li><a class="nav-link" href="#sec-mcnemar-test"><span class="header-section-number">23.13</span> McNemar 卡方检验 mcnemar.test</a></li>
<li><a class="nav-link" href="#sec-mood-test"><span class="header-section-number">23.14</span> Mood 方差检验 mood.test</a></li>
<li><a class="nav-link" href="#sec-oneway-test"><span class="header-section-number">23.15</span> 单因素多重比较 oneway.test</a></li>
<li>
<a class="nav-link" href="#sec-pairwise-test"><span class="header-section-number">23.16</span> 配对样本的检验</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#subsec-pairwise-prop-test"><span class="header-section-number">23.16.1</span> 配对比例检验 pairwise.prop.test</a></li>
<li><a class="nav-link" href="#subsec-pairwise-t-test"><span class="header-section-number">23.16.2</span> 配对 t 检验 pairwise.t.test</a></li>
<li><a class="nav-link" href="#subsec-pairwise-wilcox-test"><span class="header-section-number">23.16.3</span> 配对 Wilcoxon 检验 pairwise.wilcox.test</a></li>
<li><a class="nav-link" href="#subsec-cor-test"><span class="header-section-number">23.16.4</span> 配对样本相关性检验 cor.test</a></li>
</ul>
</li>
<li><a class="nav-link" href="#sec-poisson-test"><span class="header-section-number">23.17</span> 精确泊松检验 poisson.test</a></li>
<li><a class="nav-link" href="#sec-PP-test"><span class="header-section-number">23.18</span> 单位根检验 PP.test</a></li>
<li>
<a class="nav-link" href="#sec-prop-test"><span class="header-section-number">23.19</span> 比例检验 prop.test</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#subsec-equivalent-test"><span class="header-section-number">23.19.1</span> 两个独立二项总体等价性检验</a></li>
<li><a class="nav-link" href="#subsec-ctr"><span class="header-section-number">23.19.2</span> 不同页面的点击率问题</a></li>
<li><a class="nav-link" href="#subsec-prop-home"><span class="header-section-number">23.19.3</span> 比例齐性检验</a></li>
</ul>
</li>
<li><a class="nav-link" href="#sec-prop-trend-test"><span class="header-section-number">23.20</span> 比例趋势检验 prop.trend.test</a></li>
<li><a class="nav-link" href="#sec-quade-test"><span class="header-section-number">23.21</span> Quade 检验 quade.test</a></li>
<li><a class="nav-link" href="#sec-shapiro-test"><span class="header-section-number">23.22</span> 正态性检验 shapiro.test</a></li>
<li><a class="nav-link" href="#sec-ep-test"><span class="header-section-number">23.23</span> 正态性检验 Epps-Pully 检验</a></li>
<li>
<a class="nav-link" href="#sec-t-test"><span class="header-section-number">23.24</span> 学生 t 检验 t.test</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#subsec-two-samples"><span class="header-section-number">23.24.1</span> 正态总体两样本的均值之差的检验</a></li>
<li><a class="nav-link" href="#office-ttest"><span class="header-section-number">23.24.2</span> 办公软件里的 T 检验</a></li>
</ul>
</li>
<li><a class="nav-link" href="#sec-var-test"><span class="header-section-number">23.25</span> 方差比检验 var.test</a></li>
<li>
<a class="nav-link" href="#sec-wilcox-test"><span class="header-section-number">23.26</span> Wilcoxon 秩和检验 wilcox.test</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#wilcox-test-roc"><span class="header-section-number">23.26.1</span> ROC 曲线和 wilcox.test 检验的关系</a></li></ul>
</li>
<li><a class="nav-link" href="#sec-three-plus-one-tests"><span class="header-section-number">23.27</span> 3 + 1 统计检验</a></li>
<li>
<a class="nav-link" href="#sec-classical-case-study"><span class="header-section-number">23.28</span> 经典案例</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#subsec-ucb-admissions"><span class="header-section-number">23.28.1</span> 1973 年加州大学伯克利分校的学生招生</a></li>
<li><a class="nav-link" href="#subsec-ethnicity"><span class="header-section-number">23.28.2</span> 1976~1977年美国佛罗里达州的凶杀案件中被告肤色和死刑判决的关系</a></li>
<li><a class="nav-link" href="#subsec-HairEyeColor"><span class="header-section-number">23.28.3</span> 统计专业学生的头发和眼睛的颜色</a></li>
</ul>
</li>
<li><a class="nav-link" href="#sec-hypothesis-test-session"><span class="header-section-number">23.29</span> 运行环境</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/XiangyunHuang/masr/blob/devel/hypothesis-test.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/XiangyunHuang/masr/edit/devel/hypothesis-test.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>现代应用统计与 R 语言</strong>: Modern Applied Statistics with R" was written by 黄湘云. It was last built on 2021-10-12.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
