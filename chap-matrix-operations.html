<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>附录 B 矩阵运算 | 现代应用统计与 R 语言</title>
<meta name="author" content="黄湘云">
<meta name="description" content="Eigenvectors from Eigenvalues [113]  参考 matlib 和 Matrix 包，SparseM 更加强调稀疏矩阵的 Cholesky 分解和后退法，矩阵取子集和 Kronecker 积。矩阵计算一般介绍参考在线书籍 Stephen Boyd and Lieven Vandenberghe 最新著作 Introduction to Applied...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="附录 B 矩阵运算 | 现代应用统计与 R 语言">
<meta property="og:type" content="book">
<meta property="og:image" content="/images/cover.png">
<meta property="og:description" content="Eigenvectors from Eigenvalues [113]  参考 matlib 和 Matrix 包，SparseM 更加强调稀疏矩阵的 Cholesky 分解和后退法，矩阵取子集和 Kronecker 积。矩阵计算一般介绍参考在线书籍 Stephen Boyd and Lieven Vandenberghe 最新著作 Introduction to Applied...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="附录 B 矩阵运算 | 现代应用统计与 R 语言">
<meta name="twitter:description" content="Eigenvectors from Eigenvalues [113]  参考 matlib 和 Matrix 包，SparseM 更加强调稀疏矩阵的 Cholesky 分解和后退法，矩阵取子集和 Kronecker 积。矩阵计算一般介绍参考在线书籍 Stephen Boyd and Lieven Vandenberghe 最新著作 Introduction to Applied...">
<meta name="twitter:image" content="/images/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs/header-attrs.js"></script><script src="libs/jquery/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap/bootstrap.bundle.min.js"></script><script src="libs/bs3compat/transition.js"></script><script src="libs/bs3compat/tabs.js"></script><script src="libs/bs3compat/bs3compat.js"></script><link href="libs/bs4_book/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book/bs4_book.js"></script><script src="libs/htmlwidgets/htmlwidgets.js"></script><script src="libs/plotly-binding/plotly.js"></script><script src="libs/typedarray/typedarray.min.js"></script><link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main/plotly-latest.min.js"></script><script src="libs/proj4js/proj4.js"></script><link href="libs/highcharts/css/motion.css" rel="stylesheet">
<script src="libs/highcharts/highcharts.js"></script><script src="libs/highcharts/highcharts-3d.js"></script><script src="libs/highcharts/highcharts-more.js"></script><script src="libs/highcharts/modules/stock.js"></script><script src="libs/highcharts/modules/map.js"></script><script src="libs/highcharts/modules/annotations.js"></script><script src="libs/highcharts/modules/data.js"></script><script src="libs/highcharts/modules/drilldown.js"></script><script src="libs/highcharts/modules/item-series.js"></script><script src="libs/highcharts/modules/offline-exporting.js"></script><script src="libs/highcharts/modules/overlapping-datalabels.js"></script><script src="libs/highcharts/modules/exporting.js"></script><script src="libs/highcharts/modules/export-data.js"></script><script src="libs/highcharts/modules/funnel.js"></script><script src="libs/highcharts/modules/heatmap.js"></script><script src="libs/highcharts/modules/treemap.js"></script><script src="libs/highcharts/modules/sankey.js"></script><script src="libs/highcharts/modules/dependency-wheel.js"></script><script src="libs/highcharts/modules/organization.js"></script><script src="libs/highcharts/modules/solid-gauge.js"></script><script src="libs/highcharts/modules/streamgraph.js"></script><script src="libs/highcharts/modules/sunburst.js"></script><script src="libs/highcharts/modules/vector.js"></script><script src="libs/highcharts/modules/wordcloud.js"></script><script src="libs/highcharts/modules/xrange.js"></script><script src="libs/highcharts/modules/tilemap.js"></script><script src="libs/highcharts/modules/venn.js"></script><script src="libs/highcharts/modules/gantt.js"></script><script src="libs/highcharts/modules/timeline.js"></script><script src="libs/highcharts/modules/parallel-coordinates.js"></script><script src="libs/highcharts/modules/bullet.js"></script><script src="libs/highcharts/modules/coloraxis.js"></script><script src="libs/highcharts/modules/dumbbell.js"></script><script src="libs/highcharts/modules/lollipop.js"></script><script src="libs/highcharts/modules/series-label.js"></script><script src="libs/highcharts/plugins/motion.js"></script><script src="libs/highcharts/custom/reset.js"></script><script src="libs/highcharts/modules/boost.js"></script><script src="libs/highchart-binding/highchart.js"></script><script src="libs/plotly-locale-zh-CN/zh-cn.js"></script><script src="libs/mathjax/cdn.js"></script><link href="libs/dygraphs/dygraph.css" rel="stylesheet">
<script src="libs/dygraphs/dygraph-combined.js"></script><script src="libs/dygraphs/shapes.js"></script><script src="libs/moment/moment.js"></script><script src="libs/moment-timezone/moment-timezone-with-data.js"></script><script src="libs/moment-fquarter/moment-fquarter.min.js"></script><script src="libs/dygraphs-binding/dygraphs.js"></script><script src="libs/Dygraph.Plugins.Unzoom/unzoom.js"></script><script src="libs/echarts4r/echarts-en.min.js"></script><script src="libs/echarts4r/ecStat.min.js"></script><script src="libs/echarts4r/dataTool.min.js"></script><script src="libs/echarts4r-binding/echarts4r.js"></script><script src="libs/d3/d3.min.js"></script><script src="libs/forceNetwork-binding/forceNetwork.js"></script><link href="libs/vis/vis-network.min.css" rel="stylesheet">
<script src="libs/vis/vis-network.min.js"></script><script src="libs/visNetwork-binding/visNetwork.js"></script><script src="libs/FileSaver/FileSaver.min.js"></script><script src="libs/Blob/Blob.js"></script><script src="libs/canvas-toBlob/canvas-toBlob.js"></script><script src="libs/html2canvas/html2canvas.js"></script><script src="libs/jspdf/jspdf.debug.js"></script><link href="libs/jquery-sparkline/jquery.sparkline.css" rel="stylesheet">
<script src="libs/jquery-sparkline/jquery.sparkline.js"></script><script src="libs/sparkline-binding/sparkline.js"></script><script src="libs/r2d3-render/r2d3-render.js"></script><script src="libs/webcomponents/webcomponents.js"></script><script src="libs/r2d3-binding/r2d3.js"></script><script src="libs/d3v6/d3.min.js"></script><script src="libs/es6shim/es6shim.js"></script><script src="libs/es7shim/es7shim.js"></script><script src="libs/graphre/graphre.js"></script><script src="libs/nomnoml/nomnoml.js"></script><script src="libs/nomnoml-binding/nomnoml.js"></script><script src="libs/d3-bundle/d3-bundle.min.js"></script><script src="libs/d3-lasso/d3-lasso.min.js"></script><script src="libs/save-svg-as-png/save-svg-as-png.min.js"></script><link href="libs/ggiraphjs/ggiraphjs.min.css" rel="stylesheet">
<script src="libs/ggiraphjs/ggiraphjs.min.js"></script><script src="libs/girafe-binding/girafe.js"></script><link href="libs/datatables-css/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding/datatables.js"></script><link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core/js/jquery.dataTables.min.js"></script><script src="libs/jszip/jszip.min.js"></script><script src="libs/pdfmake/pdfmake.js"></script><script src="libs/pdfmake/vfs_fonts.js"></script><link href="libs/dt-ext-buttons/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="libs/dt-ext-buttons/js/dataTables.buttons.min.js"></script><script src="libs/dt-ext-buttons/js/buttons.flash.min.js"></script><script src="libs/dt-ext-buttons/js/buttons.html5.min.js"></script><script src="libs/dt-ext-buttons/js/buttons.colVis.min.js"></script><script src="libs/dt-ext-buttons/js/buttons.print.min.js"></script><link href="libs/dt-ext-rowgroup/css/rowGroup.dataTables.min.css" rel="stylesheet">
<script src="libs/dt-ext-rowgroup/js/dataTables.rowGroup.min.js"></script><script src="libs/kePrint/kePrint.js"></script><link href="libs/lightable/lightable.css" rel="stylesheet">
<script src="libs/echarts-world/world.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-54GQKWF7VP"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-54GQKWF7VP');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Modern Applied Statistics with R">现代应用统计与 R 语言</a>:
        <small class="text-muted">Modern Applied Statistics with R</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">欢迎</a></li>
<li><a class="" href="chap-preface.html"><span class="header-section-number">1</span> 前言</a></li>
<li class="book-part">数据整理</li>
<li><a class="" href="chap-data-wrangling.html">介绍</a></li>
<li><a class="" href="chap-data-structure.html"><span class="header-section-number">2</span> 数据结构</a></li>
<li><a class="" href="chap-data-transportation.html"><span class="header-section-number">3</span> 数据搬运</a></li>
<li><a class="" href="chap-string-operations.html"><span class="header-section-number">4</span> 字符串操作</a></li>
<li><a class="" href="chap-regular-expressions.html"><span class="header-section-number">5</span> 正则表达式</a></li>
<li><a class="" href="chap-data-manipulation.html"><span class="header-section-number">6</span> 数据操作</a></li>
<li><a class="" href="chap-advanced-manipulation.html"><span class="header-section-number">7</span> 高级数据操作</a></li>
<li><a class="" href="chap-parallel-manipulation.html"><span class="header-section-number">8</span> 并行化操作</a></li>
<li><a class="" href="chap-dplyr-manipulation.html"><span class="header-section-number">9</span> 净土化操作</a></li>
<li class="book-part">统计图形</li>
<li><a class="" href="chap-statistical-graphics.html">介绍</a></li>
<li><a class="" href="chap-graphics-foundations.html"><span class="header-section-number">10</span> 图形基础</a></li>
<li><a class="" href="chap-data-visualization.html"><span class="header-section-number">11</span> 数据可视化</a></li>
<li><a class="" href="chap-interactive-web-graphics.html"><span class="header-section-number">12</span> 交互图形</a></li>
<li class="book-part">动态文档</li>
<li><a class="" href="chap-dynamic-documents.html">介绍</a></li>
<li><a class="" href="chap-document-elements.html"><span class="header-section-number">13</span> 文档元素</a></li>
<li><a class="" href="chap-portable-document.html"><span class="header-section-number">14</span> 便携式文档</a></li>
<li><a class="" href="chap-web-documents.html"><span class="header-section-number">15</span> 网页文档</a></li>
<li><a class="" href="chap-office-document.html"><span class="header-section-number">16</span> 办公文档</a></li>
<li><a class="" href="chap-reproducible-workflows.html"><span class="header-section-number">17</span> 工作流</a></li>
<li><a class="" href="chap-advanced-documents.html"><span class="header-section-number">18</span> 高级文档</a></li>
<li class="book-part">数据产品</li>
<li><a class="" href="chap-data-product.html">介绍</a></li>
<li><a class="" href="chap-interactive-data-tables.html"><span class="header-section-number">19</span> 交互表格</a></li>
<li><a class="" href="chap-interactive-shiny-app.html"><span class="header-section-number">20</span> 交互报表</a></li>
<li class="book-part">统计基础</li>
<li><a class="" href="chap-statistical-foundations.html">介绍</a></li>
<li><a class="" href="chap-sampling-distributions.html"><span class="header-section-number">21</span> 抽样分布</a></li>
<li><a class="" href="chap-parameter-estimators.html"><span class="header-section-number">22</span> 参数估计</a></li>
<li><a class="" href="chap-hypothesis-test.html"><span class="header-section-number">23</span> 假设检验</a></li>
<li><a class="" href="chap-power-Analysis.html"><span class="header-section-number">24</span> 功效分析</a></li>
<li><a class="" href="chap-experimental-design.html"><span class="header-section-number">25</span> 试验设计</a></li>
<li class="book-part">统计模型</li>
<li><a class="" href="chap-statistical-models.html">介绍</a></li>
<li><a class="" href="chap-linear-models.html"><span class="header-section-number">26</span> 线性模型</a></li>
<li><a class="" href="chap-generalized-linear-models.html"><span class="header-section-number">27</span> 广义线性模型</a></li>
<li><a class="" href="chap-bayesian-models.html"><span class="header-section-number">28</span> 贝叶斯模型</a></li>
<li class="book-part">数据建模</li>
<li><a class="" href="chap-data-modeling.html">介绍</a></li>
<li><a class="" href="chap-text-analysis.html"><span class="header-section-number">29</span> 文本分析</a></li>
<li><a class="" href="chap-survival-analysis.html"><span class="header-section-number">30</span> 生存分析</a></li>
<li><a class="" href="chap-time-series-analysis.html"><span class="header-section-number">31</span> 时序分析</a></li>
<li class="book-part">时空数据</li>
<li><a class="" href="chap-spatio-temporal-data.html">介绍</a></li>
<li><a class="" href="chap-spatial-analysis.html"><span class="header-section-number">32</span> 空间数据分析</a></li>
<li><a class="" href="chap-spatial-modeling.html"><span class="header-section-number">33</span> 空间数据建模</a></li>
<li><a class="" href="chap-spatial-viz.html"><span class="header-section-number">34</span> 空间数据可视化</a></li>
<li><a class="" href="chap-case-study.html"><span class="header-section-number">35</span> 案例研究</a></li>
<li><a class="" href="chap-data-explorer.html"><span class="header-section-number">36</span> 数据探索</a></li>
<li class="book-part">机器学习</li>
<li><a class="" href="chap-machine-learning.html">介绍</a></li>
<li><a class="" href="chap-gradient-boosting-machine.html"><span class="header-section-number">37</span> 梯度提升机</a></li>
<li><a class="" href="chap-numerical-optimization.html"><span class="header-section-number">38</span> 数值优化</a></li>
<li class="book-part">附录</li>
<li><a class="" href="chap-linux-command-bash.html"><span class="header-section-number">A</span> 命令行操作</a></li>
<li><a class="active" href="chap-matrix-operations.html"><span class="header-section-number">B</span> 矩阵运算</a></li>
<li><a class="" href="chap-symbolic-computation.html"><span class="header-section-number">C</span> 符号计算</a></li>
<li><a class="" href="chap-mixed-programming.html"><span class="header-section-number">D</span> 混合编程</a></li>
<li><a class="" href="chap-object-oriented-programming.html"><span class="header-section-number">E</span> 面向对象编程</a></li>
<li><a class="" href="chap-file-operations.html"><span class="header-section-number">F</span> 文件操作</a></li>
<li><a class="" href="chap-other-softwares.html"><span class="header-section-number">G</span> 其它软件</a></li>
<li><a class="" href="chap-notations.html"><span class="header-section-number">H</span> 符号说明</a></li>
<li><a class="" href="references.html">参考文献</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/XiangyunHuang/masr">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="chap-matrix-operations" class="section level1" number="40">
<h1>
<span class="header-section-number">附录 B</span> 矩阵运算<a class="anchor" aria-label="anchor" href="#chap-matrix-operations"><i class="fas fa-link"></i></a>
</h1>
<!-- 介绍矩阵代数内容：各类矩阵分解及其几何解释，比如矩阵行列式 -->
<blockquote>
<p>Eigenvectors from Eigenvalues <span class="citation"><a href="#ref-Denton_2019_Eigen" role="doc-biblioref">[113]</a></span></p>
</blockquote>
<blockquote>
<p>参考 <a href="https://github.com/friendly/matlib">matlib</a> 和 Matrix 包，<a href="https://CRAN.R-project.org/package=SparseM">SparseM</a> 更加强调稀疏矩阵的 Cholesky 分解和后退法，矩阵取子集和 Kronecker 积。矩阵计算一般介绍参考在线书籍 Stephen Boyd and Lieven Vandenberghe 最新著作 Introduction to Applied Linear Algebra – Vectors, Matrices, and Least Squares <span class="citation"><a href="#ref-Boyd_2018_matrix" role="doc-biblioref">[114]</a></span> 及其 <a href="https://web.stanford.edu/~boyd/vmls/vmls-julia-companion.pdf">Julia 语言实现</a>，矩阵分解部分参考 <a href="http://math.mit.edu/~gs/linearalgebra/linearalgebra5_Matrix.pdf">Introduction to Linear Algebra, 5th Edition</a>、<a href="https://shainarace.github.io/LinearAlgebra">Linear Algebra for Data Science with examples in R</a></p>
</blockquote>
<p><a href="https://github.com/faosorios/fastmatrix">fastmatrix</a>、<a href="https://cran.r-project.org/package=abind">abind</a> 各种矩阵操作。</p>
<p><a href="https://web.evanchen.cc/">Evan Chen</a> 的书<a href="https://github.com/vEnhance/napkin">An Infinitely Large Napkin</a> 介绍矩阵代数的内积空间、群、环、域等高级内容，作者提供免费的电子书。</p>
<!-- 解释基本的矩阵概念，比如秩、迹、行列式、直积等 -->
<p>分块矩阵操作，各类分解算法，及其 R 实现</p>
<div class="sourceCode" id="cb2821"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://Matrix.R-forge.R-project.org/">Matrix</a></span><span class="op">)</span></code></pre></div>
<p>以 attitude 数据集为例介绍各种矩阵操作</p>
<div class="sourceCode" id="cb2822"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">head</a></span><span class="op">(</span><span class="va">attitude</span><span class="op">)</span></code></pre></div>
<pre><code>##   rating complaints privileges learning raises critical advance
## 1     43         51         30       39     61       92      45
## 2     63         64         51       54     63       73      47
## 3     71         70         68       69     76       86      48
## 4     61         63         45       47     54       84      35
## 5     81         78         56       66     71       83      47
## 6     43         55         49       44     54       49      34</code></pre>
<p>rating 总体评价
complaints 处理员工投诉
privileges 不允许特权
learning 学习机会
raises 根据表现晋升
critical 批评
advancel 进步</p>
<div class="sourceCode" id="cb2824"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">rating</span> <span class="op">~</span><span class="va">.</span> , data <span class="op">=</span> <span class="va">attitude</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="co"># 模型是显著的，很多变量的系数不显著</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = rating ~ ., data = attitude)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.9418  -4.3555   0.3158   5.5425  11.5990 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 10.78708   11.58926   0.931 0.361634    
## complaints   0.61319    0.16098   3.809 0.000903 ***
## privileges  -0.07305    0.13572  -0.538 0.595594    
## learning     0.32033    0.16852   1.901 0.069925 .  
## raises       0.08173    0.22148   0.369 0.715480    
## critical     0.03838    0.14700   0.261 0.796334    
## advance     -0.21706    0.17821  -1.218 0.235577    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 7.068 on 23 degrees of freedom
## Multiple R-squared:  0.7326, Adjusted R-squared:  0.6628 
## F-statistic:  10.5 on 6 and 23 DF,  p-value: 1.24e-05</code></pre>
<div class="sourceCode" id="cb2826"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: rating
##            Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
## complaints  1 2927.58 2927.58 58.6026 9.056e-08 ***
## privileges  1    7.52    7.52  0.1505    0.7016    
## learning    1  137.25  137.25  2.7473    0.1110    
## raises      1    0.94    0.94  0.0189    0.8920    
## critical    1    0.56    0.56  0.0113    0.9163    
## advance     1   74.11   74.11  1.4835    0.2356    
## Residuals  23 1149.00   49.96                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<!-- 矩阵变换对应的几何意义，和实际数据对应的意义 -->
<div class="sourceCode" id="cb2828"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">attitude_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix.data.frame</a></span><span class="op">(</span><span class="va">attitude</span><span class="op">)</span>
<span class="co"># 生成演示用的矩阵</span>
<span class="va">demo_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/transpose.html">t</a></span><span class="op">(</span><span class="va">attitude_mat</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">attitude_mat</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span></code></pre></div>
<div id="subsec-matrix-multiplication" class="section level2" number="40.1">
<h2>
<span class="header-section-number">B.1</span> 矩阵乘法<a class="anchor" aria-label="anchor" href="#subsec-matrix-multiplication"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb2829"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">A</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    2
## [2,]    2    3</code></pre>
<div class="sourceCode" id="cb2831"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>, nrow <span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="va">B</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    3    5
## [2,]    2    4    6</code></pre>
<p>通常的矩阵乘法也叫矩阵内积</p>
<div class="sourceCode" id="cb2833"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A</span> <span class="op">%*%</span> <span class="va">B</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    5   11   17
## [2,]    8   18   28</code></pre>
<div class="sourceCode" id="cb2835"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A</span> <span class="op">**</span> <span class="fl">2</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    4
## [2,]    4    9</code></pre>
<div class="sourceCode" id="cb2837"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A</span> <span class="op">^</span> <span class="fl">2</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    4
## [2,]    4    9</code></pre>
<div class="sourceCode" id="cb2839"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A</span> <span class="op">**</span> <span class="va">A</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    4
## [2,]    4   27</code></pre>
</div>
<div id="subsec-hadamard-product" class="section level2" number="40.2">
<h2>
<span class="header-section-number">B.2</span> Hadamard 积<a class="anchor" aria-label="anchor" href="#subsec-hadamard-product"><i class="fas fa-link"></i></a>
</h2>
<p>Hadamard 积（法国数学家 Jacques Hadamard）也叫 Schur 积（德国数学家Issai Schur ）或 entrywise 积是两个维数相同的矩阵对应元素相乘，特别地，<span class="math inline">\(A^2\)</span> 表示将矩阵 <span class="math inline">\(A\)</span> 的每个元素平方</p>
<p><span class="math display">\[
(A\circ B)_{ij} = (A)_{ij}(B)_{ij}
\]</span></p>
<p><span class="math display">\[
\begin{bmatrix}
 a_{11} &amp; a_{12}  &amp; a_{13} \\ 
 a_{21} &amp; a_{22}  &amp; a_{23} \\ 
 a_{31} &amp; a_{32}  &amp; a_{33} 
\end{bmatrix}
\circ
\begin{bmatrix}
 b_{11} &amp; b_{12}  &amp; b_{13} \\ 
 b_{21} &amp; b_{22}  &amp; b_{23} \\ 
 b_{31} &amp; b_{32}  &amp; b_{33} 
\end{bmatrix}
= 
\begin{bmatrix}
 a_{11}b_{11} &amp; a_{12}b_{12}  &amp; a_{13}b_{13} \\ 
 a_{21}b_{21} &amp; a_{22}b_{22}  &amp; a_{23}b_{23} \\ 
 a_{31}b_{31} &amp; a_{32}b_{32}  &amp; a_{33}b_{33} 
\end{bmatrix}
\]</span></p>
<div class="sourceCode" id="cb2841"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A</span><span class="op">^</span><span class="fl">2</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    4
## [2,]    4    9</code></pre>
</div>
<div id="subsec-matrix-transpose" class="section level2" number="40.3">
<h2>
<span class="header-section-number">B.3</span> 矩阵转置<a class="anchor" aria-label="anchor" href="#subsec-matrix-transpose"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb2843"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/transpose.html">t</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    2
## [2,]    3    4
## [3,]    5    6</code></pre>
</div>
<div id="subsec-outer-product" class="section level2" number="40.4">
<h2>
<span class="header-section-number">B.4</span> 矩阵外积<a class="anchor" aria-label="anchor" href="#subsec-outer-product"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb2845"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A</span> <span class="op">%o%</span> <span class="va">B</span> <span class="co"># outer(A, B, FUN = "*")</span></code></pre></div>
<pre><code>## , , 1, 1
## 
##      [,1] [,2]
## [1,]    1    2
## [2,]    2    3
## 
## , , 2, 1
## 
##      [,1] [,2]
## [1,]    2    4
## [2,]    4    6
## 
## , , 1, 2
## 
##      [,1] [,2]
## [1,]    3    6
## [2,]    6    9
## 
## , , 2, 2
## 
##      [,1] [,2]
## [1,]    4    8
## [2,]    8   12
## 
## , , 1, 3
## 
##      [,1] [,2]
## [1,]    5   10
## [2,]   10   15
## 
## , , 2, 3
## 
##      [,1] [,2]
## [1,]    6   12
## [2,]   12   18</code></pre>
<p>直积/克罗内克积</p>
<div class="sourceCode" id="cb2847"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A</span> <span class="op">%x%</span> <span class="va">B</span> <span class="co"># kronecker(A, B, FUN = "*")</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6]
## [1,]    1    3    5    2    6   10
## [2,]    2    4    6    4    8   12
## [3,]    2    6   10    3    9   15
## [4,]    4    8   12    6   12   18</code></pre>
</div>
<div id="subsec-matrix-exp" class="section level2" number="40.5">
<h2>
<span class="header-section-number">B.5</span> 矩阵乘方<a class="anchor" aria-label="anchor" href="#subsec-matrix-exp"><i class="fas fa-link"></i></a>
</h2>
<p>矩阵 A 首先是一个方阵，对称性和正定性未知，n 个 矩阵 A 相乘</p>
<p>统计之都论坛讨论如何求矩阵的乘方 <a href="https://d.cosx.org/d/5619-svd" class="uri">https://d.cosx.org/d/5619-svd</a></p>
<div class="sourceCode" id="cb2849"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="st">"%^%"</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mat</span>, <span class="va">pow</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">is.matrix</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span> <span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/diff.html">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/dimensions.html">dim</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">pow</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">pow</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">pow</span>
    <span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/solve-methods.html">solve</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">pow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">pow</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/switch.html">switch</a></span><span class="op">(</span><span class="va">pow</span> <span class="op">+</span> <span class="fl">1</span>, <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/pkg/raster/man/ncell.html">nrow</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span>
  <span class="va">get.exponents</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">pow</span><span class="op">)</span>
    <span class="kw">if</span> <span class="op">(</span><span class="va">pow</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="cn">NULL</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="va">pow</span><span class="op">)</span><span class="op">)</span>, <span class="fu">get.exponents</span><span class="op">(</span><span class="va">pow</span> <span class="op">-</span> <span class="va">k</span><span class="op">)</span><span class="op">)</span>
  <span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/ncell.html">nrow</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span>
  <span class="va">dlog2exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/flip.html">rev</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/diff.html">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="fu">get.exponents</span><span class="op">(</span><span class="va">pow</span><span class="op">)</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html">length</a></span><span class="op">(</span><span class="va">dlog2exp</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw">if</span> <span class="op">(</span><span class="va">dlog2exp</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span> <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">dlog2exp</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span> <span class="va">mat</span> <span class="op">&lt;-</span> <span class="va">mat</span> <span class="op">%*%</span> <span class="va">mat</span>
    <span class="va">ans</span> <span class="op">&lt;-</span> <span class="va">ans</span> <span class="op">%*%</span> <span class="va">mat</span>
  <span class="op">}</span>
  <span class="va">ans</span>
<span class="op">}</span></code></pre></div>
<p>奇异值分解</p>
<div class="sourceCode" id="cb2850"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html">svd</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>
<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/all.equal.data.table.html">all.equal</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">u</span><span class="op">%*%</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">d</span><span class="op">)</span><span class="op">%*%</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/transpose.html">t</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">v</span><span class="op">)</span>,<span class="va">A</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>特征值及分解 <span class="math inline">\(A = V \Lambda V^{-1}\)</span> 求解矩阵 A 的 n 次方</p>
<div class="sourceCode" id="cb2852"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></code></pre></div>
<pre><code>## eigen() decomposition
## $values
## [1]  4.236068 -0.236068
## 
## $vectors
##           [,1]       [,2]
## [1,] 0.5257311 -0.8506508
## [2,] 0.8506508  0.5257311</code></pre>
<div class="sourceCode" id="cb2854"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">$</span><span class="va">vectors</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">$</span><span class="va">values</span><span class="op">)</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/solve-methods.html">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">$</span><span class="va">vectors</span><span class="op">)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    2
## [2,]    2    3</code></pre>
<div class="sourceCode" id="cb2856"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">$</span><span class="va">vectors</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">$</span><span class="va">values</span><span class="op">)</span><span class="op">^</span><span class="fl">3</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/solve-methods.html">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">$</span><span class="va">vectors</span><span class="op">)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]   21   34
## [2,]   34   55</code></pre>
<div class="sourceCode" id="cb2858"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A</span> <span class="op">%*%</span> <span class="va">A</span> <span class="op">%*%</span> <span class="va">A</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]   21   34
## [2,]   34   55</code></pre>
</div>
<div id="subsec-matrix-power" class="section level2" number="40.6">
<h2>
<span class="header-section-number">B.6</span> 矩阵求幂<a class="anchor" aria-label="anchor" href="#subsec-matrix-power"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb2860"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">2</span><span class="op">^</span><span class="va">A</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    2    4
## [2,]    4    8</code></pre>
<div class="sourceCode" id="cb2862"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></code></pre></div>
<pre><code>##          [,1]      [,2]
## [1,] 2.718282  7.389056
## [2,] 7.389056 20.085537</code></pre>
<p><a href="https://cran.r-project.org/web/packages/expm/index.html">expm</a> 包含 更多关于矩阵开方、取对数等计算</p>
</div>
<div id="subsec-matrix-crossproduct" class="section level2" number="40.7">
<h2>
<span class="header-section-number">B.7</span> 矩阵交叉积<a class="anchor" aria-label="anchor" href="#subsec-matrix-crossproduct"><i class="fas fa-link"></i></a>
</h2>
<p>交叉积 <span class="math inline">\(A^{\top}A\)</span></p>
<div class="sourceCode" id="cb2864"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/matrix-products.html">crossprod</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">A</span><span class="op">)</span>  <span class="co">#  t(x) %*% y</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    5    8
## [2,]    8   13</code></pre>
<div class="sourceCode" id="cb2866"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/matrix-products.html">tcrossprod</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">A</span><span class="op">)</span> <span class="co">#  x %*% t(y)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    5    8
## [2,]    8   13</code></pre>
</div>
<div id="subsec-matrix-determinant" class="section level2" number="40.8">
<h2>
<span class="header-section-number">B.8</span> 矩阵行列式<a class="anchor" aria-label="anchor" href="#subsec-matrix-determinant"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb2868"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/Matrix-class.html">det</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] -1</code></pre>
<p>expm 包计算矩阵 <span class="math inline">\(e^{\mathbf{A}}\)</span></p>
</div>
<div id="subsec-matrix-cond-num" class="section level2" number="40.9">
<h2>
<span class="header-section-number">B.9</span> 矩阵条件数<a class="anchor" aria-label="anchor" href="#subsec-matrix-cond-num"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb2870"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://Matrix.R-forge.R-project.org/">Matrix</a></span><span class="op">)</span>
<span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/kappa.html">rcond</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.04</code></pre>
<div class="sourceCode" id="cb2872"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/kappa.html">kappa</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 21.85714</code></pre>
<div class="sourceCode" id="cb2874"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/rcond.html">rcond</a></span><span class="op">(</span><span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/Hilbert.html">Hilbert</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 3.439939e-08</code></pre>
<div class="sourceCode" id="cb2876"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/rcond.html">rcond</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.04</code></pre>
</div>
<div id="subsec-matrix-inverse" class="section level2" number="40.10">
<h2>
<span class="header-section-number">B.10</span> 矩阵求逆<a class="anchor" aria-label="anchor" href="#subsec-matrix-inverse"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb2878"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/solve-methods.html">solve</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]   -3    2
## [2,]    2   -1</code></pre>
<p>应用之线性方程组</p>
<div class="sourceCode" id="cb2880"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/Hilbert.html">Hilbert</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span>
<span class="co"># not inv</span>
<span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/solve-methods.html">solve</a></span><span class="op">(</span><span class="va">B</span>,<span class="va">b</span><span class="op">)</span> </code></pre></div>
<pre><code>## 6 x 1 Matrix of class "dgeMatrix"
##      [,1]
## [1,]    1
## [2,]    1
## [3,]    1
## [4,]    1
## [5,]    1
## [6,]    1</code></pre>
<div class="sourceCode" id="cb2882"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># inv</span>
<span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/solve-methods.html">solve</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">b</span></code></pre></div>
<pre><code>## 6 x 1 Matrix of class "dgeMatrix"
##      [,1]
## [1,]    1
## [2,]    1
## [3,]    1
## [4,]    1
## [5,]    1
## [6,]    1</code></pre>
<p>Moore-Penrose generalized inverse 广义逆，如果 A 可逆则，广义逆就是逆</p>
<div class="sourceCode" id="cb2884"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span> <span class="co"># ginv 来自 MASS 包</span>
<span class="fu"><a href="https://rdrr.io/pkg/MASS/man/ginv.html">ginv</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]   -3    2
## [2,]    2   -1</code></pre>
<div class="sourceCode" id="cb2886"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/ginv.html">ginv</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">A</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    2
## [2,]    2    3</code></pre>
<div class="sourceCode" id="cb2888"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/ginv.html">ginv</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">A</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/ginv.html">ginv</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]   -3    2
## [2,]    2   -1</code></pre>
<div class="sourceCode" id="cb2890"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/transpose.html">t</a></span><span class="op">(</span><span class="va">A</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/ginv.html">ginv</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##               [,1]         [,2]
## [1,]  1.000000e+00 8.881784e-16
## [2,] -8.881784e-16 1.000000e+00</code></pre>
<div class="sourceCode" id="cb2892"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/ginv.html">ginv</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></code></pre></div>
<pre><code>##              [,1]          [,2]
## [1,] 1.000000e+00 -8.881784e-16
## [2,] 8.881784e-16  1.000000e+00</code></pre>
<div class="sourceCode" id="cb2894"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/transpose.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/ginv.html">ginv</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">A</span><span class="op">)</span></code></pre></div>
<pre><code>##              [,1]          [,2]
## [1,] 1.000000e+00 -8.881784e-16
## [2,] 8.881784e-16  1.000000e+00</code></pre>
<div class="sourceCode" id="cb2896"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/ginv.html">ginv</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">A</span></code></pre></div>
<pre><code>##               [,1]         [,2]
## [1,]  1.000000e+00 8.881784e-16
## [2,] -8.881784e-16 1.000000e+00</code></pre>
</div>
<div id="subsec-matrix-adjoint" class="section level2" number="40.11">
<h2>
<span class="header-section-number">B.11</span> 矩阵伴随<a class="anchor" aria-label="anchor" href="#subsec-matrix-adjoint"><i class="fas fa-link"></i></a>
</h2>
<p>伴随矩阵 <span class="math inline">\(A*A^{\star} = A^{\star} *A = |A|*I, A^{\star} = |A|*A^{-1}\)</span></p>
<ul>
<li><span class="math inline">\(|A^{\star}| = |A|^{n-1}, A \in \mathbb{R}^{n\times n},n \geq 2\)</span></li>
<li><span class="math inline">\((A^{\star})^{\star} = |A|^{n-2}A, A \in \mathbb{R}^{n\times n},n \geq 2\)</span></li>
<li>
<span class="math inline">\((A^{\star})^{\star}\)</span> A 的 n 次伴随是？</li>
</ul>
<div class="sourceCode" id="cb2898"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/Matrix-class.html">det</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/solve-methods.html">solve</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    3   -2
## [2,]   -2    1</code></pre>
</div>
<div id="subsec-matrix-norm" class="section level2" number="40.12">
<h2>
<span class="header-section-number">B.12</span> 矩阵范数<a class="anchor" aria-label="anchor" href="#subsec-matrix-norm"><i class="fas fa-link"></i></a>
</h2>
<p>向量和矩阵的范数，包括1，2，无穷范数，其他操作看 Matrix 包，尤其关于稀疏矩阵计算部分</p>
<dl>
<dt>
<span class="math inline">\(1\)</span>-范数</dt>
<dd>列和绝对值最大的
</dd>
<dt>
<span class="math inline">\(\infty\)</span> - 范数</dt>
<dd>行和绝对值最大的
</dd>
<dt>Frobenius - 范数</dt>
<dd>Euclidean 范数
</dd>
<dt>
<span class="math inline">\(M\)</span> - 范数</dt>
<dd>矩阵里模最大的元素，矩阵里面的元素可能含有复数，所以取模最大
</dd>
<dt>
<span class="math inline">\(2\)</span> - 范数</dt>
<dd>又称谱范数，矩阵最大的奇异值，如果是方阵，就是最大的特征值
</dd>
</dl>
<div class="sourceCode" id="cb2900"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/norm.html">norm</a></span><span class="op">(</span><span class="va">A</span>, type <span class="op">=</span> <span class="st">"1"</span><span class="op">)</span> <span class="co"># max(abs(colSums(A)))</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb2902"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/norm.html">norm</a></span><span class="op">(</span><span class="va">A</span>, type <span class="op">=</span> <span class="st">"I"</span><span class="op">)</span> <span class="co"># max(abs(rowSums(A)))</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb2904"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/norm.html">norm</a></span><span class="op">(</span><span class="va">A</span>, type <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 4.242641</code></pre>
<div class="sourceCode" id="cb2906"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/norm.html">norm</a></span><span class="op">(</span><span class="va">A</span>, type <span class="op">=</span> <span class="st">"M"</span><span class="op">)</span> <span class="co">#</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb2908"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/norm.html">norm</a></span><span class="op">(</span><span class="va">A</span>, type <span class="op">=</span> <span class="st">"2"</span><span class="op">)</span> <span class="co"># max(svd(A)$d)</span></code></pre></div>
<pre><code>## [1] 4.236068</code></pre>
<div class="rmdinfo">
<p>显然，<span class="math inline">\(1-,\infty-,M-\)</span> 的范数计算比 <span class="math inline">\(F-\)</span> 范数快，函数 <code>norm</code> 默认情况下求 <span class="math inline">\(1-\)</span> 范数</p>
</div>
</div>
<div id="subsec-matrix-rank" class="section level2" number="40.13">
<h2>
<span class="header-section-number">B.13</span> 矩阵求秩<a class="anchor" aria-label="anchor" href="#subsec-matrix-rank"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb2910"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/qr-methods.html">qr</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">$</span><span class="va">rank</span> <span class="co"># or qr.default(A)$rank</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
</div>
<div id="subsec-matrix-trace" class="section level2" number="40.14">
<h2>
<span class="header-section-number">B.14</span> 矩阵求迹<a class="anchor" aria-label="anchor" href="#subsec-matrix-trace"><i class="fas fa-link"></i></a>
</h2>
<p>若</p>
<p><span class="math display">\[
A = \begin{bmatrix}
 a_{11} &amp; a_{12}  &amp; a_{13} \\ 
 a_{21} &amp; a_{22}  &amp; a_{23} \\ 
 a_{31} &amp; a_{32}  &amp; a_{33} 
\end{bmatrix}
\]</span></p>
<p>则矩阵 <span class="math inline">\(A\)</span> 的迹 <span class="math inline">\(\operatorname{tr}(A) = \sum_{i=1}^{n}a_{ii}\)</span></p>
<div class="sourceCode" id="cb2912"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<p>特殊矩阵的构造</p>
</div>
<div id="subsec-identity-matrix" class="section level2" number="40.15">
<h2>
<span class="header-section-number">B.15</span> 单位矩阵<a class="anchor" aria-label="anchor" href="#subsec-identity-matrix"><i class="fas fa-link"></i></a>
</h2>
<p>矩阵对角线上全是1，其余位置都是0</p>
<p><span class="math display">\[
A = \begin{bmatrix}
 1 &amp; 0  &amp; 0 \\ 
 0 &amp; 1  &amp; 0 \\ 
 0 &amp; 0  &amp; 1 
\end{bmatrix}
\]</span></p>
<div class="sourceCode" id="cb2914"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rep.html">rep</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    0    0
## [2,]    0    1    0
## [3,]    0    0    1</code></pre>
<p>而全1矩阵是所有元素都是1的矩阵，可以借助外积运算构造，如3阶全1矩阵</p>
<div class="sourceCode" id="cb2916"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span> <span class="op">%o%</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span> </code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    1    1
## [2,]    1    1    1
## [3,]    1    1    1</code></pre>
</div>
<div id="subsec-matrix-diagonals" class="section level2" number="40.16">
<h2>
<span class="header-section-number">B.16</span> 对角矩阵<a class="anchor" aria-label="anchor" href="#subsec-matrix-diagonals"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb2918"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>       <span class="co"># diagonal of a matrix</span></code></pre></div>
<pre><code>## [1] 1 3</code></pre>
<div class="sourceCode" id="cb2920"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">)</span> <span class="co"># construct a diagonal matrix</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    0
## [2,]    0    3</code></pre>
</div>
<div id="subsec-upper-matrix" class="section level2" number="40.17">
<h2>
<span class="header-section-number">B.17</span> 上/下三角矩阵<a class="anchor" aria-label="anchor" href="#subsec-upper-matrix"><i class="fas fa-link"></i></a>
</h2>
<p>矩阵下三角</p>
<p>row 和 col</p>
<div class="sourceCode" id="cb2922"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/row.html">row</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    1
## [2,]    2    2</code></pre>
<div class="sourceCode" id="cb2924"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/col.html">col</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    2
## [2,]    1    2</code></pre>
<div class="sourceCode" id="cb2926"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/row.html">row</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<pre><code>## [1] 1 3</code></pre>
<div class="sourceCode" id="cb2928"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html">upper.tri</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="co"># 矩阵上三角</span></code></pre></div>
<pre><code>##       [,1]  [,2]
## [1,] FALSE  TRUE
## [2,] FALSE FALSE</code></pre>
<div class="sourceCode" id="cb2930"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html">upper.tri</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb2932"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html">lower.tri</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># 获得上三角矩阵</span>
<span class="va">A</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    2
## [2,]    0    3</code></pre>
<ul>
<li>下三角矩阵</li>
</ul>
<div class="sourceCode" id="cb2934"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">A</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    2
## [2,]    2    3</code></pre>
<div class="sourceCode" id="cb2936"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html">lower.tri</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></code></pre></div>
<pre><code>##       [,1]  [,2]
## [1,] FALSE FALSE
## [2,]  TRUE FALSE</code></pre>
<div class="sourceCode" id="cb2938"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html">lower.tri</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb2940"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html">upper.tri</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># 获得下三角矩阵</span>
<span class="va">A</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    0
## [2,]    2    3</code></pre>
<div class="sourceCode" id="cb2942"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">A</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/row.html">row</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/col.html">col</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span>
<span class="va">A</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    0
## [2,]    2    3</code></pre>
</div>
<div id="subsec-sparse-matrix" class="section level2" number="40.18">
<h2>
<span class="header-section-number">B.18</span> 稀疏矩阵<a class="anchor" aria-label="anchor" href="#subsec-sparse-matrix"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb2944"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span>
<span class="co">## pointer vectors can be used, and the (i,x) slots are sorted if necessary:</span>
<span class="co">## 使用指针构造</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/sparseMatrix.html">sparseMatrix</a></span><span class="op">(</span>i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>, p<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">6</span><span class="op">)</span>, x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, dimnames <span class="op">=</span> <span class="va">dn</span><span class="op">)</span>
<span class="va">m</span></code></pre></div>
<pre><code>## 3 x 5 sparse Matrix of class "dgCMatrix"
##   a b c d e
## A . 2 . . 6
## B . . 4 . 5
## C 1 . 3 . .</code></pre>
<div class="sourceCode" id="cb2946"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## 典型构造方式</span>
<span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span>; <span class="va">j</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">9</span>,<span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>; <span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">7</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>
<span class="op">(</span><span class="va">AA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/sparseMatrix.html">sparseMatrix</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">j</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span>                    <span class="co">##  8 x 10 "dgCMatrix"</span></code></pre></div>
<pre><code>## 8 x 10 sparse Matrix of class "dgCMatrix"
##                              
## [1,] . 7 . . .  .  .  .  .  .
## [2,] . . . . .  .  .  .  .  .
## [3,] . . . . .  .  .  . 14  .
## [4,] . . . . . 21  .  .  .  .
## [5,] . . . . .  . 28  .  .  .
## [6,] . . . . .  .  . 35  .  .
## [7,] . . . . .  .  .  . 42  .
## [8,] . . . . .  .  .  .  . 49</code></pre>
</div>
<div id="subsec-triangular-matrix" class="section level2" number="40.19">
<h2>
<span class="header-section-number">B.19</span> 三对角矩阵<a class="anchor" aria-label="anchor" href="#subsec-triangular-matrix"><i class="fas fa-link"></i></a>
</h2>
<!-- 各类矩阵分解技术，及其算法实现、适用范围，最常见的 LU 分解、SVD 和 QR 分解，参考 R 内置的帮助文档及其实现 -->
</div>
<div id="subsec-lu-decomposition" class="section level2" number="40.20">
<h2>
<span class="header-section-number">B.20</span> LU 分解<a class="anchor" aria-label="anchor" href="#subsec-lu-decomposition"><i class="fas fa-link"></i></a>
</h2>
</div>
<div id="subsec-schur-decomposition" class="section level2" number="40.21">
<h2>
<span class="header-section-number">B.21</span> Schur 分解<a class="anchor" aria-label="anchor" href="#subsec-schur-decomposition"><i class="fas fa-link"></i></a>
</h2>
</div>
<div id="subsec-choleski-decomposition" class="section level2" number="40.22">
<h2>
<span class="header-section-number">B.22</span> Cholesky 分解<a class="anchor" aria-label="anchor" href="#subsec-choleski-decomposition"><i class="fas fa-link"></i></a>
</h2>
<p>实对称正定矩阵的 Choleski 分解</p>
<div class="sourceCode" id="cb2948"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/chol.html">chol</a></span><span class="op">(</span><span class="va">A</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##          [,1] [,2]
## [1,] 1.414214    0
## [2,] 0.000000    2</code></pre>
<div class="sourceCode" id="cb2950"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Inverse from Choleski (or QR) Decomposition</span>
<span class="fu">Matrix</span><span class="fu">::</span><span class="fu">chol2inv</span><span class="op">(</span><span class="va">A</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##      [,1]   [,2]
## [1,] 0.25 0.0000
## [2,] 0.00 0.0625</code></pre>
<p><code><a href="https://rdrr.io/pkg/Matrix/man/Cholesky.html">Matrix::Cholesky</a></code> 实现稀疏 Cholesky 分解</p>
</div>
<div id="subsec-eigenvalues-decomposition" class="section level2" number="40.23">
<h2>
<span class="header-section-number">B.23</span> 特征值分解<a class="anchor" aria-label="anchor" href="#subsec-eigenvalues-decomposition"><i class="fas fa-link"></i></a>
</h2>
<p>特征值分解（Eigenvalues Decomposition）也叫谱分解（Spectral Decomposition）</p>
<div class="sourceCode" id="cb2952"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></code></pre></div>
<pre><code>## eigen() decomposition
## $values
## [1] 3 1
## 
## $vectors
##      [,1]       [,2]
## [1,]    0  0.7071068
## [2,]    1 -0.7071068</code></pre>
</div>
<div id="subsec-Singular-Value-Decomposition" class="section level2" number="40.24">
<h2>
<span class="header-section-number">B.24</span> SVD 分解<a class="anchor" aria-label="anchor" href="#subsec-Singular-Value-Decomposition"><i class="fas fa-link"></i></a>
</h2>
<p><a href="https://github.com/bwlewis/irlba">Fast truncated singular value decompositions</a>
奇异值分解是特征值分解的推广</p>
<div class="sourceCode" id="cb2954"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/svd.html">svd</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></code></pre></div>
<pre><code>## $d
## [1] 3.6502815 0.8218544
## 
## $u
##            [,1]       [,2]
## [1,] -0.1601822 -0.9870875
## [2,] -0.9870875  0.1601822
## 
## $v
##            [,1]       [,2]
## [1,] -0.5847103 -0.8112422
## [2,] -0.8112422  0.5847103</code></pre>
<div class="sourceCode" id="cb2956"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/svd.html">svd</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">$</span><span class="va">d</span></code></pre></div>
<pre><code>## [1] 3.6502815 0.8218544</code></pre>
<p>邱怡轩将奇异值分解用于图像压缩 <a href="https://cosx.org/2014/02/svd-and-image-compression" class="uri">https://cosx.org/2014/02/svd-and-image-compression</a> 并制作了 <a href="https://yihui.shinyapps.io/imgsvd/">Shiny App</a> 交互式演示</p>
</div>
<div id="subsec-QR-Decomposition" class="section level2" number="40.25">
<h2>
<span class="header-section-number">B.25</span> QR 分解<a class="anchor" aria-label="anchor" href="#subsec-QR-Decomposition"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb2958"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/qr.html">qr.default</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></code></pre></div>
<pre><code>## $qr
##            [,1]      [,2]
## [1,] -2.2360680 -2.683282
## [2,]  0.8944272  1.341641
## 
## $rank
## [1] 2
## 
## $qraux
## [1] 1.447214 1.341641
## 
## $pivot
## [1] 1 2
## 
## attr(,"class")
## [1] "qr"</code></pre>
<div class="sourceCode" id="cb2960"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/qraux.html">qr.X</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/qr.html">qr.default</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    0
## [2,]    2    3</code></pre>
<div class="sourceCode" id="cb2962"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/sparseQR-class.html">qr.Q</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/qr.html">qr.default</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##            [,1]       [,2]
## [1,] -0.4472136 -0.8944272
## [2,] -0.8944272  0.4472136</code></pre>
<div class="sourceCode" id="cb2964"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/qraux.html">qr.R</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/qr.html">qr.default</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##           [,1]      [,2]
## [1,] -2.236068 -2.683282
## [2,]  0.000000  1.341641</code></pre>
<div class="sourceCode" id="cb2966"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/sparseQR-class.html">qr.Q</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/qr.html">qr.default</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">)</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/r/base/qraux.html">qr.R</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/qr.html">qr.default</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##      [,1]          [,2]
## [1,]    1 -2.220446e-16
## [2,]    2  3.000000e+00</code></pre>
<p>用 <a href="https://www.wikiwand.com/en/Householder_transformation">Householder 变换</a> 做 QR 分解 <span class="citation"><a href="#ref-Bates_1988_Nonlinear" role="doc-biblioref">[115]</a></span> 及其 R 语言实现 <a href="https://rpubs.com/aaronsc32/qr-decomposition-householder" class="uri">https://rpubs.com/aaronsc32/qr-decomposition-householder</a></p>
<p>Householder 变换是平面反射的一般情况：
要计算 <span class="math inline">\(N\times P\)</span> 维矩阵 <span class="math inline">\(X\)</span> 的 QR 分解，我们采用 Householder 变换</p>
<p><span class="math display">\[
\mathbf{H}_{u} = \mathbf{I} -2\mathbf{u}\mathbf{u}^{\top}
\]</span></p>
<p>其中 <span class="math inline">\(I\)</span> 是 <span class="math inline">\(N\times N\)</span> 维的单位矩阵，<span class="math inline">\(u\)</span> 是 <span class="math inline">\(N\)</span> 维单位向量，即 <span class="math inline">\(\| \mathbf{u}\| = \sqrt{\mathbf{u}\mathbf{u}^{\top}} = 1\)</span>。则 <span class="math inline">\(H_u\)</span> 是对称正交的，因为</p>
<p><span class="math display">\[
\mathbf{H}_{u}^{\top} = \mathbf{I}^{\top} - 2\mathbf{u}\mathbf{u}^{\top} = \mathbf{H}_{u}
\]</span></p>
<p>并且</p>
<p><span class="math display">\[
\mathbf{H}_{u}^{\top}\mathbf{H}_{u} =  \mathbf{I} -4\mathbf{u}\mathbf{u}^{\top} + 4\mathbf{u}\mathbf{u}^{\top}\mathbf{u}\mathbf{u}^{\top} = \mathbf{I}
\]</span></p>
<p>让 <span class="math inline">\(\mathbf{H}_{u}\)</span> 乘以向量 <span class="math inline">\(\mathbf{y}\)</span>，即</p>
<p><span class="math display">\[
\mathbf{H}_{u}\mathbf{y} = \mathbf{y} - 2\mathbf{u}\mathbf{u}^{\top}\mathbf{y}
\]</span></p>
<p>它是 <span class="math inline">\(y\)</span> 关于垂直于过原点的 <span class="math inline">\(u\)</span> 的直线的反射，只要</p>
<p><span class="math display" id="eq:householder-negative">\[\begin{equation}
\mathbf{u} = \frac{\mathbf{y} - \| \mathbf{y} \|\mathbf{e}_{1}}{\| \mathbf{y} - \| \mathbf{y} \|\mathbf{e}_{1}\|} \tag{B.1}
\end{equation}\]</span></p>
<p>或者</p>
<p><span class="math display" id="eq:householder-positive">\[\begin{equation}
\mathbf{u} = \frac{\mathbf{y} + \| \mathbf{y} \|\mathbf{e}_{1}}{\| \mathbf{y} + \| \mathbf{y} \|\mathbf{e}_{1}\|} \tag{B.2}
\end{equation}\]</span></p>
<p>其中 <span class="math inline">\(\mathbf{e}_{1} = (1,0,\ldots,0)^{\top}\)</span>，Householder 变换使得向量 <span class="math inline">\(y\)</span> 成为 <span class="math inline">\(x\)</span> 轴，在新的坐标系统中，向量 <span class="math inline">\(H_{u}y\)</span> 的坐标为 <span class="math inline">\((\pm\|y\|, 0, \ldots, 0)^\top\)</span></p>
<p>举个例子</p>
<p>借助 Householder 变换做 QR 分解的优势：</p>
<ol style="list-style-type: decimal">
<li>更快、数值更稳定比直接构造 Q，特别当 N 大于 P 的时候</li>
<li>相比于存储矩阵 Q 的 <span class="math inline">\(N^2\)</span> 个元素，Householder 变换只存储 P 个向量 <span class="math inline">\(u_1,\ldots,u_P\)</span>
</li>
<li>QR 分解的真实实现，比如在 LINPACK 中，定义 <span class="math inline">\(u\)</span> 的时候，公式 <a href="chap-matrix-operations.html#eq:householder-negative">(B.1)</a> 或 <a href="chap-matrix-operations.html#eq:householder-positive">(B.2)</a> 的选择基于<span class="math inline">\(y\)</span>的第一个坐标的符号。如果坐标是负的，使用公式<a href="chap-matrix-operations.html#eq:householder-negative">(B.1)</a>，如果是正的，使用公式 <a href="chap-matrix-operations.html#eq:householder-positive">(B.2)</a>， 这个做法可以使得数值计算更加稳定。</li>
</ol>
<p>Stan 实现的 QR 分解在贝叶斯线性回归模型中的应用<a href="references.html#fn84" class="footnote-ref" id="fnref84"><sup>84</sup></a></p>
</div>
<div id="subsec-jordan-Decomposition" class="section level2" number="40.26">
<h2>
<span class="header-section-number">B.26</span> Jordan 分解<a class="anchor" aria-label="anchor" href="#subsec-jordan-Decomposition"><i class="fas fa-link"></i></a>
</h2>
</div>
<div id="subsec-Givens-Rotation" class="section level2" number="40.27">
<h2>
<span class="header-section-number">B.27</span> Givens 旋转<a class="anchor" aria-label="anchor" href="#subsec-Givens-Rotation"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><p>Givens 旋转 <a href="https://www.wikiwand.com/en/Givens_rotation" class="uri">https://www.wikiwand.com/en/Givens_rotation</a></p></li>
<li><p>帽子矩阵在统计中的应用 回归与方差分析 <span class="citation"><a href="#ref-David_1978_Hat" role="doc-biblioref">[116]</a></span></p></li>
</ul>
</div>
<div id="sec-special-functions" class="section level2" number="40.28">
<h2>
<span class="header-section-number">B.28</span> 特殊函数<a class="anchor" aria-label="anchor" href="#sec-special-functions"><i class="fas fa-link"></i></a>
</h2>
<div id="factorial" class="section level3" number="40.28.1">
<h3>
<span class="header-section-number">B.28.1</span> 阶乘<a class="anchor" aria-label="anchor" href="#factorial"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>阶乘 <span class="math inline">\(n! = 1\times 2\times 3\cdots n\)</span>
</li>
<li>双阶乘 <span class="math inline">\((2n+1)!! = 1 \times 3\times 5 \times \cdots \times (2n+1), n = 0,1,2,\cdots\)</span>
</li>
</ul>
<div class="sourceCode" id="cb2968"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span> <span class="co"># 阶乘</span></code></pre></div>
<pre><code>## [1] 120</code></pre>
<div class="sourceCode" id="cb2970"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="fl">5</span>, length.out <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1 3 5</code></pre>
<div class="sourceCode" id="cb2972"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/prod.html">prod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="fl">5</span>, length.out <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="co"># 连乘 双阶乘</span></code></pre></div>
<pre><code>## [1] 15</code></pre>
<div class="sourceCode" id="cb2974"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1 2 3 4 5</code></pre>
<div class="sourceCode" id="cb2976"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumprod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="co"># 累积</span></code></pre></div>
<pre><code>## [1]   1   2   6  24 120</code></pre>
<div class="sourceCode" id="cb2978"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="co"># 累和</span></code></pre></div>
<pre><code>## [1]  1  3  6 10 15</code></pre>
<p>此外还有 <code>cummax</code> 和 <code>cummin</code></p>
<ul>
<li>组合数 <span class="math inline">\(C_{n}^{k} = \frac{n(n-1)…(n-k+1)}{k!}\)</span>
</li>
</ul>
<p><span class="math inline">\(C_{5}^{3} = \frac{5 \times 4 \times 3}{3 \times 2 \times 1}\)</span></p>
<div class="sourceCode" id="cb2980"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Special.html">choose</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<blockquote>
<p>斯特林公式</p>
</blockquote>
</div>
<div id="gamma" class="section level3" number="40.28.2">
<h3>
<span class="header-section-number">B.28.2</span> 伽马函数<a class="anchor" aria-label="anchor" href="#gamma"><i class="fas fa-link"></i></a>
</h3>
<p><span class="math inline">\(\Gamma(x) = \int_{0}^{\infty} t^{x-1}\exp(-t)dt\)</span>
<span class="math inline">\(\Gamma(n) = (n-1)!, n \in \mathbb{Z}^{+}\)</span></p>
<div class="sourceCode" id="cb2982"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Special.html">gamma</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb2984"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Special.html">gamma</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 362880</code></pre>
<div class="sourceCode" id="cb2986"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gamma2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>,<span class="va">x</span><span class="op">)</span><span class="op">{</span>
  <span class="va">t</span><span class="op">^</span><span class="op">(</span><span class="va">x</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">t</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/stats/integrate.html">integrate</a></span><span class="op">(</span><span class="va">gamma2</span>, lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="op">+</span> <span class="cn">Inf</span>, x <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<pre><code>## 362880 with absolute error &lt; 0.025</code></pre>
<ul>
<li>psigamma(x, deriv) 表示 <span class="math inline">\(\psi(x)\)</span> 的 <code>deriv</code> 阶导数</li>
</ul>
<p><span class="math inline">\(\mathrm{digamma}(x) \triangleq \psi(x) = \frac{d}{dx}{\ln \Gamma(x)} = \Gamma'(x) / \Gamma(x)\)</span></p>
<div class="sourceCode" id="cb2988"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 例1</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">2</span>
<span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/deriv.html">deriv</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Special.html">gamma</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"x"</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Special.html">gamma</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1
## attr(,"gradient")
##              x
## [1,] 0.4227843</code></pre>
<div class="sourceCode" id="cb2990"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 与此等价</span>
<span class="fu"><a href="https://rdrr.io/r/base/Special.html">psigamma</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.4227843</code></pre>
<div class="sourceCode" id="cb2992"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Special.html">digamma</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># psi(x) 的一阶导数</span></code></pre></div>
<pre><code>## [1] 0.4227843</code></pre>
<div class="sourceCode" id="cb2994"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Special.html">trigamma</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># psi(x) 的二阶导数</span></code></pre></div>
<pre><code>## [1] 0.6449341</code></pre>
<div class="sourceCode" id="cb2996"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 例2</span>
<span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/deriv.html">deriv</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Special.html">psigamma</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"x"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.6449341
## attr(,"gradient")
##               x
## [1,] -0.4041138</code></pre>
<div class="sourceCode" id="cb2998"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 与此等价</span>
<span class="fu"><a href="https://rdrr.io/r/base/Special.html">psigamma</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] -0.4041138</code></pre>
<div class="sourceCode" id="cb3000"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 注意与下面这个例子比较</span>
<span class="va">dx2x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/deriv.html">deriv</a></span><span class="op">(</span><span class="op">~</span> <span class="va">x</span><span class="op">^</span><span class="fl">3</span>, <span class="st">"x"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="va">dx2x</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 8
## attr(,"gradient")
##       x
## [1,] 12</code></pre>
</div>
<div id="beta" class="section level3" number="40.28.3">
<h3>
<span class="header-section-number">B.28.3</span> 贝塔函数<a class="anchor" aria-label="anchor" href="#beta"><i class="fas fa-link"></i></a>
</h3>
<p><span class="math inline">\(B(a,b) = \Gamma(a)\Gamma(b)/\Gamma(a+b) = \int_{0}^{1} t^{a-1} (1-t)^{b-1} dt\)</span></p>
<div class="sourceCode" id="cb3002"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Special.html">beta</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb3004"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Special.html">beta</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.08333333</code></pre>
<div class="sourceCode" id="cb3006"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">beta2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">t</span><span class="op">^</span><span class="op">(</span><span class="va">a</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">t</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="va">b</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/stats/integrate.html">integrate</a></span><span class="op">(</span><span class="va">beta2</span>, lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="fl">1</span>, a <span class="op">=</span> <span class="fl">2</span>, b <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>## 0.08333333 with absolute error &lt; 9.3e-16</code></pre>
</div>
<div id="bessel" class="section level3" number="40.28.4">
<h3>
<span class="header-section-number">B.28.4</span> 贝塞尔函数<a class="anchor" aria-label="anchor" href="#bessel"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb3008"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Bessel.html">besselI</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">nu</span>, expon.scaled <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># 修正的第一类</span>
<span class="fu"><a href="https://rdrr.io/r/base/Bessel.html">besselK</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">nu</span>, expon.scaled <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># 修正的第二类</span>
<span class="fu"><a href="https://rdrr.io/r/base/Bessel.html">besselJ</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">nu</span><span class="op">)</span> <span class="co"># 第一类</span>
<span class="fu"><a href="https://rdrr.io/r/base/Bessel.html">besselY</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">nu</span><span class="op">)</span> <span class="co"># 第二类</span></code></pre></div>
<ul>
<li>
<span class="math inline">\(\nu\)</span> 贝塞尔函数的阶，可以是分数</li>
<li>expon.scaled 是否使用指数表示</li>
</ul>
<div class="sourceCode" id="cb3009"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span>, length.out <span class="op">=</span> <span class="fl">501</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">x</span>,
  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">""</span>, type <span class="op">=</span> <span class="st">"n"</span>,
  main <span class="op">=</span> <span class="st">"Bessel Functions  I_nu(x)"</span>
<span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">nu</span> <span class="kw">in</span> <span class="va">nus</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/Bessel.html">besselI</a></span><span class="op">(</span><span class="va">x</span>, nu <span class="op">=</span> <span class="va">nu</span><span class="op">)</span>, col <span class="op">=</span> <span class="va">nu</span> <span class="op">+</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"nu="</span>, <span class="va">nus</span><span class="op">)</span>, col <span class="op">=</span> <span class="va">nus</span> <span class="op">+</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="matrix-operations_files/figure-html/modified-bessel-1.png" width="672" style="display: block; margin: auto;"></div>
<p>介绍复数矩阵的计算，矩阵的指数计算，介绍一点分形</p>
<div class="sourceCode" id="cb3010"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 考虑用 gganimate 实现，去掉 caTools 依赖</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">caTools</span><span class="op">)</span>
<span class="va">jet.colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span>
  <span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"cyan"</span>, <span class="st">"#7FFF7F"</span>,
  <span class="st">"yellow"</span>, <span class="st">"#FF7F00"</span>, <span class="st">"red"</span>, <span class="st">"#7F0000"</span>
<span class="op">)</span><span class="op">)</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">1000</span> <span class="co"># define size</span>
<span class="va">C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/complex.html">complex</a></span><span class="op">(</span>
  real <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.8</span>, <span class="fl">0.6</span>, length.out <span class="op">=</span> <span class="va">m</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">m</span><span class="op">)</span>,
  imag <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">1.2</span>, length.out <span class="op">=</span> <span class="va">m</span><span class="op">)</span>, <span class="va">m</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">C</span>, <span class="va">m</span>, <span class="va">m</span><span class="op">)</span> <span class="co"># reshape as square matrix of complex numbers</span>
<span class="va">Z</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># initialize Z to zero</span>
<span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">m</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span> <span class="co"># initialize output 3D array</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span> <span class="op">{</span> <span class="co"># loop with 20 iterations</span>
  <span class="va">Z</span> <span class="op">&lt;-</span> <span class="va">Z</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">C</span> <span class="co"># the central difference equation</span>
  <span class="va">X</span><span class="op">[</span>, , <span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span><span class="op">)</span> <span class="co"># capture results</span>
<span class="op">}</span>
<span class="fu">write.gif</span><span class="op">(</span><span class="va">X</span>, <span class="st">"Mandelbrot.gif"</span>, col <span class="op">=</span> <span class="va">jet.colors</span>, delay <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></code></pre></div>

</div>
</div>
</div>
<h3>参考文献</h3>
<div id="refs" class="references csl-bib-body">
<div id="ref-Denton_2019_Eigen" class="csl-entry">
<div class="csl-left-margin">[113] </div>
<div class="csl-right-inline">P. B. Denton, S. J. Parke, T. Tao, and X. Zhang, <span>“Eigenvectors from eigenvalues,”</span> 2019,Available: <a href="https://arxiv.org/pdf/1908.03795.pdf">https://arxiv.org/pdf/1908.03795.pdf</a>
</div>
</div>
<div id="ref-Boyd_2018_matrix" class="csl-entry">
<div class="csl-left-margin">[114] </div>
<div class="csl-right-inline">S. Boyd and L. Vandenberghe, <em>Introduction to applied linear algebra: Vectors, matrices, and least squares</em>. New York, NY: Cambridge University Press, 2018.Available: <a href="https://web.stanford.edu/~boyd/vmls/vmls.pdf">https://web.stanford.edu/~boyd/vmls/vmls.pdf</a>
</div>
</div>
<div id="ref-Bates_1988_Nonlinear" class="csl-entry">
<div class="csl-left-margin">[115] </div>
<div class="csl-right-inline">D. M. Bates and D. G. Watts, <em>Nonlinear regression analysis and its applications</em>. New York, NY: John Wiley &amp; Sons, 1988.Available: <a href="https://doi.org/10.1002/9780470316757.app2">https://doi.org/10.1002/9780470316757.app2</a>
</div>
</div>
<div id="ref-David_1978_Hat" class="csl-entry">
<div class="csl-left-margin">[116] </div>
<div class="csl-right-inline">D. C. Hoaglin and R. E. Welsch, <span>“The hat matrix in regression and ANOVA,”</span> <em>The American Statistician</em>, vol. 32, no. 1, pp. 17–22, 1978,Available: <a href="https://www.jstor.org/stable/2683469">https://www.jstor.org/stable/2683469</a>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="chap-linux-command-bash.html"><span class="header-section-number">A</span> 命令行操作</a></div>
<div class="next"><a href="chap-symbolic-computation.html"><span class="header-section-number">C</span> 符号计算</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#chap-matrix-operations"><span class="header-section-number">B</span> 矩阵运算</a></li>
<li><a class="nav-link" href="#subsec-matrix-multiplication"><span class="header-section-number">B.1</span> 矩阵乘法</a></li>
<li><a class="nav-link" href="#subsec-hadamard-product"><span class="header-section-number">B.2</span> Hadamard 积</a></li>
<li><a class="nav-link" href="#subsec-matrix-transpose"><span class="header-section-number">B.3</span> 矩阵转置</a></li>
<li><a class="nav-link" href="#subsec-outer-product"><span class="header-section-number">B.4</span> 矩阵外积</a></li>
<li><a class="nav-link" href="#subsec-matrix-exp"><span class="header-section-number">B.5</span> 矩阵乘方</a></li>
<li><a class="nav-link" href="#subsec-matrix-power"><span class="header-section-number">B.6</span> 矩阵求幂</a></li>
<li><a class="nav-link" href="#subsec-matrix-crossproduct"><span class="header-section-number">B.7</span> 矩阵交叉积</a></li>
<li><a class="nav-link" href="#subsec-matrix-determinant"><span class="header-section-number">B.8</span> 矩阵行列式</a></li>
<li><a class="nav-link" href="#subsec-matrix-cond-num"><span class="header-section-number">B.9</span> 矩阵条件数</a></li>
<li><a class="nav-link" href="#subsec-matrix-inverse"><span class="header-section-number">B.10</span> 矩阵求逆</a></li>
<li><a class="nav-link" href="#subsec-matrix-adjoint"><span class="header-section-number">B.11</span> 矩阵伴随</a></li>
<li><a class="nav-link" href="#subsec-matrix-norm"><span class="header-section-number">B.12</span> 矩阵范数</a></li>
<li><a class="nav-link" href="#subsec-matrix-rank"><span class="header-section-number">B.13</span> 矩阵求秩</a></li>
<li><a class="nav-link" href="#subsec-matrix-trace"><span class="header-section-number">B.14</span> 矩阵求迹</a></li>
<li><a class="nav-link" href="#subsec-identity-matrix"><span class="header-section-number">B.15</span> 单位矩阵</a></li>
<li><a class="nav-link" href="#subsec-matrix-diagonals"><span class="header-section-number">B.16</span> 对角矩阵</a></li>
<li><a class="nav-link" href="#subsec-upper-matrix"><span class="header-section-number">B.17</span> 上/下三角矩阵</a></li>
<li><a class="nav-link" href="#subsec-sparse-matrix"><span class="header-section-number">B.18</span> 稀疏矩阵</a></li>
<li><a class="nav-link" href="#subsec-triangular-matrix"><span class="header-section-number">B.19</span> 三对角矩阵</a></li>
<li><a class="nav-link" href="#subsec-lu-decomposition"><span class="header-section-number">B.20</span> LU 分解</a></li>
<li><a class="nav-link" href="#subsec-schur-decomposition"><span class="header-section-number">B.21</span> Schur 分解</a></li>
<li><a class="nav-link" href="#subsec-choleski-decomposition"><span class="header-section-number">B.22</span> Cholesky 分解</a></li>
<li><a class="nav-link" href="#subsec-eigenvalues-decomposition"><span class="header-section-number">B.23</span> 特征值分解</a></li>
<li><a class="nav-link" href="#subsec-Singular-Value-Decomposition"><span class="header-section-number">B.24</span> SVD 分解</a></li>
<li><a class="nav-link" href="#subsec-QR-Decomposition"><span class="header-section-number">B.25</span> QR 分解</a></li>
<li><a class="nav-link" href="#subsec-jordan-Decomposition"><span class="header-section-number">B.26</span> Jordan 分解</a></li>
<li><a class="nav-link" href="#subsec-Givens-Rotation"><span class="header-section-number">B.27</span> Givens 旋转</a></li>
<li>
<a class="nav-link" href="#sec-special-functions"><span class="header-section-number">B.28</span> 特殊函数</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#factorial"><span class="header-section-number">B.28.1</span> 阶乘</a></li>
<li><a class="nav-link" href="#gamma"><span class="header-section-number">B.28.2</span> 伽马函数</a></li>
<li><a class="nav-link" href="#beta"><span class="header-section-number">B.28.3</span> 贝塔函数</a></li>
<li><a class="nav-link" href="#bessel"><span class="header-section-number">B.28.4</span> 贝塞尔函数</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/XiangyunHuang/masr/blob/devel/matrix-operations.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/XiangyunHuang/masr/edit/devel/matrix-operations.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>现代应用统计与 R 语言</strong>: Modern Applied Statistics with R" was written by 黄湘云. It was last built on 2021-12-04.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
