<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>附录 B 矩阵运算 | 现代应用统计与 R 语言</title>

    <meta name="author" content="黄湘云" />
  
   <meta name="description" content="线性模型理论及其应用，注意模型的适用范围、参数估计方法、模型检验和诊断，理论和应用并重，同时附以真实的案例分析。将线性模型、广义线性模型、广义可加模型、线性混合效应模型、广义线性混合效应模型和广义可加混合效应模型融合到同一框架下。应用层面，要考虑数据集的平衡问题、缺失问题和异常问题。应用场景包括环境污染、流行病学和风险控制等领域。" />
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="附录 B 矩阵运算 | 现代应用统计与 R 语言" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/images/cover.png" />
  <meta property="og:description" content="线性模型理论及其应用，注意模型的适用范围、参数估计方法、模型检验和诊断，理论和应用并重，同时附以真实的案例分析。将线性模型、广义线性模型、广义可加模型、线性混合效应模型、广义线性混合效应模型和广义可加混合效应模型融合到同一框架下。应用层面，要考虑数据集的平衡问题、缺失问题和异常问题。应用场景包括环境污染、流行病学和风险控制等领域。" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="附录 B 矩阵运算 | 现代应用统计与 R 语言" />
  
  <meta name="twitter:description" content="线性模型理论及其应用，注意模型的适用范围、参数估计方法、模型检验和诊断，理论和应用并重，同时附以真实的案例分析。将线性模型、广义线性模型、广义可加模型、线性混合效应模型、广义线性混合效应模型和广义可加混合效应模型融合到同一框架下。应用层面，要考虑数据集的平衡问题、缺失问题和异常问题。应用场景包括环境污染、流行病学和风险控制等领域。" />
  <meta name="twitter:image" content="/images/cover.png" />
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/jquery/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat/transition.js"></script>
    <script src="libs/bs3compat/tabs.js"></script>
    <script src="libs/bs3compat/bs3compat.js"></script>
    <link href="libs/bs4_book/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book/bs4_book.js"></script>
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/plotly-binding/plotly.js"></script>
    <script src="libs/typedarray/typedarray.min.js"></script>
    <link href="libs/crosstalk/css/crosstalk.min.css" rel="stylesheet" />
    <script src="libs/crosstalk/js/crosstalk.min.js"></script>
    <link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="libs/plotly-main/plotly-latest.min.js"></script>
    <script src="libs/plotly-locale-zh-CN/zh-cn.js"></script>
    <script src="libs/mathjax/cdn.js"></script>
    <link href="libs/dygraphs/dygraph.css" rel="stylesheet" />
    <script src="libs/dygraphs/dygraph-combined.js"></script>
    <script src="libs/dygraphs/shapes.js"></script>
    <script src="libs/moment/moment.js"></script>
    <script src="libs/moment-timezone/moment-timezone-with-data.js"></script>
    <script src="libs/moment-fquarter/moment-fquarter.min.js"></script>
    <script src="libs/dygraphs-binding/dygraphs.js"></script>
    <script src="libs/Dygraph.Plugins.Unzoom/unzoom.js"></script>
    <script src="libs/echarts4r/echarts-en.min.js"></script>
    <script src="libs/echarts4r/ecStat.min.js"></script>
    <script src="libs/echarts4r/dataTool.min.js"></script>
    <script src="libs/echarts4r-binding/echarts4r.js"></script>
    <script src="libs/d3/d3.min.js"></script>
    <script src="libs/forceNetwork-binding/forceNetwork.js"></script>
    <link href="libs/vis/vis-network.min.css" rel="stylesheet" />
    <script src="libs/vis/vis-network.min.js"></script>
    <script src="libs/visNetwork-binding/visNetwork.js"></script>
    <script src="libs/FileSaver/FileSaver.min.js"></script>
    <script src="libs/Blob/Blob.js"></script>
    <script src="libs/canvas-toBlob/canvas-toBlob.js"></script>
    <script src="libs/html2canvas/html2canvas.js"></script>
    <script src="libs/jspdf/jspdf.debug.js"></script>
    <link href="libs/jquery-sparkline/jquery.sparkline.css" rel="stylesheet" />
    <script src="libs/jquery-sparkline/jquery.sparkline.js"></script>
    <script src="libs/sparkline-binding/sparkline.js"></script>
    <script src="libs/r2d3-render/r2d3-render.js"></script>
    <script src="libs/webcomponents/webcomponents.js"></script>
    <script src="libs/r2d3-binding/r2d3.js"></script>
    <script src="libs/d3v6/d3.min.js"></script>
    <script src="libs/es6shim/es6shim.js"></script>
    <script src="libs/es7shim/es7shim.js"></script>
    <script src="libs/graphre/graphre.js"></script>
    <script src="libs/nomnoml/nomnoml.js"></script>
    <script src="libs/nomnoml-binding/nomnoml.js"></script>
    <script src="libs/d3-bundle/d3-bundle.min.js"></script>
    <script src="libs/d3-lasso/d3-lasso.min.js"></script>
    <script src="libs/save-svg-as-png/save-svg-as-png.min.js"></script>
    <link href="libs/ggiraphjs/ggiraphjs.min.css" rel="stylesheet" />
    <script src="libs/ggiraphjs/ggiraphjs.min.js"></script>
    <script src="libs/girafe-binding/girafe.js"></script>
    <link href="libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding/datatables.js"></script>
    <link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core/js/jquery.dataTables.min.js"></script>
    <script src="libs/jszip/jszip.min.js"></script>
    <script src="libs/pdfmake/pdfmake.js"></script>
    <script src="libs/pdfmake/vfs_fonts.js"></script>
    <link href="libs/dt-ext-buttons/css/buttons.dataTables.min.css" rel="stylesheet" />
    <script src="libs/dt-ext-buttons/js/dataTables.buttons.min.js"></script>
    <script src="libs/dt-ext-buttons/js/buttons.html5.min.js"></script>
    <script src="libs/dt-ext-buttons/js/buttons.colVis.min.js"></script>
    <script src="libs/dt-ext-buttons/js/buttons.print.min.js"></script>
    <link href="libs/dt-ext-rowgroup/css/rowGroup.dataTables.min.css" rel="stylesheet" />
    <script src="libs/dt-ext-rowgroup/js/dataTables.rowGroup.min.js"></script>
    <script src="libs/kePrint/kePrint.js"></script>
    <link href="libs/lightable/lightable.css" rel="stylesheet" />
    <script src="libs/echarts-world/world.js"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-54GQKWF7VP"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-54GQKWF7VP');
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
  <style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
    <style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
      <link rel="stylesheet" href="style.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Modern Applied Statistics with R">现代应用统计与 R 语言</a>:
        <small class="text-muted">Modern Applied Statistics with R</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<div id="chap-matrix-operations" class="section level1" number="38">
<h1><span class="header-section-number">附录 B</span> 矩阵运算</h1>
<!-- 介绍矩阵代数内容：各类矩阵分解及其几何解释，比如矩阵行列式 -->
<blockquote>
<p>Eigenvectors from Eigenvalues <span class="citation"><a href="#ref-Denton_2019_Eigen" role="doc-biblioref">[103]</a></span></p>
</blockquote>
<blockquote>
<p>参考 <a href="https://github.com/friendly/matlib">matlib</a> 和 Matrix 包，<a href="https://CRAN.R-project.org/package=SparseM">SparseM</a> 更加强调稀疏矩阵的 Cholesky 分解和后退法，矩阵取子集和 Kronecker 积。矩阵计算一般介绍参考在线书籍 Stephen Boyd and Lieven Vandenberghe 最新著作 Introduction to Applied Linear Algebra – Vectors, Matrices, and Least Squares <span class="citation"><a href="#ref-Boyd_2018_matrix" role="doc-biblioref">[104]</a></span> 及其 <a href="https://web.stanford.edu/~boyd/vmls/vmls-julia-companion.pdf">Julia 语言实现</a>，矩阵分解部分参考 <a href="http://math.mit.edu/~gs/linearalgebra/linearalgebra5_Matrix.pdf">Introduction to Linear Algebra, 5th Edition</a>、<a href="https://shainarace.github.io/LinearAlgebra">Linear Algebra for Data Science with examples in R</a></p>
</blockquote>
<p><a href="https://github.com/faosorios/fastmatrix">fastmatrix</a>、<a href="https://cran.r-project.org/package=abind">abind</a> 各种矩阵操作。</p>
<p><a href="https://web.evanchen.cc/">Evan Chen</a> 的书<a href="https://github.com/vEnhance/napkin">An Infinitely Large Napkin</a> 介绍矩阵代数的内积空间、群、环、域等高级内容，作者提供免费的电子书。</p>
<!-- 解释基本的矩阵概念，比如秩、迹、行列式、直积等 -->
<p>分块矩阵操作，各类分解算法，及其 R 实现</p>
<div class="sourceCode" id="cb2730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2730-1"><a href="chap-matrix-operations.html#cb2730-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Matrix)</span></code></pre></div>
<p>以 attitude 数据集为例介绍各种矩阵操作</p>
<div class="sourceCode" id="cb2731"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2731-1"><a href="chap-matrix-operations.html#cb2731-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(attitude)</span></code></pre></div>
<pre><code>##   rating complaints privileges learning raises critical advance
## 1     43         51         30       39     61       92      45
## 2     63         64         51       54     63       73      47
## 3     71         70         68       69     76       86      48
## 4     61         63         45       47     54       84      35
## 5     81         78         56       66     71       83      47
## 6     43         55         49       44     54       49      34</code></pre>
<p>rating 总体评价
complaints 处理员工投诉
privileges 不允许特权
learning 学习机会
raises 根据表现晋升
critical 批评
advancel 进步</p>
<div class="sourceCode" id="cb2733"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2733-1"><a href="chap-matrix-operations.html#cb2733-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(rating <span class="sc">~</span>. , <span class="at">data =</span> attitude)</span>
<span id="cb2733-2"><a href="chap-matrix-operations.html#cb2733-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit) <span class="co"># 模型是显著的，很多变量的系数不显著</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = rating ~ ., data = attitude)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.9418  -4.3555   0.3158   5.5425  11.5990 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 10.78708   11.58926   0.931 0.361634    
## complaints   0.61319    0.16098   3.809 0.000903 ***
## privileges  -0.07305    0.13572  -0.538 0.595594    
## learning     0.32033    0.16852   1.901 0.069925 .  
## raises       0.08173    0.22148   0.369 0.715480    
## critical     0.03838    0.14700   0.261 0.796334    
## advance     -0.21706    0.17821  -1.218 0.235577    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 7.068 on 23 degrees of freedom
## Multiple R-squared:  0.7326, Adjusted R-squared:  0.6628 
## F-statistic:  10.5 on 6 and 23 DF,  p-value: 1.24e-05</code></pre>
<div class="sourceCode" id="cb2735"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2735-1"><a href="chap-matrix-operations.html#cb2735-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: rating
##            Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
## complaints  1 2927.58 2927.58 58.6026 9.056e-08 ***
## privileges  1    7.52    7.52  0.1505    0.7016    
## learning    1  137.25  137.25  2.7473    0.1110    
## raises      1    0.94    0.94  0.0189    0.8920    
## critical    1    0.56    0.56  0.0113    0.9163    
## advance     1   74.11   74.11  1.4835    0.2356    
## Residuals  23 1149.00   49.96                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<!-- 矩阵变换对应的几何意义，和实际数据对应的意义 -->
<div class="sourceCode" id="cb2737"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2737-1"><a href="chap-matrix-operations.html#cb2737-1" aria-hidden="true" tabindex="-1"></a>attitude_mat <span class="ot">&lt;-</span> <span class="fu">as.matrix.data.frame</span>(attitude)</span>
<span id="cb2737-2"><a href="chap-matrix-operations.html#cb2737-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 生成演示用的矩阵</span></span>
<span id="cb2737-3"><a href="chap-matrix-operations.html#cb2737-3" aria-hidden="true" tabindex="-1"></a>demo_mat <span class="ot">&lt;-</span> <span class="fu">t</span>(attitude_mat[, <span class="sc">-</span><span class="dv">1</span>]) <span class="sc">%*%</span> attitude_mat[, <span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div>
<div id="subsec-matrix-multiplication" class="section level2" number="38.1">
<h2><span class="header-section-number">B.1</span> 矩阵乘法</h2>
<div class="sourceCode" id="cb2738"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2738-1"><a href="chap-matrix-operations.html#cb2738-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb2738-2"><a href="chap-matrix-operations.html#cb2738-2" aria-hidden="true" tabindex="-1"></a>A</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    2
## [2,]    2    3</code></pre>
<div class="sourceCode" id="cb2740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2740-1"><a href="chap-matrix-operations.html#cb2740-1" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>), <span class="at">nrow =</span><span class="dv">2</span>)</span>
<span id="cb2740-2"><a href="chap-matrix-operations.html#cb2740-2" aria-hidden="true" tabindex="-1"></a>B</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    3    5
## [2,]    2    4    6</code></pre>
<p>通常的矩阵乘法也叫矩阵内积</p>
<div class="sourceCode" id="cb2742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2742-1"><a href="chap-matrix-operations.html#cb2742-1" aria-hidden="true" tabindex="-1"></a>A <span class="sc">%*%</span> B</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    5   11   17
## [2,]    8   18   28</code></pre>
<div class="sourceCode" id="cb2744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2744-1"><a href="chap-matrix-operations.html#cb2744-1" aria-hidden="true" tabindex="-1"></a>A <span class="sc">**</span> <span class="dv">2</span></span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    4
## [2,]    4    9</code></pre>
<div class="sourceCode" id="cb2746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2746-1"><a href="chap-matrix-operations.html#cb2746-1" aria-hidden="true" tabindex="-1"></a>A <span class="sc">^</span> <span class="dv">2</span></span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    4
## [2,]    4    9</code></pre>
<div class="sourceCode" id="cb2748"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2748-1"><a href="chap-matrix-operations.html#cb2748-1" aria-hidden="true" tabindex="-1"></a>A <span class="sc">**</span> A</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    4
## [2,]    4   27</code></pre>
</div>
<div id="subsec-hadamard-product" class="section level2" number="38.2">
<h2><span class="header-section-number">B.2</span> Hadamard 积</h2>
<p>Hadamard 积（法国数学家 Jacques Hadamard）也叫 Schur 积（德国数学家Issai Schur ）或 entrywise 积是两个维数相同的矩阵对应元素相乘，特别地，<span class="math inline">\(A^2\)</span> 表示将矩阵 <span class="math inline">\(A\)</span> 的每个元素平方</p>
<p><span class="math display">\[
(A\circ B)_{ij} = (A)_{ij}(B)_{ij}
\]</span></p>
<p><span class="math display">\[
\begin{bmatrix}
 a_{11} &amp; a_{12}  &amp; a_{13} \\ 
 a_{21} &amp; a_{22}  &amp; a_{23} \\ 
 a_{31} &amp; a_{32}  &amp; a_{33} 
\end{bmatrix}
\circ
\begin{bmatrix}
 b_{11} &amp; b_{12}  &amp; b_{13} \\ 
 b_{21} &amp; b_{22}  &amp; b_{23} \\ 
 b_{31} &amp; b_{32}  &amp; b_{33} 
\end{bmatrix}
= 
\begin{bmatrix}
 a_{11}b_{11} &amp; a_{12}b_{12}  &amp; a_{13}b_{13} \\ 
 a_{21}b_{21} &amp; a_{22}b_{22}  &amp; a_{23}b_{23} \\ 
 a_{31}b_{31} &amp; a_{32}b_{32}  &amp; a_{33}b_{33} 
\end{bmatrix}
\]</span></p>
<div class="sourceCode" id="cb2750"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2750-1"><a href="chap-matrix-operations.html#cb2750-1" aria-hidden="true" tabindex="-1"></a>A<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    4
## [2,]    4    9</code></pre>
</div>
<div id="subsec-matrix-transpose" class="section level2" number="38.3">
<h2><span class="header-section-number">B.3</span> 矩阵转置</h2>
<div class="sourceCode" id="cb2752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2752-1"><a href="chap-matrix-operations.html#cb2752-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(B)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    2
## [2,]    3    4
## [3,]    5    6</code></pre>
</div>
<div id="subsec-outer-product" class="section level2" number="38.4">
<h2><span class="header-section-number">B.4</span> 矩阵外积</h2>
<div class="sourceCode" id="cb2754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2754-1"><a href="chap-matrix-operations.html#cb2754-1" aria-hidden="true" tabindex="-1"></a>A <span class="sc">%o%</span> B <span class="co"># outer(A, B, FUN = &quot;*&quot;)</span></span></code></pre></div>
<pre><code>## , , 1, 1
## 
##      [,1] [,2]
## [1,]    1    2
## [2,]    2    3
## 
## , , 2, 1
## 
##      [,1] [,2]
## [1,]    2    4
## [2,]    4    6
## 
## , , 1, 2
## 
##      [,1] [,2]
## [1,]    3    6
## [2,]    6    9
## 
## , , 2, 2
## 
##      [,1] [,2]
## [1,]    4    8
## [2,]    8   12
## 
## , , 1, 3
## 
##      [,1] [,2]
## [1,]    5   10
## [2,]   10   15
## 
## , , 2, 3
## 
##      [,1] [,2]
## [1,]    6   12
## [2,]   12   18</code></pre>
<p>直积/克罗内克积</p>
<div class="sourceCode" id="cb2756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2756-1"><a href="chap-matrix-operations.html#cb2756-1" aria-hidden="true" tabindex="-1"></a>A <span class="sc">%x%</span> B <span class="co"># kronecker(A, B, FUN = &quot;*&quot;)</span></span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6]
## [1,]    1    3    5    2    6   10
## [2,]    2    4    6    4    8   12
## [3,]    2    6   10    3    9   15
## [4,]    4    8   12    6   12   18</code></pre>
</div>
<div id="subsec-matrix-exp" class="section level2" number="38.5">
<h2><span class="header-section-number">B.5</span> 矩阵乘方</h2>
<p>矩阵 A 首先是一个方阵，对称性和正定性未知，n 个 矩阵 A 相乘</p>
<p>统计之都论坛讨论如何求矩阵的乘方 <a href="https://d.cosx.org/d/5619-svd" class="uri">https://d.cosx.org/d/5619-svd</a></p>
<div class="sourceCode" id="cb2758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2758-1"><a href="chap-matrix-operations.html#cb2758-1" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;%^%&quot;</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(mat, pow) {</span>
<span id="cb2758-2"><a href="chap-matrix-operations.html#cb2758-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.matrix</span>(mat)) mat <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(mat)</span>
<span id="cb2758-3"><a href="chap-matrix-operations.html#cb2758-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="sc">!</span><span class="fu">diff</span>(<span class="fu">dim</span>(mat)))</span>
<span id="cb2758-4"><a href="chap-matrix-operations.html#cb2758-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (pow <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb2758-5"><a href="chap-matrix-operations.html#cb2758-5" aria-hidden="true" tabindex="-1"></a>    pow <span class="ot">&lt;-</span> <span class="sc">-</span>pow</span>
<span id="cb2758-6"><a href="chap-matrix-operations.html#cb2758-6" aria-hidden="true" tabindex="-1"></a>    mat <span class="ot">&lt;-</span> <span class="fu">solve</span>(mat)</span>
<span id="cb2758-7"><a href="chap-matrix-operations.html#cb2758-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2758-8"><a href="chap-matrix-operations.html#cb2758-8" aria-hidden="true" tabindex="-1"></a>  pow <span class="ot">&lt;-</span> <span class="fu">round</span>(pow)</span>
<span id="cb2758-9"><a href="chap-matrix-operations.html#cb2758-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">switch</span>(pow <span class="sc">+</span> <span class="dv">1</span>, <span class="fu">return</span>(<span class="fu">diag</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(mat))), <span class="fu">return</span>(mat))</span>
<span id="cb2758-10"><a href="chap-matrix-operations.html#cb2758-10" aria-hidden="true" tabindex="-1"></a>  get.exponents <span class="ot">&lt;-</span> <span class="cf">function</span>(pow)</span>
<span id="cb2758-11"><a href="chap-matrix-operations.html#cb2758-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (pow <span class="sc">==</span> <span class="dv">0</span>) <span class="cn">NULL</span> <span class="cf">else</span> <span class="fu">c</span>(k <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">^</span><span class="fu">floor</span>(<span class="fu">log2</span>(pow)), <span class="fu">get.exponents</span>(pow <span class="sc">-</span> k))</span>
<span id="cb2758-12"><a href="chap-matrix-operations.html#cb2758-12" aria-hidden="true" tabindex="-1"></a>  ans <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">nrow</span>(mat))</span>
<span id="cb2758-13"><a href="chap-matrix-operations.html#cb2758-13" aria-hidden="true" tabindex="-1"></a>  dlog2exp <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="sc">-</span><span class="fu">diff</span>(<span class="fu">c</span>(<span class="fu">log2</span>(<span class="fu">get.exponents</span>(pow)), <span class="dv">0</span>)))</span>
<span id="cb2758-14"><a href="chap-matrix-operations.html#cb2758-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(dlog2exp)) {</span>
<span id="cb2758-15"><a href="chap-matrix-operations.html#cb2758-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (dlog2exp[j]) <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>dlog2exp[j]) mat <span class="ot">&lt;-</span> mat <span class="sc">%*%</span> mat</span>
<span id="cb2758-16"><a href="chap-matrix-operations.html#cb2758-16" aria-hidden="true" tabindex="-1"></a>    ans <span class="ot">&lt;-</span> ans <span class="sc">%*%</span> mat</span>
<span id="cb2758-17"><a href="chap-matrix-operations.html#cb2758-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2758-18"><a href="chap-matrix-operations.html#cb2758-18" aria-hidden="true" tabindex="-1"></a>  ans</span>
<span id="cb2758-19"><a href="chap-matrix-operations.html#cb2758-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>奇异值分解</p>
<div class="sourceCode" id="cb2759"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2759-1"><a href="chap-matrix-operations.html#cb2759-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">svd</span>(A)</span>
<span id="cb2759-2"><a href="chap-matrix-operations.html#cb2759-2" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(s<span class="sc">$</span>u<span class="sc">%*%</span><span class="fu">diag</span>(s<span class="sc">$</span>d)<span class="sc">%*%</span><span class="fu">t</span>(s<span class="sc">$</span>v),A)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>特征值及分解 <span class="math inline">\(A = V \Lambda V^{-1}\)</span> 求解矩阵 A 的 n 次方</p>
<div class="sourceCode" id="cb2761"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2761-1"><a href="chap-matrix-operations.html#cb2761-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(A)</span></code></pre></div>
<pre><code>## eigen() decomposition
## $values
## [1]  4.236068 -0.236068
## 
## $vectors
##           [,1]       [,2]
## [1,] 0.5257311 -0.8506508
## [2,] 0.8506508  0.5257311</code></pre>
<div class="sourceCode" id="cb2763"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2763-1"><a href="chap-matrix-operations.html#cb2763-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(A)<span class="sc">$</span>vectors <span class="sc">%*%</span> <span class="fu">diag</span>(<span class="fu">eigen</span>(A)<span class="sc">$</span>values) <span class="sc">%*%</span> <span class="fu">solve</span>(<span class="fu">eigen</span>(A)<span class="sc">$</span>vectors)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    2
## [2,]    2    3</code></pre>
<div class="sourceCode" id="cb2765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2765-1"><a href="chap-matrix-operations.html#cb2765-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(A)<span class="sc">$</span>vectors <span class="sc">%*%</span> <span class="fu">diag</span>(<span class="fu">eigen</span>(A)<span class="sc">$</span>values)<span class="sc">^</span><span class="dv">3</span> <span class="sc">%*%</span> <span class="fu">solve</span>(<span class="fu">eigen</span>(A)<span class="sc">$</span>vectors)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]   21   34
## [2,]   34   55</code></pre>
<div class="sourceCode" id="cb2767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2767-1"><a href="chap-matrix-operations.html#cb2767-1" aria-hidden="true" tabindex="-1"></a>A <span class="sc">%*%</span> A <span class="sc">%*%</span> A</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]   21   34
## [2,]   34   55</code></pre>
</div>
<div id="subsec-matrix-power" class="section level2" number="38.6">
<h2><span class="header-section-number">B.6</span> 矩阵求幂</h2>
<div class="sourceCode" id="cb2769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2769-1"><a href="chap-matrix-operations.html#cb2769-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">^</span>A</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    2    4
## [2,]    4    8</code></pre>
<div class="sourceCode" id="cb2771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2771-1"><a href="chap-matrix-operations.html#cb2771-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(A)</span></code></pre></div>
<pre><code>##          [,1]      [,2]
## [1,] 2.718282  7.389056
## [2,] 7.389056 20.085537</code></pre>
<p><a href="https://cran.r-project.org/web/packages/expm/index.html">expm</a> 包含 更多关于矩阵开方、取对数等计算</p>
</div>
<div id="subsec-matrix-crossproduct" class="section level2" number="38.7">
<h2><span class="header-section-number">B.7</span> 矩阵交叉积</h2>
<p>交叉积 <span class="math inline">\(A^{\top}A\)</span></p>
<div class="sourceCode" id="cb2773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2773-1"><a href="chap-matrix-operations.html#cb2773-1" aria-hidden="true" tabindex="-1"></a><span class="fu">crossprod</span>(A, A)  <span class="co">#  t(x) %*% y</span></span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    5    8
## [2,]    8   13</code></pre>
<div class="sourceCode" id="cb2775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2775-1"><a href="chap-matrix-operations.html#cb2775-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tcrossprod</span>(A, A) <span class="co">#  x %*% t(y)</span></span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    5    8
## [2,]    8   13</code></pre>
</div>
<div id="subsec-matrix-determinant" class="section level2" number="38.8">
<h2><span class="header-section-number">B.8</span> 矩阵行列式</h2>
<div class="sourceCode" id="cb2777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2777-1"><a href="chap-matrix-operations.html#cb2777-1" aria-hidden="true" tabindex="-1"></a><span class="fu">det</span>(A)</span></code></pre></div>
<pre><code>## [1] -1</code></pre>
<p>expm 包计算矩阵 <span class="math inline">\(e^{\mathbf{A}}\)</span></p>
</div>
<div id="subsec-matrix-cond-num" class="section level2" number="38.9">
<h2><span class="header-section-number">B.9</span> 矩阵条件数</h2>
<div class="sourceCode" id="cb2779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2779-1"><a href="chap-matrix-operations.html#cb2779-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Matrix)</span>
<span id="cb2779-2"><a href="chap-matrix-operations.html#cb2779-2" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">rcond</span>(A)</span></code></pre></div>
<pre><code>## [1] 0.04</code></pre>
<div class="sourceCode" id="cb2781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2781-1"><a href="chap-matrix-operations.html#cb2781-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kappa</span>(A)</span></code></pre></div>
<pre><code>## [1] 21.85714</code></pre>
<div class="sourceCode" id="cb2783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2783-1"><a href="chap-matrix-operations.html#cb2783-1" aria-hidden="true" tabindex="-1"></a>Matrix<span class="sc">::</span><span class="fu">rcond</span>(Matrix<span class="sc">::</span><span class="fu">Hilbert</span>(<span class="dv">6</span>))</span></code></pre></div>
<pre><code>## [1] 3.439939e-08</code></pre>
<div class="sourceCode" id="cb2785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2785-1"><a href="chap-matrix-operations.html#cb2785-1" aria-hidden="true" tabindex="-1"></a>Matrix<span class="sc">::</span><span class="fu">rcond</span>(A)</span></code></pre></div>
<pre><code>## [1] 0.04</code></pre>
</div>
<div id="subsec-matrix-inverse" class="section level2" number="38.10">
<h2><span class="header-section-number">B.10</span> 矩阵求逆</h2>
<div class="sourceCode" id="cb2787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2787-1"><a href="chap-matrix-operations.html#cb2787-1" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(A)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]   -3    2
## [2,]    2   -1</code></pre>
<p>应用之线性方程组</p>
<div class="sourceCode" id="cb2789"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2789-1"><a href="chap-matrix-operations.html#cb2789-1" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">Hilbert</span>(<span class="dv">6</span>)</span>
<span id="cb2789-2"><a href="chap-matrix-operations.html#cb2789-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(B)</span>
<span id="cb2789-3"><a href="chap-matrix-operations.html#cb2789-3" aria-hidden="true" tabindex="-1"></a><span class="co"># not inv</span></span>
<span id="cb2789-4"><a href="chap-matrix-operations.html#cb2789-4" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(B,b) </span></code></pre></div>
<pre><code>## 6 x 1 Matrix of class &quot;dgeMatrix&quot;
##      [,1]
## [1,]    1
## [2,]    1
## [3,]    1
## [4,]    1
## [5,]    1
## [6,]    1</code></pre>
<div class="sourceCode" id="cb2791"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2791-1"><a href="chap-matrix-operations.html#cb2791-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inv</span></span>
<span id="cb2791-2"><a href="chap-matrix-operations.html#cb2791-2" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(B) <span class="sc">%*%</span> b</span></code></pre></div>
<pre><code>## 6 x 1 Matrix of class &quot;dgeMatrix&quot;
##      [,1]
## [1,]    1
## [2,]    1
## [3,]    1
## [4,]    1
## [5,]    1
## [6,]    1</code></pre>
<p>Moore-Penrose generalized inverse 广义逆，如果 A 可逆则，广义逆就是逆</p>
<div class="sourceCode" id="cb2793"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2793-1"><a href="chap-matrix-operations.html#cb2793-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS) <span class="co"># ginv 来自 MASS 包</span></span>
<span id="cb2793-2"><a href="chap-matrix-operations.html#cb2793-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ginv</span>(A)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]   -3    2
## [2,]    2   -1</code></pre>
<div class="sourceCode" id="cb2795"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2795-1"><a href="chap-matrix-operations.html#cb2795-1" aria-hidden="true" tabindex="-1"></a>A <span class="sc">%*%</span> <span class="fu">ginv</span>(A) <span class="sc">%*%</span> A</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    2
## [2,]    2    3</code></pre>
<div class="sourceCode" id="cb2797"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2797-1"><a href="chap-matrix-operations.html#cb2797-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ginv</span>(A) <span class="sc">%*%</span> A <span class="sc">%*%</span> <span class="fu">ginv</span>(A)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]   -3    2
## [2,]    2   -1</code></pre>
<div class="sourceCode" id="cb2799"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2799-1"><a href="chap-matrix-operations.html#cb2799-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(A <span class="sc">%*%</span> <span class="fu">ginv</span>(A))</span></code></pre></div>
<pre><code>##               [,1]         [,2]
## [1,]  1.000000e+00 8.881784e-16
## [2,] -8.881784e-16 1.000000e+00</code></pre>
<div class="sourceCode" id="cb2801"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2801-1"><a href="chap-matrix-operations.html#cb2801-1" aria-hidden="true" tabindex="-1"></a>A <span class="sc">%*%</span> <span class="fu">ginv</span>(A)</span></code></pre></div>
<pre><code>##              [,1]          [,2]
## [1,] 1.000000e+00 -8.881784e-16
## [2,] 8.881784e-16  1.000000e+00</code></pre>
<div class="sourceCode" id="cb2803"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2803-1"><a href="chap-matrix-operations.html#cb2803-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(<span class="fu">ginv</span>(A) <span class="sc">%*%</span> A)</span></code></pre></div>
<pre><code>##              [,1]          [,2]
## [1,] 1.000000e+00 -8.881784e-16
## [2,] 8.881784e-16  1.000000e+00</code></pre>
<div class="sourceCode" id="cb2805"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2805-1"><a href="chap-matrix-operations.html#cb2805-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ginv</span>(A) <span class="sc">%*%</span> A</span></code></pre></div>
<pre><code>##               [,1]         [,2]
## [1,]  1.000000e+00 8.881784e-16
## [2,] -8.881784e-16 1.000000e+00</code></pre>
</div>
<div id="subsec-matrix-adjoint" class="section level2" number="38.11">
<h2><span class="header-section-number">B.11</span> 矩阵伴随</h2>
<p>伴随矩阵 <span class="math inline">\(A*A^{\star} = A^{\star} *A = |A|*I, A^{\star} = |A|*A^{-1}\)</span></p>
<ul>
<li><span class="math inline">\(|A^{\star}| = |A|^{n-1}, A \in \mathbb{R}^{n\times n},n \geq 2\)</span></li>
<li><span class="math inline">\((A^{\star})^{\star} = |A|^{n-2}A, A \in \mathbb{R}^{n\times n},n \geq 2\)</span></li>
<li><span class="math inline">\((A^{\star})^{\star}\)</span> A 的 n 次伴随是？</li>
</ul>
<div class="sourceCode" id="cb2807"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2807-1"><a href="chap-matrix-operations.html#cb2807-1" aria-hidden="true" tabindex="-1"></a><span class="fu">det</span>(A)<span class="sc">*</span><span class="fu">solve</span>(A)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    3   -2
## [2,]   -2    1</code></pre>
</div>
<div id="subsec-matrix-norm" class="section level2" number="38.12">
<h2><span class="header-section-number">B.12</span> 矩阵范数</h2>
<p>向量和矩阵的范数，包括1，2，无穷范数，其他操作看 Matrix 包，尤其关于稀疏矩阵计算部分</p>
<dl>
<dt><span class="math inline">\(1\)</span>-范数</dt>
<dd>列和绝对值最大的
</dd>
<dt><span class="math inline">\(\infty\)</span> - 范数</dt>
<dd>行和绝对值最大的
</dd>
<dt>Frobenius - 范数</dt>
<dd>Euclidean 范数
</dd>
<dt><span class="math inline">\(M\)</span> - 范数</dt>
<dd>矩阵里模最大的元素，矩阵里面的元素可能含有复数，所以取模最大
</dd>
<dt><span class="math inline">\(2\)</span> - 范数</dt>
<dd>又称谱范数，矩阵最大的奇异值，如果是方阵，就是最大的特征值
</dd>
</dl>
<div class="sourceCode" id="cb2809"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2809-1"><a href="chap-matrix-operations.html#cb2809-1" aria-hidden="true" tabindex="-1"></a><span class="fu">norm</span>(A, <span class="at">type =</span> <span class="st">&quot;1&quot;</span>) <span class="co"># max(abs(colSums(A)))</span></span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb2811"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2811-1"><a href="chap-matrix-operations.html#cb2811-1" aria-hidden="true" tabindex="-1"></a><span class="fu">norm</span>(A, <span class="at">type =</span> <span class="st">&quot;I&quot;</span>) <span class="co"># max(abs(rowSums(A)))</span></span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb2813"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2813-1"><a href="chap-matrix-operations.html#cb2813-1" aria-hidden="true" tabindex="-1"></a><span class="fu">norm</span>(A, <span class="at">type =</span> <span class="st">&quot;F&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 4.242641</code></pre>
<div class="sourceCode" id="cb2815"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2815-1"><a href="chap-matrix-operations.html#cb2815-1" aria-hidden="true" tabindex="-1"></a><span class="fu">norm</span>(A, <span class="at">type =</span> <span class="st">&quot;M&quot;</span>) <span class="co">#</span></span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb2817"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2817-1"><a href="chap-matrix-operations.html#cb2817-1" aria-hidden="true" tabindex="-1"></a><span class="fu">norm</span>(A, <span class="at">type =</span> <span class="st">&quot;2&quot;</span>) <span class="co"># max(svd(A)$d)</span></span></code></pre></div>
<pre><code>## [1] 4.236068</code></pre>
<div class="rmdinfo">
<p>显然，<span class="math inline">\(1-,\infty-,M-\)</span> 的范数计算比 <span class="math inline">\(F-\)</span> 范数快，函数 <code>norm</code> 默认情况下求 <span class="math inline">\(1-\)</span> 范数</p>
</div>
</div>
<div id="subsec-matrix-rank" class="section level2" number="38.13">
<h2><span class="header-section-number">B.13</span> 矩阵求秩</h2>
<div class="sourceCode" id="cb2819"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2819-1"><a href="chap-matrix-operations.html#cb2819-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qr</span>(A)<span class="sc">$</span>rank <span class="co"># or qr.default(A)$rank</span></span></code></pre></div>
<pre><code>## [1] 2</code></pre>
</div>
<div id="subsec-matrix-trace" class="section level2" number="38.14">
<h2><span class="header-section-number">B.14</span> 矩阵求迹</h2>
<p>若</p>
<p><span class="math display">\[
A = \begin{bmatrix}
 a_{11} &amp; a_{12}  &amp; a_{13} \\ 
 a_{21} &amp; a_{22}  &amp; a_{23} \\ 
 a_{31} &amp; a_{32}  &amp; a_{33} 
\end{bmatrix}
\]</span></p>
<p>则矩阵 <span class="math inline">\(A\)</span> 的迹 <span class="math inline">\(\operatorname{tr}(A) = \sum_{i=1}^{n}a_{ii}\)</span></p>
<div class="sourceCode" id="cb2821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2821-1"><a href="chap-matrix-operations.html#cb2821-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">diag</span>(A))</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<p>特殊矩阵的构造</p>
</div>
<div id="subsec-identity-matrix" class="section level2" number="38.15">
<h2><span class="header-section-number">B.15</span> 单位矩阵</h2>
<p>矩阵对角线上全是1，其余位置都是0</p>
<p><span class="math display">\[
A = \begin{bmatrix}
 1 &amp; 0  &amp; 0 \\ 
 0 &amp; 1  &amp; 0 \\ 
 0 &amp; 0  &amp; 1 
\end{bmatrix}
\]</span></p>
<div class="sourceCode" id="cb2823"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2823-1"><a href="chap-matrix-operations.html#cb2823-1" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(<span class="fu">rep</span>(<span class="dv">3</span>))</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    0    0
## [2,]    0    1    0
## [3,]    0    0    1</code></pre>
<p>而全1矩阵是所有元素都是1的矩阵，可以借助外积运算构造，如3阶全1矩阵</p>
<div class="sourceCode" id="cb2825"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2825-1"><a href="chap-matrix-operations.html#cb2825-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">3</span>) <span class="sc">%o%</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">3</span>) </span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    1    1
## [2,]    1    1    1
## [3,]    1    1    1</code></pre>
</div>
<div id="subsec-matrix-diagonals" class="section level2" number="38.16">
<h2><span class="header-section-number">B.16</span> 对角矩阵</h2>
<div class="sourceCode" id="cb2827"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2827-1"><a href="chap-matrix-operations.html#cb2827-1" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(A)       <span class="co"># diagonal of a matrix</span></span></code></pre></div>
<pre><code>## [1] 1 3</code></pre>
<div class="sourceCode" id="cb2829"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2829-1"><a href="chap-matrix-operations.html#cb2829-1" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(<span class="fu">diag</span>(A)) <span class="co"># construct a diagonal matrix</span></span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    0
## [2,]    0    3</code></pre>
</div>
<div id="subsec-upper-matrix" class="section level2" number="38.17">
<h2><span class="header-section-number">B.17</span> 上/下三角矩阵</h2>
<p>矩阵下三角</p>
<p>row 和 col</p>
<div class="sourceCode" id="cb2831"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2831-1"><a href="chap-matrix-operations.html#cb2831-1" aria-hidden="true" tabindex="-1"></a><span class="fu">row</span>(A)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    1
## [2,]    2    2</code></pre>
<div class="sourceCode" id="cb2833"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2833-1"><a href="chap-matrix-operations.html#cb2833-1" aria-hidden="true" tabindex="-1"></a><span class="fu">col</span>(A)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    2
## [2,]    1    2</code></pre>
<div class="sourceCode" id="cb2835"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2835-1"><a href="chap-matrix-operations.html#cb2835-1" aria-hidden="true" tabindex="-1"></a>A[<span class="fu">row</span>(A)]</span></code></pre></div>
<pre><code>## [1] 1 3</code></pre>
<div class="sourceCode" id="cb2837"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2837-1"><a href="chap-matrix-operations.html#cb2837-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upper.tri</span>(A) <span class="co"># 矩阵上三角</span></span></code></pre></div>
<pre><code>##       [,1]  [,2]
## [1,] FALSE  TRUE
## [2,] FALSE FALSE</code></pre>
<div class="sourceCode" id="cb2839"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2839-1"><a href="chap-matrix-operations.html#cb2839-1" aria-hidden="true" tabindex="-1"></a>A[<span class="fu">upper.tri</span>(A)]</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb2841"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2841-1"><a href="chap-matrix-operations.html#cb2841-1" aria-hidden="true" tabindex="-1"></a>A[<span class="fu">lower.tri</span>(A)] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># 获得上三角矩阵</span></span>
<span id="cb2841-2"><a href="chap-matrix-operations.html#cb2841-2" aria-hidden="true" tabindex="-1"></a>A</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    2
## [2,]    0    3</code></pre>
<ul>
<li>下三角矩阵</li>
</ul>
<div class="sourceCode" id="cb2843"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2843-1"><a href="chap-matrix-operations.html#cb2843-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb2843-2"><a href="chap-matrix-operations.html#cb2843-2" aria-hidden="true" tabindex="-1"></a>A</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    2
## [2,]    2    3</code></pre>
<div class="sourceCode" id="cb2845"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2845-1"><a href="chap-matrix-operations.html#cb2845-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lower.tri</span>(A)</span></code></pre></div>
<pre><code>##       [,1]  [,2]
## [1,] FALSE FALSE
## [2,]  TRUE FALSE</code></pre>
<div class="sourceCode" id="cb2847"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2847-1"><a href="chap-matrix-operations.html#cb2847-1" aria-hidden="true" tabindex="-1"></a>A[<span class="fu">lower.tri</span>(A)]</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb2849"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2849-1"><a href="chap-matrix-operations.html#cb2849-1" aria-hidden="true" tabindex="-1"></a>A[<span class="fu">upper.tri</span>(A)] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># 获得下三角矩阵</span></span>
<span id="cb2849-2"><a href="chap-matrix-operations.html#cb2849-2" aria-hidden="true" tabindex="-1"></a>A</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    0
## [2,]    2    3</code></pre>
<div class="sourceCode" id="cb2851"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2851-1"><a href="chap-matrix-operations.html#cb2851-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb2851-2"><a href="chap-matrix-operations.html#cb2851-2" aria-hidden="true" tabindex="-1"></a>A[<span class="fu">row</span>(A) <span class="sc">&lt;</span> <span class="fu">col</span>(A)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb2851-3"><a href="chap-matrix-operations.html#cb2851-3" aria-hidden="true" tabindex="-1"></a>A</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    0
## [2,]    2    3</code></pre>
</div>
<div id="subsec-sparse-matrix" class="section level2" number="38.18">
<h2><span class="header-section-number">B.18</span> 稀疏矩阵</h2>
<div class="sourceCode" id="cb2853"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2853-1"><a href="chap-matrix-operations.html#cb2853-1" aria-hidden="true" tabindex="-1"></a>dn <span class="ot">&lt;-</span> <span class="fu">list</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb2853-2"><a href="chap-matrix-operations.html#cb2853-2" aria-hidden="true" tabindex="-1"></a><span class="do">## pointer vectors can be used, and the (i,x) slots are sorted if necessary:</span></span>
<span id="cb2853-3"><a href="chap-matrix-operations.html#cb2853-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 使用指针构造</span></span>
<span id="cb2853-4"><a href="chap-matrix-operations.html#cb2853-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">sparseMatrix</span>(<span class="at">i =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">1</span>), <span class="at">p=</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">6</span>), <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">dimnames =</span> dn)</span>
<span id="cb2853-5"><a href="chap-matrix-operations.html#cb2853-5" aria-hidden="true" tabindex="-1"></a>m</span></code></pre></div>
<pre><code>## 3 x 5 sparse Matrix of class &quot;dgCMatrix&quot;
##   a b c d e
## A . 2 . . 6
## B . . 4 . 5
## C 1 . 3 . .</code></pre>
<div class="sourceCode" id="cb2855"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2855-1"><a href="chap-matrix-operations.html#cb2855-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 典型构造方式</span></span>
<span id="cb2855-2"><a href="chap-matrix-operations.html#cb2855-2" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">8</span>); j <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">9</span>,<span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>); x <span class="ot">&lt;-</span> <span class="dv">7</span> <span class="sc">*</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)</span>
<span id="cb2855-3"><a href="chap-matrix-operations.html#cb2855-3" aria-hidden="true" tabindex="-1"></a>(AA <span class="ot">&lt;-</span> <span class="fu">sparseMatrix</span>(i, j, <span class="at">x =</span> x))                    <span class="do">##  8 x 10 &quot;dgCMatrix&quot;</span></span></code></pre></div>
<pre><code>## 8 x 10 sparse Matrix of class &quot;dgCMatrix&quot;
##                              
## [1,] . 7 . . .  .  .  .  .  .
## [2,] . . . . .  .  .  .  .  .
## [3,] . . . . .  .  .  . 14  .
## [4,] . . . . . 21  .  .  .  .
## [5,] . . . . .  . 28  .  .  .
## [6,] . . . . .  .  . 35  .  .
## [7,] . . . . .  .  .  . 42  .
## [8,] . . . . .  .  .  .  . 49</code></pre>
</div>
<div id="subsec-triangular-matrix" class="section level2" number="38.19">
<h2><span class="header-section-number">B.19</span> 三对角矩阵</h2>
<!-- 各类矩阵分解技术，及其算法实现、适用范围，最常见的 LU 分解、SVD 和 QR 分解，参考 R 内置的帮助文档及其实现 -->
</div>
<div id="subsec-lu-decomposition" class="section level2" number="38.20">
<h2><span class="header-section-number">B.20</span> LU 分解</h2>
</div>
<div id="subsec-schur-decomposition" class="section level2" number="38.21">
<h2><span class="header-section-number">B.21</span> Schur 分解</h2>
</div>
<div id="subsec-choleski-decomposition" class="section level2" number="38.22">
<h2><span class="header-section-number">B.22</span> Cholesky 分解</h2>
<p>实对称正定矩阵的 Choleski 分解</p>
<div class="sourceCode" id="cb2857"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2857-1"><a href="chap-matrix-operations.html#cb2857-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chol</span>(A <span class="sc">+</span> <span class="fu">diag</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">2</span>)))</span></code></pre></div>
<pre><code>##          [,1] [,2]
## [1,] 1.414214    0
## [2,] 0.000000    2</code></pre>
<div class="sourceCode" id="cb2859"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2859-1"><a href="chap-matrix-operations.html#cb2859-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inverse from Choleski (or QR) Decomposition</span></span>
<span id="cb2859-2"><a href="chap-matrix-operations.html#cb2859-2" aria-hidden="true" tabindex="-1"></a>Matrix<span class="sc">::</span><span class="fu">chol2inv</span>(A <span class="sc">+</span> <span class="fu">diag</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">2</span>)))</span></code></pre></div>
<pre><code>##      [,1]   [,2]
## [1,] 0.25 0.0000
## [2,] 0.00 0.0625</code></pre>
<p><code>Matrix::Cholesky</code> 实现稀疏 Cholesky 分解</p>
</div>
<div id="subsec-eigenvalues-decomposition" class="section level2" number="38.23">
<h2><span class="header-section-number">B.23</span> 特征值分解</h2>
<p>特征值分解（Eigenvalues Decomposition）也叫谱分解（Spectral Decomposition）</p>
<div class="sourceCode" id="cb2861"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2861-1"><a href="chap-matrix-operations.html#cb2861-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(A)</span></code></pre></div>
<pre><code>## eigen() decomposition
## $values
## [1] 3 1
## 
## $vectors
##      [,1]       [,2]
## [1,]    0  0.7071068
## [2,]    1 -0.7071068</code></pre>
</div>
<div id="subsec-Singular-Value-Decomposition" class="section level2" number="38.24">
<h2><span class="header-section-number">B.24</span> SVD 分解</h2>
<p><a href="https://github.com/bwlewis/irlba">Fast truncated singular value decompositions</a>
奇异值分解是特征值分解的推广</p>
<div class="sourceCode" id="cb2863"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2863-1"><a href="chap-matrix-operations.html#cb2863-1" aria-hidden="true" tabindex="-1"></a><span class="fu">svd</span>(A)</span></code></pre></div>
<pre><code>## $d
## [1] 3.6502815 0.8218544
## 
## $u
##            [,1]       [,2]
## [1,] -0.1601822 -0.9870875
## [2,] -0.9870875  0.1601822
## 
## $v
##            [,1]       [,2]
## [1,] -0.5847103 -0.8112422
## [2,] -0.8112422  0.5847103</code></pre>
<div class="sourceCode" id="cb2865"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2865-1"><a href="chap-matrix-operations.html#cb2865-1" aria-hidden="true" tabindex="-1"></a><span class="fu">svd</span>(A)<span class="sc">$</span>d</span></code></pre></div>
<pre><code>## [1] 3.6502815 0.8218544</code></pre>
<p>邱怡轩将奇异值分解用于图像压缩 <a href="https://cosx.org/2014/02/svd-and-image-compression" class="uri">https://cosx.org/2014/02/svd-and-image-compression</a> 并制作了 <a href="https://yihui.shinyapps.io/imgsvd/">Shiny App</a> 交互式演示</p>
</div>
<div id="subsec-QR-Decomposition" class="section level2" number="38.25">
<h2><span class="header-section-number">B.25</span> QR 分解</h2>
<div class="sourceCode" id="cb2867"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2867-1"><a href="chap-matrix-operations.html#cb2867-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qr.default</span>(A)</span></code></pre></div>
<pre><code>## $qr
##            [,1]      [,2]
## [1,] -2.2360680 -2.683282
## [2,]  0.8944272  1.341641
## 
## $rank
## [1] 2
## 
## $qraux
## [1] 1.447214 1.341641
## 
## $pivot
## [1] 1 2
## 
## attr(,&quot;class&quot;)
## [1] &quot;qr&quot;</code></pre>
<div class="sourceCode" id="cb2869"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2869-1"><a href="chap-matrix-operations.html#cb2869-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qr.X</span>(<span class="fu">qr.default</span>(A))</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    0
## [2,]    2    3</code></pre>
<div class="sourceCode" id="cb2871"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2871-1"><a href="chap-matrix-operations.html#cb2871-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qr.Q</span>(<span class="fu">qr.default</span>(A))</span></code></pre></div>
<pre><code>##            [,1]       [,2]
## [1,] -0.4472136 -0.8944272
## [2,] -0.8944272  0.4472136</code></pre>
<div class="sourceCode" id="cb2873"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2873-1"><a href="chap-matrix-operations.html#cb2873-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qr.R</span>(<span class="fu">qr.default</span>(A))</span></code></pre></div>
<pre><code>##           [,1]      [,2]
## [1,] -2.236068 -2.683282
## [2,]  0.000000  1.341641</code></pre>
<div class="sourceCode" id="cb2875"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2875-1"><a href="chap-matrix-operations.html#cb2875-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qr.Q</span>(<span class="fu">qr.default</span>(A)) <span class="sc">%*%</span> <span class="fu">qr.R</span>(<span class="fu">qr.default</span>(A))</span></code></pre></div>
<pre><code>##      [,1]          [,2]
## [1,]    1 -2.220446e-16
## [2,]    2  3.000000e+00</code></pre>
<p>用 <a href="https://www.wikiwand.com/en/Householder_transformation">Householder 变换</a> 做 QR 分解 <span class="citation"><a href="#ref-Bates_1988_Nonlinear" role="doc-biblioref">[105]</a></span> 及其 R 语言实现 <a href="https://rpubs.com/aaronsc32/qr-decomposition-householder" class="uri">https://rpubs.com/aaronsc32/qr-decomposition-householder</a></p>
<p>Householder 变换是平面反射的一般情况：
要计算 <span class="math inline">\(N\times P\)</span> 维矩阵 <span class="math inline">\(X\)</span> 的 QR 分解，我们采用 Householder 变换</p>
<p><span class="math display">\[
\mathbf{H}_{u} = \mathbf{I} -2\mathbf{u}\mathbf{u}^{\top}
\]</span></p>
<p>其中 <span class="math inline">\(I\)</span> 是 <span class="math inline">\(N\times N\)</span> 维的单位矩阵，<span class="math inline">\(u\)</span> 是 <span class="math inline">\(N\)</span> 维单位向量，即 <span class="math inline">\(\| \mathbf{u}\| = \sqrt{\mathbf{u}\mathbf{u}^{\top}} = 1\)</span>。则 <span class="math inline">\(H_u\)</span> 是对称正交的，因为</p>
<p><span class="math display">\[
\mathbf{H}_{u}^{\top} = \mathbf{I}^{\top} - 2\mathbf{u}\mathbf{u}^{\top} = \mathbf{H}_{u}
\]</span></p>
<p>并且</p>
<p><span class="math display">\[
\mathbf{H}_{u}^{\top}\mathbf{H}_{u} =  \mathbf{I} -4\mathbf{u}\mathbf{u}^{\top} + 4\mathbf{u}\mathbf{u}^{\top}\mathbf{u}\mathbf{u}^{\top} = \mathbf{I}
\]</span></p>
<p>让 <span class="math inline">\(\mathbf{H}_{u}\)</span> 乘以向量 <span class="math inline">\(\mathbf{y}\)</span>，即</p>
<p><span class="math display">\[
\mathbf{H}_{u}\mathbf{y} = \mathbf{y} - 2\mathbf{u}\mathbf{u}^{\top}\mathbf{y}
\]</span></p>
<p>它是 <span class="math inline">\(y\)</span> 关于垂直于过原点的 <span class="math inline">\(u\)</span> 的直线的反射，只要</p>
<p><span class="math display" id="eq:householder-negative">\[\begin{equation}
\mathbf{u} = \frac{\mathbf{y} - \| \mathbf{y} \|\mathbf{e}_{1}}{\| \mathbf{y} - \| \mathbf{y} \|\mathbf{e}_{1}\|} \tag{B.1}
\end{equation}\]</span></p>
<p>或者</p>
<p><span class="math display" id="eq:householder-positive">\[\begin{equation}
\mathbf{u} = \frac{\mathbf{y} + \| \mathbf{y} \|\mathbf{e}_{1}}{\| \mathbf{y} + \| \mathbf{y} \|\mathbf{e}_{1}\|} \tag{B.2}
\end{equation}\]</span></p>
<p>其中 <span class="math inline">\(\mathbf{e}_{1} = (1,0,\ldots,0)^{\top}\)</span>，Householder 变换使得向量 <span class="math inline">\(y\)</span> 成为 <span class="math inline">\(x\)</span> 轴，在新的坐标系统中，向量 <span class="math inline">\(H_{u}y\)</span> 的坐标为 <span class="math inline">\((\pm\|y\|, 0, \ldots, 0)^\top\)</span></p>
<p>举个例子</p>
<p>借助 Householder 变换做 QR 分解的优势：</p>
<ol style="list-style-type: decimal">
<li>更快、数值更稳定比直接构造 Q，特别当 N 大于 P 的时候</li>
<li>相比于存储矩阵 Q 的 <span class="math inline">\(N^2\)</span> 个元素，Householder 变换只存储 P 个向量 <span class="math inline">\(u_1,\ldots,u_P\)</span></li>
<li>QR 分解的真实实现，比如在 LINPACK 中，定义 <span class="math inline">\(u\)</span> 的时候，公式 <a href="chap-matrix-operations.html#eq:householder-negative">(B.1)</a> 或 <a href="chap-matrix-operations.html#eq:householder-positive">(B.2)</a> 的选择基于<span class="math inline">\(y\)</span>的第一个坐标的符号。如果坐标是负的，使用公式<a href="chap-matrix-operations.html#eq:householder-negative">(B.1)</a>，如果是正的，使用公式 <a href="chap-matrix-operations.html#eq:householder-positive">(B.2)</a>， 这个做法可以使得数值计算更加稳定。</li>
</ol>
<p>Stan 实现的 QR 分解在贝叶斯线性回归模型中的应用<a href="#fn85" class="footnote-ref" id="fnref85"><sup>85</sup></a></p>
</div>
<div id="subsec-jordan-Decomposition" class="section level2" number="38.26">
<h2><span class="header-section-number">B.26</span> Jordan 分解</h2>
</div>
<div id="subsec-Givens-Rotation" class="section level2" number="38.27">
<h2><span class="header-section-number">B.27</span> Givens 旋转</h2>
<ul>
<li><p>Givens 旋转 <a href="https://www.wikiwand.com/en/Givens_rotation" class="uri">https://www.wikiwand.com/en/Givens_rotation</a></p></li>
<li><p>帽子矩阵在统计中的应用 回归与方差分析 <span class="citation"><a href="#ref-David_1978_Hat" role="doc-biblioref">[106]</a></span></p></li>
</ul>
</div>
<div id="sec-special-functions" class="section level2" number="38.28">
<h2><span class="header-section-number">B.28</span> 特殊函数</h2>
<div id="factorial" class="section level3" number="38.28.1">
<h3><span class="header-section-number">B.28.1</span> 阶乘</h3>
<ul>
<li>阶乘 <span class="math inline">\(n! = 1\times 2\times 3\cdots n\)</span></li>
<li>双阶乘 <span class="math inline">\((2n+1)!! = 1 \times 3\times 5 \times \cdots \times (2n+1), n = 0,1,2,\cdots\)</span></li>
</ul>
<div class="sourceCode" id="cb2877"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2877-1"><a href="chap-matrix-operations.html#cb2877-1" aria-hidden="true" tabindex="-1"></a><span class="fu">factorial</span>(<span class="dv">5</span>) <span class="co"># 阶乘</span></span></code></pre></div>
<pre><code>## [1] 120</code></pre>
<div class="sourceCode" id="cb2879"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2879-1"><a href="chap-matrix-operations.html#cb2879-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 1 3 5</code></pre>
<div class="sourceCode" id="cb2881"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2881-1"><a href="chap-matrix-operations.html#cb2881-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prod</span>(<span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">3</span>)) <span class="co"># 连乘 双阶乘</span></span></code></pre></div>
<pre><code>## [1] 15</code></pre>
<div class="sourceCode" id="cb2883"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2883-1"><a href="chap-matrix-operations.html#cb2883-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 1 2 3 4 5</code></pre>
<div class="sourceCode" id="cb2885"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2885-1"><a href="chap-matrix-operations.html#cb2885-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cumprod</span>(<span class="fu">seq</span>(<span class="dv">5</span>)) <span class="co"># 累积</span></span></code></pre></div>
<pre><code>## [1]   1   2   6  24 120</code></pre>
<div class="sourceCode" id="cb2887"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2887-1"><a href="chap-matrix-operations.html#cb2887-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cumsum</span>(<span class="fu">seq</span>(<span class="dv">5</span>)) <span class="co"># 累和</span></span></code></pre></div>
<pre><code>## [1]  1  3  6 10 15</code></pre>
<p>此外还有 <code>cummax</code> 和 <code>cummin</code></p>
<ul>
<li>组合数 <span class="math inline">\(C_{n}^{k} = \frac{n(n-1)…(n-k+1)}{k!}\)</span></li>
</ul>
<p><span class="math inline">\(C_{5}^{3} = \frac{5 \times 4 \times 3}{3 \times 2 \times 1}\)</span></p>
<div class="sourceCode" id="cb2889"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2889-1"><a href="chap-matrix-operations.html#cb2889-1" aria-hidden="true" tabindex="-1"></a><span class="fu">choose</span>(<span class="dv">5</span>,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<blockquote>
<p>斯特林公式</p>
</blockquote>
</div>
<div id="gamma" class="section level3" number="38.28.2">
<h3><span class="header-section-number">B.28.2</span> 伽马函数</h3>
<p><span class="math inline">\(\Gamma(x) = \int_{0}^{\infty} t^{x-1}\exp(-t)dt\)</span>
<span class="math inline">\(\Gamma(n) = (n-1)!, n \in \mathbb{Z}^{+}\)</span></p>
<div class="sourceCode" id="cb2891"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2891-1"><a href="chap-matrix-operations.html#cb2891-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gamma</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb2893"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2893-1"><a href="chap-matrix-operations.html#cb2893-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gamma</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1] 362880</code></pre>
<div class="sourceCode" id="cb2895"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2895-1"><a href="chap-matrix-operations.html#cb2895-1" aria-hidden="true" tabindex="-1"></a>gamma2 <span class="ot">&lt;-</span> <span class="cf">function</span>(t,x){</span>
<span id="cb2895-2"><a href="chap-matrix-operations.html#cb2895-2" aria-hidden="true" tabindex="-1"></a>  t<span class="sc">^</span>(x<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>t)</span>
<span id="cb2895-3"><a href="chap-matrix-operations.html#cb2895-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2895-4"><a href="chap-matrix-operations.html#cb2895-4" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>(gamma2, <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="sc">+</span> <span class="cn">Inf</span>, <span class="at">x =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## 362880 with absolute error &lt; 0.025</code></pre>
<ul>
<li>psigamma(x, deriv) 表示 <span class="math inline">\(\psi(x)\)</span> 的 <code>deriv</code> 阶导数</li>
</ul>
<p><span class="math inline">\(\mathrm{digamma}(x) \triangleq \psi(x) = \frac{d}{dx}{\ln \Gamma(x)} = \Gamma&#39;(x) / \Gamma(x)\)</span></p>
<div class="sourceCode" id="cb2897"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2897-1"><a href="chap-matrix-operations.html#cb2897-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 例1</span></span>
<span id="cb2897-2"><a href="chap-matrix-operations.html#cb2897-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb2897-3"><a href="chap-matrix-operations.html#cb2897-3" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="fu">deriv</span>(<span class="sc">~</span> <span class="fu">gamma</span>(x), <span class="st">&quot;x&quot;</span>))<span class="sc">/</span><span class="fu">gamma</span>(x)</span></code></pre></div>
<pre><code>## [1] 1
## attr(,&quot;gradient&quot;)
##              x
## [1,] 0.4227843</code></pre>
<div class="sourceCode" id="cb2899"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2899-1"><a href="chap-matrix-operations.html#cb2899-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 与此等价</span></span>
<span id="cb2899-2"><a href="chap-matrix-operations.html#cb2899-2" aria-hidden="true" tabindex="-1"></a><span class="fu">psigamma</span>(<span class="dv">2</span>, <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 0.4227843</code></pre>
<div class="sourceCode" id="cb2901"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2901-1"><a href="chap-matrix-operations.html#cb2901-1" aria-hidden="true" tabindex="-1"></a><span class="fu">digamma</span>(x) <span class="co"># psi(x) 的一阶导数</span></span></code></pre></div>
<pre><code>## [1] 0.4227843</code></pre>
<div class="sourceCode" id="cb2903"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2903-1"><a href="chap-matrix-operations.html#cb2903-1" aria-hidden="true" tabindex="-1"></a><span class="fu">trigamma</span>(x) <span class="co"># psi(x) 的二阶导数</span></span></code></pre></div>
<pre><code>## [1] 0.6449341</code></pre>
<div class="sourceCode" id="cb2905"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2905-1"><a href="chap-matrix-operations.html#cb2905-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 例2</span></span>
<span id="cb2905-2"><a href="chap-matrix-operations.html#cb2905-2" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="fu">deriv</span>(<span class="sc">~</span> <span class="fu">psigamma</span>(x, <span class="dv">1</span>), <span class="st">&quot;x&quot;</span>))</span></code></pre></div>
<pre><code>## [1] 0.6449341
## attr(,&quot;gradient&quot;)
##               x
## [1,] -0.4041138</code></pre>
<div class="sourceCode" id="cb2907"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2907-1"><a href="chap-matrix-operations.html#cb2907-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 与此等价</span></span>
<span id="cb2907-2"><a href="chap-matrix-operations.html#cb2907-2" aria-hidden="true" tabindex="-1"></a><span class="fu">psigamma</span>(<span class="dv">2</span>, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] -0.4041138</code></pre>
<div class="sourceCode" id="cb2909"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2909-1"><a href="chap-matrix-operations.html#cb2909-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 注意与下面这个例子比较</span></span>
<span id="cb2909-2"><a href="chap-matrix-operations.html#cb2909-2" aria-hidden="true" tabindex="-1"></a>dx2x <span class="ot">&lt;-</span> <span class="fu">deriv</span>(<span class="sc">~</span> x<span class="sc">^</span><span class="dv">3</span>, <span class="st">&quot;x&quot;</span>)</span>
<span id="cb2909-3"><a href="chap-matrix-operations.html#cb2909-3" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(dx2x)</span></code></pre></div>
<pre><code>## [1] 8
## attr(,&quot;gradient&quot;)
##       x
## [1,] 12</code></pre>
</div>
<div id="beta" class="section level3" number="38.28.3">
<h3><span class="header-section-number">B.28.3</span> 贝塔函数</h3>
<p><span class="math inline">\(B(a,b) = \Gamma(a)\Gamma(b)/\Gamma(a+b) = \int_{0}^{1} t^{a-1} (1-t)^{b-1} dt\)</span></p>
<div class="sourceCode" id="cb2911"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2911-1"><a href="chap-matrix-operations.html#cb2911-1" aria-hidden="true" tabindex="-1"></a><span class="fu">beta</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb2913"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2913-1"><a href="chap-matrix-operations.html#cb2913-1" aria-hidden="true" tabindex="-1"></a><span class="fu">beta</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.08333333</code></pre>
<div class="sourceCode" id="cb2915"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2915-1"><a href="chap-matrix-operations.html#cb2915-1" aria-hidden="true" tabindex="-1"></a>beta2 <span class="ot">&lt;-</span> <span class="cf">function</span>(t, a, b) {</span>
<span id="cb2915-2"><a href="chap-matrix-operations.html#cb2915-2" aria-hidden="true" tabindex="-1"></a>  t<span class="sc">^</span>(a <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> t)<span class="sc">^</span>(b <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb2915-3"><a href="chap-matrix-operations.html#cb2915-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2915-4"><a href="chap-matrix-operations.html#cb2915-4" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>(beta2, <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="dv">1</span>, <span class="at">a =</span> <span class="dv">2</span>, <span class="at">b =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## 0.08333333 with absolute error &lt; 9.3e-16</code></pre>
</div>
<div id="bessel" class="section level3" number="38.28.4">
<h3><span class="header-section-number">B.28.4</span> 贝塞尔函数</h3>
<div class="sourceCode" id="cb2917"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2917-1"><a href="chap-matrix-operations.html#cb2917-1" aria-hidden="true" tabindex="-1"></a><span class="fu">besselI</span>(x, nu, <span class="at">expon.scaled =</span> <span class="cn">FALSE</span>) <span class="co"># 修正的第一类</span></span>
<span id="cb2917-2"><a href="chap-matrix-operations.html#cb2917-2" aria-hidden="true" tabindex="-1"></a><span class="fu">besselK</span>(x, nu, <span class="at">expon.scaled =</span> <span class="cn">FALSE</span>) <span class="co"># 修正的第二类</span></span>
<span id="cb2917-3"><a href="chap-matrix-operations.html#cb2917-3" aria-hidden="true" tabindex="-1"></a><span class="fu">besselJ</span>(x, nu) <span class="co"># 第一类</span></span>
<span id="cb2917-4"><a href="chap-matrix-operations.html#cb2917-4" aria-hidden="true" tabindex="-1"></a><span class="fu">besselY</span>(x, nu) <span class="co"># 第二类</span></span></code></pre></div>
<ul>
<li><span class="math inline">\(\nu\)</span> 贝塞尔函数的阶，可以是分数</li>
<li>expon.scaled 是否使用指数表示</li>
</ul>
<div class="sourceCode" id="cb2918"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2918-1"><a href="chap-matrix-operations.html#cb2918-1" aria-hidden="true" tabindex="-1"></a>nus <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>)</span>
<span id="cb2918-2"><a href="chap-matrix-operations.html#cb2918-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">501</span>)</span>
<span id="cb2918-3"><a href="chap-matrix-operations.html#cb2918-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, x,</span>
<span id="cb2918-4"><a href="chap-matrix-operations.html#cb2918-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">6</span>), <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">type =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb2918-5"><a href="chap-matrix-operations.html#cb2918-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;Bessel Functions  I_nu(x)&quot;</span></span>
<span id="cb2918-6"><a href="chap-matrix-operations.html#cb2918-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2918-7"><a href="chap-matrix-operations.html#cb2918-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (nu <span class="cf">in</span> nus) <span class="fu">lines</span>(x, <span class="fu">besselI</span>(x, <span class="at">nu =</span> nu), <span class="at">col =</span> nu <span class="sc">+</span> <span class="dv">2</span>)</span>
<span id="cb2918-8"><a href="chap-matrix-operations.html#cb2918-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">legend =</span> <span class="fu">paste</span>(<span class="st">&quot;nu=&quot;</span>, nus), <span class="at">col =</span> nus <span class="sc">+</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="matrix-operations_files/figure-html/modified-bessel-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>介绍复数矩阵的计算，矩阵的指数计算，介绍一点分形</p>
<div class="sourceCode" id="cb2919"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2919-1"><a href="chap-matrix-operations.html#cb2919-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 考虑用 gganimate 实现，去掉 caTools 依赖</span></span>
<span id="cb2919-2"><a href="chap-matrix-operations.html#cb2919-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caTools)</span>
<span id="cb2919-3"><a href="chap-matrix-operations.html#cb2919-3" aria-hidden="true" tabindex="-1"></a>jet.colors <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(</span>
<span id="cb2919-4"><a href="chap-matrix-operations.html#cb2919-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;cyan&quot;</span>, <span class="st">&quot;#7FFF7F&quot;</span>,</span>
<span id="cb2919-5"><a href="chap-matrix-operations.html#cb2919-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;#FF7F00&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;#7F0000&quot;</span></span>
<span id="cb2919-6"><a href="chap-matrix-operations.html#cb2919-6" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb2919-7"><a href="chap-matrix-operations.html#cb2919-7" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># define size</span></span>
<span id="cb2919-8"><a href="chap-matrix-operations.html#cb2919-8" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">complex</span>(</span>
<span id="cb2919-9"><a href="chap-matrix-operations.html#cb2919-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">real =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.8</span>, <span class="fl">0.6</span>, <span class="at">length.out =</span> m), <span class="at">each =</span> m),</span>
<span id="cb2919-10"><a href="chap-matrix-operations.html#cb2919-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">imag =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.2</span>, <span class="fl">1.2</span>, <span class="at">length.out =</span> m), m)</span>
<span id="cb2919-11"><a href="chap-matrix-operations.html#cb2919-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2919-12"><a href="chap-matrix-operations.html#cb2919-12" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">matrix</span>(C, m, m) <span class="co"># reshape as square matrix of complex numbers</span></span>
<span id="cb2919-13"><a href="chap-matrix-operations.html#cb2919-13" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># initialize Z to zero</span></span>
<span id="cb2919-14"><a href="chap-matrix-operations.html#cb2919-14" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>, <span class="fu">c</span>(m, m, <span class="dv">20</span>)) <span class="co"># initialize output 3D array</span></span>
<span id="cb2919-15"><a href="chap-matrix-operations.html#cb2919-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) { <span class="co"># loop with 20 iterations</span></span>
<span id="cb2919-16"><a href="chap-matrix-operations.html#cb2919-16" aria-hidden="true" tabindex="-1"></a>  Z <span class="ot">&lt;-</span> Z<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> C <span class="co"># the central difference equation</span></span>
<span id="cb2919-17"><a href="chap-matrix-operations.html#cb2919-17" aria-hidden="true" tabindex="-1"></a>  X[, , k] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(Z)) <span class="co"># capture results</span></span>
<span id="cb2919-18"><a href="chap-matrix-operations.html#cb2919-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2919-19"><a href="chap-matrix-operations.html#cb2919-19" aria-hidden="true" tabindex="-1"></a><span class="fu">write.gif</span>(X, <span class="st">&quot;Mandelbrot.gif&quot;</span>, <span class="at">col =</span> jet.colors, <span class="at">delay =</span> <span class="dv">100</span>)</span></code></pre></div>

</div>
</div>
</div>
<h3>参考文献</h3>
<div id="refs" class="references csl-bib-body">
<div id="ref-Denton_2019_Eigen" class="csl-entry">
<div class="csl-left-margin">[103] </div><div class="csl-right-inline">P. B. Denton, S. J. Parke, T. Tao, and X. Zhang, <span>“Eigenvectors from eigenvalues,”</span> 2019,Available: <a href="https://arxiv.org/pdf/1908.03795.pdf">https://arxiv.org/pdf/1908.03795.pdf</a></div>
</div>
<div id="ref-Boyd_2018_matrix" class="csl-entry">
<div class="csl-left-margin">[104] </div><div class="csl-right-inline">S. Boyd and L. Vandenberghe, <em>Introduction to applied linear algebra: Vectors, matrices, and least squares</em>. New York, NY: Cambridge University Press, 2018.Available: <a href="https://web.stanford.edu/~boyd/vmls/vmls.pdf">https://web.stanford.edu/~boyd/vmls/vmls.pdf</a></div>
</div>
<div id="ref-Bates_1988_Nonlinear" class="csl-entry">
<div class="csl-left-margin">[105] </div><div class="csl-right-inline">D. M. Bates and D. G. Watts, <em>Nonlinear regression analysis and its applications</em>. New York, NY: John Wiley &amp; Sons, 1988.Available: <a href="https://doi.org/10.1002/9780470316757.app2">https://doi.org/10.1002/9780470316757.app2</a></div>
</div>
<div id="ref-David_1978_Hat" class="csl-entry">
<div class="csl-left-margin">[106] </div><div class="csl-right-inline">D. C. Hoaglin and R. E. Welsch, <span>“The hat matrix in regression and ANOVA,”</span> <em>The American Statistician</em>, vol. 32, no. 1, pp. 17–22, 1978,Available: <a href="https://www.jstor.org/stable/2683469">https://www.jstor.org/stable/2683469</a></div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="85">
<li id="fn85"><p><a href="https://mc-stan.org/users/documentation/case-studies/qr_regression.html" class="uri">https://mc-stan.org/users/documentation/case-studies/qr_regression.html</a><a href="chap-matrix-operations.html#fnref85" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>现代应用统计与 R 语言</strong>: Modern Applied Statistics with R" was written by 黄湘云. It was last built on 2022-04-03.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
<script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>

</html>
