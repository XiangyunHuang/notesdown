<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>第 35 章 案例研究 | 现代应用统计与 R 语言</title>
<meta name="author" content="黄湘云">
<meta name="description" content="library(magrittr) library(ggplot2) library(gganimate) library(formattable) library(packagemetrics) 提升回归模型的10个提示 10 quick tips to improve your regression modeling tidymodels 和 easystats 都是基于...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="第 35 章 案例研究 | 现代应用统计与 R 语言">
<meta property="og:type" content="book">
<meta property="og:image" content="/images/cover.png">
<meta property="og:description" content="library(magrittr) library(ggplot2) library(gganimate) library(formattable) library(packagemetrics) 提升回归模型的10个提示 10 quick tips to improve your regression modeling tidymodels 和 easystats 都是基于...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="第 35 章 案例研究 | 现代应用统计与 R 语言">
<meta name="twitter:description" content="library(magrittr) library(ggplot2) library(gganimate) library(formattable) library(packagemetrics) 提升回归模型的10个提示 10 quick tips to improve your regression modeling tidymodels 和 easystats 都是基于...">
<meta name="twitter:image" content="/images/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs/header-attrs.js"></script><script src="libs/jquery/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap/bootstrap.bundle.min.js"></script><script src="libs/bs3compat/transition.js"></script><script src="libs/bs3compat/tabs.js"></script><script src="libs/bs3compat/bs3compat.js"></script><link href="libs/bs4_book/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book/bs4_book.js"></script><script src="libs/htmlwidgets/htmlwidgets.js"></script><script src="libs/plotly-binding/plotly.js"></script><script src="libs/typedarray/typedarray.min.js"></script><link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main/plotly-latest.min.js"></script><script src="libs/proj4js/proj4.js"></script><link href="libs/highcharts/css/motion.css" rel="stylesheet">
<script src="libs/highcharts/highcharts.js"></script><script src="libs/highcharts/highcharts-3d.js"></script><script src="libs/highcharts/highcharts-more.js"></script><script src="libs/highcharts/modules/stock.js"></script><script src="libs/highcharts/modules/map.js"></script><script src="libs/highcharts/modules/annotations.js"></script><script src="libs/highcharts/modules/data.js"></script><script src="libs/highcharts/modules/drilldown.js"></script><script src="libs/highcharts/modules/item-series.js"></script><script src="libs/highcharts/modules/offline-exporting.js"></script><script src="libs/highcharts/modules/overlapping-datalabels.js"></script><script src="libs/highcharts/modules/exporting.js"></script><script src="libs/highcharts/modules/export-data.js"></script><script src="libs/highcharts/modules/funnel.js"></script><script src="libs/highcharts/modules/heatmap.js"></script><script src="libs/highcharts/modules/treemap.js"></script><script src="libs/highcharts/modules/sankey.js"></script><script src="libs/highcharts/modules/dependency-wheel.js"></script><script src="libs/highcharts/modules/organization.js"></script><script src="libs/highcharts/modules/solid-gauge.js"></script><script src="libs/highcharts/modules/streamgraph.js"></script><script src="libs/highcharts/modules/sunburst.js"></script><script src="libs/highcharts/modules/vector.js"></script><script src="libs/highcharts/modules/wordcloud.js"></script><script src="libs/highcharts/modules/xrange.js"></script><script src="libs/highcharts/modules/tilemap.js"></script><script src="libs/highcharts/modules/venn.js"></script><script src="libs/highcharts/modules/gantt.js"></script><script src="libs/highcharts/modules/timeline.js"></script><script src="libs/highcharts/modules/parallel-coordinates.js"></script><script src="libs/highcharts/modules/bullet.js"></script><script src="libs/highcharts/modules/coloraxis.js"></script><script src="libs/highcharts/modules/dumbbell.js"></script><script src="libs/highcharts/modules/lollipop.js"></script><script src="libs/highcharts/modules/series-label.js"></script><script src="libs/highcharts/plugins/motion.js"></script><script src="libs/highcharts/custom/reset.js"></script><script src="libs/highcharts/modules/boost.js"></script><script src="libs/highchart-binding/highchart.js"></script><script src="libs/plotly-locale-zh-CN/zh-cn.js"></script><script src="libs/mathjax/cdn.js"></script><link href="libs/dygraphs/dygraph.css" rel="stylesheet">
<script src="libs/dygraphs/dygraph-combined.js"></script><script src="libs/dygraphs/shapes.js"></script><script src="libs/moment/moment.js"></script><script src="libs/moment-timezone/moment-timezone-with-data.js"></script><script src="libs/moment-fquarter/moment-fquarter.min.js"></script><script src="libs/dygraphs-binding/dygraphs.js"></script><script src="libs/Dygraph.Plugins.Unzoom/unzoom.js"></script><script src="libs/echarts4r/echarts-en.min.js"></script><script src="libs/echarts4r/ecStat.min.js"></script><script src="libs/echarts4r/dataTool.min.js"></script><script src="libs/echarts4r-binding/echarts4r.js"></script><script src="libs/d3/d3.min.js"></script><script src="libs/forceNetwork-binding/forceNetwork.js"></script><link href="libs/vis/vis-network.min.css" rel="stylesheet">
<script src="libs/vis/vis-network.min.js"></script><script src="libs/visNetwork-binding/visNetwork.js"></script><script src="libs/FileSaver/FileSaver.min.js"></script><script src="libs/Blob/Blob.js"></script><script src="libs/canvas-toBlob/canvas-toBlob.js"></script><script src="libs/html2canvas/html2canvas.js"></script><script src="libs/jspdf/jspdf.debug.js"></script><link href="libs/jquery-sparkline/jquery.sparkline.css" rel="stylesheet">
<script src="libs/jquery-sparkline/jquery.sparkline.js"></script><script src="libs/sparkline-binding/sparkline.js"></script><script src="libs/r2d3-render/r2d3-render.js"></script><script src="libs/webcomponents/webcomponents.js"></script><script src="libs/r2d3-binding/r2d3.js"></script><script src="libs/d3v6/d3.min.js"></script><script src="libs/es6shim/es6shim.js"></script><script src="libs/es7shim/es7shim.js"></script><script src="libs/graphre/graphre.js"></script><script src="libs/nomnoml/nomnoml.js"></script><script src="libs/nomnoml-binding/nomnoml.js"></script><script src="libs/d3-bundle/d3-bundle.min.js"></script><script src="libs/d3-lasso/d3-lasso.min.js"></script><script src="libs/save-svg-as-png/save-svg-as-png.min.js"></script><link href="libs/ggiraphjs/ggiraphjs.min.css" rel="stylesheet">
<script src="libs/ggiraphjs/ggiraphjs.min.js"></script><script src="libs/girafe-binding/girafe.js"></script><link href="libs/datatables-css/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding/datatables.js"></script><link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core/js/jquery.dataTables.min.js"></script><script src="libs/jszip/jszip.min.js"></script><script src="libs/pdfmake/pdfmake.js"></script><script src="libs/pdfmake/vfs_fonts.js"></script><link href="libs/dt-ext-buttons/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="libs/dt-ext-buttons/js/dataTables.buttons.min.js"></script><script src="libs/dt-ext-buttons/js/buttons.flash.min.js"></script><script src="libs/dt-ext-buttons/js/buttons.html5.min.js"></script><script src="libs/dt-ext-buttons/js/buttons.colVis.min.js"></script><script src="libs/dt-ext-buttons/js/buttons.print.min.js"></script><link href="libs/dt-ext-rowgroup/css/rowGroup.dataTables.min.css" rel="stylesheet">
<script src="libs/dt-ext-rowgroup/js/dataTables.rowGroup.min.js"></script><script src="libs/kePrint/kePrint.js"></script><link href="libs/lightable/lightable.css" rel="stylesheet">
<script src="libs/echarts-world/world.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-54GQKWF7VP"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-54GQKWF7VP');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Modern Applied Statistics with R">现代应用统计与 R 语言</a>:
        <small class="text-muted">Modern Applied Statistics with R</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">欢迎</a></li>
<li><a class="" href="chap-preface.html"><span class="header-section-number">1</span> 前言</a></li>
<li class="book-part">数据整理</li>
<li><a class="" href="chap-data-wrangling.html">介绍</a></li>
<li><a class="" href="chap-data-structure.html"><span class="header-section-number">2</span> 数据结构</a></li>
<li><a class="" href="chap-data-transportation.html"><span class="header-section-number">3</span> 数据搬运</a></li>
<li><a class="" href="chap-string-operations.html"><span class="header-section-number">4</span> 字符串操作</a></li>
<li><a class="" href="chap-regular-expressions.html"><span class="header-section-number">5</span> 正则表达式</a></li>
<li><a class="" href="chap-data-manipulation.html"><span class="header-section-number">6</span> 数据操作</a></li>
<li><a class="" href="chap-advanced-manipulation.html"><span class="header-section-number">7</span> 高级数据操作</a></li>
<li><a class="" href="chap-parallel-manipulation.html"><span class="header-section-number">8</span> 并行化操作</a></li>
<li><a class="" href="chap-dplyr-manipulation.html"><span class="header-section-number">9</span> 净土化操作</a></li>
<li class="book-part">统计图形</li>
<li><a class="" href="chap-statistical-graphics.html">介绍</a></li>
<li><a class="" href="chap-graphics-foundations.html"><span class="header-section-number">10</span> 图形基础</a></li>
<li><a class="" href="chap-data-visualization.html"><span class="header-section-number">11</span> 数据可视化</a></li>
<li><a class="" href="chap-interactive-web-graphics.html"><span class="header-section-number">12</span> 交互图形</a></li>
<li class="book-part">动态文档</li>
<li><a class="" href="chap-dynamic-documents.html">介绍</a></li>
<li><a class="" href="chap-document-elements.html"><span class="header-section-number">13</span> 文档元素</a></li>
<li><a class="" href="chap-portable-document.html"><span class="header-section-number">14</span> 便携式文档</a></li>
<li><a class="" href="chap-web-documents.html"><span class="header-section-number">15</span> 网页文档</a></li>
<li><a class="" href="chap-office-document.html"><span class="header-section-number">16</span> 办公文档</a></li>
<li><a class="" href="chap-reproducible-workflows.html"><span class="header-section-number">17</span> 工作流</a></li>
<li><a class="" href="chap-advanced-documents.html"><span class="header-section-number">18</span> 高级文档</a></li>
<li class="book-part">数据产品</li>
<li><a class="" href="chap-data-product.html">介绍</a></li>
<li><a class="" href="chap-interactive-data-tables.html"><span class="header-section-number">19</span> 交互表格</a></li>
<li><a class="" href="chap-interactive-shiny-app.html"><span class="header-section-number">20</span> 交互报表</a></li>
<li class="book-part">统计基础</li>
<li><a class="" href="chap-statistical-foundations.html">介绍</a></li>
<li><a class="" href="chap-sampling-distributions.html"><span class="header-section-number">21</span> 抽样分布</a></li>
<li><a class="" href="chap-parameter-estimators.html"><span class="header-section-number">22</span> 参数估计</a></li>
<li><a class="" href="chap-hypothesis-test.html"><span class="header-section-number">23</span> 假设检验</a></li>
<li><a class="" href="chap-power-Analysis.html"><span class="header-section-number">24</span> 功效分析</a></li>
<li><a class="" href="chap-experimental-design.html"><span class="header-section-number">25</span> 试验设计</a></li>
<li class="book-part">统计模型</li>
<li><a class="" href="chap-statistical-models.html">介绍</a></li>
<li><a class="" href="chap-linear-models.html"><span class="header-section-number">26</span> 线性模型</a></li>
<li><a class="" href="chap-generalized-linear-models.html"><span class="header-section-number">27</span> 广义线性模型</a></li>
<li><a class="" href="chap-bayesian-models.html"><span class="header-section-number">28</span> 贝叶斯模型</a></li>
<li class="book-part">数据建模</li>
<li><a class="" href="chap-data-modeling.html">介绍</a></li>
<li><a class="" href="chap-text-analysis.html"><span class="header-section-number">29</span> 文本分析</a></li>
<li><a class="" href="chap-survival-analysis.html"><span class="header-section-number">30</span> 生存分析</a></li>
<li><a class="" href="chap-time-series-analysis.html"><span class="header-section-number">31</span> 时序分析</a></li>
<li class="book-part">时空数据</li>
<li><a class="" href="chap-spatio-temporal-data.html">介绍</a></li>
<li><a class="" href="chap-spatial-analysis.html"><span class="header-section-number">32</span> 空间数据分析</a></li>
<li><a class="" href="chap-spatial-modeling.html"><span class="header-section-number">33</span> 空间数据建模</a></li>
<li><a class="" href="chap-spatial-viz.html"><span class="header-section-number">34</span> 空间数据可视化</a></li>
<li><a class="active" href="chap-case-study.html"><span class="header-section-number">35</span> 案例研究</a></li>
<li><a class="" href="chap-data-explorer.html"><span class="header-section-number">36</span> 数据探索</a></li>
<li class="book-part">机器学习</li>
<li><a class="" href="chap-machine-learning.html">介绍</a></li>
<li><a class="" href="chap-gradient-boosting-machine.html"><span class="header-section-number">37</span> 梯度提升机</a></li>
<li><a class="" href="chap-numerical-optimization.html"><span class="header-section-number">38</span> 数值优化</a></li>
<li class="book-part">附录</li>
<li><a class="" href="chap-linux-command-bash.html"><span class="header-section-number">A</span> 命令行操作</a></li>
<li><a class="" href="chap-matrix-operations.html"><span class="header-section-number">B</span> 矩阵运算</a></li>
<li><a class="" href="chap-symbolic-computation.html"><span class="header-section-number">C</span> 符号计算</a></li>
<li><a class="" href="chap-mixed-programming.html"><span class="header-section-number">D</span> 混合编程</a></li>
<li><a class="" href="chap-object-oriented-programming.html"><span class="header-section-number">E</span> 面向对象编程</a></li>
<li><a class="" href="chap-file-operations.html"><span class="header-section-number">F</span> 文件操作</a></li>
<li><a class="" href="chap-other-softwares.html"><span class="header-section-number">G</span> 其它软件</a></li>
<li><a class="" href="chap-notations.html"><span class="header-section-number">H</span> 符号说明</a></li>
<li><a class="" href="references.html">参考文献</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/XiangyunHuang/masr">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="chap-case-study" class="section level1" number="35">
<h1>
<span class="header-section-number">第 35 章</span> 案例研究<a class="anchor" aria-label="anchor" href="#chap-case-study"><i class="fas fa-link"></i></a>
</h1>
<div class="sourceCode" id="cb2401"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://gganimate.com">gganimate</a></span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://renkun-ken.github.io/formattable/">formattable</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">packagemetrics</span><span class="op">)</span></code></pre></div>
<p>提升回归模型的10个提示
<a href="https://statmodeling.stat.columbia.edu/wp-content/uploads/2020/07/raos_tips.pdf">10 quick tips to improve your regression modeling</a></p>
<p><a href="https://github.com/tidymodels/tidymodels">tidymodels</a> 和 <a href="https://github.com/easystats/easystats">easystats</a> 都是基于 <a href="https://github.com/tidyverse/tidyverse">tidyverse</a> <span class="citation"><a href="#ref-Hadley_2019_tidyverse" role="doc-biblioref">[89]</a></span> 的统计模型套件，<a href="https://github.com/strengejacke/strengejacke">strengejacke</a>、 <a href="https://github.com/mlr-org/mlr3verse">mlr3verse</a> 目的和 tidymodels 差不多，都是提供做数据建模的完整解决方案，区别在于它不基于 tidyverse 这套东西。</p>
<p><a href="https://github.com/easystats/easystats">easystats</a> 包含 <a href="https://github.com/easystats/insight">insight</a> <span class="citation"><a href="#ref-ludecke2019insight" role="doc-biblioref">[90]</a></span> 和 <a href="https://github.com/easystats/bayestestR">bayestestR</a> <span class="citation"><a href="#ref-makowski2019bayestestr" role="doc-biblioref">[91]</a></span> 等共 9 个R 包，<a href="https://github.com/tidymodels/tidymodels">tidymodels</a> 也包含差不多量的 R 包。
<a href="https://github.com/ModelOriented/DrWhy">DrWhy</a>
<a href="https://github.com/harrelfe/rms">rms</a> Regression Modeling Strategies</p>
<p><a href="https://github.com/ddsjoberg/gtsummary">gtsummary</a>
<a href="https://github.com/vincentarelbundock/modelsummary">modelsummary</a> 整理模型输出，提供丰富的格式输出，如 PDF, Text/Markdown, LaTeX, MS Word, RTF, JPG, and PNG.</p>
<div class="sourceCode" id="cb2402"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gtsummary</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">modelsummary</span><span class="op">)</span></code></pre></div>
<p><a href="https://github.com/rfordatascience">R for Data Science Online Learning Community</a> 在线学习社区以 <a href="https://github.com/rfordatascience/tidytuesday">tidytuesday</a> 闻名遐迩。</p>
<pre class="nomnoml"><code>#padding: 25
#fontsize: 18
#stroke: #26A63A
#linewidth: 2

[Import] -&gt; [Understand]

[Understand |
  [Wrangle] -&gt; [Visualize]
  [Visualize] -&gt; [Model]
  [Model] -&gt; [Wrangle]
]

[Understand] -&gt; [Communicate]</code></pre>
<p>统计建模：两种文化 <span class="citation"><a href="#ref-Breiman_2001_Modeling" role="doc-biblioref">[92]</a></span></p>
<blockquote>
<p>这些案例来自 Kaggle、 Tudesday 或者自己找的数据集，而不是论文里，或者 R 包里的小数据集，应该更加真实，贴近实际问题，考虑更多细节</p>
</blockquote>
<div id="sec-life-of-statisticians" class="section level2" number="35.1">
<h2>
<span class="header-section-number">35.1</span> 统计学家生平<a class="anchor" aria-label="anchor" href="#sec-life-of-statisticians"><i class="fas fa-link"></i></a>
</h2>
<!-- 定位：不用任何数据建模的手段，我只是呈现数据本身，但是给人的感觉要达到，一眼就能获得一个直接的感觉，读者立马就能有个感觉，这个感觉就是知道影响统计学家寿命的重大因素有哪些，后续的检验只是帮助我们更加准确地知道影响的大小 -->
<p>世纪统计学家 100 位统计学家，寿命的影响因素，关联分析，图展示数据本身的</p>
<!-- https://github.com/XiangyunHuang/MSG-Book/issues/74 -->
<p>注明每位统计学家所在的年代经历的重大事件，如欧洲中世纪霍乱，第二次世界大战，文化大革命，用图形来讲故事，展现数据可视化的魅力，参考文献 <span class="citation"><a href="#ref-Statisticians_1997_Johnson" role="doc-biblioref">[93]</a></span></p>
</div>
<div id="sec-history-of-r" class="section level2" number="35.2">
<h2>
<span class="header-section-number">35.2</span> R 语言发展历史<a class="anchor" aria-label="anchor" href="#sec-history-of-r"><i class="fas fa-link"></i></a>
</h2>
<p>R 语言发展历史和现状，用图来表达</p>
</div>
<div id="sec-PlantGrowth" class="section level2" number="35.3">
<h2>
<span class="header-section-number">35.3</span> 不同实验条件下植物生长情况<a class="anchor" aria-label="anchor" href="#sec-PlantGrowth"><i class="fas fa-link"></i></a>
</h2>
<p>PlantGrowth 数据集收集自 Annette J. Dobson 所著书籍《An Introduction to Statistical Modelling》<span class="citation"><a href="#ref-Dobson_1983_Modelling" role="doc-biblioref">[94]</a></span> 第 2 章第 2 节的案例 — 研究植物在两种不同试验条件下的生长情况，植物通过光合作用吸收土壤的养分和空气中的二氧化碳，完成积累，故以植物的干重来刻画植物的生长情况，首先将几乎相同的种子随机地分配到实验组和对照组，基于完全随机实验设计（completely randomized experimental design），经过预定的时间后，将植物收割，干燥并称重，结果如表 <a href="chap-case-study.html#tab:PlantGrowth-data">35.1</a> 所示</p>
<div class="sourceCode" id="cb2404"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># do.call("cbind", lapply(split(PlantGrowth, f = PlantGrowth$group), subset, select = "weight"))</span>
<span class="co">## 或者</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/stars/reference/merge.html">split</a></span><span class="op">(</span><span class="va">PlantGrowth</span>, f <span class="op">=</span> <span class="va">PlantGrowth</span><span class="op">$</span><span class="va">group</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># 分组</span>
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">subset</span>, select <span class="op">=</span> <span class="st">"weight"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># 计算</span>
  <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span><span class="op">(</span><span class="st">"cbind"</span>, <span class="va">.</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># 合并</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="va">.</span>, <span class="fu"><a href="https://rdrr.io/pkg/raster/man/factor.html">levels</a></span><span class="op">(</span><span class="va">PlantGrowth</span><span class="op">$</span><span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># 重命名 `colnames&lt;-`(., levels(PlantGrowth$group))</span>
  <span class="va">t</span> <span class="op">%&gt;%</span> 
  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">.</span>,
    caption <span class="op">=</span> <span class="st">"不同生长环境下植物的干重"</span>, row.names <span class="op">=</span> <span class="cn">TRUE</span>,
    align <span class="op">=</span> <span class="st">"c"</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:PlantGrowth-data">表 35.1: </span>不同生长环境下植物的干重</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="center">1</th>
<th align="center">2</th>
<th align="center">3</th>
<th align="center">4</th>
<th align="center">5</th>
<th align="center">6</th>
<th align="center">7</th>
<th align="center">8</th>
<th align="center">9</th>
<th align="center">10</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ctrl</td>
<td align="center">4.17</td>
<td align="center">5.58</td>
<td align="center">5.18</td>
<td align="center">6.11</td>
<td align="center">4.50</td>
<td align="center">4.61</td>
<td align="center">5.17</td>
<td align="center">4.53</td>
<td align="center">5.33</td>
<td align="center">5.14</td>
</tr>
<tr class="even">
<td align="left">trt1</td>
<td align="center">4.81</td>
<td align="center">4.17</td>
<td align="center">4.41</td>
<td align="center">3.59</td>
<td align="center">5.87</td>
<td align="center">3.83</td>
<td align="center">6.03</td>
<td align="center">4.89</td>
<td align="center">4.32</td>
<td align="center">4.69</td>
</tr>
<tr class="odd">
<td align="left">trt2</td>
<td align="center">6.31</td>
<td align="center">5.12</td>
<td align="center">5.54</td>
<td align="center">5.50</td>
<td align="center">5.37</td>
<td align="center">5.29</td>
<td align="center">4.92</td>
<td align="center">6.15</td>
<td align="center">5.80</td>
<td align="center">5.26</td>
</tr>
</tbody>
</table></div>
<p>设立对照组（控制组）ctrl 和实验组 trt1 和 trt2，比较不同的处理方式对植物干重的影响</p>
<div class="sourceCode" id="cb2405"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summary.html">summary</a></span><span class="op">(</span><span class="va">PlantGrowth</span><span class="op">)</span></code></pre></div>
<pre><code>##      weight       group   
##  Min.   :3.590   ctrl:10  
##  1st Qu.:4.550   trt1:10  
##  Median :5.155   trt2:10  
##  Mean   :5.073            
##  3rd Qu.:5.530            
##  Max.   :6.310</code></pre>
<p>每个组都有10颗植物，生长情况如图<a href="chap-case-study.html#fig:plant-growth-fig">35.1</a>所示</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plant-growth-fig"></span>
<img src="case-study_files/figure-html/plant-growth-fig-1.png" alt="植物干重" width="45%"><img src="case-study_files/figure-html/plant-growth-fig-2.png" alt="植物干重" width="45%"><p class="caption">
图 35.1: 植物干重
</p>
</div>
<p>实验条件 trt1 和 trt2 对植物生长状况有显著的影响，为了量化这种影响，建立线性回归模型</p>
<div class="sourceCode" id="cb2407"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_sublm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">group</span>,
  data <span class="op">=</span> <span class="va">PlantGrowth</span>,
  subset <span class="op">=</span> <span class="va">group</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="st">"ctrl"</span>, <span class="st">"trt1"</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">fit_sublm</span><span class="op">)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: weight
##           Df Sum Sq Mean Sq F value Pr(&gt;F)
## group      1 0.6882 0.68820  1.4191  0.249
## Residuals 18 8.7292 0.48496</code></pre>
<div class="sourceCode" id="cb2409"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_sublm</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = weight ~ group, data = PlantGrowth, subset = group %in% 
##     c("ctrl", "trt1"))
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.0710 -0.4938  0.0685  0.2462  1.3690 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   5.0320     0.2202  22.850 9.55e-15 ***
## grouptrt1    -0.3710     0.3114  -1.191    0.249    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.6964 on 18 degrees of freedom
## Multiple R-squared:  0.07308,    Adjusted R-squared:  0.02158 
## F-statistic: 1.419 on 1 and 18 DF,  p-value: 0.249</code></pre>
<p>下面再通过检验的方式比较实验组和对照组相比，是否有显著作用</p>
<div class="sourceCode" id="cb2411"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 控制组和实验组1比较</span>
<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">PlantGrowth</span>, subset <span class="op">=</span> <span class="va">group</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="st">"ctrl"</span>, <span class="st">"trt1"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  weight by group
## t = 1.1913, df = 16.524, p-value = 0.2504
## alternative hypothesis: true difference in means between group ctrl and group trt1 is not equal to 0
## 95 percent confidence interval:
##  -0.2875162  1.0295162
## sample estimates:
## mean in group ctrl mean in group trt1 
##              5.032              4.661</code></pre>
<div class="sourceCode" id="cb2413"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 控制组和实验组2比较</span>
<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">PlantGrowth</span>, subset <span class="op">=</span> <span class="va">group</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="st">"ctrl"</span>, <span class="st">"trt2"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  weight by group
## t = -2.134, df = 16.786, p-value = 0.0479
## alternative hypothesis: true difference in means between group ctrl and group trt2 is not equal to 0
## 95 percent confidence interval:
##  -0.98287213 -0.00512787
## sample estimates:
## mean in group ctrl mean in group trt2 
##              5.032              5.526</code></pre>
<p>检验结果表明，实验条件 trt2 会对植物生长产生显著效果，而实验条件 trt1 不会。在假定同方差的情况下，建立线性回归模型，同时考虑实验条件 trt1 和 trt2</p>
<div class="sourceCode" id="cb2415"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 模型拟合</span>
<span class="va">fit_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">PlantGrowth</span><span class="op">)</span>

<span class="co">## 模型输出</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_lm</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = weight ~ group, data = PlantGrowth)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.0710 -0.4180 -0.0060  0.2627  1.3690 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   5.0320     0.1971  25.527   &lt;2e-16 ***
## grouptrt1    -0.3710     0.2788  -1.331   0.1944    
## grouptrt2     0.4940     0.2788   1.772   0.0877 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.6234 on 27 degrees of freedom
## Multiple R-squared:  0.2641, Adjusted R-squared:  0.2096 
## F-statistic: 4.846 on 2 and 27 DF,  p-value: 0.01591</code></pre>
<div class="sourceCode" id="cb2417"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## 方差分析</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">fit_lm</span><span class="op">)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: weight
##           Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
## group      2  3.7663  1.8832  4.8461 0.01591 *
## Residuals 27 10.4921  0.3886                  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<div class="sourceCode" id="cb2419"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## 参数估计</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_lm</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##             Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept)    5.032  0.1971284 25.526514 1.936575e-20
## grouptrt1     -0.371  0.2787816 -1.330791 1.943879e-01
## grouptrt2      0.494  0.2787816  1.771996 8.768168e-02</code></pre>
<p>模型输出整理成表 <a href="chap-case-study.html#tab:lm-plant-growth-output">35.2</a> 所示</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:lm-plant-growth-output">表 35.2: </span>线性回归的输出</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">估计值</th>
<th align="right">标准差</th>
<th align="right">t 统计量</th>
<th align="right">P 值</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(\alpha\)</span></td>
<td align="right">5.032</td>
<td align="right">0.1971</td>
<td align="right">25.5265</td>
<td align="right">0.0000</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\beta_1\)</span></td>
<td align="right">-0.371</td>
<td align="right">0.2788</td>
<td align="right">-1.3308</td>
<td align="right">0.1944</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\beta_2\)</span></td>
<td align="right">0.494</td>
<td align="right">0.2788</td>
<td align="right">1.7720</td>
<td align="right">0.0877</td>
</tr>
</tbody>
</table></div>
<p>还可以将模型转化为数学公式</p>
<div class="sourceCode" id="cb2421"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 理论模型</span>
<span class="fu">equatiomatic</span><span class="fu">::</span><span class="fu"><a href="https://datalorax.github.io/equatiomatic/reference/extract_eq.html">extract_eq</a></span><span class="op">(</span><span class="va">fit_lm</span><span class="op">)</span></code></pre></div>
<p><span class="math display">\[
\operatorname{weight} = \alpha + \beta_{1}(\operatorname{group}_{\operatorname{trt1}}) + \beta_{2}(\operatorname{group}_{\operatorname{trt2}}) + \epsilon
\]</span></p>
<div class="sourceCode" id="cb2422"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 拟合模型</span>
<span class="fu">equatiomatic</span><span class="fu">::</span><span class="fu"><a href="https://datalorax.github.io/equatiomatic/reference/extract_eq.html">extract_eq</a></span><span class="op">(</span><span class="va">fit_lm</span>, use_coefs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><span class="math display">\[
\operatorname{\widehat{weight}} = 5.03 - 0.37(\operatorname{group}_{\operatorname{trt1}}) + 0.49(\operatorname{group}_{\operatorname{trt2}})
\]</span></p>
<p>进一步地，我们在线性模型的基础上考虑每个实验组有不同的方差，先做方差齐性检验。</p>
<div class="sourceCode" id="cb2423"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/bartlett.test.html">bartlett.test</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">PlantGrowth</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  weight by group
## Bartlett's K-squared = 2.8786, df = 2, p-value = 0.2371</code></pre>
<div class="sourceCode" id="cb2425"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/fligner.test.html">fligner.test</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">PlantGrowth</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Fligner-Killeen test of homogeneity of variances
## 
## data:  weight by group
## Fligner-Killeen:med chi-squared = 2.3499, df = 2, p-value = 0.3088</code></pre>
<p>检验的结果显示，可以认为三个组的方差没有显著差异，但我们还是考虑每个组有不同的方差，看看放开假设能获得多少提升，后续会发现，从对数似然的角度来看，实际提升量很小，只有 7.72%</p>
<p>上面同时比较多个总体的方差，会发现方差没有显著差异，那么接下来在假定方差齐性的条件下，比较均值的差异是否显著？</p>
<div class="sourceCode" id="cb2427"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 参数检验，假定异方差</span>
<span class="fu"><a href="https://rdrr.io/r/stats/oneway.test.html">oneway.test</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">PlantGrowth</span>, var.equal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  One-way analysis of means (not assuming equal variances)
## 
## data:  weight and group
## F = 5.181, num df = 2.000, denom df = 17.128, p-value = 0.01739</code></pre>
<div class="sourceCode" id="cb2429"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 参数检验，假定方差齐性</span>
<span class="fu"><a href="https://rdrr.io/r/stats/oneway.test.html">oneway.test</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">PlantGrowth</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  One-way analysis of means
## 
## data:  weight and group
## F = 4.8461, num df = 2, denom df = 27, p-value = 0.01591</code></pre>
<div class="sourceCode" id="cb2431"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 非参数检验</span>
<span class="fu"><a href="https://rdrr.io/r/stats/kruskal.test.html">kruskal.test</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">PlantGrowth</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  weight by group
## Kruskal-Wallis chi-squared = 7.9882, df = 2, p-value = 0.01842</code></pre>
<p>检验结果显示它们的均值是有显著差异的！</p>
<div class="sourceCode" id="cb2433"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 固定效应模型</span>
<span class="va">fit_gls</span> <span class="op">&lt;-</span> <span class="fu">nlme</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/gls.html">gls</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="fl">1</span>,
  weights <span class="op">=</span> <span class="fu">nlme</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/varIdent.html">varIdent</a></span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">group</span><span class="op">)</span>,
  data <span class="op">=</span> <span class="va">PlantGrowth</span>, method <span class="op">=</span> <span class="st">"REML"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_gls</span><span class="op">)</span></code></pre></div>
<pre><code>## Generalized least squares fit by REML
##   Model: weight ~ 1 
##   Data: PlantGrowth 
##        AIC      BIC    logLik
##   70.48628 75.95547 -31.24314
## 
## Variance function:
##  Structure: Different standard deviations per stratum
##  Formula: ~1 | group 
##  Parameter estimates:
##      ctrl      trt1      trt2 
## 1.0000000 1.5825700 0.9230865 
## 
## Coefficients:
##                Value Std.Error  t-value p-value
## (Intercept) 5.199759 0.1162421 44.73214       0
## 
## Standardized residuals:
##         Min          Q1         Med          Q3         Max 
## -1.74647988 -0.91870713 -0.07591108  0.60676033  2.03987301 
## 
## Residual standard error: 0.5896195 
## Degrees of freedom: 30 total; 29 residual</code></pre>
<div class="sourceCode" id="cb2435"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 随机效应模型</span>
<span class="va">fit_lme</span> <span class="op">&lt;-</span> <span class="fu">nlme</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html">lme</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="fl">1</span>, random <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">PlantGrowth</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_lme</span><span class="op">)</span></code></pre></div>
<pre><code>## Linear mixed-effects model fit by REML
##   Data: PlantGrowth 
##        AIC      BIC    logLik
##   67.44473 71.54662 -30.72237
## 
## Random effects:
##  Formula: ~1 | group
##         (Intercept)  Residual
## StdDev:   0.3865976 0.6233746
## 
## Fixed effects:  weight ~ 1 
##             Value Std.Error DF  t-value p-value
## (Intercept) 5.073 0.2505443 27 20.24792       0
## 
## Standardized Within-Group Residuals:
##          Min           Q1          Med           Q3          Max 
## -1.854449795 -0.688750457  0.006389611  0.406096866  2.059729645 
## 
## Number of Observations: 30
## Number of Groups: 3</code></pre>
<p><span class="math inline">\(\sigma_i^2 = Var(\epsilon_{ij}), i = 1,2,3\)</span> 表示第 <span class="math inline">\(i\)</span> 组的方差，</p>
<p><span class="math display">\[
y_{ij} = \mu + \epsilon_{ij}, i = 1,2,3
\]</span></p>
<p>其中 <span class="math inline">\(\mu\)</span> 是固定的未知参数，我们和之前假定同方差情形下的模型比较一下，现在异方差情况下模型提升的情况，从对数似然的角度来看</p>
<div class="sourceCode" id="cb2437"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">fit_lm</span><span class="op">)</span>
<span class="co">## 'log Lik.' -26.80952 (df=4)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">fit_lm</span>, REML <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">## 'log Lik.' -29.00481 (df=4)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">fit_gls</span><span class="op">)</span>
<span class="co">## 'log Lik.' -31.24314 (df=4)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">fit_lme</span><span class="op">)</span>
<span class="co">## 'log Lik.' -30.72237 (df=3)</span></code></pre></div>
<p>进一步地，我们考虑两水平模型，认为不同的实验组其均值和方差都不一样，检验三样本均值是否相等？</p>
<p><span class="math inline">\(\mu_1 = \mu_2 = \mu_3\)</span> 检验，这里因为每组的样本量都一样，因此考虑 Turkey 的 T 法检验，检验均值是否有显著差别，实际上这里因为实验组数量只有2个，可以两两比对，如前所述。但是这里我们想扩展一下，考虑多组比较的问题。</p>
<!-- 书籍 《概率论与数理统计教程》438 页重复数相等场合下的多重比较 T 法 [@Prob_2011_Mao] -->
<p>和上面用 <code>gls</code> 拟合的模型是一致的。</p>
<p><span class="math display">\[\begin{align}
y_{ij}&amp; = \mu_i + \epsilon_{ij}, \\
\mu_i &amp; = \mu_{\theta} + \xi_i. \quad i  = 1,\ldots,3; \quad j = 1, \ldots, 10.
\end{align}\]</span></p>
<p>其中 <span class="math inline">\(\mu_i\)</span> 是随机的未知变量，服从均值为 <span class="math inline">\(\mu_{\theta}\)</span> 方差为 <span class="math inline">\(Var(\xi_i) = \tau^2\)</span> 的正态分布</p>
<p>我们用 <strong>MASS</strong> 包提供的 <code><a href="https://rdrr.io/pkg/MASS/man/glmmPQL.html">glmmPQL()</a></code> 函数拟合该数据集</p>
<div class="sourceCode" id="cb2438"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_lme_pql</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/glmmPQL.html">glmmPQL</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="fl">1</span>,
  random <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">group</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>,
  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">PlantGrowth</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_lme_pql</span><span class="op">)</span></code></pre></div>
<pre><code>## Linear mixed-effects model fit by maximum likelihood
##   Data: PlantGrowth 
##   AIC BIC logLik
##    NA  NA     NA
## 
## Random effects:
##  Formula: ~1 | group
##         (Intercept)  Residual
## StdDev:   0.2944234 0.6233746
## 
## Variance function:
##  Structure: fixed weights
##  Formula: ~invwt 
## Fixed effects:  weight ~ 1 
##             Value Std.Error DF  t-value p-value
## (Intercept) 5.073 0.2080656 27 24.38174       0
## 
## Standardized Within-Group Residuals:
##          Min           Q1          Med           Q3          Max 
## -1.922640850 -0.734727623  0.004564386  0.405111223  1.991538416 
## 
## Number of Observations: 30
## Number of Groups: 3</code></pre>
<p>我们再借助 <strong>brms</strong> 包从贝叶斯的角度来分析数据，并建模</p>
<!-- 就以 brms 包为例谈谈先验、参数设置，默认的先验有可能太宽泛了，导致不是很合理 <https://discourse.mc-stan.org/t/11584> -->
<div class="sourceCode" id="cb2440"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 贝叶斯模型</span>
<span class="va">fit_brm</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/brms/man/brm.html">brm</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">PlantGrowth</span><span class="op">)</span>
<span class="co"># 参考 https://www.xiangyunhuang.com.cn/2019/05/normal-hierarchical-model/</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.rcpp.org">Rcpp</a></span><span class="op">)</span>
<span class="va">fit_lme_brm</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/brms/man/brm.html">brm</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">group</span><span class="op">)</span>,
  data <span class="op">=</span> <span class="va">PlantGrowth</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span>, 
  refresh <span class="op">=</span> <span class="fl">0</span>, seed <span class="op">=</span> <span class="fl">2019</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_lme_brm</span><span class="op">)</span></code></pre></div>
</div>
<div id="sec-orange" class="section level2" number="35.4">
<h2>
<span class="header-section-number">35.4</span> 橘树生长情况<a class="anchor" aria-label="anchor" href="#sec-orange"><i class="fas fa-link"></i></a>
</h2>
<!-- 非线性混合效应模型 {#chap-nonlinear-mixed-models} -->
<p>Orange 数据集包含三个变量，记录了加利福尼亚南部的一个小树林中的五棵橘树的生长情况，在 <strong>datasets</strong> 包里，数据集保存为 <code><a href="https://rdrr.io/pkg/terra/man/c.html">c("nfnGroupedData", "nfGroupedData", "groupedData", "data.frame")</a></code> 类型的数据，同时具有着四个类的特点。</p>
<ul>
<li>Tree: 有序的指示变量，根据5棵橘树的最大直径划分，测量值很可能是根据林务员常用的“胸围周长”</li>
<li>age: 橘树的树龄，自 1968 年 12 月 31 日起按天计算</li>
<li>circumference: 橘树树干的周长，单位是毫米</li>
</ul>
<p>查看部分数据的情况</p>
<div class="sourceCode" id="cb2441"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">head</a></span><span class="op">(</span><span class="va">Orange</span><span class="op">)</span></code></pre></div>
<pre><code>## Grouped Data: circumference ~ age | Tree
##   Tree  age circumference
## 1    1  118            30
## 2    1  484            58
## 3    1  664            87
## 4    1 1004           115
## 5    1 1231           120
## 6    1 1372           142</code></pre>
<p>查看变量的属性</p>
<div class="sourceCode" id="cb2443"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">Orange</span><span class="op">)</span></code></pre></div>
<pre><code>## Classes 'nfnGroupedData', 'nfGroupedData', 'groupedData' and 'data.frame':   35 obs. of  3 variables:
##  $ Tree         : Ord.factor w/ 5 levels "3"&lt;"1"&lt;"5"&lt;"2"&lt;..: 2 2 2 2 2 2 2 4 4 4 ...
##  $ age          : num  118 484 664 1004 1231 ...
##  $ circumference: num  30 58 87 115 120 142 145 33 69 111 ...
##  - attr(*, "formula")=Class 'formula'  language circumference ~ age | Tree
##   .. ..- attr(*, ".Environment")=&lt;environment: R_EmptyEnv&gt; 
##  - attr(*, "labels")=List of 2
##   ..$ x: chr "Time since December 31, 1968"
##   ..$ y: chr "Trunk circumference"
##  - attr(*, "units")=List of 2
##   ..$ x: chr "(days)"
##   ..$ y: chr "(mm)"</code></pre>
<p>说明 5 棵树之间的大小关系是 <code>3 &lt; 1 &lt; 5 &lt; 2 &lt; 4</code>，这里的数字 1，2，3，4，5 只是对树的编号，第一次测量时树的大小关系在 R 内用有序因子来表示。</p>
<div class="sourceCode" id="cb2445"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/factor.html">levels</a></span><span class="op">(</span><span class="va">Orange</span><span class="op">$</span><span class="va">Tree</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "3" "1" "5" "2" "4"</code></pre>
<p>表 <a href="chap-case-study.html#tab:orange-data">35.3</a> 记录了 5 颗橘树自 1968 年 12 月 31 日以来的生长情况</p>
<div class="sourceCode" id="cb2447"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># aggregate(data = Orange, circumference ~  age, FUN = mean)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/reshape.html">reshape</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">Orange</span>, v.names <span class="op">=</span> <span class="st">"circumference"</span>, idvar <span class="op">=</span> <span class="st">"Tree"</span>,
  timevar <span class="op">=</span> <span class="st">"age"</span>, direction <span class="op">=</span> <span class="st">"wide"</span>, sep <span class="op">=</span> <span class="st">""</span>
<span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">.</span>,
    caption <span class="op">=</span> <span class="st">"躯干周长（毫米）随时间（天）的变化"</span>,
    row.names <span class="op">=</span> <span class="cn">FALSE</span>, col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"(circumference)"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/pkg/raster/man/names.html">names</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span>,
    align <span class="op">=</span> <span class="st">"c"</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:orange-data">表 35.3: </span>躯干周长（毫米）随时间（天）的变化</caption>
<thead><tr class="header">
<th align="center">Tree</th>
<th align="center">118</th>
<th align="center">484</th>
<th align="center">664</th>
<th align="center">1004</th>
<th align="center">1231</th>
<th align="center">1372</th>
<th align="center">1582</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">30</td>
<td align="center">58</td>
<td align="center">87</td>
<td align="center">115</td>
<td align="center">120</td>
<td align="center">142</td>
<td align="center">145</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">33</td>
<td align="center">69</td>
<td align="center">111</td>
<td align="center">156</td>
<td align="center">172</td>
<td align="center">203</td>
<td align="center">203</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">30</td>
<td align="center">51</td>
<td align="center">75</td>
<td align="center">108</td>
<td align="center">115</td>
<td align="center">139</td>
<td align="center">140</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">32</td>
<td align="center">62</td>
<td align="center">112</td>
<td align="center">167</td>
<td align="center">179</td>
<td align="center">209</td>
<td align="center">214</td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="center">30</td>
<td align="center">49</td>
<td align="center">81</td>
<td align="center">125</td>
<td align="center">142</td>
<td align="center">174</td>
<td align="center">177</td>
</tr>
</tbody>
</table></div>
<p>图 <a href="chap-case-study.html#fig:orange-tree">35.2</a> 以直观的方式展示 5 颗橘树的生长变化，相比于表 <a href="chap-case-study.html#tab:orange-data">35.3</a> 我们能更加明确读取数据中的变化</p>
<div class="sourceCode" id="cb2448"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Orange</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">circumference</span>, color <span class="op">=</span> <span class="va">Tree</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"age (day)"</span>, y <span class="op">=</span> <span class="st">"circumference (mm)"</span><span class="op">)</span>
<span class="va">p</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:orange-tree"></span>
<img src="case-study_files/figure-html/orange-tree-1.png" alt="橘树生长模型" width="2100"><p class="caption">
图 35.2: 橘树生长模型
</p>
</div>
<div class="sourceCode" id="cb2449"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://gganimate.com">gganimate</a></span><span class="op">)</span>
<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://gganimate.com/reference/transition_reveal.html">transition_reveal</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="case-study_files/figure-html/unnamed-chunk-9-1.gif" style="display: block; margin: auto;"></div>
</div>
<div id="pkg-network" class="section level2" number="35.5">
<h2>
<span class="header-section-number">35.5</span> R 包网络分析<a class="anchor" aria-label="anchor" href="#pkg-network"><i class="fas fa-link"></i></a>
</h2>
<p>首先我们从 CRAN 官网下载 R 包描述信息</p>
<div class="sourceCode" id="cb2450"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pdb</span> <span class="op">&lt;-</span> <span class="fu">tools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/tools/CRANtools.html">CRAN_package_db</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>接着，我们可以看看CRAN 上发布的 R 包数量</p>
<div class="sourceCode" id="cb2451"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html">length</a></span><span class="op">(</span><span class="va">pdb</span><span class="op">[</span>, <span class="st">"Package"</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 18317</code></pre>
<p>经过与官网发布的数据来对比，我们发现这里计算的结果与实际不符，多出来了几十个R包，所以我们再观察一下是否有重复的 R 包描述信息</p>
<div class="sourceCode" id="cb2453"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pdb</span><span class="op">[</span>, <span class="st">"Package"</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">duplicated</a></span><span class="op">(</span><span class="va">pdb</span><span class="op">[</span>, <span class="st">"Package"</span><span class="op">]</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<pre><code>##  [1] "boot"       "class"      "cluster"    "codetools"  "foreign"   
##  [6] "KernSmooth" "lattice"    "MASS"       "Matrix"     "mgcv"      
## [11] "nlme"       "nnet"       "rpart"      "spatial"    "survival"  
## [16] "RODBC"      "XML"</code></pre>
<p>不难发现，果然有！所以去掉重复的 R 包信息，就是 CRAN 上实际发布的 R 包数量</p>
<div class="sourceCode" id="cb2455"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/dimensions.html">dim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/subset.html">subset</a></span><span class="op">(</span><span class="va">pdb</span>, subset <span class="op">=</span> <span class="op">!</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">duplicated</a></span><span class="op">(</span><span class="va">pdb</span><span class="op">[</span>, <span class="st">"Package"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></code></pre></div>
<pre><code>## [1] 18300</code></pre>
<p>接下来就是分析去掉重复信息后的数据矩阵 pdb</p>
<div class="sourceCode" id="cb2457"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/subset.html">subset</a></span><span class="op">(</span><span class="va">pdb</span>, subset <span class="op">=</span> <span class="op">!</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">duplicated</a></span><span class="op">(</span><span class="va">pdb</span><span class="op">[</span>, <span class="st">"Package"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="R-Core-Team" class="section level3" number="35.5.1">
<h3>
<span class="header-section-number">35.5.1</span> R 核心团队<a class="anchor" aria-label="anchor" href="#R-Core-Team"><i class="fas fa-link"></i></a>
</h3>
<p>R 核心团队除了维护开发 Base R 包以外，还开发了哪些 R 包，我们依据这些开发者邮箱 <code>&lt;Firstname&gt;.&lt;Lastname&gt;@R-project.org</code> 的特点，从数据集 pdb 中提取他们开发的 R 包</p>
<div class="sourceCode" id="cb2458"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">core_pdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/subset.html">subset</a></span><span class="op">(</span><span class="va">pdb</span>,
  subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span>,
    pattern <span class="op">=</span> <span class="st">"(@R-project\\.org)"</span>
  <span class="op">)</span>,
  select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="st">"Package"</span>, <span class="st">"Maintainer"</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/dimensions.html">dim</a></span><span class="op">(</span><span class="va">core_pdb</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">core_pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 104   2</code></pre>
<p>这么少，是不是有点意外，看来很多大佬更喜欢用自己的邮箱，比如 Paul Murrell， 他的邮箱是 <a href="mailto:paul@stat.auckland.ac.nz" class="email">paul@stat.auckland.ac.nz</a></p>
<div class="sourceCode" id="cb2460"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/subset.html">subset</a></span><span class="op">(</span><span class="va">pdb</span>,
  subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span>, pattern <span class="op">=</span> <span class="st">"(Paul Murrell)"</span><span class="op">)</span>,
  select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="st">"Package"</span>, <span class="st">"Maintainer"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<pre><code>##            Package                              Maintainer
## 2513       compare Paul Murrell &lt;p.murrell@auckland.ac.nz&gt;
## 5722         gdiff Paul Murrell &lt;paul@stat.auckland.ac.nz&gt;
## 6465      gridBase Paul Murrell &lt;paul@stat.auckland.ac.nz&gt;
## 6466    gridBezier Paul Murrell &lt;paul@stat.auckland.ac.nz&gt;
## 6467     gridDebug Paul Murrell &lt;p.murrell@auckland.ac.nz&gt;
## 6469  gridGeometry Paul Murrell &lt;paul@stat.auckland.ac.nz&gt;
## 6470  gridGraphics Paul Murrell &lt;paul@stat.auckland.ac.nz&gt;
## 6471  gridGraphviz Paul Murrell &lt;p.murrell@auckland.ac.nz&gt;
## 6475       gridSVG Paul Murrell &lt;paul@stat.auckland.ac.nz&gt;
## 6478      grImport Paul Murrell &lt;p.murrell@auckland.ac.nz&gt;
## 6479     grImport2 Paul Murrell &lt;paul@stat.auckland.ac.nz&gt;
## 6802       hexView Paul Murrell &lt;paul@stat.auckland.ac.nz&gt;
## 9211      metapost Paul Murrell &lt;paul@stat.auckland.ac.nz&gt;
## 12864    rasterize Paul Murrell &lt;paul@stat.auckland.ac.nz&gt;
## 13597    RGraphics Paul Murrell &lt;paul@stat.auckland.ac.nz&gt;
## 14025        roloc Paul Murrell &lt;paul@stat.auckland.ac.nz&gt;
## 14026 rolocISCCNBS Paul Murrell &lt;paul@stat.auckland.ac.nz&gt;
## 17840       vwline Paul Murrell &lt;paul@stat.auckland.ac.nz&gt;</code></pre>
<p>所以这种方式不行了，只能列举所有 R Core Team 成员，挨个去匹配，幸好 <code><a href="https://rdrr.io/r/base/contributors.html">contributors()</a></code> 函数已经收集了成员名单，不需要我们去官网找了。</p>
<div class="sourceCode" id="cb2462"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">core_team</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span>
  text <span class="op">=</span> <span class="st">"
Douglas Bates
John Chambers
Peter Dalgaard
Robert Gentleman
Kurt Hornik
Ross Ihaka
Tomas Kalibera
Michael Lawrence
Friedrich Leisch
Uwe Ligges
Thomas Lumley
Martin Maechler
Martin Morgan
Paul Murrell
Martyn Plummer
Brian Ripley
Deepayan Sarkar
Duncan Temple Lang
Luke Tierney
Simon Urbanek
Heiner Schwarte
Guido Masarotto
Stefano Iacus
Seth Falcon
Duncan Murdoch
David Meyer
Simon Wood
"</span>, header <span class="op">=</span> <span class="cn">FALSE</span>, sep <span class="op">=</span> <span class="st">"\n"</span>, 
  check.names <span class="op">=</span> <span class="cn">FALSE</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span>,
  colClasses <span class="op">=</span> <span class="st">"character"</span>, comment.char <span class="op">=</span> <span class="st">""</span>, col.names <span class="op">=</span> <span class="st">"name"</span>
<span class="op">)</span></code></pre></div>
<p>R 核心团队维护的 R 包及其最新发布的日期</p>
<div class="sourceCode" id="cb2463"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">core_pdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/subset.html">subset</a></span><span class="op">(</span><span class="va">pdb</span>,
  subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span>,
    pattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"("</span>, <span class="va">core_team</span><span class="op">$</span><span class="va">name</span>, <span class="st">")"</span>, collapse <span class="op">=</span> <span class="st">"|"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
  <span class="op">)</span>,
  select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="st">"Package"</span>, <span class="st">"Maintainer"</span>, <span class="st">"Published"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>清理 Maintainer 字段中的邮箱部分，方便表格展示</p>
<div class="sourceCode" id="cb2464"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">clean_maintainer</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># 去掉邮箱</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"&lt;([^&lt;&gt;]*)&gt;"</span>, <span class="st">""</span>, <span class="va">x</span><span class="op">)</span>
  <span class="co"># 去掉 \n \t \' \" 和 '</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"(\\\n)|(\\\t)|(\\\")|(\\\')|(')"</span>, <span class="st">""</span>, <span class="va">x</span><span class="op">)</span>
  <span class="co"># 去掉末尾空格</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">" +$"</span>, <span class="st">""</span>, <span class="va">x</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">core_pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">clean_maintainer</span><span class="op">(</span><span class="va">core_pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p>我们可以看到 R 核心团队总共开发维护有 173 个 R 包</p>
<div class="sourceCode" id="cb2465"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/dimensions.html">dim</a></span><span class="op">(</span><span class="va">core_pdb</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 173   3</code></pre>
<p>篇幅所限，就展示部分人和R包，见表 <a href="chap-case-study.html#tab:r-core-team">35.4</a> 按照拼音顺序 Brian Ripley 是第一位</p>
<div class="sourceCode" id="cb2467"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">head</a></span><span class="op">(</span><span class="va">core_pdb</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span>
  <span class="va">core_pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span>,
  <span class="va">core_pdb</span><span class="op">[</span>, <span class="st">"Published"</span><span class="op">]</span>
<span class="op">)</span>, <span class="op">]</span>, <span class="fl">6</span><span class="op">)</span>,
caption <span class="op">=</span> <span class="st">"R Core Team 维护的 R 包（展示部分）"</span>, 
booktabs <span class="op">=</span> <span class="cn">TRUE</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:r-core-team">表 35.4: </span>R Core Team 维护的 R 包（展示部分）</caption>
<thead><tr class="header">
<th align="left">Package</th>
<th align="left">Maintainer</th>
<th align="left">Published</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">mix</td>
<td align="left">Brian Ripley</td>
<td align="left">2017-06-12</td>
</tr>
<tr class="even">
<td align="left">pspline</td>
<td align="left">Brian Ripley</td>
<td align="left">2017-06-12</td>
</tr>
<tr class="odd">
<td align="left">gee</td>
<td align="left">Brian Ripley</td>
<td align="left">2019-11-07</td>
</tr>
<tr class="even">
<td align="left">boot</td>
<td align="left">Brian Ripley</td>
<td align="left">2021-05-03</td>
</tr>
<tr class="odd">
<td align="left">class</td>
<td align="left">Brian Ripley</td>
<td align="left">2021-05-03</td>
</tr>
<tr class="even">
<td align="left">KernSmooth</td>
<td align="left">Brian Ripley</td>
<td align="left">2021-05-03</td>
</tr>
</tbody>
</table></div>
<p>分组计数，看看核心开发者维护的 R 包有多少</p>
<div class="sourceCode" id="cb2468"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/aggregate.sf.html">aggregate</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">core_pdb</span>, <span class="va">Package</span> <span class="op">~</span> <span class="va">Maintainer</span>, FUN <span class="op">=</span> <span class="va">length</span><span class="op">)</span> |&gt; 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">Maintainer</span>, <span class="va">Package</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">Package</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"R 核心团队"</span>, y <span class="op">=</span> <span class="st">"R 包数量"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"source-han-serif-cn"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="case-study_files/figure-html/unnamed-chunk-21-1.png" width="75%" style="display: block; margin: auto;"></div>
</div>
<div id="Top-Creators" class="section level3" number="35.5.2">
<h3>
<span class="header-section-number">35.5.2</span> 高产的开发者<a class="anchor" aria-label="anchor" href="#Top-Creators"><i class="fas fa-link"></i></a>
</h3>
<blockquote>
<p>这些人的个人简介</p>
</blockquote>
<p>接下来，我们再来查看一些比较高产的 R 包开发者谢益辉都维护了哪些R包，如表 <a href="chap-case-study.html#tab:rmarkdown-ecology">35.5</a> 所示</p>
<div class="sourceCode" id="cb2469"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">yihui_pdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/subset.html">subset</a></span><span class="op">(</span><span class="va">pdb</span>,
  subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Yihui Xie"</span>, <span class="va">pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span><span class="op">)</span>,
  select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="st">"Package"</span>, <span class="st">"Title"</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">yihui_pdb</span><span class="op">[</span>, <span class="st">"Title"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"(\\\n)"</span>, <span class="st">" "</span>, <span class="va">yihui_pdb</span><span class="op">[</span>, <span class="st">"Title"</span><span class="op">]</span><span class="op">)</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">yihui_pdb</span>,
  caption <span class="op">=</span> <span class="st">"谢益辉维护的 R Markdown 生态"</span>,
  booktabs <span class="op">=</span> <span class="cn">TRUE</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:rmarkdown-ecology">表 35.5: </span>谢益辉维护的 R Markdown 生态</caption>
<colgroup>
<col width="10%">
<col width="89%">
</colgroup>
<thead><tr class="header">
<th align="left">Package</th>
<th align="left">Title</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">animation</td>
<td align="left">A Gallery of Animations in Statistics and Utilities to Create Animations</td>
</tr>
<tr class="even">
<td align="left">blogdown</td>
<td align="left">Create Blogs and Websites with R Markdown</td>
</tr>
<tr class="odd">
<td align="left">bookdown</td>
<td align="left">Authoring Books and Technical Documents with R Markdown</td>
</tr>
<tr class="even">
<td align="left">DT</td>
<td align="left">A Wrapper of the JavaScript Library ‘DataTables’</td>
</tr>
<tr class="odd">
<td align="left">evaluate</td>
<td align="left">Parsing and Evaluation Tools that Provide More Details than the Default</td>
</tr>
<tr class="even">
<td align="left">formatR</td>
<td align="left">Format R Code Automatically</td>
</tr>
<tr class="odd">
<td align="left">fun</td>
<td align="left">Use R for Fun</td>
</tr>
<tr class="even">
<td align="left">highr</td>
<td align="left">Syntax Highlighting for R Source Code</td>
</tr>
<tr class="odd">
<td align="left">knitr</td>
<td align="left">A General-Purpose Package for Dynamic Report Generation in R</td>
</tr>
<tr class="even">
<td align="left">markdown</td>
<td align="left">Render Markdown with the C Library ‘Sundown’</td>
</tr>
<tr class="odd">
<td align="left">mime</td>
<td align="left">Map Filenames to MIME Types</td>
</tr>
<tr class="even">
<td align="left">MSG</td>
<td align="left">Data and Functions for the Book Modern Statistical Graphics</td>
</tr>
<tr class="odd">
<td align="left">pagedown</td>
<td align="left">Paginate the HTML Output of R Markdown with CSS for Print</td>
</tr>
<tr class="even">
<td align="left">printr</td>
<td align="left">Automatically Print R Objects to Appropriate Formats According to the ‘knitr’ Output Format</td>
</tr>
<tr class="odd">
<td align="left">Rd2roxygen</td>
<td align="left">Convert Rd to ‘Roxygen’ Documentation</td>
</tr>
<tr class="even">
<td align="left">rmarkdown</td>
<td align="left">Dynamic Documents for R</td>
</tr>
<tr class="odd">
<td align="left">rolldown</td>
<td align="left">R Markdown Output Formats for Storytelling</td>
</tr>
<tr class="even">
<td align="left">rticles</td>
<td align="left">Article Formats for R Markdown</td>
</tr>
<tr class="odd">
<td align="left">servr</td>
<td align="left">A Simple HTTP Server to Serve Static Files or Dynamic Documents</td>
</tr>
<tr class="even">
<td align="left">testit</td>
<td align="left">A Simple Package for Testing R Packages</td>
</tr>
<tr class="odd">
<td align="left">tinytex</td>
<td align="left">Helper Functions to Install and Maintain TeX Live, and Compile LaTeX Documents</td>
</tr>
<tr class="even">
<td align="left">tufte</td>
<td align="left">Tufte’s Styles for R Markdown Documents</td>
</tr>
<tr class="odd">
<td align="left">xaringan</td>
<td align="left">Presentation Ninja</td>
</tr>
<tr class="even">
<td align="left">xfun</td>
<td align="left">Supporting Functions for Packages Maintained by ‘Yihui Xie’</td>
</tr>
</tbody>
</table></div>
<p>Jeroen Ooms 维护从 C++ 世界搬运进来的库，如图像处理 magick 包、 视频处理 av 包、 PDF 文档操作 qpdf 包</p>
<div class="sourceCode" id="cb2470"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/subset.html">subset</a></span><span class="op">(</span><span class="va">pdb</span>, subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Jeroen Ooms"</span>, <span class="va">pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span><span class="op">)</span>,
       select <span class="op">=</span> <span class="st">'Package'</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] "antiword"    "askpass"     "av"          "base64"      "bcrypt"     
##  [6] "brotli"      "cld2"        "cld3"        "commonmark"  "credentials"
## [11] "curl"        "gert"        "gifski"      "gpg"         "graphql"    
## [16] "hunspell"    "jose"        "js"          "jsonld"      "jsonlite"   
## [21] "katex"       "magick"      "maketools"   "minimist"    "mongolite"  
## [26] "opencpu"     "opencv"      "openssl"     "pdftools"    "protolite"  
## [31] "qpdf"        "RAppArmor"   "rjade"       "RMySQL"      "rsvg"       
## [36] "rzmq"        "sodium"      "spelling"    "ssh"         "sys"        
## [41] "tesseract"   "unix"        "unrtf"       "V8"          "webp"       
## [46] "webutils"    "writexl"     "xslt"</code></pre>
<p>Dirk Eddelbuettel 维护 Rcpp 生态</p>
<div class="sourceCode" id="cb2472"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/subset.html">subset</a></span><span class="op">(</span><span class="va">pdb</span>, subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Dirk Eddelbuettel"</span>, <span class="va">pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span><span class="op">)</span>,
       select <span class="op">=</span> <span class="st">'Package'</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] "anytime"             "AsioHeaders"         "BH"                 
##  [4] "binb"                "corels"              "dang"               
##  [7] "digest"              "drat"                "gaussfacts"         
## [10] "gcbd"                "gettz"               "gunsales"           
## [13] "inline"              "linl"                "littler"            
## [16] "nanotime"            "pinp"                "pkgKitten"          
## [19] "prrd"                "random"              "RApiDatetime"       
## [22] "RApiSerialize"       "Rblpapi"             "Rcpp"               
## [25] "RcppAnnoy"           "RcppAPT"             "RcppArmadillo"      
## [28] "RcppBDT"             "RcppCCTZ"            "RcppClassic"        
## [31] "RcppClassicExamples" "RcppCNPy"            "RcppDate"           
## [34] "RcppDE"              "RcppEigen"           "RcppExamples"       
## [37] "RcppFarmHash"        "RcppFastFloat"       "RcppGetconf"        
## [40] "RcppGSL"             "RcppMsgPack"         "RcppNLoptExample"   
## [43] "RcppQuantuccia"      "RcppRedis"           "RcppSimdJson"       
## [46] "RcppSMC"             "RcppSpdlog"          "RcppStreams"        
## [49] "RcppTOML"            "RcppXts"             "RcppZiggurat"       
## [52] "RDieHarder"          "rfoaas"              "RInside"            
## [55] "rmsfact"             "RProtoBuf"           "RPushbullet"        
## [58] "RQuantLib"           "RVowpalWabbit"       "sanitizers"         
## [61] "td"                  "tidyCpp"             "tiledb"             
## [64] "tint"                "ttdo"                "x13binary"</code></pre>
<p>Hadley Wickham 维护 tidyverse 生态</p>
<div class="sourceCode" id="cb2474"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/subset.html">subset</a></span><span class="op">(</span><span class="va">pdb</span>, subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Hadley Wickham"</span>, <span class="va">pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span><span class="op">)</span>,
       select <span class="op">=</span> <span class="st">'Package'</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] "assertthat"    "babynames"     "bigrquery"     "classifly"    
##  [5] "conflicted"    "cubelyr"       "dbplyr"        "diffviewer"   
##  [9] "downlit"       "dplyr"         "dtplyr"        "ellipsis"     
## [13] "feather"       "forcats"       "fueleconomy"   "generics"     
## [17] "ggplot2movies" "gtable"        "haven"         "hflights"     
## [21] "highlight"     "httr"          "httr2"         "lazyeval"     
## [25] "lobstr"        "lvplot"        "meifly"        "modelr"       
## [29] "multidplyr"    "nasaweather"   "nycflights13"  "pins"         
## [33] "pkgdown"       "plyr"          "productplots"  "profr"        
## [37] "proto"         "pryr"          "rappdirs"      "reshape"      
## [41] "reshape2"      "roxygen2"      "rvest"         "scales"       
## [45] "sloop"         "stringr"       "testthat"      "tidyr"        
## [49] "tidyverse"     "waldo"</code></pre>
<p><a href="https://scottchamberlain.info/">Scott Chamberlain</a> 是非营利性组织 <a href="https://ropensci.org/">rOpenSci</a> 的联合创始人，但是没几个 R 包听说过</p>
<div class="sourceCode" id="cb2476"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/subset.html">subset</a></span><span class="op">(</span><span class="va">pdb</span>, subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Scott Chamberlain"</span>, <span class="va">pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span><span class="op">)</span>,
       select <span class="op">=</span> <span class="st">'Package'</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] "analogsea"   "bold"        "brranching"  "charlatan"   "citecorp"   
##  [6] "ckanr"       "conditionz"  "cowsay"      "crul"        "discgolf"   
## [11] "elastic"     "fauxpas"     "finch"       "fulltext"    "geojson"    
## [16] "geojsonio"   "geojsonlint" "getlandsat"  "ghql"        "gistr"      
## [21] "handlr"      "hoardr"      "httpcode"    "httping"     "isdparser"  
## [26] "jaod"        "jqr"         "mapr"        "microdemic"  "mregions"   
## [31] "natserv"     "oai"         "openadds"    "pangaear"    "parzer"     
## [36] "phylocomr"   "pubchunks"   "randgeo"     "rbace"       "rbhl"       
## [41] "rbison"      "rcitoid"     "rcol"        "rcoreoa"     "rcrossref"  
## [46] "rdatacite"   "rdryad"      "request"     "rgbif"       "rgnparser"  
## [51] "ritis"       "rnoaa"       "rorcid"      "rphylopic"   "rplos"      
## [56] "rredlist"    "rvertnet"    "sofa"        "solrium"     "spocc"      
## [61] "taxize"      "taxizedb"    "traits"      "vcr"         "webmockr"   
## [66] "wellknown"   "wikitaxa"    "worrms"      "zbank"</code></pre>
</div>
<div id="R-Package-Developers" class="section level3" number="35.5.3">
<h3>
<span class="header-section-number">35.5.3</span> 社区开发者<a class="anchor" aria-label="anchor" href="#R-Package-Developers"><i class="fas fa-link"></i></a>
</h3>
<p>接下来，我们想看看 R 包维护者数量有多少</p>
<div class="sourceCode" id="cb2478"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/unique.html">unique</a></span><span class="op">(</span><span class="va">pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 10668</code></pre>
<p>可实际上没有这么多的开发者，因为存在这样的情况，以 R 包维护者 Hadley Wickham 为例，由于他曾使用过不同的邮箱，所以在维护者字段出现了不一致的情况，实际却是同一个人。</p>
<div class="sourceCode" id="cb2480"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/subset.html">subset</a></span><span class="op">(</span><span class="va">pdb</span>,
  subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Hadley Wickham"</span>, <span class="va">pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span><span class="op">)</span>,
  select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="st">"Package"</span>, <span class="st">"Maintainer"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<pre><code>##             Package                             Maintainer
## 601      assertthat    Hadley Wickham &lt;hadley@rstudio.com&gt;
## 758       babynames    Hadley Wickham &lt;hadley@rstudio.com&gt;
## 1206      bigrquery    Hadley Wickham &lt;hadley@rstudio.com&gt;
## 2195      classifly   Hadley Wickham &lt;h.wickham@gmail.com&gt;
## 2594     conflicted    Hadley Wickham &lt;hadley@rstudio.com&gt;
....</code></pre>
<p>因此，有必要先把 Maintainer 字段中的邮箱部分去掉，这样我们可以得到比较靠谱的R包维护者数量了！</p>
<div class="sourceCode" id="cb2482"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">clean_maintainer</span><span class="op">(</span><span class="va">pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/unique.html">unique</a></span><span class="op">(</span><span class="va">pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 9865</code></pre>
<p>接下来，我们还想把 R 包维护者，按照其维护的R包数量排个序，用条形图<a href="chap-case-study.html#fig:top-maintainers">35.3</a> 表示，其中 Orphaned 表示之前的R包维护者不愿意继续维护了，后来有人接手维护，Orphaned 表示这一类接盘侠。</p>
<div class="sourceCode" id="cb2484"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">top_maintainer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">20</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">7</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">barCenters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/barplot.html">barplot</a></span><span class="op">(</span><span class="va">top_maintainer</span>,
  col <span class="op">=</span> <span class="st">"lightblue"</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>,
  axisnames <span class="op">=</span> <span class="cn">FALSE</span>, horiz <span class="op">=</span> <span class="cn">TRUE</span>, border <span class="op">=</span> <span class="st">"white"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html">text</a></span><span class="op">(</span>
  y <span class="op">=</span> <span class="va">barCenters</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="st">"usr"</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,
  adj <span class="op">=</span> <span class="fl">1</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/names.html">names</a></span><span class="op">(</span><span class="va">top_maintainer</span><span class="op">)</span>, xpd <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>,
  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span>, by <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span>, by <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,
  las <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"gray"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:top-maintainers"></span>
<img src="case-study_files/figure-html/top-maintainers-1.png" alt="维护 R 包数量最多的 20 个人" width="75%"><p class="caption">
图 35.3: 维护 R 包数量最多的 20 个人
</p>
</div>
<p>调用 ggplot2 包绘图要求输入的数据类型是 <code>data.frame</code>，所以我们首先将 <code>top_maintainer</code> 转化为数据框类型</p>
<div class="sourceCode" id="cb2485"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">top_maintainer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">top_maintainer</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">top_maintainer</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="st">"Maintainer"</span>, <span class="st">"Freq"</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">top_maintainer</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Maintainer</span>, y <span class="op">=</span> <span class="va">Freq</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Maintainer"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Numbers of Package"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="case-study_files/figure-html/unnamed-chunk-29-1.png" width="2100" style="display: block; margin: auto;"></div>
<p>条形图在柱子很多的情况下，点线图是一种更加简洁的替代方式</p>
<div class="sourceCode" id="cb2486"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">top_maintainer</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Freq</span>, y <span class="op">=</span> <span class="va">Maintainer</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">20</span>, xend <span class="op">=</span> <span class="va">Freq</span>, yend <span class="op">=</span> <span class="va">Maintainer</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"grey50"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span>, colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">" # of Packages "</span>, y <span class="op">=</span> <span class="st">" Maintainer "</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="case-study_files/figure-html/unnamed-chunk-30-1.png" width="2100" style="display: block; margin: auto;"></div>
<p>接下来，我们想看看开发者维护的 R 包数量的分布，仅从上图，我们知道有的人能维护 80 多个 R 包，总体的分布情况又是如何呢？如图所示，我们将纵轴刻度设置为 log 模式，随着开发的R包数量的增加，开发者人数是指数级递减，可见开发R包依然是一个门槛很高的工作！</p>
<div class="sourceCode" id="cb2487"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,
  col <span class="op">=</span> <span class="st">"lightblue"</span>, log <span class="op">=</span> <span class="st">"y"</span>, border <span class="op">=</span> <span class="st">"white"</span>,
  xlab <span class="op">=</span> <span class="st">"# of Packages"</span>, ylab <span class="op">=</span> <span class="st">"# of Maintainers (log)"</span>,
  panel.first <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="case-study_files/figure-html/unnamed-chunk-31-1.png" width="2100" style="display: block; margin: auto;"></div>
<p>只开发一个 R 包的人数达到 5276 人，占开发者总数的 67.31%，约为2/3。</p>
</div>
<div id="first-commit" class="section level3" number="35.5.4">
<h3>
<span class="header-section-number">35.5.4</span> 首次贡献 R 包<a class="anchor" aria-label="anchor" href="#first-commit"><i class="fas fa-link"></i></a>
</h3>
<p>我们还想进一步了解这些人是不是就自己开发自己维护，基本没有其他人参与，答案是 Almost Sure. 这些人其实占了大部分，相比于前面的 R 核心开发团队或者 R Markdown 生态的维护者，他们绝大部分属于金字塔底部的人，二八定律似乎在这里再次得到印证。</p>
<div class="sourceCode" id="cb2488"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sub_pdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/subset.html">subset</a></span><span class="op">(</span><span class="va">pdb</span>, select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="st">"Package"</span>, <span class="st">"Maintainer"</span>, <span class="st">"Author"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>接着先清理一下 Maintainer 和 Author 字段，Author 字段的内容比起 Maintainer 复杂一些</p>
<div class="sourceCode" id="cb2489"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">clean_author</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># 去掉中括号及其内容 [aut] [aut, cre]</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"(\\[.*?\\])"</span>, <span class="st">""</span>, <span class="va">x</span><span class="op">)</span>
  <span class="co"># 去掉小括号及其内容 ()</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"(\\(.*?\\))"</span>, <span class="st">""</span>, <span class="va">x</span><span class="op">)</span>
  <span class="co"># 去掉尖括号及其内容 &lt; &gt;</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"(&lt;.*?&gt;)"</span>, <span class="st">""</span>, <span class="va">x</span><span class="op">)</span>
  <span class="co"># 去掉 \n</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"(\\\n)"</span>, <span class="st">""</span>, <span class="va">x</span><span class="op">)</span>
  <span class="co"># 去掉制表符、双引号、单引号和 \'，如 'Hadley Wickham' 中的单引号 ' 等</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"(\\\t)|(\\\")|(\\\')|(')|(\\))"</span>, <span class="st">""</span>, <span class="va">x</span><span class="op">)</span>
  <span class="co"># Christian P. Robert, Universite Paris Dauphine, and Jean-Michel\n        Marin, Universite Montpellier 2</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"(and)"</span>, <span class="st">""</span>, <span class="va">x</span><span class="op">)</span>
  <span class="co"># 两个以上的空格替换为一个空格</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"( {2,})"</span>,<span class="st">" "</span>,<span class="va">x</span><span class="op">)</span>
  <span class="va">x</span>
<span class="op">}</span>

<span class="va">sub_pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">clean_maintainer</span><span class="op">(</span><span class="va">sub_pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span><span class="op">)</span>
<span class="va">sub_pdb</span><span class="op">[</span>, <span class="st">"Author"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">clean_author</span><span class="op">(</span><span class="va">sub_pdb</span><span class="op">[</span>, <span class="st">"Author"</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p>维护多个 R 包的开发者数量</p>
<div class="sourceCode" id="cb2490"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/unique.html">unique</a></span><span class="op">(</span><span class="va">sub_pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">duplicated</a></span><span class="op">(</span><span class="va">sub_pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 3231</code></pre>
<p>总的开发者中去掉开发了多个R包的人，就剩下只维护1个R包的开发者，共有</p>
<div class="sourceCode" id="cb2492"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">first_ctb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setops.html">setdiff</a></span><span class="op">(</span>
  <span class="va">sub_pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">duplicated</a></span><span class="op">(</span><span class="va">sub_pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span><span class="op">)</span><span class="op">]</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/raster/man/unique.html">unique</a></span><span class="op">(</span><span class="va">sub_pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">duplicated</a></span><span class="op">(</span><span class="va">sub_pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>按照每个R包贡献者的数量分组，如图所示，有一个或者没有贡献者的占总数占 70.60%，说明这些 R 包的开发者基本在单干，有 4 个及以下的贡献者占总数（这个总数是指只开发了一个R包的那些开发者）的 90.85%。</p>
<div class="sourceCode" id="cb2493"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ctb_num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span>
    <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/tstrsplit.html">strsplit</a></span><span class="op">(</span>
      <span class="fu"><a href="https://rdrr.io/pkg/raster/man/subset.html">subset</a></span><span class="op">(</span><span class="va">sub_pdb</span>,
             subset <span class="op">=</span> <span class="va">sub_pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span> <span class="op">%in%</span> <span class="va">first_ctb</span>,
             select <span class="op">=</span> <span class="st">"Author"</span>, drop <span class="op">=</span> <span class="cn">TRUE</span> <span class="co"># drop out data.frame return vector</span>
      <span class="op">)</span>,
      split <span class="op">=</span> <span class="st">","</span>
    <span class="op">)</span>, <span class="va">length</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/raster/man/hist.html">hist</a></span><span class="op">(</span><span class="va">ctb_num</span>, col <span class="op">=</span> <span class="st">"lightblue"</span>, border <span class="op">=</span> <span class="st">"white"</span>, 
     probability <span class="op">=</span> <span class="cn">TRUE</span>, labels <span class="op">=</span> <span class="cn">TRUE</span>,
     xlab <span class="op">=</span> <span class="st">"# of Contributors"</span>, ylab <span class="op">=</span> <span class="st">"Proportion"</span>, main <span class="op">=</span> <span class="st">""</span>,
     panel.first <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="case-study_files/figure-html/unnamed-chunk-36-1.png" width="2100" style="display: block; margin: auto;"></div>
<p>这些基本单干的R包开发者是否参与其它 R 包的贡献？如果不参与，则他们对社区的贡献非常有限，仅限于为社区带来数量上的堆积！</p>
<div class="sourceCode" id="cb2494"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ctb_num</span><span class="op">)</span></code></pre></div>
<pre><code>## ctb_num
##    1    2    3    4    5    6    7    8    9   10   11   12   13   14   15   16 
## 3006 1382  924  577  275  163  104   58   41   28   15   10    7    8    5    4 
##   17   18   19   20   22   23   24   27   28   56   60  133 
##    7    5    2    3    1    3    1    1    1    1    1    1</code></pre>
<p>有意思的是，有一个开发者虽然只开发了一个 R 包，但是却引来37位贡献者（包括开发者本人在内），下面把这个颇受欢迎的 R 包找出来</p>
<div class="sourceCode" id="cb2496"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 找到开发者</span>
<span class="va">first_ctb</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/which.minmax.html">which.max</a></span><span class="op">(</span><span class="va">ctb_num</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<pre><code>## [1] "Ryan Curtin"</code></pre>
<div class="sourceCode" id="cb2498"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 找到 R 包</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/subset.html">subset</a></span><span class="op">(</span><span class="va">sub_pdb</span>, subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Matt Dowle"</span>, <span class="va">sub_pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span><span class="op">)</span>, select <span class="op">=</span> <span class="st">"Package"</span><span class="op">)</span></code></pre></div>
<pre><code>##         Package
## 3165 data.table</code></pre>
<p>哇，大名鼎鼎的 <a href="https://github.com/Rdatatable/data.table">data.table</a> 包！！ I JUST find it!! 这是个异数，我们知道 data.table 在R社区享有盛名，影响范围很广，从 Matt Dowle 的 <a href="https://github.com/mattdowle">Github 主页</a> 来看，他确实只开发了这一个 R 包！黑天鹅在这里出现了！如果按照谁的贡献者多谁影响力大的规律来看，有 10 个以上贡献者的其它几个 R 包也必定是名器！这里留给读者把它找出来吧！</p>
</div>
<div id="Contribution-Network" class="section level3" number="35.5.5">
<h3>
<span class="header-section-number">35.5.5</span> 贡献关系网络<a class="anchor" aria-label="anchor" href="#Contribution-Network"><i class="fas fa-link"></i></a>
</h3>
<!-- 综合上面的分析，社区的主要推动者是余下的 1/3，他们相互之间的合作应该比较多，我们接下来想分析一下他们之间的贡献网络。 -->
<p>接下来进入本节最核心的部分，分析所有的开发者之间的贡献网络，在第<a href="chap-case-study.html#first-commit">35.5.4</a>节清理 Author 字段的正则表达式几乎不可能覆盖到所有的情况，所以既然 Maintainer 字段是比较好清理的，不妨以它作为匹配的模式去匹配 Author 字段，这样做的代价就是迭代次数会很多，增加一定的计算负担，但是为了更加准确的清理结果，也是拼了！</p>
<div class="sourceCode" id="cb2500"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">net_pdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/subset.html">subset</a></span><span class="op">(</span><span class="va">pdb</span>, select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="st">"Maintainer"</span>, <span class="st">"Author"</span><span class="op">)</span><span class="op">)</span>
<span class="va">net_pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">clean_maintainer</span><span class="op">(</span><span class="va">net_pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span><span class="op">)</span>
<span class="va">total_maintainer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/unique.html">unique</a></span><span class="op">(</span><span class="va">net_pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span><span class="op">)</span>
<span class="va">clean_author</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">maintainer</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">net_pdb</span><span class="op">[</span>, <span class="st">"Author"</span><span class="op">]</span>, <span class="va">grepl</span>, pattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"("</span>, <span class="va">maintainer</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>接下来是非常耗时的一步，实际是两层循环 1.2 亿次左右的查找计算， <code>grepl</code> 耗时 30分钟左右，正则表达式本身的性能优化问题，<code>maintainer_author</code> 逻辑型矩阵占用内存空间 430 M 左右</p>
<div class="sourceCode" id="cb2501"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">maintainer_author</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span><span class="op">(</span><span class="st">"cbind"</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">total_maintainer</span>, <span class="va">clean_author</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">maintainer_author</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">total_maintainer</span>
<span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">maintainer_author</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">net_pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span></code></pre></div>
<p>为了重复运行这段耗时很长的代码，我们将中间结果保存到磁盘，推荐保存为 R 支持的序列化后的数据格式 <code>*.rds</code>，相比于 <code>*.csv</code> 格式能极大地减少磁盘存储空间，读者可运行下面两行保存数据的代码，比较看看！</p>
<div class="sourceCode" id="cb2502"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">maintainer_author</span>, file <span class="op">=</span> <span class="st">"data/maintainer_author.rds"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span><span class="op">(</span><span class="va">maintainer_author</span>,file <span class="op">=</span> <span class="st">"data/maintainer_author.csv"</span>, row.names <span class="op">=</span> <span class="cn">TRUE</span>, col.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>查看 <code>maintainer_author</code> 数据集占用内存空间的大小</p>
<div class="sourceCode" id="cb2503"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/object.size.html">object.size</a></span><span class="op">(</span><span class="va">maintainer_author</span><span class="op">)</span>, units <span class="op">=</span> <span class="st">"auto"</span><span class="op">)</span></code></pre></div>
<p>看几个数字，R 包贡献者最多的有 62 人,这个 R 包的粉丝是真多！有一个开发者对 137 个 R 包的做出过贡献，其中包括自己开发的 R 包，快来快来抓住他！</p>
<div class="sourceCode" id="cb2504"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summarize-generics.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/rowSums.html">rowSums</a></span><span class="op">(</span><span class="va">maintainer_author</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/summarize-generics.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/rowSums.html">colSums</a></span><span class="op">(</span><span class="va">maintainer_author</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>继续看看每个开发者对外贡献的量的分布情况，由图可知，绝大部分开发者对外输出不超过 3，其表示对其它 R 包的贡献不超过 3个</p>
<div class="sourceCode" id="cb2505"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/rowSums.html">colSums</a></span><span class="op">(</span><span class="va">maintainer_author</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/rowSums.html">colSums</a></span><span class="op">(</span><span class="va">maintainer_author</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">10</span><span class="op">]</span>, 
     probability <span class="op">=</span> <span class="cn">FALSE</span>, xlab <span class="op">=</span> <span class="st">""</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span></code></pre></div>
<p>每个 R 包参与贡献的人数分布又是如何呢？如图所示，基本集中在1~2个人的样子</p>
<div class="sourceCode" id="cb2506"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/rowSums.html">rowSums</a></span><span class="op">(</span><span class="va">maintainer_author</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/rowSums.html">rowSums</a></span><span class="op">(</span><span class="va">maintainer_author</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">20</span><span class="op">]</span>, 
     xlab <span class="op">=</span> <span class="st">""</span>, main <span class="op">=</span> <span class="st">""</span>,probability <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>好了，接下来我们要深入挖掘贡献协作网络中的结构特点，看看是不是由几位领导人在完全掌控，还有一大群人其实是自己搞自己的那点事，写论文、发布 R 包、投稿等如此循环。其实这就是 R 社区的特点，也决定了它不会像 Python 那样应用性强，有足够多的工程开发人员加入。大多数人写 R 包只是为了配合发论文而已，并不关心有没有人来用自己的 R 包！此外，没有人来做功能整合和持续维护，所以发展缓慢！各自造轮子的事情太多！</p>
<p>接着，先从表面看看开发者和贡献者的关系矩阵，<code>maintainer_author</code> 是一个大型的超稀疏矩阵，非零元素最多的行、列分别只占 0.79% 和 0.95%，都不到百分之一。</p>
<div class="sourceCode" id="cb2507"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 非零元素最多的行</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/summarize-generics.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">rowMeans</a></span><span class="op">(</span><span class="va">maintainer_author</span><span class="op">)</span><span class="op">)</span>
<span class="co"># 非零元素最多的列</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/summarize-generics.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">colMeans</a></span><span class="op">(</span><span class="va">maintainer_author</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<blockquote>
<p>用稀疏索引的方式重新编码矩阵，然后用<a href="https://bommaritollc.com/2012/06/17/summary-community-detection-algorithms-igraph-0-6/">社群检测的算法</a>找到其中的结构，网络关系图用 Gephi 画，igraph 肯定是不行了，参考文献 <a href="https://cosx.org/2011/04/exploring-renren-social-network">社会网络分析：探索人人网好友推荐系统</a> 网络的统计建模分析 <a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Statistical Modeling of Networks in R &lt;a href="https://user2010.org/Invited/handcockuser2010.pdf" class="uri"&gt;https://user2010.org/Invited/handcockuser2010.pdf&lt;/a&gt;&lt;/p&gt;'><sup>77</sup></a></p>
</blockquote>
<p>重新获取 <code>maintainer_author</code> 矩阵，存储指标向量，然后调用 Matrix 生成稀疏矩阵，后续的数据操作就好办了，因为 Matrix 包是内置的，它定义的稀疏矩阵类其它 R 包也都支持。先以一个简单的例子说明构造稀疏矩阵的过程</p>
<div class="sourceCode" id="cb2508"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://Matrix.R-forge.R-project.org/">Matrix</a></span><span class="op">)</span>
<span class="va">spM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/spMatrix.html">spMatrix</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, 
                j <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>,
                x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span>
<span class="va">spM</span></code></pre></div>
<pre><code>## 3 x 4 sparse Matrix of class "dgTMatrix"
##             
## [1,] 4 . . 4
## [2,] . 1 . .
## [3,] 4 . 8 .</code></pre>
<div class="sourceCode" id="cb2510"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/image.html">image</a></span><span class="op">(</span><span class="va">spM</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:vis-sparse-mat"></span>
<img src="case-study_files/figure-html/vis-sparse-mat-1.png" alt="稀疏矩阵的图表示" width="75%"><p class="caption">
图 35.4: 稀疏矩阵的图表示
</p>
</div>
<p><code>i</code> 和 <code>j</code> 表示矩阵中有值的位置，<code>x</code> 表示对应位置上的值，<code>i</code>，<code>j</code> 和 <code>x</code> 是三个长度相等的数值型向量，我们还可以调用 <code>image</code>函数，把稀疏矩阵可视化出来，对于大型稀疏矩阵可视化其稀疏模式是重要的。</p>
<blockquote>
<p>贡献网络可视化 <a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Network Analysis and Visualization with R and igraph &lt;a href="https://kateto.net/networks-r-igraph" class="uri"&gt;https://kateto.net/networks-r-igraph&lt;/a&gt; with &lt;a href="https://kateto.net/wp-content/uploads/2016/01/NetSciX_2016_Workshop.pdf"&gt;PDF&lt;/a&gt;&lt;/p&gt;'><sup>78</sup></a></p>
</blockquote>
<div class="sourceCode" id="cb2511"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">clean_net_pdb</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">maintainer</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">index</span> <span class="op">&lt;-</span> <span class="fu">clean_author</span><span class="op">(</span><span class="va">maintainer</span><span class="op">)</span>
  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">index</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    from_id <span class="op">=</span> <span class="va">maintainer</span>,
    to_id <span class="op">=</span> <span class="va">net_pdb</span><span class="op">[</span>, <span class="st">"Maintainer"</span><span class="op">]</span><span class="op">[</span><span class="va">index</span><span class="op">]</span>,
    stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb2512"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># maintainer_author &lt;- data.table::rbindlist(lapply(total_maintainer, clean_net_pdb))</span>
<span class="co"># saveRDS(maintainer_author, file = "data/maintainer_author.rds")</span>
<span class="va">toc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span><span class="op">{</span>
  <span class="va">maintainer_author_net</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">total_maintainer</span>, <span class="va">clean_net_pdb</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>, gcFirst <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>分组统计开发者之间贡献次数，从开发者到</p>
<div class="sourceCode" id="cb2513"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">maintainer_author_net</span><span class="op">$</span><span class="va">weight</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/aggregate.sf.html">aggregate</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">from_id</span> <span class="op">+</span> <span class="va">to_id</span>, data <span class="op">=</span> <span class="va">maintainer_author_net</span>, <span class="va">sum</span><span class="op">)</span>

<span class="va">dup_edges</span> <span class="op">&lt;-</span> <span class="va">edges</span><span class="op">[</span><span class="va">edges</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">!=</span> <span class="va">edges</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="op">]</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">geomnet</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dup_edges</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>from_id <span class="op">=</span> <span class="va">from_id</span>, to_id <span class="op">=</span> <span class="va">to_id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_net</span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="va">weight</span><span class="op">)</span>,
    layout.alg <span class="op">=</span> <span class="st">"kamadakawai"</span>,
    labelon <span class="op">=</span> <span class="cn">FALSE</span>, directed <span class="op">=</span> <span class="cn">TRUE</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span>, ealpha <span class="op">=</span> <span class="fl">1</span>,
    ecolour <span class="op">=</span> <span class="st">"grey70"</span>, arrowsize <span class="op">=</span> <span class="fl">0.1</span>, size <span class="op">=</span> <span class="fl">0.5</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_net</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2514"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># https://smallstats.blogspot.jp/2012/12/loading-huge-graphs-with-igraph-and-r.html</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://igraph.org">igraph</a></span><span class="op">)</span>
<span class="co"># 贡献矩阵</span>
<span class="va">ctb_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html">graph.data.frame</a></span><span class="op">(</span><span class="va">maintainer_author</span>, directed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">vertex.attrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="va">ctb_df</span><span class="op">$</span><span class="va">from_id</span>, <span class="va">ctb_df</span><span class="op">$</span><span class="va">to_id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbind</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/pkg/raster/man/match.html">match</a></span><span class="op">(</span><span class="va">ctb_df</span><span class="op">$</span><span class="va">from_id</span>, <span class="va">vertex.attrs</span><span class="op">$</span><span class="va">name</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/raster/man/match.html">match</a></span><span class="op">(</span><span class="va">ctb_df</span><span class="op">$</span><span class="va">to_id</span>, <span class="va">vertex.attrs</span><span class="op">$</span><span class="va">name</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">ctb_net</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/make_empty_graph.html">graph.empty</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">0</span>, directed <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="va">ctb_net</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/add_vertices.html">add.vertices</a></span><span class="op">(</span><span class="va">ctb_net</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html">length</a></span><span class="op">(</span><span class="va">vertex.attrs</span><span class="op">$</span><span class="va">name</span><span class="op">)</span>, attr <span class="op">=</span> <span class="va">vertex.attrs</span><span class="op">)</span>
<span class="va">ctb_net</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/add_edges.html">add.edges</a></span><span class="op">(</span><span class="va">ctb_net</span>, <span class="va">edges</span><span class="op">)</span></code></pre></div>
</div>
<div id="CRAN-Update-Packages" class="section level3" number="35.5.6">
<h3>
<span class="header-section-number">35.5.6</span> 更新知多少<a class="anchor" aria-label="anchor" href="#CRAN-Update-Packages"><i class="fas fa-link"></i></a>
</h3>
<p>这节标题取其字面意思表达 CRAN 服务器的特殊日子 2012-10-29，那天 CRAN 更新了一大波 R 包，像一根擎天柱一样支撑这幅图！</p>
<div class="sourceCode" id="cb2515"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">update_pdb</span> <span class="op">&lt;-</span> <span class="va">pdb</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="st">"Package"</span>, <span class="st">"Published"</span><span class="op">)</span><span class="op">]</span>
<span class="co"># 这天要更新的R包最多</span>
<span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">update_pdb</span><span class="op">[</span>,<span class="st">"Published"</span><span class="op">]</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></code></pre></div>
<pre><code>## 2021-09-02 
##         97</code></pre>
<div class="sourceCode" id="cb2517"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">update_pdb</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html">as.Date</a></span><span class="op">(</span><span class="va">Published</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"skyblue4"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
      date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="st">"2011-01-01"</span>, <span class="st">"2012-10-20"</span><span class="op">)</span><span class="op">)</span>,
      count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">87</span><span class="op">)</span>
    <span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">count</span><span class="op">)</span>,
    arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">15</span>, length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="st">"inches"</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html">as.Date</a></span><span class="op">(</span><span class="st">"2010-11-01"</span><span class="op">)</span>, y <span class="op">=</span> <span class="fl">75</span>, label <span class="op">=</span> <span class="st">"(2012-10-29,87)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html">scale_x_date</a></span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 year"</span>, date_labels <span class="op">=</span> <span class="st">"%Y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Published Date"</span>, y <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:pdb-update-history"></span>
<img src="case-study_files/figure-html/pdb-update-history-1.png" alt="R 包更新历史" width="2100"><p class="caption">
图 35.5: R 包更新历史
</p>
</div>
<p>当日发布的R包，不论是新增还是更新之前发布的R包都视为最新版，当日之前的都是旧版本，它们可能存在已经修复的 BUG！这句子好奇怪是吧，因为很多 R 包要么托管在 Github 上，要么托管在 <a href="https://r-forge.r-project.org/">R-Forge</a> 上开发，而 CRAN 上的版本除了发布日外，一般来讲都会落后。如图所示待更新的 R 包在日期上的分布，有的已经10来年没有更新了，最老的 R 包可以追溯到 2006-03-15，它是 coxrobust！！</p>
<div class="sourceCode" id="cb2518"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/subset.html">subset</a></span><span class="op">(</span><span class="va">update_pdb</span>, subset <span class="op">=</span> <span class="va">update_pdb</span><span class="op">[</span>, <span class="st">"Published"</span><span class="op">]</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/summarize-generics.html">min</a></span><span class="op">(</span><span class="va">update_pdb</span><span class="op">[</span>, <span class="st">"Published"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##        Package  Published
## 2825 coxrobust 2006-03-15</code></pre>
<div class="sourceCode" id="cb2520"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">update_pdb</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/which.minmax.html">which.min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html">as.Date</a></span><span class="op">(</span><span class="va">update_pdb</span><span class="op">[</span>, <span class="st">"Published"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, <span class="fl">1</span><span class="op">]</span></code></pre></div>
<pre><code>## [1] "coxrobust"</code></pre>
</div>
<div id="Package-Licenses" class="section level3" number="35.5.7">
<h3>
<span class="header-section-number">35.5.7</span> 使用许可证<a class="anchor" aria-label="anchor" href="#Package-Licenses"><i class="fas fa-link"></i></a>
</h3>
<blockquote>
<p>列举 R 社区使用的许可证及其区别和联系
R 开源还体现在许可证信息，顺便谈谈美国和中国技术封锁，开源社区可能面临的风险</p>
</blockquote>
<p>社区主要使用 GPL 及其相关授权协议，因为 R 软件本身也是授权在 GPL-2 或 GPL-3 下</p>
<div class="sourceCode" id="cb2522"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">license_pdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">pdb</span><span class="op">[</span>, <span class="st">"License"</span><span class="op">]</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">20</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">12</span>, <span class="fl">0.5</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1e1</span>, <span class="fl">1e2</span>, <span class="fl">1e3</span>, <span class="fl">1e4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span><span class="op">)</span>,
     type <span class="op">=</span> <span class="st">"n"</span>,panel.first <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="op">)</span>,
     ann <span class="op">=</span> <span class="cn">FALSE</span>, log <span class="op">=</span> <span class="st">"x"</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>,
     at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1e1</span>, <span class="fl">1e2</span>, <span class="fl">1e3</span>, <span class="fl">1e4</span><span class="op">)</span>,
     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">2</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">3</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">4</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html">text</a></span><span class="op">(</span>
  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html">length</a></span><span class="op">(</span><span class="va">license_pdb</span><span class="op">)</span><span class="op">)</span>, x <span class="op">=</span> <span class="fl">1</span>, cex <span class="op">=</span> <span class="fl">1</span>, offset <span class="op">=</span> <span class="fl">1</span>,
  pos <span class="op">=</span> <span class="fl">2</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/names.html">names</a></span><span class="op">(</span><span class="va">license_pdb</span><span class="op">)</span>, xpd <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html">text</a></span><span class="op">(</span><span class="fl">1e3</span>, <span class="fl">15</span>, <span class="st">"CRAN"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="fl">1</span>, y0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html">length</a></span><span class="op">(</span><span class="va">license_pdb</span><span class="op">)</span><span class="op">)</span>, 
         x1 <span class="op">=</span> <span class="va">license_pdb</span>, y1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html">length</a></span><span class="op">(</span><span class="va">license_pdb</span><span class="op">)</span><span class="op">)</span>, 
         col <span class="op">=</span> <span class="st">"lightblue"</span>, lwd <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:license-cran"></span>
<img src="case-study_files/figure-html/license-cran-1.png" alt="CRAN 上采用的发布协议" width="2100"><p class="caption">
图 35.6: CRAN 上采用的发布协议
</p>
</div>
<div class="sourceCode" id="cb2523"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rforge_pdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/available.packages.html">available.packages</a></span><span class="op">(</span>repos <span class="op">=</span> <span class="st">"https://R-Forge.R-project.org"</span><span class="op">)</span>
<span class="va">license_rforge_pdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">rforge_pdb</span><span class="op">[</span>, <span class="st">"License"</span><span class="op">]</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">20</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">12</span>, <span class="fl">0.5</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1e1</span>, <span class="fl">1e2</span>, <span class="fl">1e3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="fl">20</span>,length.out <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,
  type <span class="op">=</span> <span class="st">"n"</span>,panel.first <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="op">)</span>,
  ann <span class="op">=</span> <span class="cn">FALSE</span>, log <span class="op">=</span> <span class="st">"x"</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>,
  at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1e1</span>, <span class="fl">1e2</span>, <span class="fl">1e3</span><span class="op">)</span>,
  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">2</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html">text</a></span><span class="op">(</span>
  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html">length</a></span><span class="op">(</span><span class="va">license_rforge_pdb</span><span class="op">)</span><span class="op">)</span>, x <span class="op">=</span> <span class="fl">1</span>, cex <span class="op">=</span> <span class="fl">1</span>, offset <span class="op">=</span> <span class="fl">1</span>,
  pos <span class="op">=</span> <span class="fl">2</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/names.html">names</a></span><span class="op">(</span><span class="va">license_rforge_pdb</span><span class="op">)</span>, xpd <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html">text</a></span><span class="op">(</span><span class="fl">1e2</span>, <span class="fl">15</span>, <span class="st">"R-Forge"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="fl">1</span>, y0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html">length</a></span><span class="op">(</span><span class="va">license_rforge_pdb</span><span class="op">)</span><span class="op">)</span>, 
         x1 <span class="op">=</span> <span class="va">license_rforge_pdb</span>, y1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html">length</a></span><span class="op">(</span><span class="va">license_rforge_pdb</span><span class="op">)</span><span class="op">)</span>, 
         lwd <span class="op">=</span> <span class="fl">4</span>, col <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:license-rforge"></span>
<img src="case-study_files/figure-html/license-rforge-1.png" alt="R-Forge 开发者采用的发布协议" width="2100"><p class="caption">
图 35.7: R-Forge 开发者采用的发布协议
</p>
</div>
<blockquote>
<p>改进的方向是含义相同的进行合并，这需要研究一下各个许可证，然后使用对比型条形图合并上面两个图</p>
</blockquote>
<p>CRAN 会检测 R 包的授权，只有授权协议包含在数据库中的才可以在 CRAN 上发布 <a href="https://svn.r-project.org/R/trunk/share/licenses/license.db" class="uri">https://svn.r-project.org/R/trunk/share/licenses/license.db</a></p>
</div>
<div id="Choose-Package" class="section level3" number="35.5.8">
<h3>
<span class="header-section-number">35.5.8</span> 选择 R 包<a class="anchor" aria-label="anchor" href="#Choose-Package"><i class="fas fa-link"></i></a>
</h3>
<p>R 社区开发的 R 包实在太多了，重复造的轮子也很多，哪个轮子结实好用就选哪个，挑选合适的 R 包</p>
<div class="sourceCode" id="cb2524"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># remotes::install_github("ropenscilabs/packagemetrics")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://renkun-ken.github.io/formattable/">formattable</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">packagemetrics</span><span class="op">)</span>
<span class="va">packages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/subset.html">subset</a></span><span class="op">(</span><span class="va">pdb</span>, <span class="va">Maintainer</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/utils/maintainer.html">maintainer</a></span><span class="op">(</span><span class="st">"rmarkdown"</span><span class="op">)</span>, select <span class="op">=</span> <span class="st">"Package"</span><span class="op">)</span>

<span class="va">pdb_metrics</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">packages</span>, <span class="fl">1</span>, <span class="va">combine_metrics</span><span class="op">)</span>
<span class="va">pdb_metrics</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbindlist</a></span><span class="op">(</span><span class="va">pdb_metrics</span>, fill <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">pd</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/subset.html">subset</a></span><span class="op">(</span><span class="va">pdb_metrics</span>, select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="st">"package"</span>, <span class="st">"published"</span>, <span class="st">"dl_last_month"</span>,
    <span class="st">"stars"</span>, <span class="st">"forks"</span>, <span class="st">"last_commit"</span>,
    <span class="st">"depends_count"</span>, <span class="st">"watchers"</span><span class="op">)</span>
  <span class="op">)</span> |&gt; 
  <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/transform.data.table.html">transform</a></span><span class="op">(</span>last_commit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">last_commit</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="va">pd</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">pd</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">""</span>

<span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/formattable.html">formattable</a></span><span class="op">(</span>
  <span class="va">pd</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    package <span class="op">=</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/formatter.html">formatter</a></span><span class="op">(</span><span class="st">"span"</span>,
      style <span class="op">=</span> <span class="va">x</span> <span class="op">~</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/style.html">style</a></span><span class="op">(</span>font.weight <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>
    <span class="op">)</span>,
    contributors <span class="op">=</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/color_tile.html">color_tile</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"#1CC2E3"</span><span class="op">)</span>,
    depends_count <span class="op">=</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/color_tile.html">color_tile</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"#1CC2E3"</span><span class="op">)</span>,
    reverse_count <span class="op">=</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/color_tile.html">color_tile</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"#1CC2E3"</span><span class="op">)</span>,
    tidyverse_happy <span class="op">=</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/formatter.html">formatter</a></span><span class="op">(</span><span class="st">"span"</span>,
      style <span class="op">=</span> <span class="va">x</span> <span class="op">~</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/style.html">style</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fifelse.html">ifelse</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"purple"</span>, <span class="st">"white"</span><span class="op">)</span><span class="op">)</span>,
      <span class="va">x</span> <span class="op">~</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/icontext.html">icontext</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fifelse.html">ifelse</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"glass"</span>, <span class="st">"glass"</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>,
    vignette <span class="op">=</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/formatter.html">formatter</a></span><span class="op">(</span><span class="st">"span"</span>,
      style <span class="op">=</span> <span class="va">x</span> <span class="op">~</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/style.html">style</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fifelse.html">ifelse</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"green"</span>, <span class="st">"white"</span><span class="op">)</span><span class="op">)</span>,
      <span class="va">x</span> <span class="op">~</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/icontext.html">icontext</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fifelse.html">ifelse</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"ok"</span>, <span class="st">"ok"</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>,
    has_tests <span class="op">=</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/formatter.html">formatter</a></span><span class="op">(</span><span class="st">"span"</span>,
      style <span class="op">=</span> <span class="va">x</span> <span class="op">~</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/style.html">style</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fifelse.html">ifelse</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"green"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span>,
      <span class="va">x</span> <span class="op">~</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/icontext.html">icontext</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fifelse.html">ifelse</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"ok"</span>, <span class="st">"remove"</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>,
    dl_last_month <span class="op">=</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/color_bar.html">color_bar</a></span><span class="op">(</span><span class="st">"#56A33E"</span><span class="op">)</span>,
    forks <span class="op">=</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/color_tile.html">color_tile</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"#56A33E"</span><span class="op">)</span>,
    stars <span class="op">=</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/color_tile.html">color_tile</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"#56A33E"</span><span class="op">)</span>,
    last_commit <span class="op">=</span> <span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/color_tile.html">color_tile</a></span><span class="op">(</span><span class="st">"#F06B13"</span>, <span class="st">"white"</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="pkg-growth" class="section level3" number="35.5.9">
<h3>
<span class="header-section-number">35.5.9</span> R 包增长速度<a class="anchor" aria-label="anchor" href="#pkg-growth"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb2525"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 抓取网页数据</span>
<span class="va">pkgs</span> <span class="op">&lt;-</span> <span class="va">pdb</span> |&gt;
  <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/transform.data.table.html">transform</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/flip.html">rev</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/ncell.html">nrow</a></span><span class="op">(</span><span class="va">pdb</span><span class="op">)</span><span class="op">)</span>, Date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html">as.Date</a></span><span class="op">(</span><span class="va">Date</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/transform.data.table.html">transform</a></span><span class="op">(</span>Month <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">Date</span>, format <span class="op">=</span> <span class="st">"%Y-%m"</span><span class="op">)</span><span class="op">)</span>

<span class="va">pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/aggregate.sf.html">aggregate</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">count</span> <span class="op">~</span> <span class="va">Month</span>, data <span class="op">=</span> <span class="va">pkgs</span>, FUN <span class="op">=</span> <span class="va">min</span><span class="op">)</span>

<span class="va">pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/transform.data.table.html">transform</a></span><span class="op">(</span><span class="va">pkgs</span>, Date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">Month</span>, <span class="st">"-01"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/raster/man/subset.html">subset</a></span><span class="op">(</span><span class="va">Date</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html">as.Date</a></span><span class="op">(</span><span class="st">"2012-12-31"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># 计算自2013年以来 R 包增长速度</span>
<span class="va">new_pkgs</span> <span class="op">&lt;-</span> <span class="va">pkgs</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/raster/man/subset.html">subset</a></span><span class="op">(</span><span class="va">Date</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html">as.Date</a></span><span class="op">(</span><span class="st">"2012-12-31"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/transform.data.table.html">transform</a></span><span class="op">(</span>publishedGrowth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">tail</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">count</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span> <span class="op">/</span> <span class="va">count</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/transform.data.table.html">transform</a></span><span class="op">(</span>counter <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/ncell.html">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span>

<span class="co"># 绘图</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span>

<span class="va">gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pkgs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Date</span>, y <span class="op">=</span> <span class="va">count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_log10</a></span><span class="op">(</span>
    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">100</span>, <span class="fl">1000</span>, <span class="fl">10000</span><span class="op">)</span>,
    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"10"</span>, <span class="st">"100"</span>, <span class="st">"1.000"</span>, <span class="st">"10.000"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"# Packages (log)"</span>,
    title <span class="op">=</span> <span class="st">"Packages published on CRAN ever since"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span>, base_family <span class="op">=</span> <span class="st">"sans"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.grid.major.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, size <span class="op">=</span> <span class="fl">1</span>, colour <span class="op">=</span> <span class="st">"#535353"</span><span class="op">)</span>

<span class="va">gg2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">new_pkgs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Date</span>, y <span class="op">=</span> <span class="va">count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">new_pkgs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summarize-generics.html">min</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.048</span><span class="op">^</span><span class="va">counter</span><span class="op">)</span><span class="op">)</span>,
    color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">.7</span>, linetype <span class="op">=</span> <span class="fl">1</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>,
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html">as.Date</a></span><span class="op">(</span><span class="st">"2015-04-01"</span><span class="op">)</span>, xend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html">as.Date</a></span><span class="op">(</span><span class="st">"2015-08-01"</span><span class="op">)</span>,
    y <span class="op">=</span> <span class="fl">1000</span>, yend <span class="op">=</span> <span class="fl">1000</span>, colour <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">1</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>,
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html">as.Date</a></span><span class="op">(</span><span class="st">"2016-12-01"</span><span class="op">)</span>,
    y <span class="op">=</span> <span class="fl">1000</span>, label <span class="op">=</span> <span class="st">"4.6% growth estimation"</span>, size <span class="op">=</span> <span class="fl">3.5</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>
    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">12000</span>, by <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span>,
    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">12000</span>, by <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    y <span class="op">=</span> <span class="st">"# Packages"</span>, x <span class="op">=</span> <span class="st">""</span>,
    subtitle <span class="op">=</span> <span class="st">"Packages published on CRAN since 2013"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>
    base_size <span class="op">=</span> <span class="fl">11</span>, base_family <span class="op">=</span> <span class="st">"sans"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.grid.major.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, size <span class="op">=</span> <span class="fl">.6</span>, colour <span class="op">=</span> <span class="st">"#535353"</span><span class="op">)</span>

<span class="va">gg</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">gg2</span>, vp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/viewport.html">viewport</a></span><span class="op">(</span><span class="fl">.70</span>, <span class="fl">.31</span>, <span class="fl">.43</span>, <span class="fl">.43</span><span class="op">)</span><span class="op">)</span></code></pre></div>

</div>
</div>
</div>
<h3>参考文献</h3>
<div id="refs" class="references csl-bib-body">
<div id="ref-Hadley_2019_tidyverse" class="csl-entry">
<div class="csl-left-margin">[89] </div>
<div class="csl-right-inline">H. Wickham <em>et al.</em>, <span>“Welcome to the <span class="nocase">tidyverse</span>,”</span> <em>Journal of Open Source Software</em>, vol. 4, no. 43, p. 1686, 2019, doi: <a href="https://doi.org/10.21105/joss.01686">10.21105/joss.01686</a>.</div>
</div>
<div id="ref-ludecke2019insight" class="csl-entry">
<div class="csl-left-margin">[90] </div>
<div class="csl-right-inline">D. Lüdecke, P. Waggoner, and D. Makowski, <span>“<span class="nocase">insight</span>: A unified interface to access information from model objects in r,”</span> <em>Journal of Open Source Software</em>, vol. 4, no. 38, p. 1412, 2019, doi: <a href="https://doi.org/10.21105/joss.01412">10.21105/joss.01412</a>.</div>
</div>
<div id="ref-makowski2019bayestestr" class="csl-entry">
<div class="csl-left-margin">[91] </div>
<div class="csl-right-inline">D. Makowski, M. Ben-Shachar, and D. Lüdecke, <span>“<span class="nocase">bayestestR</span>: Describing effects and their uncertainty, existence and significance within the bayesian framework,”</span> <em>Journal of Open Source Software</em>, vol. 4, no. 40, p. 1541, 2019, doi: <a href="https://doi.org/10.21105/joss.01541">10.21105/joss.01541</a>.</div>
</div>
<div id="ref-Breiman_2001_Modeling" class="csl-entry">
<div class="csl-left-margin">[92] </div>
<div class="csl-right-inline">L. Breiman, <span>“Statistical modeling: The two cultures (with comments and a rejoinder by the author),”</span> <em>Journal of the American Statistical Association</em>, vol. 16, no. 3, pp. 199–231, Dec. 2001, doi: <a href="https://doi.org/10.1214/ss/1009213726">10.1214/ss/1009213726</a>.</div>
</div>
<div id="ref-Statisticians_1997_Johnson" class="csl-entry">
<div class="csl-left-margin">[93] </div>
<div class="csl-right-inline">N. L. Johnson and S. Kotz, <em>Leading personalities in statistical sciences: From the seventeenth century to the present</em>. New York, NY: John Wiley &amp; Sons, 1997.</div>
</div>
<div id="ref-Dobson_1983_Modelling" class="csl-entry">
<div class="csl-left-margin">[94] </div>
<div class="csl-right-inline">A. J. Dobson, <em>An introduction to statistical modelling</em>, 1st ed. London: Chapman; Hall/CRC, 1983. doi: <a href="https://doi.org/10.1007/978-1-4899-3174-0">10.1007/978-1-4899-3174-0</a>.</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="chap-spatial-viz.html"><span class="header-section-number">34</span> 空间数据可视化</a></div>
<div class="next"><a href="chap-data-explorer.html"><span class="header-section-number">36</span> 数据探索</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#chap-case-study"><span class="header-section-number">35</span> 案例研究</a></li>
<li><a class="nav-link" href="#sec-life-of-statisticians"><span class="header-section-number">35.1</span> 统计学家生平</a></li>
<li><a class="nav-link" href="#sec-history-of-r"><span class="header-section-number">35.2</span> R 语言发展历史</a></li>
<li><a class="nav-link" href="#sec-PlantGrowth"><span class="header-section-number">35.3</span> 不同实验条件下植物生长情况</a></li>
<li><a class="nav-link" href="#sec-orange"><span class="header-section-number">35.4</span> 橘树生长情况</a></li>
<li>
<a class="nav-link" href="#pkg-network"><span class="header-section-number">35.5</span> R 包网络分析</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#R-Core-Team"><span class="header-section-number">35.5.1</span> R 核心团队</a></li>
<li><a class="nav-link" href="#Top-Creators"><span class="header-section-number">35.5.2</span> 高产的开发者</a></li>
<li><a class="nav-link" href="#R-Package-Developers"><span class="header-section-number">35.5.3</span> 社区开发者</a></li>
<li><a class="nav-link" href="#first-commit"><span class="header-section-number">35.5.4</span> 首次贡献 R 包</a></li>
<li><a class="nav-link" href="#Contribution-Network"><span class="header-section-number">35.5.5</span> 贡献关系网络</a></li>
<li><a class="nav-link" href="#CRAN-Update-Packages"><span class="header-section-number">35.5.6</span> 更新知多少</a></li>
<li><a class="nav-link" href="#Package-Licenses"><span class="header-section-number">35.5.7</span> 使用许可证</a></li>
<li><a class="nav-link" href="#Choose-Package"><span class="header-section-number">35.5.8</span> 选择 R 包</a></li>
<li><a class="nav-link" href="#pkg-growth"><span class="header-section-number">35.5.9</span> R 包增长速度</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/XiangyunHuang/masr/blob/devel/case-study.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/XiangyunHuang/masr/edit/devel/case-study.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>现代应用统计与 R 语言</strong>: Modern Applied Statistics with R" was written by 黄湘云. It was last built on 2021-10-12.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
